(new R9.logger).time("combined");(function(c){function k(){var a=c('\x3cdiv class\x3d"scroll-bar"\x3e\x3cdiv class\x3d"gutter"\x3e\x3c/div\x3e\x3cdiv class\x3d"handle"\x3e\x3c/div\x3e\x3c/div\x3e').insertAfter(this);this.data("scrollbar",a);a.find(".handle").height(this[0].offsetHeight/this[0].scrollHeight*100+"%")}function l(){var a=this.data("scrollbar"),b=a.find(".handle");a.find(".gutter");var d=this,g=0;this.on("touchstart",function(a){g=a.touches[0].pageY});this.on("touchmove",function(a){var b=this.scrollTop+10*(0<g-a.touches[0].pageY?
1:-1);e.bind(c(this))(b);a.preventDefault()});this.on("mousewheel DOMMouseScroll",function(a){var b=a.originalEvent,b=this.scrollTop+10*(0>(b.wheelDelta||-b.detail)?1:-1);e.bind(c(this))(b);a.preventDefault()});a.on("click",".gutter",function(a){a=a.pageY||a.clientY;e.bind(d)(h.bind(d)(a),!0)});b.on("mousedown",function(){window.getSelection&&window.getSelection().removeAllRanges();b.addClass("hover");c(document).on("mousemove.scrollhandle",function(a){var b=a.pageY||a.clientY;a.preventDefault();
e.bind(d)(h.bind(d)(b))});c(document).on("mouseup.scrollhandle",function(a){b.removeClass("hover");c(document).off(".scrollhandle")});var a=m();if(a.changeEvt)c(document).on(a.changeEvt,function(){document[a.hiddenProp]&&(b.removeClass("hover"),c(document).off(".scrollhandle"))})})}function m(){var a,b;"undefined"!==typeof document.hidden?(a="hidden",b="visibilitychange"):"undefined"!==typeof document.msHidden?(a="msHidden",b="msvisibilitychange"):"undefined"!==typeof document.webkitHidden&&(a="webkitHidden",
b="webkitvisibilitychange");return{hiddenProp:a,changeEvt:b}}function h(a){var b=this.data("scrollbar"),d=b.find(".handle"),b=b.find(".gutter");a=a-b.offset().top-d.outerHeight()/2;var c=this[0].scrollHeight-this[0].offsetHeight,d=b.height()-d.outerHeight();return c/d*a}function e(a,b){b?this.animate({scrollTop:a},{duration:100,step:f.bind(this),complete:f.bind(this)}):(this[0].scrollTop=a,f.bind(this)())}function f(){var a=this.data("scrollbar");if(a){var b=a.find(".handle"),a=a.find(".gutter"),
c=this[0].scrollTop,e=this[0].scrollHeight-this[0].offsetHeight,a=(a.height()-b.outerHeight())/e*c+b.outerHeight()/2-b.outerHeight()/2+5;b.css("top",a)}}function n(a){a&&"undefined"!==typeof a.scrollTo&&e.bind(this)(a.scrollTo);a&&a.reset&&e.bind(this)(0)}c.fn.scroller=function(a){var b=this.data("scrollbar");if(b)this[0].offsetHeight>=this[0].scrollHeight?b.hide():b.show();else{if(this[0].offsetHeight>=this[0].scrollHeight)return;k.bind(this)();l.bind(this)()}n.bind(this)(a);return this}})(jQuery);(function(c,e){var l=c.config.getBoolean("ui.horizon.widgets.styleJamSelect.scrollLock",!1),k=function(a){c.dom.toggleOneClass(document.body,"scroll-locked",a)};c.createWidgetClass("select.StyleJamSelect",{input:null,inputStatus:null,display:null,displayStatus:null,content:null,background:null,listWrapper:null,list:null,container:null,inlineElementName:null,isOpen:!1,isOpening:!1,options:{modal:!1,container:"",onOpen:null,onClose:null,change:null,onChange:null,alignment:"left",minWidth:300,modalBelowDisplay:!1,
showLabel:!0,showFocusIndication:!1,selectOnFocus:!0,focusModeHighlight:"",showInfoItem:!1,infoItemEnabledClass:"",infoItemDisabledClass:"",infoItemOptionValues:null,infoItemOptionTooltips:null,repositionOnScroll:!1},init:function(){this.input=this.getChildElement("input");this.inputStatus=this.getChildElement("input-status");this.content=this.getChildElement("content");this.list=this.getChildElement("list");this.listWrapper=this.getChildElement("list-wrapper");this.options.container&&(this.container=
e(this.options.container),this.container.length||(this.container=null));this.options.modal?(this.display=this.getChildElement("display"),this.displayStatus=this.getChildElement("display-status"),this.background=this.getChildElement("bg"),this.inlineElementName="display"):this.inlineElementName="input";this.options.showInfoItem&&this.setupInfoOptionItem()},addEventHandlers:function(){var a=this;this.registerEvent("click",this[this.inlineElementName],function(){a.toggleContent()});this.registerEvent("keydown.select",
this[this.inlineElementName],function(b){a.handleKeyboardNavigation(b,a.inlineElementName)});this.registerEvent("focus",this[this.inlineElementName],this.onFocus.bind(this,this.inlineElementName));this.registerEvent("keydown.select",document,function(b){a.handleDocumentKeyboardNavigation(b,a.inlineElementName)});this.inputStatus.on("change",function(b){if(a.options.change){var c,d;d=e(this);c=d.attr("data-value");d=d.html();a.options.change.call(a,b,c,d)}});this.list.on("click","li",function(){a.updateValue(e(this),
!0);a.close()});l&&(this.registerEvent("mouseenter",this.list,function(){a.list.one("scroll",k.bind(window,!0))}),this.registerEvent("mouseleave",this.list,k.bind(window,!1)));this.registerEvent("click.select touchstart.select",e(document),function(b){0===e(b.target).closest("#"+a.id("content")+", #"+a.id()).length&&(a.close(),a.onBlur(a.options.modal?"display":"input"))});this.options.repositionOnScroll&&this.registerEvent("scroll",e(window),function(){c.dom.schedule(a.position.bind(a))});this.registerEvent("resize",
e(window),function(){c.dom.schedule(a.position.bind(a))});this.options.showFocusIndication&&this.subscribe("body.accessibilityMode.enabled",function(b){b?c.dom.swapClasses(a[a.inlineElementName],"",a.options.focusModeHighlight):c.dom.swapClasses(a[a.inlineElementName],a.options.focusModeHighlight,"")})},handleKeyboardNavigation:function(a,b){switch(a.which){case c.globals.keyCodes.SPACE:case c.globals.keyCodes.RETURN:this.isOpen||(this.isOpening=!0,this.open(),a.preventDefault());break;case c.globals.keyCodes.DOWN:case c.globals.keyCodes.UP:a.preventDefault();
this.isOpen||(this.isOpening=!0,this.open());break;case c.globals.keyCodes.TAB:this.isOpen&&this.close(),this.onBlur(b)}},handleDocumentKeyboardNavigation:function(a,b){switch(a.which){case c.globals.keyCodes.SPACE:case c.globals.keyCodes.RETURN:this.isOpen&&!this.isOpening?(this.updateValue(this.getHighlightedItems().first(),!1),this.triggerChange(),this.close(),a.preventDefault()):this.isOpening&&(this.isOpening=!1);break;case c.globals.keyCodes.DOWN:this.isOpen&&!this.isOpening?(a.preventDefault(),
a=this.list.find("li.js-focus").next(),a.length||(a=this.list.children("li[data-selected\x3dtrue]"),a.length||(a=this.list.children().eq(0))),this.focusItem(a)):this.isOpening&&(this.isOpening=!1);break;case c.globals.keyCodes.UP:this.isOpen&&!this.isOpening&&(a.preventDefault(),a=this.list.find("li.js-focus").prev(),a.length||(a=this.list.children("li[data-selected\x3dtrue]"),a.length||(a=this.list.children().eq(0))),this.focusItem(a));break;case c.globals.keyCodes.TAB:this.isOpen&&(this.close(),
this.focusInlineElement(),this.onBlur(b));break;case c.globals.keyCodes.ESC:this.isOpen&&(this.updateSelection(this.getSelectedItem()),this.close(),this.focusInlineElement())}},isValidElement:function(){return!0},focusInlineElement:function(){this[this.inlineElementName].focus()},onFocus:function(a){c.dom.swapChildrenClasses(this[a],this.options.sjstate[a],"blurred","focused")},onBlur:function(a){c.dom.swapChildrenClasses(this[a],this.options.sjstate[a],"focused","blurred")},toggleContent:function(){this.isOpen?
this.close():this.open()},open:function(){if(!this.isOpen){this.position();var a=this;this.isOpen=!0;if(this.container)this.container.off("scroll."+a.id()).on("scroll."+a.id(),function(){a.isOpen&&a.position()});this.list.scroller();setTimeout(function(){a.ensureVisible(a.getSelectedItem(),!0)},200);c.dom.swapChildrenClasses(this.content,this.options.sjstate.content,"closed","open");c.dom.swapChildrenClasses(this.input,this.options.sjstate.input,"closed","open");c.dom.swapChildrenClasses(this.display,
this.options.sjstate.display,"closed","open");if("function"===typeof this.options.onOpen)this.options.onOpen(this);this.display&&this.display.attr("aria-expanded",!0);c.events.publish("Select.opened",{id:this.id()})}},close:function(){if(this.isOpen){l&&k(!1);var a=this.isOpen;this.isOpen=!1;c.dom.swapChildrenClasses(this.content,this.options.sjstate.content,"open","closed");c.dom.swapChildrenClasses(this.input,this.options.sjstate.input,"open","closed");c.dom.swapChildrenClasses(this.display,this.options.sjstate.display,
"open","closed");if("function"===typeof this.options.onClose)this.options.onClose(a,this);this.display&&this.display.attr("aria-expanded",!1);this.options.selectOnFocus&&this.focusInlineElement();c.events.publish("Select.closed",{id:this.id()})}},position:function(){var a=this.getPositionElement(),b=a.offset(),c=a.outerWidth(),d=e(window).outerWidth(),g={};if(this.container)var f=this.container.offset(),b={top:this.options.modalBelowDisplay?1:b.top-f.top+container.scrollTop(),left:this.options.modalBelowDisplay?
0:b.left-f.left};this.options.modal?(this.background.css({width:c-16,height:this.display.outerHeight()-16}),f=Math.max(c,this.options.minWidth),this.content.css({minWidth:f>d?d:f,maxWidth:d}),a=this.options.modalBelowDisplay?Math.floor(b.top+a.outerHeight()+1):Math.floor(b.top)):(a=Math.floor(b.top+a.outerHeight()),g.minWidth=c);f=this.content.outerWidth();b="right"===this.options.alignment?Math.ceil(b.left-(f-c)):Math.floor(b.left);b+f>d&&(d=d-f-10,b=0<d?d:0);g.transform="translate("+b+"px, "+a+
"px)";g.msTransform=g.transform;this.content.css(g)},getPositionElement:function(){return this.options.modal?this.display:this.input},ensureVisible:function(a,b){if(a.position()){var c=a.position().top;a=a.outerHeight(!0);var d=this.listWrapper.scrollTop(),g=this.listWrapper.height(),f=this.list.scrollTop();if(b){b=this.list[0].scrollHeight;var e=c+this.list.scrollTop(),h=(g-a)/2;if(e>h&&b-e>h){this.list.scroller({scrollTo:d+f+c-h});return}e<h?this.list.scroller({scrollTo:0}):this.list.scroller({scrollTo:b-
g})}0>c?this.list.scroller({scrollTo:d+f+c}):c+a>g&&this.list.scroller({scrollTo:d+f+(c+a-g)})}},getSelectedItem:function(){var a=this.list.find("li"),b=a.filter("[data-value\x3d'"+this.val()+"']");return b.length?b:a.first()},getHighlightedItems:function(){return this.list.children("li.js-focus")},focusItem:function(a){if(this.options.selectOnFocus)this.updateSelection(a);else{var b=this.list.children(".js-focus");b.removeClass("js-focus").attr("aria-selected",!1);a.addClass("js-focus").attr("aria-selected",
!0);var e=this.getStlBlock("item-focused");c.dom.swapClasses(b,e,"");c.dom.swapClasses(a,"",e);(this.display||this.element).attr("aria-activedescendant",a.attr("id"));this.isOpen&&this.ensureVisible(a,!0)}},toggleItemSelection:function(a,b){a.toggleClass("js-focus",b).attr("aria-selected",b);c.dom.swapChildrenClasses(a,this.options.sjstate.listItem,b?"deselected":"selected",b?"selected":"deselected")},updateSelection:function(a){(this.display||this.element).attr("aria-activedescendant",a.attr("id"));
this.toggleItemSelection(this.getHighlightedItems(),!1);this.toggleItemSelection(a,!0);this.options.selectOnFocus&&a.focus()},updateValue:function(a,b){this.isNodeDisabled(a)||(this.isOpen&&this.ensureVisible(a,!0),this.updateSelection(a),this.setInputValue(a),this.options.showInfoItem&&this.setupInfoOptionItem(),b&&this.triggerChange())},triggerChange:function(){"function"===typeof this.options.change&&this.inputStatus.trigger("change")},setInputValue:function(a){var b=a.attr("data-value");a=a.attr("data-labelText")||
a.attr("data-title");this.inputStatus.html(a);this.inputStatus.attr("data-value",b);this.inputStatus.attr("data-title",a);this.options.modal&&this.options.showLabel&&(this.displayStatus.html(a),this.displayStatus.attr("data-value",b),this.displayStatus.attr("data-title",a));this.options.modal&&this.getChildElement("display-text").attr("aria-label",a);this.element.hasValue=!!b},setupInfoOptionItem:function(){var a=this.options.infoItemOptionValues;if(a&&0<a.length){var b=this.getChildElement("post-info"),
a=a.indexOf(this.getValue());-1<a?((a=this.options.infoItemOptionTooltips[a])&&b.toolTip({content:a,extraClass:"halfWidth"}),c.dom.swapClasses(b,this.options.infoItemDisabledClass,this.options.infoItemEnabledClass)):c.dom.swapClasses(b,this.options.infoItemEnabledClass,this.options.infoItemDisabledClass)}},_getItemByValue:function(a){return this.list.find("li[data-value\x3d'"+a+"']")},val:function(){return this.inputStatus.attr("data-value")},getValue:function(){return this.val()},dataVal:function(){return this.inputStatus.attr("data-value")},
getDataValue:function(){return this.dataVal()},getText:function(){return this.inputStatus.html()},setText:function(a){this.inputStatus.html(a)},setValue:function(a,b){a=this._getItemByValue(a);this.updateValue(a,b)},setValueOrDefault:function(a,b){a=this._getItemByValue(a);a.length?this.updateValue(a,b):this.setValue("",b)},getItemText:function(a){a=this._getItemByValue(a);if(a.length)return a.html()},updateItemText:function(a,b){var c=this._getItemByValue(a);c.length&&(c.attr("data-title",b),c.html(b));
a===this.getDataValue()&&this.setInputValue(c)},updateItemValue:function(a,b,c){a=this._getItemByValue(a);a.length&&a.attr("data-value",b);c&&(this.setInputValue(a),this.updateSelection(a))},selectItem:function(a,b){a=this._getItemByValue(a);b&&(this.setInputValue(a),this.updateSelection(a))},isNodeSelected:function(a){return a.length&&"true"===a.attr("data-selected")},isNodeDisabled:function(a){return a.length&&a.attr("disabled")},getNodeDataValue:function(a){return a.length?a.attr("data-value"):
""},disableValue:function(a){a=this._getItemByValue(a);a.length&&a.attr("disabled","disabled")},enableValue:function(a){a=this._getItemByValue(a);a.length&&a.removeAttr("disabled")},hideNode:function(a){a=this._getItemByValue(a);a.length&&(this.swapClasses(a,"","Select__content__list__list-item--hidden"),a.attr("hidden","hidden"))},showNode:function(a){a=this._getItemByValue(a);a.length&&(this.swapClasses(a,"Select__content__list__list-item--hidden",""),a.removeAttr("hidden"))},hasVisibleNodes:function(){var a=
this.list.find("li");return a.length>a.filter("[hidden\x3d'hidden']").length}})})(window.R9,window.jq||window.jQuery);(function(d,e){d.createComponentClass("common.search.SearchFormDisplaySwitch",{options:{isRadiobuttonSet:!1,isSelect:!1,isCheckbox:!1,options:null,baseEvent:"",namespace:null},switch:null,switchElement:null,checkOptions:null,init:function(){var a=this;this.switchElement=this.getChildElement("switch");this.checkOptions={};e.each(this.options.options,function(b,c){a.checkOptions[c.displayOption?"checked":"unchecked"]=c})},addEventHandlers:function(){},inlineComponentsReady:function(){this.switch=this.switchElement.getWidget();
this.options.isRadiobuttonSet?this.switch.options.change=this.onRadioChange.bind(this):this.options.isSelect?this.switch.options.change=this.onSelectChange.bind(this):this.options.isCheckbox&&(this.switch=e.fn.styleJamCheckBox?this.switchElement.styleJamCheckbox({change:this.onCheckChange.bind(this)}).getWidget():this.switchElement.checkbox({change:this.onCheckChange.bind(this)}).getWidget());this.subscribe(this.options.baseEvent+".set",this.setDisplay.bind(this));this.subscribe(this.options.baseEvent+
".focus",this.focus.bind(this));this.subscribe(this.options.baseEvent+".trigger",this.triggerBy.bind(this))},triggerBy:function(a){(a=this.getChildElement(a))&&a.trigger("click")},onRadioChange:function(a,b,c){this.publishChangeEvent(a.value,b.title)},onSelectChange:function(a,b,c){this.publishChangeEvent(b,c)},onCheckChange:function(a){a=this.checkOptions[a.checked?"checked":"unchecked"];this.publishChangeEvent(a.value,a.text)},publishChangeEvent:function(a,b){d.events.publish(this.options.baseEvent+
".change",{value:a,text:b,namespace:this.options.namespace})},setDisplay:function(a){this.options.isRadiobuttonSet?this.switch.setButtonCheckedByValue(a):this.options.isSelect?this.switch.setValue(a,!1):this.options.isCheckbox&&(this.switch.setChecked(this.checkOptions.checked.value===a),this.switch.refresh&&this.switch.refresh(this.switch.element))},focus:function(){this.switchElement.focus()}})})(window.R9,window.jQuery);(function(a,e){a.createWidgetClass("dropdown.StyleJamDropdownDialogTrigger",{options:{states:null,showFocusIndication:!1,useValueLabel:!1},isFocused:!1,isOpen:!1,cover:null,init:function(){this.options.useCover&&(this.cover=this.getChildElement("cover"))},addEventHandlers:function(){var d=this,c=this.options.states||{};this.element.on("focus",this.onFocus.bind(this));this.element.on("blur",this.onBlur.bind(this));this.options.showFocusIndication&&this.subscribe("body.accessibilityMode.enabled",function(b){b?
a.dom.swapClasses(d.element,"",c.focusModeHighlight):a.dom.swapClasses(d.element,c.focusModeHighlight,"")});this.subscribe("hotels.detailsv2.sticky.toggle",function(b){b?a.dom.swapClasses(this.element,this.options.styles.dropdownTrigger,this.options.styles.dropdownTriggerSticky):a.dom.swapClasses(this.element,this.options.styles.dropdownTriggerSticky,this.options.styles.dropdownTrigger)}.bind(this))},onFocus:function(){this.isFocused||(this.setView("focused"),this.isFocused=!0)},onBlur:function(a){if(a||
this.isFocused&&!this.isOpen)this.setView("blurred"),this.isFocused=!1},focus:function(){this.element.focus()},blur:function(){this.element.blur()},open:function(){this.isOpen=!0;this.element.attr("aria-pressed")&&this.element.attr("aria-pressed",!0);this.element.attr("aria-expanded",!0);this.setView("opened");this.onFocus()},close:function(){this.isOpen=!1;this.element.attr("aria-pressed")&&this.element.attr("aria-pressed",!1);this.element.attr("aria-expanded",!1);this.setView("closed");if(!this.element.is(":focus"))this.onBlur()},
setView:function(d){var c=this,b=this.options.states||{};a.dom.schedule(function(){switch(d){case "opened":a.dom.swapClasses(c.element,b.closed,b.opened);c.options.useCover&&(a.dom.swapClasses(c.cover,b.coverClosed,b.coverOpened),c.getChildElement("cover-inner").css("transform","scale("+(c.cover.outerWidth()+2)/c.element.outerWidth()+", 1.333)"));break;case "closed":a.dom.swapClasses(c.element,b.opened,b.closed);c.options.useCover&&(a.dom.swapClasses(c.cover,b.coverOpened,b.coverClosed),c.getChildElement("cover-inner").css("transform",
"scale(1)"));break;case "focused":a.dom.swapClasses(c.element,b.notFocused,b.focused);break;case "blurred":a.dom.swapClasses(c.element,b.focused,b.notFocused)}})},removeHasValue:function(){},addHasValue:function(){},hasValue:function(){return!0},enabled:e.noop,disable:e.noop,isVisible:function(){return this.element.is(":visible")},updateValueText:function(a){this.options.useValueLabel&&this.getChildElement("display-text").attr("aria-label",a)}})})(R9,jQuery);(function(b,c){b.createWidgetClass("button.StyleJamButton",{options:{inactiveStlBlock:"",activeStlBlock:"",canPulse:!1},init:function(){},addEventHandlers:function(){this.options.inactiveStlBlock&&this.options.activeStlBlock&&(this.subscribe("button.deactivate",{id:this.id()},this.toggleActivation.bind(this,!1)),this.subscribe("button.activate",{id:this.id()},this.toggleActivation.bind(this,!0)));this.options.canPulse&&(this.subscribe("button.pulse",{id:this.id()},this.pulse.bind(this,!0)),this.subscribe("button.pulse.reset",
{id:this.id()},this.pulse.bind(this,!1)))},toggleActivation:function(a){this.swapClassesToggle(this.element,this.options.inactiveStlBlock,this.options.activeStlBlock,!a)},pulse:function(a){this.swapClassesToggle(this.element,"","Button--pulse",!a)}})})(R9,jQuery);(function(b){R9.extend("Widgets",{TextInput:function(a,c){this.elementNode=a;this.element=b(this.elementNode);this.validateElement()&&(this.options=b.extend({},this.options,c),this.init())}});R9.extend("Widgets.TextInput",{isTextInput:function(a){return a&&a.nodeName&&"input"==a.nodeName.toLowerCase()&&"text"==a.type.toLowerCase()},isWidgetControlled:function(a){return"undefined"==typeof document.createElement("input").placeholder}});R9.extend("Widgets.TextInput.prototype",{widgetName:"textinput",
widgetBaseClass:"r9-textinput",widgetPlaceholderClass:"r9-textinput-placeholder-active",elementNode:null,element:null,options:{click:null,change:null},init:function(){this.bindInputEvent("focus",this.handleElementFocusEvent);this.bindInputEvent("smartyfocus",this.handleElementFocusEvent);this.bindInputEvent("blur",this.handleElementBlurEvent);this.bindFormSubmission();this.element.data(this.widgetName,this);this.element.is(":focus")||this.handleElementBlurEvent(this.elementNode)},validateElement:function(){return R9.Widgets.TextInput.isTextInput(this.elementNode)&&
R9.Widgets.TextInput.isWidgetControlled(this.elementNode)&&void 0===this.element.data(this.widgetName)},bindInputEvent:function(a,b){var c=this;a+="."+this.widgetName;this.element.unbind(a).bind(a,function(a){b.call(c,this,a)})},bindFormSubmission:function(){var a=this,b="submit."+a.widgetName+a.element.attr("id"),d="form-pre-submit."+a.widgetName+a.element.attr("id");this.element.parents("form").off(b).on(b,function(b){a.element.val()==a.element.attr("placeholder")&&a.clearPlaceholderText(a.element)});
this.element.parents("form").off(d).on(d,function(b){a.element.val()==a.element.attr("placeholder")&&a.clearPlaceholderText(a.element)})},handleElementFocusEvent:function(a,c){a.disabled||(b(a).val()==b(a).attr("placeholder")&&this.clearPlaceholderText(b(a)),this.options.focus&&this.options.focus.apply(this,arguments))},handleElementBlurEvent:function(a,c){a.disabled||(0==b.trim(b(a).val()).length&&this.setPlaceholderText(a),this.options.blur&&this.options.blur.apply(this,arguments))},clearPlaceholderText:function(a){a.removeClass(this.widgetPlaceholderClass).val("")},
setPlaceholderText:function(a){b(a).addClass(this.widgetPlaceholderClass).val(b(a).attr("placeholder"))}})})(jq||jQuery);
(function(b){R9.createWidgetClass("text.StyleJamTextInput",b.extend({},R9.Widgets.TextInput.prototype,{widgetPlaceholderClass:"vs-placeholder",inputElement:null,inputState:null,options:{needsPlaceholderSupport:!1,selectOnFocus:!1,inputValidationEnabled:!1,presentationStates:{}},init:function(){this.inputElement=this.inputElement||this.element;this.elementNode=this.inputElement.get(0);this.options.inputValidationEnabled&&(this.inputState=this.getChildElement("inputState"),this.inputError=this.getChildElement("inputError"),
this.inputSuccess=this.getChildElement("inputSuccess"))},addEventHandlers:function(){var a=this;(this.options.needsPlaceholderSupport||this.options.presentationStates)&&this.bindInputEvent("focus",this.handleElementFocusEvent);this.options.needsPlaceholderSupport&&(this.element.is(":focus")||this.handleElementBlurEvent(this.elementNode),this.bindInputEvent("smartyfocus",this.handleElementFocusEvent),this.bindInputEvent("blur",this.handleElementBlurEvent));if(this.options.selectOnFocus)a.inputElement.on("focus",
function(){a.inputElement.on("mouseup.a keyup.a",function(b){a.elementNode.setSelectionRange(0,9999);a.inputElement.off("mouseup.a keyup.a").select()})});this.options.inputValidationEnabled&&null!==this.inputState&&this.subscribe("input.validation",a.handleValidation.bind(this));this.options.presentationStates&&this.styleInvalidState()},getValue:function(){return b(this.inputElement).val()},handleElementFocusEvent:function(a,b){this.options.presentationStates&&this.styleInvalidState(!1);R9.Widgets.TextInput.prototype.handleElementFocusEvent.call(this,
a,b)},styleInvalidState:function(a){a?R9.dom.swapClasses(b(this.elementNode),this.options.presentationStates.regular,this.options.presentationStates.invalid):R9.dom.swapClasses(b(this.elementNode),this.options.presentationStates.invalid,this.options.presentationStates.regular)},handleValidation:function(a){a&&a.state&&a.inputEl===this.element.id()&&("error"===a.state&&this.swapClasses(this.inputError,"TextInput__State--hidden","TextInput__State--visible"),"success"===a.state&&this.swapClasses(this.inputSuccess,
"TextInput__State--hidden","TextInput__State--visible"))}}))})(jq||jQuery);(function(c){R9.extend("Widgets",{NumberBox:function(b,a){this.inputNode=c(b).find("input")[0];this.jqNode=c(b);if(!this.isValidElement())return this;this.options=c.extend({},this.options,a);this.init()}});R9.extend("Widgets.NumberBox.prototype",{widgetName:"r9NumberBox",inputNode:null,jqNode:null,options:{min:0,max:6,defaultValue:0,callback:c.noop,validator:null,onlyDecorateDisabledButtons:!1},boxValue:0,incrButton:null,decrButton:null,styleJamButton:null,isValidElement:function(){return this.jqNode&&
this.jqNode.children().hasClass("incrementor")&&this.jqNode.children().hasClass("decrementor")&&this.jqNode.children().hasClass("numberHolder")},canChange:function(b){return"function"===typeof this.options.validator?this.options.validator.call(this,b,this.boxValue):!0},getStyleJamButton:function(){return R9.stylejam&&R9.stylejam.common&&R9.stylejam.common.widgets&&R9.stylejam.common.widgets.button?R9.stylejam.common.widgets.button.StyleJamButton:null},increment:function(){if(this.boxValue<this.options.max&&
this.canChange(1))return this.boxValue+=1,this.updateView(),this.options.callback.call(this,1,this.boxValue),!0;this.disableButton(this.incrButton);return!1},decrement:function(){if(this.boxValue>this.options.min&&this.canChange(-1))return--this.boxValue,this.updateView(),this.options.callback.call(this,-1,this.boxValue),!0;this.disableButton(this.decrButton);return!1},updateView:function(){c(this.inputNode).val(this.boxValue);c(this.inputNode).trigger("change");c(this.jqNode).attr("aria-valuenow",
this.boxValue);this.boxValue===this.options.max?(this.enableButton(this.decrButton),this.disableButton(this.incrButton)):(this.boxValue===this.options.min?this.disableButton(this.decrButton):this.enableButton(this.decrButton),this.enableButton(this.incrButton));this.ariaLabel&&this.ariaLabel.length&&this.ariaLabelMessage&&this.updateAriaLabel()},updateAriaLabel:function(){this.ariaLabelUpdateId&&(window.clearTimeout(this.ariaLabelUpdateId),this.ariaLabelUpdateId=null);this.ariaLabelUpdateId=window.setTimeout(function(){var b;
b=-1<this.ariaLabelMessage.indexOf("|")?R9.Common.Utils.String.formatChoice(this.ariaLabelMessage,this.boxValue,this.boxValue):R9.Common.Utils.String.formatString(this.ariaLabelMessage,this.boxValue);this.ariaLabel.html(b)}.bind(this),200)},getValue:function(){return this.boxValue},setValue:function(b,a){b=parseInt(b);if(isNaN(b)||this.boxValue===b)return!1;var c=b-this.boxValue;if(!a&&!this.canChange(c))return!1;this.boxValue=b;this.updateView();this.options.callback&&this.options.callback.call(this,
c);return!0},init:function(){this.styleJamButton=this.getStyleJamButton();this.boxValue=""!=this.inputNode.value?parseInt(this.inputNode.value,10):0;this.incrButton=this.jqNode.find(".incrementor");this.decrButton=this.jqNode.find(".decrementor");this.jqNode.data(this.widgetName,this);0<this.options.defaultValue?this.setValue(this.options.defaultValue):!isNaN(this.options.max)&&this.boxValue>this.options.max&&(this.boxValue=this.options.max);c(this.inputNode).prop("readonly","readonly");this.inputNode.value=
this.boxValue;var b=this;this.incrButton.unbind("click").click(function(a){b.increment();jq(b.jqNode).trigger("increment");return!1});this.decrButton.unbind("click").click(function(a){b.decrement();jq(b.jqNode).trigger("decrement");return!1});this.updateView()},enableButton:function(b){b.removeClass("NumberBox-disabled").prop("disabled",!1).attr("aria-disabled","false");this.styleJamButton&&R9.dom.swapClasses(b,this.styleJamButton.plusMinusButtonDisabled,this.styleJamButton.plusMinusButtonEnabled)},
disableButton:function(b){b.addClass("NumberBox-disabled");this.options.onlyDecorateDisabledButtons||b.prop("disabled",!0).attr("aria-disabled","true");this.styleJamButton&&R9.dom.swapClasses(b,this.styleJamButton.plusMinusButtonEnabled,this.styleJamButton.plusMinusButtonDisabled)},disableDecrement:function(){this.disableButton(this.decrButton)},enableDecrement:function(){this.enableButton(this.decrButton)},disableIncrement:function(){this.disableButton(this.incrButton)},enableIncrement:function(){this.enableButton(this.incrButton)}})})(jq||
jQuery);
(function(c,b){c.createWidgetClass("number.StyleJamNumberBox",b.extend({},c.Widgets.NumberBox.prototype,{init:function(a,c){this.styleJamButton=this.getStyleJamButton();this.inputNode=b(a).find("input")[0];this.jqNode=b(a);this.styleJamButton&&this.jqNode.data("presentation")&&(a=this.jqNode.data("presentation"),this.styleJamButton.hasOwnProperty(a)&&(this.styleJamButton=this.styleJamButton[a]));if(!this.isValidElement())return this;this.inputNode&&(this.boxValue=""!==this.inputNode.value?parseInt(this.inputNode.value,
10):0);this.incrButton=this.jqNode.find(".incrementor-js");this.decrButton=this.jqNode.find(".decrementor-js");this.ariaLabel=this.getChildElement("ariaLabel");this.ariaLabelMessage=this.ariaLabel.data("msg");this.ariaLabel.attr("data-msg",null);0<this.options.defaultValue&&0===this.boxValue&&this.setValue(this.options.defaultValue,!0);this.options.withConstant&&(this.options=b.extend({withConstant:!1,descriptionWords:[]},this.options,c),this.index=0,this.countWord=this.jqNode.find(".count-word-js"),
this.options.min=0,this.options.max=this.options.descriptionWords.length-1,this.updateConstantValue(0));b(this.inputNode).prop("readonly","readonly");this.updateView()},isValidElement:function(){return!0},canChange:function(a){return"function"===typeof this.options.validator?this.options.validator.call(this,a,this.boxValue):!0},addEventHandlers:function(a){var d=this;this.incrButton.unbind("click").click(function(a){d.options.withConstant?(d.updateConstantValue(1),d.options.callback.call(d)):d.increment();
jq(d.jqNode).trigger("increment");c.globals.keyboardNav||b(this).blur();return!1});this.decrButton.unbind("click").click(function(a){d.options.withConstant?(d.updateConstantValue(-1),d.options.callback.call(d)):d.decrement();jq(d.jqNode).trigger("decrement");c.globals.keyboardNav||b(this).blur();return!1});this.element.keyup(function(a){if(a.altKey||a.ctrlKey||a.shiftKey)return!0;switch(a.keyCode){case c.globals.keyCodes.DOWN:case c.globals.keyCodes.LEFT:case c.globals.keyCodes.PAGE_DOWN:return d.decrement(),
jq(d.jqNode).trigger("decrement"),a.preventDefault(),a.stopPropagation(),!1;case c.globals.keyCodes.UP:case c.globals.keyCodes.RIGHT:case c.globals.keyCodes.PAGE_UP:return d.increment(),jq(d.jqNode).trigger("increment"),a.preventDefault(),a.stopPropagation(),!1}});this.element.on("keydown",function(a){if(a.altKey||a.ctrlKey||a.shiftKey)return!0;switch(a.keyCode){case c.globals.keyCodes.PAGE_UP:case c.globals.keyCodes.PAGE_DOWN:case c.globals.keyCodes.HOME:case c.globals.keyCodes.END:case c.globals.keyCodes.LEFT:case c.globals.keyCodes.UP:case c.globals.keyCodes.RIGHT:case c.globals.keyCodes.DOWN:return a.preventDefault(),
a.stopPropagation(),!1}})},setValue:function(a,b){a=parseInt(a);if(isNaN(a)||this.boxValue===a)return!1;var c=this.boxValue>a?0===a?a:this.boxValue-a:a-this.boxValue;if(b||this.canChange(c))this.boxValue=a,this.updateView(),this.options.callback&&!b&&this.options.callback.call(this,c)},getIndex:function(){return this.index},setIndex:function(a,b){a=parseInt(a);if(isNaN(a)||this.index===a)return!1;a-=this.index;b&&(this.updateConstantValue(a),this.options.callback&&!b&&this.options.callback.call(this,
a))},updateConstantValue:function(a){a=this.index+a;0<=a&&a<this.options.descriptionWords.length&&(this.index=a,this.countWord.text(this.options.descriptionWords[this.index]));this.index===this.options.max?(this.enableButton(this.decrButton),this.disableButton(this.incrButton)):(this.index===this.options.min?this.disableButton(this.decrButton):this.enableButton(this.decrButton),this.enableButton(this.incrButton))}}))})(window.R9,window.jQuery);(function(k,e){k.createWidgetClass("dropdown.StyleJamDropdownDialog",{element:null,trigger:null,triggerObj:void 0,elementNode:null,content:null,label:null,value:null,icon:null,isOpen:!1,leftOffset:0,ajaxLoadFailed:!1,eventSuffix:null,subValue:null,animationDuration:200,options:{autoOpen:!1,alignment:null,direction:"down",isPopover:!1,showIcon:!0,matchWidth:!1,isFixedWidth:!1,loadWithAjaxOnInit:!1,ajaxUrl:"",ajaxData:{},iconClass:"",contentClass:"",triggerElemId:null,content:null,onInit:null,onOpen:null,
onClose:null,text:"",coverTrigger:!1,topOffset:0,topOffsetFromTrigger:0,leftOffset:0,removeZIndex:!1,flippable:!0,delayShowDropdown:e.noop,showDropdownDelay:200,hasSubValue:!1,animateClose:null,expandTo:null,forceTriggerWidth:!1,openDisabled:!1,staticPosition:!1,subtractContainerOffset:!1},states:null,init:function(){!this.options.alignment&&this.element&&this.element.data("alignment")&&(this.options.alignment=this.element.data("alignment"));!this.options.expandTo&&this.element&&this.element.data("expandto")&&
(this.options.expandTo=this.element.data("expandto"));this.options.alignment||(this.options.alignment="left");this.eventSuffix=".DropdownDialog."+this.id();this.options.autoOpen?this.open():this.element.addClass(this.options.closedStateClzs);this.options.coverTrigger&&(this.cover=this.getChildElement("cover"),this.innerContent=this.getChildElement("inner"));if(this.options.onInit)this.options.onInit(this);this.options.target?this.trigger=this.options.target:this.createTrigger();this.elementNode=this.element[0];
this.createContent();this.popoverArrow=this.getChildElement("popover-arrow");this.options.loadWithAjaxOnInit&&this.options.ajaxUrl&&this.loadAjax();this.options.alignment||(this.options.alignment="left");if(this.options.coverTrigger)this.trigger.one("mouseover",this.reposition.bind(this))},addEventHandlers:function(){function a(a){b.isOpen&&(a=e(a.target).closest(".StyleJamDropdownDialog"),b.content[0]!=a[0]&&b.isOpen&&b.close())}var b=this,c=e("body"),d=this.trigger;c.on("click"+this.eventSuffix,
a);c.on("touchstart"+this.eventSuffix,a);this.subscribe("trips.menu.open",e.proxy(this.close,this));this.subscribe("authentication.showLogin",this.close.bind(this,null,!0));this.registerEvent("click",d,function(d){c.off("click",a);b.toggleContent();setTimeout(function(){c.on("click",a)},10)});this.registerEvent("keydown",d,function(d){if(13===d.which||32===d.which)b.toggleContent(),setTimeout(function(){c.on("click",a)},10),d.preventDefault(),d.stopImmediatePropagation(),d.stopPropagation()});this.registerEvent("keydown"+
this.eventSuffix,e(document),function(a){27===a.which&&b.close(a,null,!0)});this.registerEvent("resize"+this.eventSuffix,e(window),function(){b.isOpen&&b.reposition(!0)});this.registerEvent("scroll"+this.eventSuffix,e(document),function(){b.isOpen&&b.reposition(!0)});this.registerEvent("scroll"+this.eventSuffix,e(".viewport"),function(){b.isOpen&&b.reposition(!0)});var g=null,d=function(){b.triggerObj&&!b.triggerObj.isVisible()||g||k.Common.Utils.Browsers.isIE(11)||(g=setTimeout(function(){b.reposition(!0);
g=null},25))};this.registerEvent("click",this.content.find(".close"),this.close.bind(this));this.subscribe("common.dropdown.closeAll",this.close.bind(this));this.registerEvent("mouseup touchend",this.content,d);this.subscribe("horizon.dropdownDialog.reposition",d)},destroy:function(){this.base();this.trigger.off("mouseover");e(".viewport").off("scroll"+this.eventSuffix);e(window).off("resize"+this.eventSuffix);e(document).off("scroll"+this.eventSuffix).off("keydown"+this.eventSuffix);e(document.body).off("click"+
this.eventSuffix).off("touchstart"+this.eventSuffix);this.content.off("keydown")},createContent:function(){this.content=this.options.content&&this.options.content.length?e(this.options.content):e("#"+this.element.attr("id")+"_content");this.options.isFixedWidth&&this.content.css("width",this.getTriggerWidth()+"px")},createTrigger:function(){if(null!=this.options.triggerElemId)this.trigger=e("#"+this.options.triggerElemId);else{var a=this.element.data("trigger-id");null!=a&&""!==a&&(this.trigger=e("#"+
a))}null!=this.trigger&&this.trigger.length?this.triggerObj=this.trigger.getWidget():this.trigger=this.element;this.label=this.trigger.find(".js-label");this.options.showIcon&&(this.icon=this.trigger.find(".js-icon"));this.options.hasSubValue&&(this.subValue=this.label.find(".js-subValue"));if(this.options.text)this[this.options.hasSubValue?"updateValue":"updateLabel"](this.options.text);else this.options.hasSubValue||(a=this.label.html())&&a.trim()&&this.updateLabel(a.trim())},open:function(){if(!this.options.openDisabled){this.isOpen=
!0;var a=this,b="body";if("function"===typeof this.options.delayShowDropdown&&this.options.delayShowDropdown()&&!this.showDropdownTimeout)this.showDropdownTimeout=setTimeout(this.open.bind(this),this.options.showDropdownDelay);else{null!==this.showDropdownTimeout&&(clearTimeout(this.showDropdownTimeout),this.showDropdownTimeout=null);this.options.container&&""!==this.options.container&&(b=this.options.container,e(a.options.container).off("scroll."+a.id()).on("scroll."+a.id(),function(){a.isOpen&&
a.reposition()}));this.options.isPopover&&this.popoverArrow.show();this.content.appendTo(b);if(this.options.onOpen)this.options.onOpen(this);a.triggerObj&&a.triggerObj.open();this.reposition();k.dom.swapClasses(a.content,this.getStateClasses("closed"),this.getStateClasses("open"));this.options.coverTrigger&&(this.content.removeClass("closed").addClass("open"),k.dom.swapClasses(this.cover,this.getStateClasses("coverClosed"),this.getStateClasses("coverOpened")),k.dom.swapClasses(this.innerContent,this.getStateClasses("contentClosed"),
this.getStateClasses("contentOpened")));this.content.attr("aria-expanded",!0);k.events.publish("DropdownDialog.open",{id:a.id()});this.setupTabKeyHandling()}}},setupTabKeyHandling:function(){var a=this,b=this.getFocusableElements();b.length&&(b.first().focus(),this.content.off("keydown").on("keydown",function(b){var d=a.getFocusableElements(),c=e(b.target),h=d.first().is(c)&&b.shiftKey,c=d.last().is(c)&&!b.shiftKey;b.which===k.globals.keyCodes.TAB&&(1===d.length||h||c)&&a.close(b,!1,!0)}))},getFocusableElements:function(){return this.content.find(":input:visible,[tabindex]:visible").not("[tabindex\x3d-1],[disabled]")},
_close:function(a,b,c){var d=this.isOpen,e=this;this.isOpen=!1;this.options.isPopover&&this.popoverArrow.hide();this.triggerObj&&this.triggerObj.close();k.dom.swapClasses(this.content,this.getStateClasses("open"),this.getStateClasses("closed"));this.options.coverTrigger&&(this.content.removeClass("open").addClass("closed"),k.dom.swapClasses(this.cover,this.getStateClasses("coverOpened"),this.getStateClasses("coverClosed")),k.dom.swapClasses(this.innerContent,this.getStateClasses("contentOpened"),
this.getStateClasses("contentClosed")));this.content.css({top:"",right:"",left:"",bottom:""});this.options.coverTrigger?setTimeout(function(){e.element.append(e.content)},200):this.element.append(this.content);this.content.off("keydown");c&&e.triggerObj&&e.triggerObj.focus();if(this.options.onClose)this.options.onClose(d,this,a);k.events.publish("DropdownDialog.close",{id:this.id(),silent:!!b});this.content.attr("aria-expanded",!1)},close:function(a,b,c){if(this.options.animateClose){var d=this;this.animateClose(function(){d._close(a,
b,c)})}else this.isOpen&&this._close(a,b,c)},toggleContent:function(){this.isOpen?this.close(null,null,!0):this.open()},updateLabel:function(a,b,c){var d=a;b&&(d+=(c||"")+b);this.label.html(d);"0"==d+""||d?this.triggerObj&&this.triggerObj.addHasValue():this.triggerObj&&this.triggerObj.removeHasValue();this.triggerObj&&a&&this.triggerObj.updateValueText(a)},updateValue:function(a){a=a||"";this.value.html(a);"0"==a+""||a?this.triggerObj&&this.triggerObj.addHasValue():this.triggerObj&&this.triggerObj.removeHasValue()},
hasValue:function(){return this.triggerObj?this.triggerObj.hasValue():!1},reposition:function(a){if(this.options.staticPosition)this.content.css(this.options.staticPosition);else{var b=this.options.direction,c=this.options.alignment,d=this.trigger.offset(),g=e(this.options.container),h=e(this.options.expandTo),m=h.length&&h.is(":visible"),f=e(window).outerWidth(),n=m?h.offset():null;if(g.length)var l=g.offset(),d={top:d.top-l.top+g.scrollTop(),left:d.left-l.left};else g=e(window);l=d.top+this.trigger.outerHeight();
l+=this.options.topOffsetFromTrigger;0===this.trigger.width()&&0!==this.trigger.position().top&&(l+=window.scrollY);if(this.options.coverTrigger)m=0,h=e(this.options.container),this.options.subtractContainerOffset&&h.length&&(m=h.offset().left),h=this.content.outerWidth(),l=Math.floor(l)-this.trigger.outerHeight(),m=Math.floor(this.trigger.offset().left)-m,c=m+"px",m+h>f&&(h=f-h-10,c=(0<h?h:0)+"px"),this.options.newSearchHeaderDesign&&568>f&&(c=0),this.content.css({transform:"translate("+c+","+(l+
"px")+")",top:0,right:"inherit !important"}),this.cover.css({width:this.trigger.outerWidth()-16,height:this.trigger.outerHeight()-16});else{this.shouldFlipDirection(b)&&(b=this.getReversedDirection(b));this.shouldFlipAlignment(c)&&(c=this.getReversedDirection(c));this.updateAnimationClass(b,c);this.content.toggleClass("noAnimation",!!a);"up"===b?(k.dom.swapClasses(this.content,this.getStateClasses("default"),this.getStateClasses("up")),l=d.top-this.content.outerHeight()):k.dom.swapClasses(this.content,
this.getStateClasses("up"),this.getStateClasses("default"));if("left"===b||"right"===b)l="up"===this.options.alignment?d.top-this.trigger.outerHeight()/2:"down"===this.options.alignment?d.top-this.content.outerHeight()+this.trigger.outerHeight():d.top+this.trigger.outerHeight()/2-this.content.outerHeight()/2;f={top:Math.floor(l)+"px"};m?"right"===c?f.right=Math.floor(g.width()-h.width()-n.left)+"px":f.left=Math.floor(n.left)+"px":"left"===b?f.right=Math.floor(g.width()-d.left)+"px":"right"===b?f.left=
Math.floor(d.left+this.trigger.width())+"px":"right"===c?(b=this.getTriggerWidth(),38>b&&!this.options.forceTriggerWidth&&(b=38),f.right=Math.floor(g.width()-(d.left+b))+"px"):f.left="center"===c?Math.floor(d.left-this.content.outerWidth()/2)+this.getTriggerWidth()/2+"px":Math.floor(d.left)+"px";this.options.topOffset&&0!==this.options.topOffset&&(f.marginTop=this.options.topOffset+"px");this.options.leftOffset&&0!==this.options.leftOffset&&(f.right?f.right=parseInt(f.right.replace("px",""))-this.options.leftOffset+
"px":f.left&&(f.left=parseInt(f.left.replace("px",""))+this.options.leftOffset+"px"));this.leftOffset&&(f.marginLeft=this.leftOffset+"px");this.options.isPopover&&"right"===c&&(f.left=Math.floor(d.left+this.getTriggerWidth()+22)+"px",f.top=Math.floor(l-45)+"px");l=this.options.isFixedWidth?"width":"minWidth";this.options.matchWidth?f[l]=this.getTriggerWidth()+"px":m?f[l]=h.outerWidth()+"px":f.minWidth="";this.options.removeZIndex||(f.zIndex=this.trigger.zIndex()+9999);this.content.css(f)}}},shouldFlipDirection:function(a){if(this.options.flippable){var b=
e(window).scrollTop(),c=b+e(window).outerHeight(),d=this.content.outerHeight(),g=this.trigger.offset().top,c=g+this.trigger.outerHeight()+d>c,b=g-d<b;if("down"===a)return c&&!b;if("up"===a)return b&&!c}return!1},shouldFlipAlignment:function(a){if(this.options.flippable){var b=e(window).width(),c=this.content.width(),d=this.trigger.offset().left,g=this.trigger.width(),g=0>=d+("left"===a?0:g)-c,b=d+("left"===a?c:0)>=b;if("left"===a)return!g&&b;if("right"===a)return g&&!b}return!1},getReversedDirection:function(a){switch(a){case "down":return"up";
case "up":return"down";case "left":return"right";case "right":return"left";case "bottom":return"top";case "top":return"bottom";case "center":return"center"}return a},updateAnimationClass:function(a,b){a=this.getDirectionClass(a,b);this.content.hasClass(a)||this.content.removeClass(function(a,b){return(b.match(/\banimate-\S+/g)||[]).join(" ")}).addClass(a).removeAttr("style")},getDirectionClass:function(a,b){var c;"left"===a||"right"===a?(c="down"===b?"top":"bottom",a="center"===a?"right":this.getReversedDirection(a)):
(c="down"===a?"top":"bottom",a="center"===b?"right":b);return"animate-"+c+"-"+a},loadAjax:function(){var a=this;return k.ajax.execute(this.options.ajaxUrl,{data:this.options.ajaxData,customUpdate:function(b){b.innerHTML&&""!==b.innerHTML?a.content.html(b.innerHTML):(a.element.remove(),a.ajaxLoadFailed=!0);return!0}})},getTriggerWidth:function(){if(null!=this.trigger){var a=this.trigger[0].getBoundingClientRect();return a?a.right-a.left:this.trigger.outerWidth()}return 0},disableDropdown:function(){this.options.openDisabled=
!0;this.element.addClass("disabled");this.triggerObj&&this.triggerObj.disable()},enableDropdown:function(){this.options.openDisabled=!1;this.element.removeClass("disabled");this.triggerObj&&this.triggerObj.enable()},animateClose:function(a){var b=this,c=this.content.attr("class").match(/\banimate-\S+/);c&&c.length&&(this.content.removeClass(c[0]),window.setTimeout(function(){b.content.addClass(c[0]+" close-animation")},1),window.setTimeout(function(){a();b.content.removeClass("close-animation")},
this.animationDuration))},getStateClasses:function(a){null===this.states&&(this.states=k.question.ask("dropdown.dialog.states"));if(this.states)return this.states[a]}})})(R9,jQuery);(function(c,k){var g="adults seniors youth child seatInfant lapInfant".split(" ");c.createComponentClass("flights.search.StyleJamFlightTravelerDropdown",{travelerSelect:null,travelerTypes:null,cabinDisplay:null,numBoxes:null,cabinWidget:null,hasErrorMessage:null,errorMessageElement:null,options:{namespace:null,maxTravelers:16,maxAdults:9,maxChildren:7,includeCabin:!0,msg:{singleAdult:"",singleSenior:"",singleChild:"",travelersChoice:""},errorMsg:{minimumTravelers:"",maximumTravelers:"",lapInfantsExceedAdults:"",
unaccompaniedMinors:""},dataQuestion:"flights.search.travelers"},numTravelers:1,init:function(){var a=this;this.numBoxes=[];this.travelerTypes=g.filter(function(b){return a.getChildElement(b).length});this.travelerTypes.forEach(this.bindNumberBox.bind(this));this.calculateTravelers();this.element.data("component",this)},addEventHandlers:function(){var a=this;this.getChildElement("close").click(function(){a.travelerSelect.close()})},inlineComponentsReady:function(){this.options.includeCabin&&(this.cabinWidget=
this.getChildElement("cabinType").getWidget());if(this.travelerSelect=this.getChildElement("dialog").getWidget())this.subscribe("flights.inline.travelers.open",this.travelerSelect.open.bind(this.travelerSelect)),this.subscribe("flights.search.travelers.close",{namespace:this.options.namespace},this.travelerSelect.close.bind(this.travelerSelect));this.options.includeCabin&&this.subscribe("flights.search.cabinType.change",{namespace:this.options.namespace},this.onCabinTypeChange.bind(this));this.answer(this.options.dataQuestion,
this.serialize.bind(this));this.subscribe("flights.search.travelers.set",this.load.bind(this));this.subscribe("flights.search.travelers.refresh",{namespace:this.options.namespace},this.updateDisplay.bind(this));c.events.publish("flights.search.travelers.init."+(this.options.namespace||""));c.dom.schedule(this.updateNumberBoxes.bind(this));this.errorMessageElement=this.getChildElement("errorMessage")},load:function(a){!a||a.hasOwnProperty("namespace")&&a.namespace!==this.options.namespace||(a.type&&
this[a.type]?this[a.type].setValue(a.count,!0):this.travelerTypes.forEach(function(b){a.hasOwnProperty(b)&&this.hasOwnProperty(b)&&this[b].setValue(a[b],!0)},this),this.calculateTravelers(),c.events.publish("flights.search.travelers.lapInfant",{count:this.lapInfant.getValue()}),this.updateDisplay())},bindNumberBox:function(a){var b=this,d=this.isEligibleAdult(a);(d=this.getChildElement(a).styleJamNumberBox({validator:function(d){return b.validate(this,d,a)},callback:function(d){b.onTravelersChange(this,
d,a)},max:(d?this.options.maxAdults:this.options.maxChildren)+1,onlyDecorateDisabledButtons:!0}).getWidget())&&this.numBoxes.push({id:a,obj:d});this[a]=d},calculateTravelers:function(){var a=this;this.numTravelers=this.travelerTypes.reduce(function(b,d){return b+a[d].getValue()},0)},validate:function(a,b,d){var c=this.isEligibleAdult(d),f=this.totalAdultCount(),e=this.options.errorMsg;if(0<b){if("lapInfant"===d&&a.getValue()>=f)return this.showErrorMessage(e.lapInfantsExceedAdults),!1;if(this.atMaxTotalTravelers())return this.showErrorMessage(e.maximumTravelers),
!1;if(this.atMaxAdults()&&c)return this.showErrorMessage(e.maximumAdults),!1;if(this.atMaxMinors()&&!c)return this.showErrorMessage(e.maximumChildren),!1}else{if(this.atMinTotalTravelers())return this.showErrorMessage(e.minimumTravelers),!1;if(c&&this.atMinEligibleInfantHolders())return this.showErrorMessage(e.lapInfantsExceedAdults),!1;if(c&&1>=f&&0<this.totalMinorCount())return this.showErrorMessage(e.unaccompaniedMinors),!1}this.hideErrorMessage();return!0},atMaxAdults:function(){return this.totalAdultCount()>=
this.options.maxAdults},atMaxMinors:function(){return this.totalMinorCount()>=this.options.maxChildren},atMaxTotalTravelers:function(){return this.numTravelers>=this.options.maxTravelers},atMinTotalTravelers:function(){return 1>=this.numTravelers},atMinEligibleInfantHolders:function(a,b){a=a||this.lapInfant.getValue();b=b||this.totalAdultCount();return a>=b},totalAdultCount:function(){var a=this.seniors?this.seniors.getValue():0;return this.adults.getValue()+a},totalMinorCount:function(){return[this.youth,
this.child,this.lapInfant,this.seatInfant].reduce(function(a,b){return a+(b?b.getValue():0)},0)},isEligibleAdult:function(a){return"adults"===a||"seniors"===a},updateNumberBoxes:function(){var a=this.totalAdultCount(),b=this.atMaxTotalTravelers();this.travelerTypes.forEach(function(d){var c=this.isEligibleAdult(d),f=this[d],e=f.getValue(),g=c&&0===a;d="lapInfant"===d&&e>=a;var h=c&&this.atMinEligibleInfantHolders(),c=c?this.atMaxAdults():this.atMaxMinors();0===e||g||this.atMinTotalTravelers()||h?
f.disableDecrement():f.enableDecrement();b||d||c?f.disableIncrement():f.enableIncrement()},this)},onTravelersChange:function(a,b,d){this.calculateTravelers();this.updateNumberBoxes();c.events.publish("flights.search.travelers.lapInfant",{count:this.lapInfant.getValue(),namespace:this.options.namespace});this.updateDisplay();c.events.publish("flights.search.travelers.change",{data:this.serialize(),namespace:this.options.namespace,travelerType:d});c.Analytics.api.trackEvent({category:"Search-Form",
action:"select-passengers",label:a._id})},onCabinTypeChange:function(){this.updateDisplay()},updateDisplay:function(){this.travelerSelect.updateLabel(this.getDisplaySummary())},getDisplaySummary:function(){var a=this.options.includeCabin?this.cabinWidget.getDisplay():null;return 1===this.adults.getValue()&&1===this.numTravelers?c.Common.Utils.String.formatString(this.options.msg.singleAdult,a):this.seniors&&1===this.seniors.getValue()&&1===this.numTravelers?c.Common.Utils.String.formatString(this.options.msg.singleSenior,
a):1===this.child.getValue()&&1===this.numTravelers?c.Common.Utils.String.formatString(this.options.msg.singleChild,a):c.Common.Utils.String.formatChoice(this.options.msg.travelersChoice,this.numTravelers,this.numTravelers+"",a)},showErrorMessage:function(a){var b=this.errorMessageElement;b&&a&&(b.text(a),this.hasErrorMessage=!0)},hideErrorMessage:function(){var a=this.errorMessageElement;a&&this.hasErrorMessage&&(a.text(""),this.hasErrorMessage=!1)},serialize:function(){return{adults:this.adults.getValue(),
seniors:this.seniors?this.seniors.getValue():0,youth:this.youth.getValue(),child:this.child.getValue(),seatInfant:this.seatInfant.getValue(),lapInfant:this.lapInfant.getValue(),travelers:this.numTravelers,displaySummary:this.getDisplaySummary()}}})})(R9,jQuery);(function(b,c){b.createComponentClass("flights.search.FlightCabinSelect",{options:{namespace:null,cabinDisplayMap:null},widget:null,init:function(){this.element.data("widget",this)},inlineComponentsReady:function(){var a=this;(this.widget=this.getChildElement("widget").getWidget())||this.log.error("No widget instance attached to CabinType element");this.widget.setOption("change",this.onChange.bind(this));this.answer("flights.search.cabinType."+this.options.namespace+".get",function(){return{value:a.getValue(),
display:a.options.cabinDisplayMap[a.getValue()]}});this.subscribe("flights.search.cabinType.set",{namespace:this.options.namespace},function(b){a.setValue(b.value)});b.events.ready("flights.search.cabinType.init."+this.options.namespace||"")},onChange:function(){var a=this.widget.getValue();b.events.publish("flights.search.cabinType.change",{id:this.id(),namespace:this.options.namespace,value:a,display:this.options.cabinDisplayMap[a]});b.Analytics.api.trackEvent({category:"Search-Form",action:"select-cabin",
label:a})},destroy:function(){this.base();this.element.data("widget",null)},getValue:function(){return this.widget.getValue()},getDisplay:function(){return this.options.cabinDisplayMap[this.getValue()]},setValue:function(a){this.widget.setValue(a)}})})(R9,jQuery);(function(c,f){c.createWidgetClass("text.InputModal",{display:null,smartyWindow:null,smartyContent:null,smartyBackground:null,pillsContainerDisplay:null,pillsContainerModal:null,placeholderUpdateInterval:null,smartyInit:!1,triggeringFocus:!1,clicking:!1,open:!1,focusTimeout:-1,initialSmartyChecked:!1,oldValue:"",multiSelectActive:!1,multiSelectCompactLayout:!1,multiSelectContainers:null,options:{mobileBreakpoint:568,openSmartyDelay:null,delayOpenSmarty:null,alignment:"left",maxWidth:516,smartyEnabled:!0,
displayPresentation:"",inputPresentations:{},useInstantFocus:!1,cleanAfterFocus:!1,pillsEnabled:!1,multiSelectEnabled:!1},init:function(){var a=this;this.display=this.getChildElement("display");this.displayInner=this.getChildElement("display-inner");this.smartyWindow=this.getChildElement("smarty-window");this.smartyContent=this.getChildElement("smarty-content");this.smartyWrapper=this.getChildElement("smarty-wrapper");this.smartyBackground=this.getChildElement("smarty-bg");this.close=this.getChildElement("close");
this.options.pillsEnabled&&(this.pillsContainerDisplay=this.getChildElement("pills-container-display"),this.pillsContainerModal=this.getChildElement("pills-container-modal"));this.multiSelectContainers=this.getChildElement("display-multi-container").add(this.getChildElement("smarty-multi-container"));setTimeout(function(){a.smartyWindow.css("display","block")},200)},bindComponent:function(){this.element.data("inputModal",this)},inlineComponentsReady:function(){var a=this;c.dom.schedule(function(){a.positionSmartyWindow()})},
addEventHandlers:function(){var a=this;this.registerEvent("mousedown",this.display,function(){a.clicking=!0});this.registerEvent("click",this.display,function(){a.toggleSmartyWindow(!0)});this.registerEvent("mouseup",this.display,function(){a.clicking=!1});this.registerEvent("click",this.close,function(){a.toggleSmartyWindow(!1)});this.registerEvent("focus",this.display,function(){a.clicking||(a.triggeringFocus?(a.toggleSmartyWindow(!1),a.triggeringFocus=!1,clearTimeout(a.focusTimeout)):a.toggleSmartyWindow(!0))});
this.registerEvent("keydown",this.display,function(b){b.which===c.globals.keyCodes.TAB&&(clearTimeout(a.focusTimeout),a.toggleSmartyWindow(!1))});this.subscribe("smarty.setitem.complete",function(){a.toggleSmartyWindow(!1)});this.registerEvent("keydown.inputmodal",this.element,function(b){switch(b.which){case c.globals.keyCodes.RETURN:case c.globals.keyCodes.ESC:a.toggleSmartyWindow(!1);a.triggeringFocus=!0;a.display.focus();break;case c.globals.keyCodes.TAB:a.triggeringFocus=!0,a.display.focus()}});
this.registerEvent("click.smarty",f(document),function(b){0===f(b.target).closest("#"+a.id("smarty-window")+", #"+a.id("display")+", .js-selection").length&&(a.open&&a.options.preventClickoutPropagation&&0===f(b.target).closest(a.options.allowedClickoutEl).length&&(b.preventDefault(),b.stopPropagation(),b.stopImmediatePropagation()),a.toggleSmartyWindow(!1))});this.registerEvent("resize",f(window),this.positionSmartyWindow.bind(this));var b=null;this.placeholderUpdateInterval=window.setInterval(function(){a.elementNode.value!==
b&&(b=a.elementNode.value,a.updatePlaceholder())},50);this.subscribe("flights.search.form.sticky.toggle",function(b){if(a.options.isStickyEnabled){var e=a.options,d=e.displayPresentation;b?(c.dom.swapClasses(a.display,e.inputPresentations[d].presentation,e.inputPresentations[d+"_STICKY"].presentation),c.dom.swapClasses(a.display.find(".js-display-icon"),e.inputPresentations[d].svg,e.inputPresentations[d+"_STICKY"].svg)):(c.dom.swapClasses(a.display,e.inputPresentations[d+"_STICKY"].presentation,e.inputPresentations[d].presentation),
c.dom.swapClasses(a.display.find(".js-display-icon"),e.inputPresentations[d+"_STICKY"].svg,e.inputPresentations[d].svg))}});if(this.options.multiSelectEnabled)this.multiSelectContainers.on("click",".js-remove-selection",this.onRemoveMultiSelectionClick.bind(this))},destroy:function(){this.base();this.element.data("inputModal",null);window.clearInterval(this.placeholderUpdateInterval);this.multiSelectContainers.off("click")},positionSmartyWindow:function(){var a=this.display.offset(),b=this.display.outerWidth(!0),
d=Math.max(b,this.options.maxWidth),c=parseInt(this.display.css("margin-left"),10),g=f(window).outerWidth(),c="right"===this.options.alignment&&this.canRightAlign()?Math.floor(a.left+(b-(d+8))):"left"===this.options.alignment&&a.left+40+d>g?Math.floor(a.left+(g-(a.left+d+40))):Math.floor(a.left-c);this.smartyWindow.css({transform:"translate("+c+"px,"+Math.floor(a.top)+"px)"});this.smartyBackground.css({width:b-16,height:this.display.outerHeight()-16});this.isFullScreen()?this.smartyContent.css({minWidth:0}):
this.smartyContent.css({minWidth:d});this.options.pillsEnabled&&this.smartyWrapper.css({maxWidth:d});this.open&&"parentIFrame"in window&&window.parentIFrame.sendMessage({action:"InputModal.opened",mode:this.isFullScreen()?"FullScreen":"Normal"})},toggleSmartyWindow:function(a){a!==this.open&&((this.open=a)?(this.multiSelectActive&&this.toggleSmartyMultiSelect(!0),"function"===typeof this.options.delayOpenSmarty&&this.options.delayOpenSmarty()?setTimeout(this._openSmartyWindow.bind(this),this.options.openSmartyDelay):
this._openSmartyWindow(),this.multiSelectActive&&this.toggleDisplayMultiSelect(!1),this.options.cleanAfterFocus&&(this.oldValue=this.element.val(),this.element.val("")),c.events.publish("InputModal.opened")):(!this.element.val()&&this.oldValue&&this.element.val(this.oldValue),this.multiSelectActive&&(this.element.val(""),this.toggleDisplayMultiSelect(!0)),c.dom.swapChildrenClasses(this.smartyWindow,this.getStlClasses().SmartyWindow,"visible","hidden"),this.updatePlaceholder(),this.smartyContent.removeClass("visible"),
this.multiSelectActive&&this.toggleSmartyMultiSelect(!1),c.events.publish("InputModal.closed",{id:this.id()}),"parentIFrame"in window&&window.parentIFrame.sendMessage({action:"InputModal.closed"})))},_openSmartyWindow:function(){var a=this,b=this.isFullScreen()?1:200;this.initialSmartyChecked||(this.element.val()&&this.options.smartyEnabled&&this.element.getWidget().runSearch(!1),this.initialSmartyChecked=!0);this.positionSmartyWindow();c.dom.swapChildrenClasses(this.smartyWindow,this.getStlClasses().SmartyWindow,
"hidden","visible");this.smartyContent.addClass("visible");this.multiSelectActive&&this.element.getWidget().showAirportMultiSelections();this.options.useInstantFocus&&this.isFullScreen()?a.element.focus().select():this.focusTimeout=setTimeout(function(){a.element.focus().select()},b)},updatePlaceholder:function(){var a=this.element.val();this.options.presentation?a?(this.swapClasses(this.display,"DisplayInput--empty","DisplayInput--full"),this.displayInner.text(a)):(this.swapClasses(this.display,
"DisplayInput--full","DisplayInput--empty"),this.displayInner.html(this.display.attr("data-placeholder"))):a?(c.dom.swapChildrenClasses(this.display,this.getStlClasses().DisplayInput,"empty","full"),this.displayInner.text(a)):(c.dom.swapChildrenClasses(this.display,this.getStlClasses().DisplayInput,"full","empty"),this.displayInner.html(this.display.attr("data-placeholder")))},getSmartyWrapper:function(){return this.smartyContent},getSmartyWindow:function(){return this.smartyWindow},getPillsContainerDisplay:function(){return this.pillsContainerDisplay},
getPillsContainerModal:function(){return this.pillsContainerModal},focus:function(){this.display.focus()},toggleInputVisibility:function(a,b){this.element.prop("disabled",!a);a&&b?this.element.fadeTo(b,1):this.element.css("opacity",a?1:0)},isFullScreen:function(){return this.options.mobileBreakpoint>f(window).outerWidth()},canRightAlign:function(){return this.options.mobileBreakpoint<=f(window).outerWidth()},pulseDisplay:function(){var a=this;this.options.presentation&&(this.swapClasses(this.display,
"DisplayInput--unpulse","DisplayInput--pulse"),window.setTimeout(function(){a.swapClasses(a.display,"DisplayInput--pulse","DisplayInput--unpulse")},1E3))},onTextInputWrapperClick:function(){var a=this.element.getWidget();this.element.prop("disabled")&&a&&a.highlightMultiCheckboxMessage()},toggleMultiSelectVisibility:function(a){this.multiSelectActive=a;this.open?this.toggleSmartyMultiSelect(a):this.toggleDisplayMultiSelect(a);this.displayInner.prop("hidden",a);this.display.find(".js-display-icon").attr("visibility",
a?"hidden":"visible");this.onToggleMultiSelectVisibility(a);var b=this.getChildElement("textInputWrapper"),c=this.onTextInputWrapperClick.bind(this);a?this.registerEvent("click",b,c):b.off("click",c)},onToggleMultiSelectVisibility:function(a){},toggleDisplayMultiSelect:function(a){this.swapClassesToggle(this.getChildElement("display-multi-container"),"DisplayMultiSelectContainer--hidden","DisplayMultiSelectContainer--visible",!a)},toggleSmartyMultiSelect:function(a){this.swapClassesToggle(this.getChildElement("smarty-multi-container"),
"SmartyMultiSelectContainer--hidden","SmartyMultiSelectContainer--visible",!a)},getMultiSelectionValue:function(){return this.multiSelectContainers.find(".js-selection").map(function(){return f(this).data("value")}).join(",")},addMultiSelection:function(a,b,d){if(this.options.multiSelectEnabled){this.multiSelectActive||this.toggleMultiSelectVisibility(!0);var e=c.template.render("displaySelection",{value:a,display:b,compact:this.multiSelectCompactLayout,stateClasses:this.getStlBlocks("DisplaySelection--input DisplaySelection--input--visible")});
this.getChildElement("display-multi-container").append(e);e=d?this.getStlBlocks("DisplaySelection--modal DisplaySelection--invisible"):this.getStlBlocks("DisplaySelection--modal DisplaySelection--modal--visible");a=c.template.render("displaySelection",{value:a,display:b,compact:this.multiSelectCompactLayout,stateClasses:e});a=f(a).appendTo(this.getChildElement("smarty-multi-container"));d&&c.dom.schedule(this.swapClasses.bind(this,a,"DisplaySelection--invisible","DisplaySelection--modal--visible"))}},
onRemoveMultiSelection:function(a,b){this.removeMultiSelection(a,b)},onRemoveMultiSelectionClick:function(a){a.stopPropagation();a=f(a.target).closest(".js-selection").data("value");this.onRemoveMultiSelection(a,"brick");this.element.focus()},removeMultiSelection:function(a,b){var c=this;this.multiSelectContainers.find(".js-selection").filter(function(){return f(this).data("value")===a}).each(function(){c.removeMultiSelectionElement(f(this),b)});this.multiSelectContainers.find(".js-selection").length||
(this.toggleMultiSelectVisibility(!1),this.toggleSmartyWindow(!0),this.element.prop("disabled")||this.element.focus())},removeMultiSelectionElement:function(a,b){b?(a.removeClass(this.getStlBlocks("DisplaySelection--input--visible DisplaySelection--modal--visible")).addClass(this.getStlBlock("DisplaySelection--invisible")),window.setTimeout(function(){a.remove()},500)):a.remove()},resetMultiSelection:function(){this.multiSelectContainers.find(".js-selection").remove();this.toggleMultiSelectVisibility(!1);
this.toggleInputVisibility(!0)},toggleMultiSelectionCompactLayout:function(a){if(this.multiSelectCompactLayout!==a){this.multiSelectCompactLayout=a;var b=this.multiSelectContainers.find(".js-selection"),d=b.find(".js-selection-value"),b=b.find(".js-selection-display");c.dom.schedule(this.swapClassesToggle.bind(this,b,"DisplaySelection__Display--visible","DisplaySelection__Display--hidden",!a));c.dom.schedule(this.swapClassesToggle.bind(this,d,"DisplaySelection__Value--hidden","DisplaySelection__Value--visible",
!a))}}})})(R9,jQuery);(function(e,f){e.publish("SmartyLogger",{loggingCategory:"Smarty",inputDefault:"destination",selectedIndex:"",subscribedLogSearchId:void 0,locationTypeIdLookupMap:{ap:"lmid",lm:"lmid",hotel:"hid",freereg:"frid",hood:"nhid",ctry:"cid"},_save:function(a){this.setStorage(a)},_log:function(a){a&&(this.logData(a,"origin"),this.logData(a,"destination"))},logData:function(a,c){var b=this;a=this.getLoggingObj(a,c);f.isEmptyObject(a)||e.Analytics.api.trackEvent(a,function(){b.cleanUpSmartyLogger(c)})},makeOptionsStr:function(a,
c){var b=this,d,f,k,g=[],l=!1;a.each(function(h){d=e.common.widgets.smarty.FlareSmarty.prototype.translateItem.call(this,a[h]);null==c||l||d.id!==c.id||d.type!==c.type||(b.selectedIndex=h+1,l=!0);f=d.id.split("/");1<f.length&&(d.idCode=f[1],d.apCode=f[0]);k="ap"===d.type?"airport":d.type;g.push("pos: "+(h+1));g.push("text: "+b.cleanString(d.short_str||d.str));g.push("locid: "+b.getBestItemId.call(b,d));g.push("loc_type: "+k)});return g.join("|")},getBestItemId:function(a){return a&&a.type?this.cleanString(a[this.locationTypeIdLookupMap[a.type]||
"id"]||a.id||""):""},getLoggingObj:function(a,c){var b=this.getStorage(c),d={};f.isEmptyObject(b)||(d={searchid:a,category:this.loggingCategory,params:{point:c}},b.hasOwnProperty("vertical")&&(d.params.vertical=b.vertical),b.hasOwnProperty("prefix")&&(d.params.prefix=b.prefix),b.hasOwnProperty("selected")&&(d.params.selected=b.selected),b.hasOwnProperty("options")&&(d.params.options=b.options));return d},setStorage:function(a){if(a&&e.storage.isAvailable()){var c=(a.inputType||this.inputDefault)+
"SmartyLogging",b=this.getStorageObj(a.inputType);a.hasOwnProperty("vertical")&&(b.vertical=a.vertical);a.hasOwnProperty("prefix")&&(b.prefix=this.cleanString(a.prefix));a.hasOwnProperty("options")&&(b.options=this.makeOptionsStr(a.options,a.selectedElem||null),b.selected=this.selectedIndex,this.selectedIndex="");e.storage.set(c,b)}},getStorageObj:function(a){a=(a||this.inputDefault)+"SmartyLogging";var c={};e.storage.isAvailable()&&(c=e.storage.get(a),f.isEmptyObject(c)&&(e.storage.set(a,{}),c=e.storage.get(a)));
return c},getStorage:function(a){var c={};e.storage.isAvailable()&&(c=e.storage.get(a+"SmartyLogging"));return c},cleanString:function(a){return"string"===typeof a?a.trim().replace(/&/g,"\\\x26"):""},cleanUpSmartyLogger:function(a){e.storage.remove(a+"SmartyLogging");this.selectedIndex=""},onLogSearchId:function(a){a&&this._log(a)}});e.SmartyLogger.subscribedLogSearchId||(e.SmartyLogger.subscribedLogSearchId=1,e.events.subscribe("smartylogger.log.searchId",f.proxy(e.SmartyLogger.onLogSearchId,e.SmartyLogger)))})(R9,
jQuery);(function(e,k){e.createWidgetClass("checkbox.StyleJamCheckbox",{widgetName:"checkbox",isToggle:!1,showLabel:!0,options:{click:k.noop,change:k.noop,keydown:k.noop,focus:k.noop,blur:k.noop},init:function(){this.elementNode=this.element.get(0);if(this.slider=this.getChildElement("slider"))this.isToggle=!0;this.label=this.getChildElement("label");this.showLabel=!!this.label.text().trim()},addEventHandlers:function(){this.bindInputEvent("click",this._handleElementClickEvent);this.bindInputEvent("change",
this._handleElementChangeEvent);this.bindInputEvent("keydown",this._handleKeydownEvent);this.bindInputEvent("focus",this._handleElementFocusEvent);this.bindInputEvent("blur",this._handleElementBlurEvent);if(!this.showLabel){var a=this;this.bindInputEvent("click",function(c){a.element.trigger("click."+this.widgetName,c)},this.getChildElement("icon"))}},bindInputEvent:function(a,c,d){var b=this;a+="."+this.widgetName;d=d||this.element;d.off(a).on(a,function(a){c.call(b,this,null,a)})},_handleElementClickEvent:function(){this.options.click.apply(this,
arguments)},_handleElementChangeEvent:function(a,c,d){e.common.widgets.checkbox.StyleJamCheckbox.refresh(a);this.options.change.apply(this,arguments);var b=k(a).prop("checked");a.setAttribute("aria-checked",b)},_handleKeydownEvent:function(a,c,d){this.options.keydown.apply(this,arguments)},_handleElementFocusEvent:function(a,c,d){a.disabled||(this.isToggle&&e.common.widgets.checkbox.StyleJamCheckbox.refresh(this.elementNode),this.options.focus.apply(this,arguments))},_handleElementBlurEvent:function(a,
c,d){a.disabled||(this.isToggle&&e.common.widgets.checkbox.StyleJamCheckbox.refresh(this.elementNode),this.options.blur.apply(this,arguments))},setEnabled:function(a){a?this.element.removeAttr("disabled"):this.element.attr("disabled","disabled");this.element.attr("aria-disabled",!a);e.common.widgets.checkbox.StyleJamCheckbox.refresh(this.element)},getValue:function(){return this.element.prop("checked")},setChecked:function(a){this.element.prop("checked",a)},setLabel:function(a){this.label.text(a)}});
e.extend("common.widgets.checkbox.StyleJamCheckbox",{isCheckbox:function(a){return a&&a.nodeName&&"input"==a.nodeName.toLowerCase()&&"checkbox"==a.type.toLowerCase()},refresh:function(a){var c=e.question.ask("checkbox.StyleJamCheckbox.states");this.reflectState(a,c)},reflectState:function(a,c){var d=k(a),b=d.data("switchInfo"),h=d.attr("id"),g=k("#"+h+"-label"),d=k("#"+h+"-icon"),h=k("#"+h+"-slider");if(g.length){var f=c.label;f[b.presentation]||(new e.logger(this.prototype._logPath)).error("Label States not defined for "+
b.presentation+". Set them in StyleJamCheckbox.java#getLabelStates");l=f[b.presentation].checked||f.VANILLA.checked;m=f[b.presentation].unchecked||f.VANILLA.unchecked;f=f[b.presentation].disabled||f.VANILLA.disabled;a.checked?e.dom.swapClasses(g,m,l):e.dom.swapClasses(g,l,m);a.disabled||a.prop&&a.prop("disabled")?e.dom.swapClasses(g,"",f):e.dom.swapClasses(g,f,"")}if(d.length){var g=c.icon,n=g.VANILLA;g[b.presentation]||(new e.logger(this.prototype._logPath)).error("Icon states not defined for "+
b.presentation+". Presentations with icons must have states defined, set them in StyleJamCheckbox.java#getIconStates");b.disableMouseOutAnimation?(l=g.disableMouseOutAnimation.checked||n.checked,m=g.disableMouseOutAnimation.unchecked||n.unchecked,f=g.disableMouseOutAnimation.disabled||n.disabled):(l=g[b.presentation].checked||n.checked,m=g[b.presentation].unchecked||n.unchecked,f=g[b.presentation].disabled||n.disabled,p=g[b.presentation].checkedFocus||n.checkedFocus,q=g[b.presentation].uncheckedFocus||
n.uncheckedFocus);d.removeClass(l+" "+p+" "+m+" "+q);a.checked?a===document.activeElement?d.addClass(p):d.addClass(l):a===document.activeElement?d.addClass(q):d.addClass(m);a.disabled||a.prop&&a.prop("disabled")?e.dom.swapClasses(d,"",f):e.dom.swapClasses(d,f,"")}if(h.length){c=c.slider;var l=c[b.presentation].checked||"",m=c[b.presentation].unchecked||"",f=c[b.presentation].disabled||"",p=c[b.presentation].checkedFocus||"",q=c[b.presentation].uncheckedFocus||"";c[b.presentation]||(new e.logger(this.prototype._logPath)).error("Slider states not defined for "+
b.presentation+". Presentations with sliders must have states defined, set them in StyleJamCheckbox.java#getSliderStates");h.removeClass(l+" "+p+" "+m+" "+q);a.checked?a===document.activeElement?h.addClass(p):h.addClass(l):a===document.activeElement?h.addClass(q):h.addClass(m);a.disabled?e.dom.swapClasses(h,"",f):e.dom.swapClasses(h,f,"")}if("TOGGLE_WITH_CHECK_MARK"===b.presentation||"TOGGLE"===b.presentation)b=k(a).getWidget(),p=k(a).parent().find(".toggle"),a.checked?b.swapClasses(p,"Checkbox--unchecked--toggle__slider__toggle",
"Checkbox--checked--toggle-with-checkmark__slider__toggle"):b.swapClasses(p,"Checkbox--checked--toggle-with-checkmark__slider__toggle","Checkbox--unchecked--toggle__slider__toggle")}});(function(a){var c=a.fn.prop;a.fn.prop=function(d,b){var h=c.apply(this,arguments);"undefined"==typeof b||"checked"!=d&&"disabled"!=d||this.each(function(){e.common.widgets.checkbox.StyleJamCheckbox.isCheckbox(this)&&a(this).parent().is(".StyleJamCheckbox")&&e.common.widgets.checkbox.StyleJamCheckbox.refresh(this)});
return h}})(k)})(R9,jQuery);(function(b){R9.extend("Widgets.Smarty",{Smarty:function(a,c){this.elementNode=a;this.element=b(this.elementNode);this.validateElement()&&(this.options=b.extend({},this.options,c),this.init())}});R9.extend("Widgets.Smarty.Smarty",{isInput:function(a){return a&&a.nodeName&&"input"==a.nodeName.toLowerCase()},isWidgetControlled:function(a){return b(a).hasClass(R9.Widgets.Smarty.Smarty.prototype.widgetBaseClass+"-input")},getDropdownEl:function(a){return jq(a).find("#smartbox")},getDropdownId:function(a){return"smartbox"}});
R9.extend("Widgets.Smarty.Smarty.prototype",{widgetName:"smarty",widgetBaseClass:"r9-smarty",elementNode:null,element:null,dropdown:null,lastValue:null,aria:!1,trimInputElements:"span.nearbyHotels, span.nearbyRentals, span.showRank",lastClickOnScrollbar:!1,keyTimeout:null,isHighlightKeyPressed:!1,isItemSet:!1,backgroundAutocomplete:null,activeAnimation:!0,options:{minLength:0,appendTo:"body",dropdown:null,fixedDropdown:!1,initialData:null,initialDataLoadWithCallback:null,searchOnFocus:!1,showDropdownWhenEmpty:!1,
dataSource:null,dataType:"text",minWidth:10,maxWidth:1024,noAutoWidth:!1,position:"left",dropdownClass:null,setItem:null,beforeStart:null,afterDone:null,dropdownListSelector:"ul li[class!\x3d'separator']",keyDelay:200,forceSelection:!1,makeHTML:null,translateItem:null,display:"inline",showBackgroundAutocomplete:!1,backgroundAutocompleteMinLength:3,getBackgroundAutocompletePositionProps:null,delayShowDropdown:null,showDropdownDelay:200,enableRemoteHide:!1,zIndex:9999,continents:[],continentsLabel:"",
onInputValueChange:function(a){},forceSelectionOfHighlightedItem:!0},init:function(){var a=this;this.aria=R9.config&&R9.config.getBoolean("ui.smarty.aria",!0);R9.config&&(this.options.zIndex=R9.config.getInt("ui.smarty.zIndex",9999));this.initDropdown();R9.globals.browserCapabilities.scrollbarRetainsInputFocus&&"false"!==R9.globals.browserCapabilities.scrollbarRetainsInputFocus||this.trackScrollbarClick();this.bindInputEvent("focus",this.handleInputFocusEvent);this.bindInputEvent("blur",this.handleInputBlurEvent);
this.bindInputEvent("keydown",this.handleInputKeydownEvent);this.bindInputEvent("textchange",this.handleInputChangeEvent);b(window).on("scroll.smarty",function(){a.position()});b(window).resize(this.handleWindowResize.bind(a));this.element.attr({autocomplete:"off",autocapitalize:"off",autocorrect:"off"});this.aria&&this.element.attr({role:"combobox","aria-autocomplete":this.options.showBackgroundAutocomplete?"both":"list"});this.element.data(this.widgetName,this);this.element.is(":focus")&&this.element.focus();
this.initBackgroundAutocomplete()},unInit:function(){this.unbindInputEvent("focus");this.unbindInputEvent("blur");this.unbindInputEvent("keydown");this.unbindInputEvent("textchange");b(window).off("scroll.smarty");this.dropdown.off("mousedown.trackScrollbarClick");jq("body").off("click.trackScrollbarClick")},initDropdown:function(){var a=R9.Widgets.Smarty.Smarty.getDropdownEl(this.element),c=R9.Widgets.Smarty.Smarty.getDropdownId(this.element),a=jq(a)[0];if(null==a){var b=R9.Widgets.Smarty.Smarty.prototype.widgetBaseClass;
this.options.dropdownClass&&(b=b+" "+this.options.dropdownClass);a=jq("\x3cdiv\x3e\x3c/div\x3e",{id:c,css:{display:"none",position:"absolute",width:"auto",zIndex:1E4},role:"dialog",tabindex:"0"}).appendTo(this.options.appendTo)[0];jq(a).addClass(b)}this.dropdown=jq(a)},validateElement:function(){return R9.Widgets.Smarty.Smarty.isInput(this.elementNode)&&R9.Widgets.Smarty.Smarty.isWidgetControlled(this.element)},trackScrollbarClick:function(){var a=this;a.dropdown.on("mousedown.trackScrollbarClick",
function(b){a.lastClickOnScrollbar=!0;b.stopPropagation();jq("body").trigger("event",[b])});jq("body").on("click.trackScrollbarClick",function(b){R9.Common.Utils.Browsers.isIE()&&a.lastClickOnScrollbar&&(a.lastClickOnScrollbar=!1,a.element.blur());a.lastClickOnScrollbar=!1})},bindInputEvent:function(a,b){var c=this;a+="."+this.widgetName;this.element.off(a).on(a,function(a){return b.call(c,this,a)})},unbindInputEvent:function(a){a+="."+this.widgetName;this.element.off(a)},bindDropdownEvent:function(a,
b){var c=this;this.dropdown.off(a,this.options.dropdownListSelector).on(a,this.options.dropdownListSelector,function(a){b.call(c,this,a)})},handleInputKeydownEvent:function(a,b){this.activeAnimation=this.focusEventHandled=!1;var c=b.keyCode?b.keyCode:b.which;switch(c){case 38:return this.highlitePrevItem(),!1;case 40:return this.highliteNextItem(),!1;case 27:return!this.hideDropdown();case 13:return this.selectHighlightedItemWhenSearchCompleted(c);case 9:if(this.canItemBeActivatedByTab()){if(R9.config.getBoolean("ui.common.smarty.anywhere-on-tab-check.enabled",
!1)&&this.isItAnywhereItem())return this.selectHighlightedItemWhenSearchCompleted(c);this.options.forceSelectionOfHighlightedItem&&this.selectHighlitedItem(c)}break;default:this.handleKeydownBeforeAutocomplete(a,b),this.abortSearchCompletedEventListeners()}},isItAnywhereItem:function(){var a=this.getItemList(),b=this.getHighlitedItemIndex();return(a=a[b])?"anywhere"==a.getAttribute("data-short-name")?!0:!1:!1},canItemBeActivatedByTab:function(){var a=this.getItemList(),c=this.getHighlitedItemIndex();
return(a=b(a[c]))?!(a.hasClass("signupnow")||a.hasClass("signup")||a.hasClass("showHistory")||a.hasClass("js-not-selectable")):!1},handleInputChangeEvent:function(a,b){if(this.focusEventHandled)this.focusEventHandled=!1;else{if(!R9.Common.Utils.Browsers.isIE(10)&&!R9.Common.Utils.Browsers.isIE(11)||this.element.is(":focus")){this.abortKeyTimeout();this.abortRequest();this.onInputChange();var c=this;this.keyTimeout=setTimeout(function(){c.keyTimeout=null;c.handleInputValue()},this.options.keyDelay)}this.activeAnimation=
!1}},onInputChange:function(){this.isItemSet=!1;var a=this.getHighlitedItem();a&&!this.itemMatches(a,this.element.val())&&this.removeItemHighlight();"function"===typeof this.options.clearItem&&this.options.clearItem(this);try{this.element&&(jq(this.element).removeClass("smarty-complete"),jq(this.element).removeClass("four-twenty"),jq(this.element).addClass("smarty-incomplete"),R9.events.publish("smarty.setitem.incomplete",{id:this.element.attr("id")}))}catch(c){}},handleInputValue:function(){var a=
this.element.val();this.options.onInputValueChange(a);this.options.showDropdownWhenEmpty||this.element.length&&0<a.length?(this.abortRequest(),this.runSearch(!0)):(this.dropdown[0].innerHTML="",this.hideDropdown())},handleInputFocusEvent:function(a,b){jq(a).trigger("smartyfocus");var c=this;if(!c.lastClickOnScrollbar){var e=function(){c.checkAlive()&&setTimeout(e,250)};setTimeout(e,250);this.onBeforeStart(b);this.runSearchOnFocus()&&(this.focusEventHandled=!0,0!=this.element.val().length||this.runNoQuerySearch()?
this.runSearch(!!b):null!==this.options.initialDataLoadWithCallback?this.options.initialDataLoadWithCallback(function(a){c.showInitialDropdownForData(a)}):this.showInitialDropdown())}},runSearchOnFocus:function(){return this.options.searchOnFocus},runNoQuerySearch:function(){return this.options.searchNoQuery},onBeforeStart:function(a){"function"===typeof this.options.beforeStart&&this.options.beforeStart(this,a)},handleInputBlurEvent:function(a,b){this.focusEventHandled=!1;var c=this;setTimeout(function(){if(c.lastClickOnScrollbar)R9.Common.Utils.Browsers.isIE()||
(c.element.focus(),c.lastClickOnScrollbar=!1);else{c.stopInputProcessing();if(c.hideDropdown()&&c.options.forceSelection)c.onForceSelection();c.onAfterDone()}},10)},stopInputProcessing:function(){this.isUpdateInProgress()&&(this.abortKeyTimeout(),this.abortRequest(),this.removeItemHighlight())},isUpdateInProgress:function(){return this.keyTimeout||this.request},onForceSelection:function(){if(!this.isItemSet&&""!==this.element.val()){var a=this.getHighlitedItem();a&&this.selectItem(a,null)}},onAfterDone:function(){"function"===
typeof this.options.afterDone&&this.options.afterDone(this)},handleItemMouseoverEvent:function(a,b){this.getItemList().removeClass("selected");jq(a).not(".js-not-selectable").addClass("selected")},handleItemMouseoutEvent:function(a,b){jq(a).removeClass("selected")},handleItemMousedownEvent:function(a,b){b.stopPropagation();jq("body").trigger("event",[b]);this.selectItem(a,null);this.hideDropdown()},selectHighlitedItem:function(a){var b=this.getItemList();if(b){var d=this.getHighlitedItemIndex();0>
d?13==a&&this.noItemToSelect():(b=b[d])&&this.selectItem(b,a)}else 13==a&&this.noItemToSelect()},selectHighlightedItemWhenSearchCompleted:function(a){var b=this;if(this.isItemSet&&!this.isHighlightKeyPressed){if(this.isDropdownHidden()&&13===a)return!0;this.hideDropdown();return!1}this.selectHighlitedItem(a);this.hideDropdown(!this.isItemSet);if(this.isItemSet)return!1;this.element.one("searchCompleted",function(){b.selectHighlitedItem(a);b.hideDropdown()});return!1},noItemToSelect:function(){},selectItem:function(a,
b){a=this.translateItem(a);this.setItem(a,b)},translateItem:function(a){return"function"===typeof this.options.translateItem?this.options.translateItem(a):a},setItem:function(a,b){if(this.element)try{if(a){jq(this.element).addClass("smarty-complete");jq(this.element).removeClass("smarty-incomplete");jq(this.element).removeClass("four-twenty");if(R9.config.getBoolean("ui.four-twenty.enabled",!1)&&"string"===typeof a.str){var c=!1,e=R9.config.getString("ui.four-twenty.states","").split(";"),f=a.str.match(/^[^,]+,\s+([A-Z]{2})(\s|$)/);
(f=f?f[1]:null)&&-1!==e.indexOf(f)&&(c=!0);for(var g=R9.config.getString("ui.four-twenty.cities","").split(";"),e=0;e<g.length;e++)""!==g[e]&&-1!==a.str.indexOf(g[e])&&(c=!0);c&&jq(this.element).addClass("four-twenty")}R9.events&&R9.events.publish("smarty.setitem.complete",{id:this.element.attr("id")})}else jq(this.element).addClass("smarty-incomplete"),jq(this.element).removeClass("smarty-complete"),jq(this.element).removeClass("four-twenty"),R9.events&&R9.events.publish("smarty.setitem.incomplete",
{id:this.element.attr("id")})}catch(h){}"function"===typeof this.options.setItem?(this.isItemSet=!0,this.options.setItem(this,a,b)):a?(this.isItemSet=!0,this.element.val(jq(a).text())):(this.isItemSet=!1,this.element.val(""))},showInitialDropdown:function(){this.showInitialDropdownForData(this.onInitialData())},showInitialDropdownForData:function(a){a&&this.searchCompleted(a,!1)},onInitialData:function(){return"function"===typeof this.options.initialData?this.options.initialData(this):this.options.initialData},
runSearch:function(a){var b=this.element.val();if(!(b.length<this.options.minLength||this.lastValue==b)){var d=this.getRequestData(),d=this.preprocessRequest(d),e=this,f=function(c){e.request=null;e.lastValue=b;c=e.postprocessResponse(c,a);e.searchCompleted(c,a)};if("function"===typeof this.options.dataSource)this.options.dataSource(d,f,this,a);else if(R9.config.getBoolean("ui.common.smarty.get.enabled",!1)){var g=this.getDataSource();d.cv=R9.config.getString("ui.common.smarty.get.version","1");this.request=
jq.ajax({type:"GET",url:g,data:d,dataType:this.options.dataType,cache:!0,success:f})}else this.request=jq.post(this.getDataSource(),d,f,this.options.dataType)}},getDataSource:function(){return this.options.dataSource},preprocessRequest:function(a){return a},getRequestData:function(){return{value:this.element.val(),formtoken:R9.globals.formtoken}},searchCompleted:function(a,b){(a=this.canShowDropdown(a))?this.showDropdown(a,b):(this.dropdown[0].innerHTML="",this.hideDropdown());this.element.trigger("searchCompleted",
!!a)},canShowDropdown:function(a){return a},abortSearchCompletedEventListeners:function(){this.element.off("searchCompleted")},postprocessResponse:function(a,b){return a},makeHTML:function(a){return"function"===typeof this.options.makeHTML?this.options.makeHTML(a):a},animateSmartyV2:function(a){var b=this;this.dropdown.addClass("smarty-animation-v2");a?this.activeAnimation?(this.dropdown.addClass("open-animation"),this.dropdown.removeClass("close-animation"),setTimeout(function(){b.dropdown.show()},
480)):b.dropdown.show():this.activeAnimation?(this.dropdown.addClass("close-animation"),this.dropdown.removeClass("open-animation"),setTimeout(function(){b.dropdown.hide()},480)):b.dropdown.hide()},showDropdown:function(a,b){if("function"===typeof this.options.delayShowDropdown&&this.options.delayShowDropdown()&&!this.showDropdownTimeout)this.showDropdownTimeout=setTimeout(this.showDropdown.bind(this,a,b),this.options.showDropdownDelay);else{null!==this.showDropdownTimeout&&(clearTimeout(this.showDropdownTimeout),
this.showDropdownTimeout=null);b=this.dropdown[0].style;var c=this.makeHTML(a);this.dropdown[0].innerHTML=c;c=R9.Widgets.Smarty.Smarty.prototype.widgetBaseClass;this.options.dropdownClass&&(c=c+" "+this.options.dropdownClass);this.dropdown.attr("class",c);a.length?this.dropdown.removeClass("empty"):this.dropdown.addClass("empty");this.position();this.aria&&(this.element.attr({"aria-expanded":!0}),this.dropdown.find("ul").attr("role","listbox"),this.dropdown.find("li").not(".js-not-option").attr("role",
"option"));R9.config.getBoolean("ui.smarty.animate",!1)&&this.dropdown.slideDown(R9.config.getInt("ui.smarty.animation.ms",250));b.visibility="visible";b.display=this.options.display;jq.fn.zIndex&&(b.zIndex=jq(this.element).zIndex()+this.options.zIndex);this.bindDropdownEvent("mousedown",this.handleItemMousedownEvent);this.bindDropdownEvent("mouseover",this.handleItemMouseoverEvent);this.bindDropdownEvent("mouseout",this.handleItemMouseoutEvent);this.removeItemHighlight();""!==this.element.val()&&
this.highlightFirstSelectableItem();R9.config.getBoolean("ui.smarty.animation.v2",!1)&&this.animateSmartyV2(!0)}},position:function(){var a=this.dropdown[0].style,b=0;this.dropdown.parent()[0]===jq(document.body)[0]&&(b=parseInt((jq(document.body).css("top")||"0").replace("-",""))||0);this.dropdown.css("width","auto");var d=this.dropdown.outerWidth(!0),e=!1;this.options.minWidth&&d<=this.options.minWidth&&(d=Math.max(this.options.minWidth,d),e=!0);this.options.maxWidth&&d>=this.options.maxWidth&&
(d=Math.min(this.options.maxWidth,d),e=!0);a.width=e||this.options.noAutoWidth?d+"px":"auto";var e=this.element.offset(),f=jq(this.options.appendTo).offset(),g=e.left-f.left;"right"===this.options.position&&(g+=this.element.width()-d-2);a.left=g+"px";a.top=b+e.top+this.element.outerHeight()-f.top+"px"},isDropdownHidden:function(){return"none"==this.dropdown.css("display")||"hidden"==this.dropdown.css("visibility")},hideDropdown:function(a){a||(this.abortKeyTimeout(),this.abortRequest());this.isHighlightKeyPressed=
!1;this.lastValue=null;if(this.isDropdownHidden())return!1;R9.config.getBoolean("ui.smarty.animation.v2",!1)?this.animateSmartyV2(!1):this.dropdown.hide();this.aria&&this.element.attr({"aria-expanded":!1});this.setBackgroundAutocomplete();return!0},abortRequest:function(){if(this.request){try{this.request.abort()}catch(a){}this.request=null}},abortKeyTimeout:function(){this.keyTimeout&&(clearTimeout(this.keyTimeout),this.keyTimeout=null)},highliteNextItem:function(){var a=this.getItemList(),b=nsel=
this.getHighlitedItemIndex();-1==b?nsel=0:b<a.length-1&&(nsel=b+1);b!=nsel&&(jq(a[b]).removeClass("selected"),jq(a[b]).trigger("mouseout"),jq(a[nsel]).addClass("selected"),jq(a[nsel]).trigger("mouseover"),this.isHighlightKeyPressed=!0,this.setBackgroundAutocomplete(a[nsel]))},highlitePrevItem:function(){var a=this.getItemList(),b=nsel=this.getHighlitedItemIndex();-1==b?nsel=0:0<b&&(nsel=b-1);b!=nsel&&(jq(a[b]).removeClass("selected"),jq(a[b]).trigger("mouseout"),jq(a[nsel]).addClass("selected"),jq(a[nsel]).trigger("mouseover"),
this.isHighlightKeyPressed=!0,this.setBackgroundAutocomplete(a[nsel]))},highlightFirstSelectableItem:function(){for(var a=this.getItemList(),b=0;b<a.length;b++){var d=jq(a[b]);if(!d.hasClass("hist")&&!d.hasClass("js-not-selectable")){d.addClass("selected");this.setBackgroundAutocomplete(a[b]);return}}jq(a[0]).addClass("selected");this.setBackgroundAutocomplete(a[0])},removeItemHighlight:function(){jq(this.getItemList()).removeClass("selected")},getHighlitedItemIndex:function(){for(var a=this.getItemList(),
b=a.length,d=0;d<b;d++)if(jq(a[d]).hasClass("selected"))return d;return R9.config.getBoolean("ui.smarty.auto.select.1st",!1)&&0<b?0:-1},getHighlitedItem:function(){for(var a=this.getItemList(),b=a.length,d=0;d<b;d++)if(jq(a[d]).hasClass("selected"))return a[d];return R9.config.getBoolean("ui.smarty.auto.select.1st",!1)&&0<b?a[0]:null},getItemList:function(){return this.dropdown.find(this.options.dropdownListSelector)},itemMatches:function(a,b){return a?0<=jq(a).text().toLowerCase().indexOf(b.toLowerCase()):
!1},checkAlive:function(){return this.element.closest("html").length?this.element.is(":visible")?!0:(this.hideDropdown(),!1):(this.hideDropdown(),this.unInit(),!1)},initBackgroundAutocomplete:function(){!this.backgroundAutocomplete&&this.options.showBackgroundAutocomplete&&(this.options.backgroundAutocompleteMinLength=R9.config.getInt("ui.common.smarty.background.autocomplete.min.length",3),this.backgroundAutocomplete=jq("\x3cinput/\x3e",{id:this.element.attr("id")+"-bg-autocomplete","class":this.element.attr("class"),
type:"text",tabindex:"-1"}).insertBefore(this.element),this.updateBackgroundAutocompletePosition(),this.backgroundAutocomplete.css("color",this.element.css("color").replace(")",", 0.27)").replace("rgb","rgba")),this.backgroundAutocomplete.addClass("smarty-bg-autocomplete"),this.element.addClass("smarty-with-bg-autocomplete"))},updateBackgroundAutocompletePosition:function(){if(this.options.showBackgroundAutocomplete)if("function"===typeof this.options.getBackgroundAutocompletePositionProps)this.backgroundAutocomplete.css(this.options.getBackgroundAutocompletePositionProps());
else{var a=this.element.is(":visible")?this.element.outerHeight():this.element.height();this.backgroundAutocomplete.css({"margin-bottom":"-"+a+"px"})}},handleKeydownBeforeAutocomplete:function(a,b){if(this.options.showBackgroundAutocomplete){var c=this;setTimeout(function(){var a=c.backgroundAutocomplete.val(),b=c.element.val();b.length>=c.options.backgroundAutocompleteMinLength&&b.length<a.length&&!c.isDropdownHidden()?c.backgroundAutocomplete.val(b+a.substr(b.length)):c.backgroundAutocomplete.val("")},
1)}},setBackgroundAutocomplete:function(a){if(this.options.showBackgroundAutocomplete){var b=this.element.val();if(a&&b.length>=this.options.backgroundAutocompleteMinLength){var d=this.getBackgroundAutocompleteText(a);if(0<d.length){a=d.toUpperCase().indexOf(b.toUpperCase());this.backgroundAutocomplete.val(-1===a?"":b+d.substr(a+b.length));return}}this.backgroundAutocomplete.val("")}this.aria&&a&&a.attributes.id&&(b=jq(a).find(this.trimInputElements).filter(function(){return jq(this).is(":visible")}),
0<b.length&&(d=jq(a).clone(),d.find(this.trimInputElements).remove(),jq(a).attr("aria-label",d.text()+" "+b.text())),this.element.attr({"aria-activedescendant":a.attributes.id.value}))},getBackgroundAutocompleteText:function(a){a=this.translateItem(a);return"string"===typeof a.str?a.str:""},handleWindowResize:function(){this.updateBackgroundAutocompletePosition()}})})(jq||jQuery);
R9.extend("Widgets.Smarty",{FlareSmarty:function(b,a){R9.Widgets.Smarty.Smarty.call(this,b,jq.extend({dataSource:"/mv/marvel"},a));var c=this;jq(".mapViewOuter .filterWrapper").scroll(function(){R9.Widgets.Smarty.Smarty.prototype.handleInputBlurEvent.call(c)})}});R9.extend("Widgets.Smarty.FlareSmarty",!0,{setRunSearchNextFocus:function(b){R9.Widgets.Smarty.FlareSmarty.runSearchNextFocus=b},runSearchNextFocus:!0});
R9.extend("Widgets.Smarty.FlareSmarty.prototype",!0,R9.Widgets.Smarty.Smarty.prototype,{translateItem:function(b){if(!b)return null;var a=jq(b).clone()[0];b=a.id.split("-");var c="";1<b.length&&0>b[1].indexOf(" ")&&(c=b[1]);jq(a).find("span.airportCode, span.region-label, span.nearbyHotels, span.nearbyRentals, span.smarty-emoji, span.smarty-label, span.smarty-popular, span.smarty-city-popular, span.smarty-air-popular, span.showRank").remove();var d=jq(a).attr("data-text-to-select"),d=d&&0<jq.trim(d).length?
d:jq(a).text(),a={type:b[0],id:c,str:d,name:d,short_str:jq(a).attr("data-short-name"),cc:jq(a).attr("data-cc")||"",apicode:a.getAttribute("data-apicode")};"isl"===a.type&&1<b.length&&(c=b[1].split("/"),a.str=c[0]);2<b.length&&(a.hc=b[2]);3<b.length&&("hotel"===a.type?a.hid=b[3]:"rest"===a.type?a.rtid=b[3]:"freereg"===a.type?a.frid=b[3]:"reg"===a.type?a.rid=b[3]:"ctry"===a.type?a.cid=b[3]:"ctgroup"===a.type?a.cgid=b[3]:"hood"===a.type?a.nhid=b[3]:a.lmid=b[3]);return a},preprocessRequest:function(b){var a=
{};this.options.extendRequest&&(a="function"===typeof this.options.extendRequest?this.options.extendRequest(this,b):this.options.extendRequest);var c={};this.options.v&&(c.v=this.options.v);c.f="h";this.options.f&&(c.f=this.options.f);c.where=b.value;c.s=this.getFlareSmartyType()||-1;c.lc_cc=R9.globals.locale.lc_cc;c.lc=R9.globals.locale.lc;return jq.extend(c,a)},runSearchOnFocus:function(){var b=R9.Widgets.Smarty.FlareSmarty.runSearchNextFocus;R9.Widgets.Smarty.FlareSmarty.runSearchNextFocus=!0;
return R9.Widgets.Smarty.Smarty.prototype.runSearchOnFocus.call(this)&&b},onInitialData:function(){var b=this.generateTopDestinations()||R9.Widgets.Smarty.Smarty.prototype.onInitialData.call(this)||this.makeRecentList(null,!0),a=this.generateAnywhereMarkup(),c=this.generateLoginBar(b||a),d=this.generateContinentsMarkup();if(b)return this.placeAnywhereMarkup(b,(a?a:"")+c);b=[];this.appendToInitialData(b);a&&b.push(a);d&&b.push(d);this.options.smartyControlGroup&&R9.globals.canLogin&&"undefined"!==
typeof c&&b.push(c);return b.length?"\x3cul\x3e"+b.join("")+"\x3c/ul\x3e":""},appendToInitialData:function(b){},generateTopDestinations:function(){if(this.options.smartyControlGroup){var b=this.options.smartyControlGroup.getTopDestinations();if(b){var a=b.getItems(),c=b.getMaxItems();return(b=a&&a.filter(function(a,b){return b<c}).map(this.createTopDestinationItem.bind(this)).join(""))&&""!==b?"\x3cul\x3e"+b+"\x3c/ul\x3e":null}}},createTopDestinationItem:function(b){return""},generateAnywhereMarkup:function(b){},
generateContinentsMarkup:function(){},placeAnywhereMarkup:function(b,a){return b?R9.config.getBoolean("ui.smarty.anywhereFirst",!1)?b.replace("\x3cul\x3e","\x3cul\x3e"+a):b.replace("\x3c/ul\x3e",a+"\x3c/ul\x3e"):b},placeContinentsMarkup:function(b,a){return b?b.replace("\x3c/ul\x3e",a+"\x3c/ul\x3e"):b},postprocessResponse:function(b,a){var c=b&&/<li/i.test(b),d=this.makeRecentList(a?this.element.val().toUpperCase():null,!c),e=this.generateOtherMarkup(c);a=this.generateAnywhereMarkup(c);var f=this.generateContinentsMarkup();
if(!d&&!c&&!a)return null;if(!c)return b=d?d:"\x3cul\x3e\x3c/ul\x3e",b=e?b.replace("\x3c/ul\x3e",e+"\x3c/ul\x3e"):b,b=this.placeAnywhereMarkup(b,a?a:""),b=this.placeContinentsMarkup(b,f),b+this.generateLoginBar(!1);b=e?b.replace("\x3c/ul\x3e",e+"\x3c/ul\x3e"):b;b=this.placeAnywhereMarkup(b,a?a:"");d&&(b=b.replace("\x3c/ul\x3e",d+"\x3c/ul\x3e"));return b.replace("\x3c/ul\x3e",this.generateLoginBar(!0)+"\x3c/ul\x3e")},generateOtherMarkup:function(b){return null},selectItem:function(b,a){jq(b).hasClass("hist")&&
this.options.smartyControlGroup?(b=jq(b).data("history-idx"),a=this.options.smartyControlGroup.getHistory(),this.options.smartyControlGroup.setFieldsFromHistoryItem(a.history[b],!1),"undefined"!==typeof this.tempState&&delete this.tempState,R9.Analytics.api.trackEvent("smartyHistory/click/historyItem")):jq(b).hasClass("showHistory")?(window.location.assign("/history"),R9.Analytics.api.trackEvent("smartyHistory/click/seeAllHistory")):jq(b).hasClass("signup")?(AjaxReg.ui.register({promoType:"smarty"}),
R9.Analytics.api.trackEvent("smartyHistory/click/signUp")):jq(b).hasClass("signupnow")?(R9.config.getBoolean("ui.login.staticSignUp")?R9.authentication.showDefault({promoType:"smarty"}):R9.authentication.showSignup(),R9.Analytics.api.trackEvent("smartyHistory/click/signUp"),R9.events.publish("smarty.setitem.complete",{id:this.element.attr("id")})):(b=this.translateItem(b),this.setItem(b,a))},makeRecentList:function(b,a){var c=this.options.recentList,d=null;if(c&&0<c.length){for(var d="",e=0;e<c.length;e++)if(!b||
-1!=c[e].display.toUpperCase().indexOf(b)){var f=c[e].display;b&&(f=this.highliteText(f,b));d+="\x3cli id\x3d'"+c[e].code+"' class\x3d'"+c[e].className+"' data-short-name\x3d'"+c[e].shortName+"'\x3e"+f+"\x3c/li\x3e"}d=""!=d?(a?"\x3cul\x3e":"")+"\x3cli class\x3d'separator'\x3e\x3cb\x3eRecently searched:\x3c/b\x3e\x3c/li\x3e"+d+(a?"\x3c/ul\x3e":""):null}return d},highliteText:function(b,a){a&&(a=a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$\x26"),b=b.replace(new RegExp("("+a+")","ig"),"\x3cb\x3e$1\x3c/b\x3e"));
return b},getFlareSmartyType:function(){return this.options.flareSmartyType},setFlareSmartyType:function(b){this.options.flareSmartyType=b},matchAndBold:function(b,a,c,d){if(!b||!a)return a;c=c||"\x3cb\x3e";d=d||"\x3c/b\x3e";var e=0,f=0,g="",h=a,k=b.length;for(b=b.toUpperCase();;){if(0!==e||0!==(f=a.toUpperCase().indexOf(b,e)))if(-1<(f=a.toUpperCase().indexOf(" "+b,e)))f++;else break;e=a.substring(e,f);h=a.substring(f,f+k);g+=e+c+h+d;h=a.substring(f+k,a.length);e=f+k}return g+h},handleItemMouseoverEvent:function(b,
a){this.getItemList().removeClass("selected");jq(b).addClass("selected");jq(b).hasClass("hist")&&this.options.smartyControlGroup&&"undefined"===typeof this.tempState&&(this.tempState=this.options.smartyControlGroup.saveFieldsToHistoryItem(),b=jq(b).data("history-idx"),a=this.options.smartyControlGroup.getHistory(),this.options.smartyControlGroup.setFieldsFromHistoryItem(a.history[b],!0))},handleItemMouseoutEvent:function(b,a){jq(b).removeClass("selected");"undefined"!==typeof this.tempState&&(this.options.smartyControlGroup.setFieldsFromHistoryItem(this.tempState,
!0),delete this.tempState)},generateLoginBar:function(b){if(!this.options.smartyControlGroup||!R9.globals.canLogin)return"";var a="admin";b&&(a+=" addSeparation");return"undefined"!==typeof R9Anon&&R9Anon?"\x3cli class\x3d'signup "+a+"'\x3eSign up to access recent searches anywhere\x3c/li\x3e":"\x3cli class\x3d'showHistory "+a+"'\x3e See all search history\x3c/li\x3e"},generateRecentHeader:function(){R9.Common.SmartyHistory.currentSmarty=this;R9.Common.SmartyHistory.currentSmartyHistory=this.options.smartyControlGroup.getHistory();
this.hasClearRecentEvent||(this.hasClearRecentEvent=!0,this.dropdown.on("click","ul li.searchHistorySeparator",function(b){b.stopPropagation();b.stopImmediatePropagation()}),this.dropdown.on("mousedown","ul li .clearRecent",function(b){b.stopPropagation();jq("body").trigger("event",[b]);R9.Common.SmartyHistory.SmartyClearHistory()}));return"\x3cli class\x3d'separator searchHistorySeparator'\x3e\x3cspan class\x3d'separatorLabel'\x3eRecent Searches\x3c/span\x3e\x3ca class\x3d'clearRecent'\x3eclear\x3c/a\x3e\x3c/li\x3e"}});
(function(b,a){b.createWidgetClass("smarty.SmartyBaseLoader",a.extend({},b.Widgets.Smarty.Smarty.prototype));b.createWidgetClass("smarty.FlareSmartyBaseLoader","common.widgets.smarty.Smarty",a.extend({},b.Widgets.Smarty.FlareSmarty.prototype,{constructor:function(c,d){this.base(c,a.extend({},b.Widgets.Smarty.FlareSmarty.prototype.options,d))}}))})(window.R9,window.jq||window.jQuery);(function(e,f){e.createWidgetClass("smarty.Smarty","common.widgets.smarty.SmartyBaseLoader",{loggingPrefix:"smarty",setItemTriggered:!1,activeAnimation:!0,focusEventHandled:!1,options:{flippable:!0,direction:"down",repositionDropdownOnResize:e.config.getBoolean("ui.smarty.repositionDropdownOnResize",!0),messages:{SMARTY_HOTELS_NEAR_CITY:"",SMARTY_RENTALS_NEAR_CITY:"",SMARTY_LOCATION_TYPE_HOTEL:"",SMARTY_LOCATION_TYPE_AIRPORT:"",SMARTY_LOCATION_TYPE_NEIGHBORHOOD:"",SMARTY_LOCATION_TYPE_CITY:"",SMARTY_LOCATION_TYPE_LANDMARK:"",
SMARTY_LOCATION_TYPE_COUNTRY:"",SMARTY_LOCATION_TYPE_COUNTRY_GROUP:"",SMARTY_LOCATION_TYPE_REGION:"",SMARTY_LOCATION_TYPE_FREE_REGION:"",SMARTY_LOCATION_TYPE_RAIL:"",SMARTY_LOCATION_TYPE_RESTAURANT:"",SMARTY_LOCATION_TYPE_AIRLINE:"",SMARTY_LOCATION_TYPE_BRAND:"",SMARTY_LOCATION_TYPE_BRAND_GROUP:"",SMARTY_LOCATION_TYPE_AIRPORT_NEAR_CITY:"",SMARTY_LOCATION_TYPE_PLACE:"",SMARTY_LOCATION_TYPE_POI:"",SMARTY_LOCATION_TYPE_WORLD:"",SMARTY_CONTINENTS_LABEL:""}},locationTypeMessages:{},constructor:function(a,
b){this.base(a,b);this.applyJsonOptions();this.locationTypeMessages={ap:this.options.messages.SMARTY_LOCATION_TYPE_AIRPORT,hood:this.options.messages.SMARTY_LOCATION_TYPE_NEIGHBORHOOD,lm:this.options.messages.SMARTY_LOCATION_TYPE_LANDMARK,ctry:this.options.messages.SMARTY_LOCATION_TYPE_COUNTRY,cg:this.options.messages.SMARTY_LOCATION_TYPE_REGION,reg:this.options.messages.SMARTY_LOCATION_TYPE_REGION,freereg:this.options.messages.SMARTY_LOCATION_TYPE_FREE_REGION,city:this.options.messages.SMARTY_LOCATION_TYPE_CITY,
hotel:this.options.messages.SMARTY_LOCATION_TYPE_HOTEL,rail:this.options.messages.SMARTY_LOCATION_TYPE_RAIL,rest:this.options.messages.SMARTY_LOCATION_TYPE_RESTAURANT}},init:function(){this.aria=e.config&&e.config.getBoolean("ui.smarty.aria",!0);e.config&&(this.options.zIndex=e.config.getInt("ui.smarty.zIndex",9999));this.dropdown=this.options.dropdown;this.initSmartyDropdown();this.element.attr("smarty",!0);!0===this.options.enableRemoteHide&&this.id()&&e.events.subscribe("Smarty.hide",f.proxy(this.hideSmartyById,
this))},hideSmartyById:function(a){this.id()!==a&&this.hideDropdown(!1)},inlineComponentsReady:function(){var a=this;setTimeout(function(){a.element.attr({autocomplete:"off",autocapitalize:"off",autocorrect:"off"});a.aria&&a.element.attr({role:"combobox","aria-autocomplete":a.options.showBackgroundAutocomplete?"both":"list"});a.element.is(":focus")?a.element.focus():a.element.attr("autofocus")&&a.element.focus();a.options.showBackgroundAutocomplete&&(a.options.getBackgroundAutocompletePositionProps=
function(){return{"margin-bottom":"-"+a.element.outerHeight(!0)+"px"}});a.initBackgroundAutocomplete();e.config.getBoolean("ui.smarty.animation.v2",!1)&&a.animateSmartyV2(!1);a.initialVal=a.element.val();a.initialCode=a.element.next(".aircode").val();""!==a.initialVal&&(a.isItemSet=!0)},1)},concatExtraDropdownClasses:function(a,b){if(f.isArray(a)&&b)for(var c=0;c<a.length;c++)a[c]&&a[c].dropdownClass&&(a[c].dropdownClass+=b)},extraIconClasses:function(a){return a?" "+e.config.getString("ui.smarty.iconClasses",
"greyIcons")+" ":""},extraLabelClasses:function(){return e.config.getBoolean("ui.smarty.labels",!1)&&this.options.extendRequest&&"v2"===this.options.extendRequest.v?e.config.getString("ui.smarty.labelsClasses","greyLabels"):""},addEventHandlers:function(){this.bindInputEvent("keydown",this.handleInputKeydownEvent);this.addDelegateEventHandlers()},addDelegateEventHandlers:e.Common.Utils.limit(1,function(){var a=[e.globals.keyCodes.TAB,e.globals.keyCodes.RETURN,e.globals.keyCodes.ESC];this.bindDelegateInputEvent("focus",
this.handleInputFocusEvent);this.bindDelegateInputEvent("mousedown touchstart",this.handleInputFocusEvent);this.bindDelegateInputEvent("blur",this.handleSmartyInputBlurEvent);this.bindDelegateInputEvent("textchange",this.handleInputChangeEvent);this.bindDelegateInputEvent("keyup",function(b){0<=a.indexOf(b.keyCode?b.keyCode:b.which)||this.dropdown&&this.dropdown.is(":visible")&&this.handleInputFocusEvent(this.element,b)})}),bindDelegateInputEvent:function(a,b){f("body").off(a,'input[smarty\x3d"true"]').on(a,
'input[smarty\x3d"true"]',function(a){var c=f(this).getWidget();return c?b.call(c,a):!1})},initDropdown:function(){this.initSmartyDropdown()},initSmartyDropdown:function(){if(!this.dropdown){var a={id:this.id("smartbox-dropdown"),css:{display:"none",position:"absolute",width:"auto"},role:"dialog",tabindex:"0"},b=this.widgetBaseClass||"";this.options.dropdownClass&&(b=b+" "+this.options.dropdownClass);this.dropdown=f("\x3cdiv\x3e\x3c/div\x3e",a).addClass(b);this.dropdown.addClass("R9-Overlay");this.dropdown.addClass(this.extraIconClasses());
this.dropdown.addClass(this.extraLabelClasses())}},setDropdownContent:function(a){this.dropdown[0].innerHTML=a},setDropdownPosition:function(){var a=this.widgetBaseClass;this.options.dropdownClass&&(a=a+" "+this.options.dropdownClass);a=a+" "+this.extraIconClasses()+" "+this.extraLabelClasses();this.dropdown.attr("class",a);var a=this.dropdown[0].style,b=this.dropdown.outerWidth(!0),c=!1;this.options.minWidth&&b<this.options.minWidth&&(b=Math.max(this.options.minWidth,b),c=!0);this.options.maxWidth&&
b>this.options.maxWidth&&(b=Math.min(this.options.maxWidth,b),c=!0);a.width=c?b+"px":"auto";if(this.options.fixedDropdown)a.position="relative";else{var c=this.options.positionTarget||this.element,d=c.offset(),e=f(this.options.appendTo).offset(),h=0,l=d.left-e.left,k=this.options.direction;this.dropdown.parent()[0]===f(document.body)[0]&&(h=parseInt((f(document.body).css("top")||"0").replace("-",""))||0);"right"===this.options.position&&(l+=c.width()-b-2);this.shouldFlipDirection(k)&&(k="down"===
k?"up":"down");"up"===k?(this.element.addClass("up"),a.top=d.top-this.dropdown.outerHeight()-h+"px"):(this.element.removeClass("up"),a.top=h+d.top+c.outerHeight()-e.top+"px");a.left=l+"px"}this.isAnimated()||(a.display="inline");this.aria&&(this.element.attr({"aria-expanded":!0}),this.dropdown.find("ul").attr("role","listbox"),this.dropdown.find("li").attr("role","option"));a.zIndex=this.element.zIndex()+this.options.zIndex;this.options.boundToScreen&&(this.dropdown.css("height","auto"),b=f(window).height(),
c=f(window).scrollTop(),d=this.dropdown.outerHeight(),a=parseInt(a.top),d+a+10-c>b&&(this.dropdown.height(b+c-a-10),this.dropdown.css("overflow-y","auto")))},shouldFlipDirection:function(a){if(this.options.flippable){var b=f(window).scrollTop(),c=b+f(window).outerHeight(),d=this.dropdown.outerHeight(),e=this.element.offset().top,c=e+this.element.outerHeight()+d>c,b=e-d<b;if("down"===a)return c&&!b;if("up"===a)return b&&!c}return!1},showDropdown:function(a,b){this.options.enableRemoteHide&&e.events.publish("Smarty.hide",
this.id());this.deferredSmartyAppend||(this.deferredSmartyAppend=1,this.dropdown.appendTo(this.options.appendTo));var c=this;this.showDropdownTimeout&&(clearTimeout(this.showDropdownTimeout),this.showDropdownTimeout=null);if("function"===typeof this.options.delayShowDropdown&&this.options.delayShowDropdown()){var d=this.showDropdownLast?Date.now()-this.showDropdownLast:null;if(!this.showDropdownLast||0===d||d&&0<d&&d<this.options.showDropdownDelay){this.showDropdownLast=this.showDropdownLast||Date.now();
this.showDropdownTimeout=setTimeout(this.showDropdown.bind(this,a,b),d||this.options.showDropdownDelay);return}}this.showDropdownLast=null;this.setDropdownContent(this.makeHTML(a));this.setDropdownPosition();this.bindDropdownEvent("click",this.handleItemClickEvent);this.bindDropdownEvent("mouseover",this.handleItemMouseoverEvent);this.bindDropdownEvent("mouseout",this.handleItemMouseoutEvent);if(this.options.repositionDropdownOnResize)f(window).off("resize.smarty").on("resize.smarty",this.handleWindowResizeSmarty.bind(this));
clearTimeout(this.clickDropdownSetID);this.clickDropdownSetID=setTimeout(function(){if(c.isSmartyActiveElement())f(document).off("click.Smarty"+c.id()).on("click.Smarty"+c.id(),function(){c.onDocumentClicked()})},400);this.removeItemHighlight();""!==this.element.val()&&this.highlightFirstSelectableItem();this.options.positionOnScroll&&(a=function(){c.position()},f(window).off("scroll.smarty",a).on("scroll.smarty",a),f(".col-left-rail").off("scroll.colSmarty").on("scroll.colSmarty",a),f(".filterList").off("scroll.colSmarty").on("scroll.colSmarty",
a));e.config.getBoolean("ui.smarty.animation.v2",!1)&&this.animateSmartyV2(!0)},hideDropdown:function(a){f(window).off("resize.smarty");this.base(a);if(e.config.getBoolean("ui.smarty.auto.select.1st",!1))return!0},toggleAnywhere:function(a){this.options.showAnywhere=a},stopInputProcessing:function(){this.setItemTriggered||this.smartyLoggerSave();this.setItemTriggered=!1;this.base()},handleItemClickEvent:function(a){this.selectItem(a,null);this.hideDropdown()},handleInputBlurEvent:function(a,b){this.handleSmartyInputBlurEvent(a,
b)},handleSmartyInputBlurEvent:function(){var a=this;this.focusEventHandled=!1;setTimeout(function(){if(!a.isSmartyActiveElement()){a.stopInputProcessing();if(a.hideDropdown()&&a.options.forceSelection)a.onForceSelection();a.onAfterDone()}},10)},onDocumentClicked:function(){if(!this.isSmartyActiveElement())if(f(document).off("click.Smarty"+this.id()),this.options.cleanUpInputFieldOnFocus){if(this.lastValue&&!this.element.val()&&this.element.val(this.lastValue),!this.isSmartyActiveElement()){this.stopInputProcessing();
if(this.hideDropdown()&&this.options.forceSelection)this.onForceSelection();this.onAfterDone()}}else this.hideDropdown()},isSmartyActiveElement:function(){return this.dropdown&&this.element?document.activeElement===this.dropdown.get(0)||document.activeElement===this.element.get(0)||0<this.dropdown.find(f(document.activeElement)).length:!1},setItem:function(a,b){this.smartyLoggerSave(a);this.setItemTriggered=!0;this.base(a,b)},smartyLoggerSave:function(a){if(e.config.getBoolean("ui.smarty.r9LogOptions",
!0)){var b={vertical:this._logPath,inputType:this.element.attr("name")||"destination",prefix:this.isItemSet||!this.setItemTriggered&&this.initialVal&&this.initialVal===this.element.val()?"":this.element.val()||"",options:this.getSmartyLoggerItems()||[]};a&&(b.selectedElem=a);e.SmartyLogger._save(b)}},getSmartyLoggerItems:function(){return this.dropdown&&this.dropdown.children&&this.dropdown.children("ul").children("li")},handleWindowResize:function(){this.handleWindowResizeSmarty()},handleWindowResizeSmarty:function(){if(!this.isDropdownHidden()){var a=
this.options.positionTarget||this.element,b=a.offset().left-f(this.options.appendTo).offset().left,c=a.offset().top+a.outerHeight()-f(this.options.appendTo).offset().top;"right"===this.options.position&&(b+=a.width()-2);this.dropdown.css("left",b+"px");this.dropdown.css("top",c+"px")}this.updateBackgroundAutocompletePosition()},destroy:function(){this.base();this.hideDropdown();this.abortSearchCompletedEventListeners();this.unInit();this.unbindInputEvent("mousedown touchstart");this.unbindInputEvent("keyup");
this.element.removeData("widget");this.element.attr("smarty",!1);f(document).off("click.Smarty"+this.id());f(window).off("resize.smarty");!0===this.options.enableRemoteHide&&this.id()&&e.events.unsubscribe("Smarty.hide",this.hideSmartyById)},animateSmarty:function(a,b){this.isAnimated()&&(a?this.dropdown.slideDown(250):this.dropdown.slideUp(250,b))},isAnimated:function(){return this.options.animateSmarty},isJSON:function(){var a=this.options.extendRequest;return a&&"j"===a.f},isJsonResponse:function(a){return this.isJSON()&&
"string"!==typeof a},applyJsonOptions:function(){this.isJSON()&&(this.options.dataType="json",this.options.extendRequest=f.extend({},this.options.extendRequest,{v:"v1"}),this.options.dropdownClass+=" smartbox-js")},postprocessResponse:function(a,b){return this.isJsonResponse(a)?a:this.base(a,b)},makeHTML:function(a){if(!this.isJsonResponse(a))return this.base(a);var b=this,c=this.getRequestData(),d=c&&c.value||"",e=this.getMaxItemsToShow();return'\x3cul role\x3d"listbox"\x3e'+a.map(function(a,c){return 0<
e&&c>=e?null:b.formatItem(a,d)}).filter(function(a){return!!a}).join("")+"\x3c/ul\x3e"},getMaxItemsToShow:function(){return-1},formatItem:function(a,b){var c=a.cc&&"ctry"===a.loctype&&e.config&&e.config.getBoolean("ui.smarty.hideCountryFeatures."+a.cc,!1);if(!a||!a.loctype)return"";var d=this.getDisplayName(a),g=this.getNearbyHotels(a),h=this.getNearbyRentals(a),d=f.extend({},a,{id:this.getItemId(a),name:d,label:[d,g,h].filter(function(a){return!!a}).join(" "),highlighting:this.highlight(d,b),parentPath:a.parentPath||
a.rc||"",nearbyHotels:g,nearbyRentals:h}),g='\x3cdiv class\x3d"smarty-city"\x3e'+d.highlighting+"\x3c/div\x3e";"ap"===a.loctype?(d.shortName=a.shortdisplayname||"",g+='\x3cspan class\x3d"airportCode"\x3e'+this.highlight(a.ap,b)+"\x3c/span\x3e"):"city"===a.loctype?d.shortName=a.cityonly||"":"ctry"===a.loctype&&a.cc&&!c&&(d.icon="/images/flags/a-small-flag."+a.cc.toLowerCase()+".png");(b=this.locationTypeMessages[a.loctype]||"")&&!c&&(g+='\x3cspan class\x3d"smarty-label '+a.loctype+'"\x3e'+b+"\x3c/span\x3e");
"ap"!==a.loctype&&"hotel"!==a.loctype&&(g+=this.formatNearbyDetails(a,d));b=a.loctype||"city";"cg"===b&&(b="ctgroup");c&&(b+=" noBackgroundIcon");c=['id\x3d"'+this.formatListItemId(a,d)+'"','class\x3d"'+b+'"','role\x3d"option"','tabindex\x3d"0"'];a.cc&&c.push('data-cc\x3d"'+a.cc+'"');a.rc&&c.push('data-rc\x3d"'+a.rc+'"');d.shortName&&c.push('data-short-name\x3d"'+d.shortName+'"');d.label&&c.push('aria-label\x3d"'+d.label+'"');d.icon&&c.push('style\x3d"background-image:url('+d.icon+')"');c.push('data-attr\x3d"'+
this.htmlEscape(JSON.stringify(d))+'"');return"\x3cli "+c.join(" ")+"\x3e"+g+"\x3c/li\x3e"},getDisplayName:function(a){var b=a.displayname||"";if(a.ap){a="("+a.ap+")";var c=b.length,d=c-a.length;b&&b.substring(d,c)===a&&(b=b.substring(0,d).trim())}return b},getNearbyHotelsCount:function(a){return a.hotelCount||a.nearbyHotels||0},getNearbyHotels:function(a){return""},getNearbyRentalsCount:function(a){return a.rentalCount||a.nearbyRentals||0},getNearbyRentals:function(a){return""},formatNearbyDetails:function(a,
b){a="";b.nearbyHotels&&(a+='\x3cspan class\x3d"smarty-label hotels"\x3e'+b.nearbyHotels+"\x3c/span\x3e");b.nearbyRentals&&(a+='\x3cspan class\x3d"smarty-label rentals"\x3e'+b.nearbyRentals+"\x3c/span\x3e");return a},getItemId:function(a){return""+(("ap"===a.loctype?a.ap:"city"===a.loctype?a.ctid:"ctry"===a.loctype?a.cid:"hotel"===a.loctype?a.hid:"reg"===a.loctype?a.rid:"freereg"===a.loctype?a.frid:"cg"===a.loctype?a.cgid:"hood"===a.loctype?a.sid:"lm"===a.loctype?a.lmid:a.id)||"")},formatListItemId:function(a,
b){return a.loctype+"-"+b.id},htmlEscape:function(a){var b={"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#39;"};return a.replace(/[&<>"']/g,function(a){return b[a]})},highlight:function(a,b){var c=a.toLowerCase().indexOf(b.toLowerCase());b=c+b.length;return 0>c?a:a.substring(0,c)+"\x3cb\x3e"+a.substring(c,b)+"\x3c/b\x3e"+a.substring(b)}})})(window.R9,window.jq||window.jQuery);(function(d,e){d.createWidgetClass("smarty.PopularDestinationsSmarty","common.widgets.smarty.FlareSmarty",{currentOrigin:null,constructor:function(a,b){d.config.getBoolean("ui.smarty.auto.select.1st.item.on.close",!1)&&e.extend(b,{dropdownList1stItemSelector:"ul[role\x3dlistbox] li:first-child:visible",dropdownListItemsSelector:"ul[role\x3dlistbox] li"});this.base(a,b)},showDropdown:function(a,b){this.base(a,b);d.config.getBoolean("ui.smarty.animation.v2",!1)&&this.activeAnimation?(this.animateSmartyV2(!0),
this.base(a,b)):this.isAnimated()&&this.animateSmarty(!0)},searchCompleted:function(a,b){d.config.getBoolean("ui.smarty.auto.select.1st.item.on.close",!1)?((a=this.canShowDropdown(a))?this.showDropdown(a,b):this.hideDropdown(!0),this.element.trigger("searchCompleted",!!a)):this.base(a,b)},hideDropdown:function(a){var b="undefined"==typeof a;if(d.config.getBoolean("ui.smarty.auto.select.1st.item.on.close",!1)&&""!==this.element[0].value&&this.isSelectOnCloseSupported()){var c=this.dropdown.find(this.options.dropdownList1stItemSelector);
a=this.dropdown.find(this.options.dropdownListItemsSelector);if("undefined"!==typeof c&&0<c.length&&c.hasClass("selected"))(a=this.extractFirstListItemData(c))&&this.setItem(a);else if(b){b=!1;for(c=0;c<a.length;c++)e(a[c]).hasClass("selected")&&(b=a[c]);b||(1<c&&(e(a[0]).hasClass("anywhere")&&"undefined"!==typeof a[1]?e(a[1]).addClass("selected"):e(a[0]).addClass("selected")),a.each(this.checkAndSetItem.bind(this)))}}if(d.config.getBoolean("ui.smarty.animation.v2",!1)&&this.activeAnimation){if(!this.dropdown||
"none"===this.dropdown.css("display"))return!1;this.animateSmartyV2(!1);this.base()}else this.isAnimated()?this.animateSmarty(!1,this.base.bind(this)):this.base();if(d.config.getBoolean("ui.smarty.auto.select.1st",!1))return!0},checkAndSetItem:function(a,b){a=e(b);if(a.hasClass("anywhere")&&a.hasClass("selected")&&a.is(":visible"))return a={id:"",short_str:"anywhere",str:a[0].innerText,type:""},this.setItem(a),!1;if("undefined"!==a.attr("id")&&a.is(":visible")&&(a=this.extractFirstListItemData(a)))return this.setItem(a),
!1},extractFirstListItemData:function(a){if(a.hasClass("anywhere")&&a.hasClass("selected")&&a.is(":visible"))return{id:"",short_str:"anywhere",str:a[0].innerText,type:""};if(d.config.getBoolean("ui.smarty.populardestinations.1st.translate",!0))return(a=this.translateItem(a))?a:!1;var b=a[0].id.split("-"),c=a[0].id;return c.startsWith("ap")?{id:b[1],short_str:a.attr("data-short-name"),str:a.clone().find("span").remove().end().text(),type:"ap"}:c.startsWith("freereg")?{frid:b[3],hc:b[2],id:b[1],str:a.children("div")[0].innerText,
type:"freereg"}:c.startsWith("ctry")?{cid:b[3],hc:b[2],id:b[1],str:a.children("div")[0].innerText,type:"ctry"}:c.startsWith("reg")?{rid:b[3],hc:b[2],id:b[1],str:a.children("div")[0].innerText,type:"reg"}:c.startsWith("city")?{hc:b[2],id:b[1],str:a.children("div")[0].innerText,type:"city"}:c.startsWith("lm")?{hc:b[2],lmid:b[3],id:b[1],str:a.children("div")[0].innerText,type:"lm"}:!1},isSelectOnCloseSupported:function(){return 51===this.options.flareSmartyType||50===this.options.flareSmartyType||58===
this.options.flareSmartyType},drawDestinationsContent:function(a){this.lastValue=null;this.currentOrigin&&this.currentOrigin===a||(this.currentOrigin=a,this.dropdown[0].innerHTML="");this.hideDropdown()}})})(window.R9,window.jq||window.jQuery);(function(e,h){var p=function(a){return 3===a.trim().length};e.createWidgetClass("smarty.FlightSmarty","common.widgets.smarty.PopularDestinationsSmarty",{isDirty:!1,constructor:function(a,b){var c={dropdownClass:" smartbox smartbox-air smartbox-air-regions smartbox-v2 R9-Overlay ",templatePresentationSuffix:"",flareSmartyType:1,forceSelection:!0,minWidth:250,searchOnFocus:!0,useNearby:!1,allowMultipleAirports:e.config.getBoolean("ui.smarty.flights.allowMultipleAirports",!0),airportMultiSelectEnabled:!1,
useApiAirportCode:e.config.getBoolean("ui.smarty.flights.useApiAirportCode",!1),nearbyChecked:!1,extendRequest:{v:"v2"},alwaysShowAnywhere:!1,disableAnywhereDirtyCheck:e.config.getBoolean("ui.smarty.disableAnywhereDirtyCheck",!1),repositionDropdownOnResize:e.config.getBoolean("ui.smarty.flights.repositionDropdownOnResize",!1),onInputChange:function(){},onAddAirportMultiSelection:function(a,b,c,e){},onRemoveAirportMultiSelection:function(a,b){},getAirportMultiSelections:function(){return[]},hasAirportMultiSelectionCode:function(){},
allowAddAirportMultiSelection:function(){}};this.concatExtraDropdownClasses([c,b],this.extraIconClasses(e.config.getBoolean("ui.smarty.flights.greyIcons",!1)));b&&b.extraDropdownClasses&&(c.dropdownClass+=" "+b.extraDropdownClasses+" ");this.base(a,h.extend(c,b))},setOptions:function(a){h.extend(this.options,a)},showDropdown:function(a,b){this.base(a,b);!this.options.useNearby||!h.trim(this.element.val()).length&&this.options.smartyControlGroup&&this.options.smartyControlGroup.getTopDestinations()||
this.addNearby()},addNearby:function(){if(this.dropdown){var a=this.id("nearby"),b=this.id("nearbyCheck"),c,f=!!this.isNearbyChecked||void 0===this.isNearbyChecked&&this.options.nearbyChecked,k=this;if(!(0<this.dropdown.find("#"+a).length)){c=0<this.dropdown.find("li").map(function(){return this.id.split("-")[0]}).toArray().filter(function(a){return"ap"===a||"apnc"===a}).length;var g=this.airportMultiSelectActive&&!!this.dropdown.find("li.js-selection").length;if(c||g)c=e.template.render("nearbySmartyCheck"+
this.options.templatePresentationSuffix,{id:b}),a=e.template.renderElement("nearbySmartyWrapper"+this.options.templatePresentationSuffix,{id:a,nearbySmartyCheck:c}),this.dropdown.prepend(a),b=this.dropdown.find("#"+b),a=b.parent().is(".StyleJamCheckbox")?"styleJamCheckbox":"checkbox",b[a]({change:function(a){k.isNearbyChecked=a.checked;"function"===typeof k.options.nearbyCallback&&k.options.nearbyCallback.call(null,{enabled:k.isNearbyChecked})}}).prop("checked",f?"checked":"")}}},getIsNearbyChecked:function(){return this.isNearbyChecked},
postprocessResponse:function(a,b){b=this.base(a,b);if(this.options.allowMultipleAirports&&1<this.element.val().split(",").filter(p).length){b="\x3cli id\x3d'custom' class\x3d'no-icon'\x3e\x3cb\x3e"+this.element.val()+"\x3c/b\x3e\x3c/li\x3e";if("string"===typeof a){var c=a.indexOf("\x3cli");if(0<c)return a.slice(0,c)+b+a.slice(c)}return"\x3cul\x3e"+b+"\x3c/ul\x3e"}return b},setIsNearbyChecked:function(a){this.isNearbyChecked!==a&&(this.isNearbyChecked=!!a,this.dropdown&&this.dropdown.find("#"+this.id("nearbyCheck")).prop("checked",
this.isNearbyChecked?"checked":""))},createTopDestinationItem:function(a){var b=[],c="%s (%s)".format(a.name,a.cityCode);b.push(a.name);a.stateCode&&""!==a.stateCode?b.push(a.stateCode):a.state&&b.push(a.state);a.country&&b.push(a.country);return('\x3cli id\x3d"ap-%s" class\x3d"ap" data-short-name\x3d"%s" data-cc\x3d"%s" data-apicode\x3d"%s" role\x3d"option"\x3e\x3cspan class\x3d"airportCode"\x3e%s\x3c/span\x3e%s\x3cspan class\x3d"smarty-label ap"\x3e'+this.options.messages.SMARTY_LOCATION_TYPE_AIRPORT+
"\x3c/span\x3e\x3c/li\x3e").format(a.cityCode+"/"+a.ctId,c,a.cid,a.cityCode,a.cityCode,b.join(", "))},translateItem:function(a){var b=this.base(a);if(this.options.useApiAirportCode&&"ap"===b.type&&b.apicode){var c=b.id.split("/");b.id=1<c.length?b.apicode+"/"+c[1]:b.apicode}this.options.airportMultiSelectEnabled&&(b.isMetroCode=h(a).hasClass("aap"));return b},makeRecentList:function(a,b){if(this.options.smartyControlGroup){var c=this.options.smartyControlGroup.getHistory();if(c){var f=this.options.smartyControlGroup.getMaxHistory(),
e="origin"===this.elementNode.name,g="destination"===this.elementNode.name,l=this.options.smartyControlGroup.isRoundTrip();a=h.trim(a);var f=""===a?f:3,d;g&&(d=h(this.options.smartyControlGroup.options.originCode).val());c=c.filter(a,e,f,l,d);g="";for(l=0;l<c.length;l++){d=c[l];var f=this.isSmartyUIV1()?d.departAirportName:d.departShortName,n=this.isSmartyUIV1()?d.destAirportName:d.destShortName,m=!1;l===c.length-1&&(m=!0);g=e?g+this.generateSmartyItem(this.matchAndBold(a,f),n,d.startDate,d.endDate,
d.idx,d.isRoundTrip,d.isPast,m):g+this.generateSmartyItem(f,this.matchAndBold(a,n),d.startDate,d.endDate,d.idx,d.isRoundTrip,d.isPast,m)}return g=""!==g?(b?"\x3cul\x3e":"")+this.generateRecentHeader()+g+(b?"\x3c/ul\x3e":""):null}}},generateSmartyItem:function(a,b,c,f,k,g,l,d){c=new moment(c);f=new moment(f);l=l?"past":"";d=d?" last":"";var h=g?"doubleArrow":"singleArrow";g=g?" - "+f.format(this.options.smartyControlGroup.options.endFormat):"";f='\x3cli tabindex\x3d"0" class\x3d"hist '+d+'" data-history-idx\x3d"'+
k+'"\x3e\x3cspan class\x3d"smartyRecentAirports"\x3e'+a+'\x3cspan class\x3d"arrow '+h+'"\x3e\x3c/span\x3e'+b+'\x3c/span\x3e\x3cspan class\x3d"smartyRecentDate '+l+'"\x3e'+c.format(this.options.smartyControlGroup.options.startFormat)+g+"\x3c/span\x3e\x3c/li\x3e";this.isSmartyUIV1()&&(a="\x3cdiv class\x3d'airports'\x3e%s\x3c/div\x3e".format('\x3cspan class\x3d"smartyRecentAirports"\x3e'+a+'\x3cspan class\x3d"arrow '+h+'"\x3e\x3c/span\x3e'+b+"\x3c/span\x3e"),b="\x3cdiv class\x3d'dates'\x3e%s\x3c/div\x3e".format('\x3cspan class\x3d"smartyRecentDate '+
l+'"\x3e'+c.format(this.options.smartyControlGroup.options.startFormat)+g+"\x3c/span\x3e"),f='\x3cli tabindex\x3d"0" class\x3d"hist '+d+'" data-history-idx\x3d"'+k+'"\x3e\x3cdiv class\x3d"icon-wrapper"\x3e'+e.template.render("smartyFlightHistorySVG")+'\x3c/div\x3e\x3cdiv class\x3d"search-info"\x3e%s\x3c/div\x3e\x3c/li\x3e'.format(a+b));return f},generateLoginBar:function(a){var b="";if(!this.options.smartyControlGroup||this.isSmartyUIV1()&&a)return"";var c="admin";a&&(c+=" addSeparation");"notloggedin"===
e.globals.analytics.loginState?(b+="\x3cli tabindex\x3d'0' class\x3d'signupnow "+c+"'\x3e"+this.options.messages.loginForSearchHistory+"\x3c/li\x3e",this.isSmartyUIV1()&&(b=e.template.render("smartySignUpIn",{extraClasses:c}))):b+="\x3cli tabindex\x3d'0' class\x3d'showHistory "+c+"'\x3e"+(this.isSmartyUIV1()?'\x3cdiv class\x3d"icon-wrapper"\x3e'+e.template.render("smartyHistorySVG")+"\x3c/div\x3e":"")+this.options.messages.seeAllSearchHistory+"\x3c/li\x3e";return b},selectItem:function(a,b){h(a).is(".sign-up-in")||
this.base(a,b)},generateAnywhereMarkup:function(a){var b="",c=this.element.val().trim().toLocaleLowerCase(),f=this.options.messages?this.options.messages.anywhere:null,k="",c=this.options.showAnywhere&&(this.options.disableAnywhereDirtyCheck||!this.isDirty||""===c||f&&0===f.toLocaleLowerCase().indexOf(c)&&2<c.length),g=this.options.smartyControlGroup&&!this.options.smartyControlGroup.isRoundTrip(),l=e.config.getBoolean("ui.smarty.anywhere.oneWay",!1);if(c||this.options.alwaysShowAnywhere){if(g&&!l)return b;
e.config.getBoolean("ui.smarty.anywhereFirst",!1)&&/ - /.test(f)&&[].map&&(f=f.split(" - ").map(function(a){return"\x3cdiv\x3e"+a+"\x3c/div\x3e"}).join(""),k+=" split ");b+="\x3cli tabindex\x3d'0' data-short-name\x3d'anywhere' class\x3d'anywhere admin "+k+(a?"addSeparation":"")+"'\x3e"+f+"\x3c/li\x3e";this.isSmartyUIV1()&&(this.isDestinationImagesEnabled()&&(k+=" dimg"),b=e.template.render("anywhereMarkUp",{extraClasses:k+(a?" addSeparation":"")}))}return b},generateContinentsMarkup:function(){var a=
"",b=this.options.continents;0<b.length&&this.options.showContinents&&(a+='\x3cdiv class\x3d"separator continents-separator"\x3e\x3cspan class\x3d"separatorLabel"\x3e'+this.options.messages.SMARTY_CONTINENTS_LABEL+"\x3c/span\x3e\x3c/div\x3e",b.forEach(function(b){a+='\x3cli  id\x3d"continent-'+b.id+'" class\x3d"continent '+b.id+'" tabindex\x3d"0" \x3e'+b.message+"\x3c/li\x3e"}));return a},generateAirportMultiSelectHeader:function(a){return e.template.render("airportMultiSelectHeader",{id:this.id("airportMultiSelectHeader"),
maxMessageVisible:!this.options.allowAddAirportMultiSelection(),selectedTitle:a,suggestedTitle:!a})},generateAirportMultiSelections:function(){var a=this,b=this.options.getAirportMultiSelections();if(!b||!b.length)return"";var c=this.generateAirportMultiSelectHeader(!0),b=b.map(function(b){var c={loctype:"ap",locationname:b.description||b.display,ap:b.code,airportname:"",shortdisplayname:b.display,smartyDisplay:b.description};return e.template.render("airportMultiSelectItem",{ariaLabel:b.display,
iconHtml:a.getSvgIcon({loctype:"ap"}),displayNameHtml:a.getDisplayNameHtml(c),airportCodeCheckboxHtml:a.getAirportCodeHtml(c,!0)})}).join("");return[c,'\x3cul role\x3d"listbox"\x3e',b,"\x3c/ul\x3e"].join("")},handleInputValue:function(){this.isDirty=!0;this.options.onInputChange();this.base()},setItem:function(a,b){if("custom"===a.type)e.events.publish("smarty.setitem.complete",{id:this.element.attr("id")});else if(a&&"easter"===a.type)e.events.publish("smarty.easteregg.found",h.extend(a,{vertical:"flights"})),
this.element.val(""),this.element.trigger("textchange");else{if(e.config.getBoolean("ui.smarty.flights.logCityVsAp",!0)){var c=a.hasOwnProperty("type")&&"city"===a.type?"city":"airport";e.Analytics.api.trackEvent({category:this.loggingPrefix,action:"click",label:c,value:(a.short_str||a.str||"").replace(/\s+/g,"-")})}this.airportMultiSelectActive&&a.isMetroCode&&this.toggleSubAirportMultiCheckboxes(!0);this.base(a,b)}},stopInputProcessing:function(){e.common.widgets.smarty.Smarty.prototype.stopInputProcessing.apply(this,
arguments)},makeHTML:function(a){if(!this.isJsonResponse(a))return this.base(a);var b=this,c=this.getRequestData(),f=c&&c.value||"",k=e.config.getInt("ui.smarty.json.itemLimit",-1),c=this.makeRecentList(f,!0),g="function"===typeof a.map&&a.length,l=this.airportMultiSelectActive?this.generateAirportMultiSelectHeader(!1):"",d="";if(g)var h=a.some(function(a){return a&&"ap"===a.loctype&&b.isCheckedMetroCode(a.ap||a.airportcode,a.airportname)}),d=d+a.map(function(a,c){if(0<k&&c>=k)return null;h&&a&&"ap"===
a.loctype&&a.sub&&(a.selectedMetroCodeMember=!0);return b.formatItem(a,f)}).filter(function(a){return!!a}).join("");d=d+(c||"")+(this.isSmartyUIV1()?this.generateAnywhereMarkup(g?a.length:0):"");d+=this.generateLoginBar(!0);return""!==d?l+'\x3cul role\x3d"listbox" class\x3d"flight-smarty"\x3e'+d+"\x3c/ul\x3e":""},canShowDropdown:function(a){var b=a;this.options.showAnywhere&&this.isSmartyUIV1()&&(b=a||[]);return b},getDestinationImages:function(a){if(!this.isDestinationImagesEnabled())return null;
switch(a.loctype){case "ap":case "apnc":return this.createDestinationImageNode(a);default:return this.base(a)}},originalUseNearby:null,toggleNearbyAllowed:function(a){null===this.originalUseNearby&&(this.originalUseNearby=!!this.options.useNearby);this.options.useNearby=a?this.originalUseNearby:!1},isNearbyEnabled:function(){return this.options.useNearby},hideNearbyCheckbox:function(){this.getChildElement("nearby").remove()},toggleMultiCheckboxEnabled:function(a){this.dropdown.find(".js-multi-select-message").prop("hidden",
a).removeClass("multiAirportSelectionsHeader__message--error");this.dropdown.find(".js-multi-select-checkbox-input").not(":checked").prop("disabled",!a)},highlightMultiCheckboxMessage:function(){this.dropdown.find(".js-multi-select-message").addClass("multiAirportSelectionsHeader__message--error")},toggleMultiCheckbox:function(a,b){a=this.dropdown.find('.js-multi-select-checkbox-input[data-value\x3d"'+a+'"]');a.prop("checked",b);this.isMetroCodeCheckbox(a)&&this.toggleSubAirportMultiCheckboxes(!1)},
showAirportMultiSelections:function(){this.showInitialDropdownForData(this.generateAirportMultiSelections());this.isNearbyEnabled()&&this.addNearby()},runSearchOnFocus:function(){return this.airportMultiSelectActive?!1:this.base()},handleItemClickEvent:function(a,b){var c=h(b.target);c.is(".js-multi-select-container, .js-not-selectable")?b.stopPropagation():c.is(".js-multi-select-checkbox")?(b.preventDefault(),b.stopPropagation(),this.handleAirportMultiCheckboxToggle(c)):this.base(a,b)},getAirportCodeHtml:function(a,
b){if(!this.options.airportMultiSelectEnabled)return this.base(a);if("ap"!==a.loctype&&"apnc"!==a.loctype)return"";var c=a.ap||a.airportCode,f=["multiAirportCheckbox",c,Math.floor(100*Math.random())].join("-");a.shortdisplayname&&a.smartyDisplay||this.log.errorInternal("AirportMultiSelect checkbox is missing destination metadata");return e.template.render("airportMultiSelectCol",{value:c,uniqueId:this.id(f),checked:b||a.selectedMetroCodeMember||this.options.hasAirportMultiSelectionCode(a.ap||a.airportCode),
disabled:a.selectedMetroCodeMember,display:a.shortdisplayname,description:a.smartyDisplay})},airportMultiSelectActive:!1,getAirportMultiSelectActive:function(){return this.airportMultiSelectActive},originalForceSelection:null,originalForceSelectionOfHighlightedItem:null,setAirportMultiSelectActive:function(a){this.airportMultiSelectActive=a;null===this.originalForceSelection&&(this.originalForceSelection=this.options.forceSelection);null===this.originalForceSelectionOfHighlightedItem&&(this.originalForceSelectionOfHighlightedItem=
this.options.forceSelectionOfHighlightedItem);a?(a=this.generateAirportMultiSelectHeader(!0),this.getChildElement("nearby").replaceWith(a),this.dropdown.find("li").not(".ap, .apnc").remove(),this.options.forceSelection=!1,this.options.forceSelectionOfHighlightedItem=!1):this.options.useNearby&&(this.getChildElement("airportMultiSelectHeader").remove(),this.addNearby(),this.options.forceSelection=this.originalForceSelection,this.options.forceSelectionOfHighlightedItem=this.originalForceSelectionOfHighlightedItem)},
isMetroCodeCheckbox:function(a){return a.parentsUntil("ul","li.aap").length},toggleSubAirportMultiCheckboxes:function(a){var b=this,c=this.dropdown.find("li.sub .js-multi-select-checkbox-input");c.each(function(){var a=h(this).data("value");b.options.onRemoveAirportMultiSelection(a)});c.prop("checked",a).prop("disabled",a)},handleAirportMultiCheckboxToggle:function(a){var b=a.siblings("input");if(b.prop("disabled"))this.highlightMultiCheckboxMessage();else{var c=!b.prop("checked");b.prop("checked",
c);b.off("click").on("click",function(){return!1});b=a.data("value");if(c)this.options.onAddAirportMultiSelection(b,a.data("display"),a.data("description"),"checkbox");else this.options.onRemoveAirportMultiSelection(b,"checkbox");this.isMetroCodeCheckbox(a)&&this.toggleSubAirportMultiCheckboxes(c);this.element.focus()}},isCheckedMetroCode:function(a,b){return this.options.airportMultiSelectEnabled&&this.options.allAirportsLocalizedText===b&&this.options.hasAirportMultiSelectionCode(a)}})})(window.R9,
window.jq||window.jQuery);(function(e,h){e.createWidgetClass("smarty.FlareSmarty","common.widgets.smarty.FlareSmartyBaseLoader",{constructor:function(a,b){this.base(a,h.extend({dataSource:"/f/smarty",appendTo:"body"},b))},init:function(){e.common.widgets.smarty.Smarty.prototype.init.apply(this,arguments)},showDropdown:function(){e.common.widgets.smarty.Smarty.prototype.showDropdown.apply(this,arguments)},translateItem:function(a){var b=e.Widgets.Smarty.FlareSmarty.prototype.translateItem.call(this,a);(a=h(a).data("attr"))&&
(b=h.extend(b,a));return b},setItem:function(){e.common.widgets.smarty.Smarty.prototype.setItem.apply(this,arguments)},handleItemClickEvent:function(a,b){this.isSmartyUIV1()?h(a).hasClass("sign-up-in")?(this.openSignUpInPopup(h(b.target).hasClass("sign-up")),this.hideDropdown()):this.base(a,b):this.base(a,b)},getDataSource:function(){return this.isSmartyUIV1()?e.config.getString("ui.common.smarty.get.url",this.options.dataSource):this.base()},postprocessResponse:function(a,b){return this.isJsonResponse(a)?
e.common.widgets.smarty.Smarty.prototype.postprocessResponse.call(this,a,b):this.base(a,b)},makeHTML:function(a){return this.isJsonResponse(a)?e.common.widgets.smarty.Smarty.prototype.makeHTML.call(this,a):this.base(a)},getMaxItemsToShow:function(){return e.config.getInt("ui.smarty.json.itemLimit",-1)},openSignUpInPopup:function(a){a?e.authentication.showSignup():e.authentication.showLogin()},isSmartyUIV1:function(){return this.isJSON()&&this.options.smartyUIUpdateEnabled},isDestinationImagesEnabled:function(){return this.isSmartyUIV1()&&
e.config.getBoolean("ui.smarty.desitnationimages.enabled",!1)},formatItem:function(a,b){if(!this.isSmartyUIV1())return this.base(a,b);var c=a.cc&&"ctry"===a.loctype&&e.config&&e.config.getBoolean("ui.smarty.hideCountryFeatures."+a.cc,!1);if(!a||!a.loctype)return"";b=this.getItemAttrs(a);var g=this.getDisplayNameHtml(a),f=this.getAirportCodeHtml(a),g=g+f,f=a.loctype||"city";"cg"===f&&(f="ctgroup");c&&(f+=" noBackgroundIcon");"ap"!==a.loctype&&"apnc"!==a.loctype||this.options.allAirportsLocalizedText!==
a.airportname||(f+=" aap");c=['role\x3d"option"','tabindex\x3d"0"','data-short-name\x3d"'+(b.shortName||"")+'"','data-text-to-select\x3d"'+(b.displayName||"")+'"'];b.hasOwnProperty("apicode")?c.push("data-apicode\x3d"+b.apicode):"rail"===a.loctype&&b.hasOwnProperty("ap")&&c.push("data-apicode\x3d"+b.ap);var d=this.getDestinationImages(a);"ctry"===a.loctype&&b.icon?(c.push('style\x3d"background-image:url('+b.icon+')"'),f+=" with-icon"):g=d&&!a.sub?d+g:b.svgIcon+g;c.push('class\x3d"'+f+(a.sub?" sub":
"")+'"');f=this.formatListItemId(a);this.addItemAttributes(a,c);f&&c.push('id\x3d"'+f+'"');a.cc&&c.push('data-cc\x3d"'+a.cc+'"');a.rc&&c.push('data-rc\x3d"'+a.rc+'"');b.shortName&&c.push('data-short-name\x3d"'+b.shortName+'"');b.label&&c.push('aria-label\x3d"'+b.label+'"');"addr"===a.loctype&&c.push('data-ctid\x3d"'+a.ctid+'"');return"\x3cli "+c.join(" ")+"\x3e"+g+"\x3c/li\x3e"},addItemAttributes:function(a,b){},formatListItemId:function(a){var b=this.getItemId(a);switch(a.loctype){case "ap":case "apnc":return[a.loctype,
[a.ap||a.airportcode,a.ctid].join("/")].join("-");case "freereg":case "reg":case "ctry":return[a.loctype,0,a.nearbyHotels,b].join("-");case "hood":case "lm":return[a.loctype,a.ctid,a.nearbyHotels,b].join("-");case "ctgroup":return[a.loctype,0,0,a.cg].join("-");default:return b?[a.loctype,b].join("-"):null}},getItemAttrs:function(a){var b=a.cc&&"ctry"===a.loctype&&e.config&&e.config.getBoolean("ui.smarty.hideCountryFeatures."+a.cc,!1),c=this.getDisplayName(a),g=this.getNearbyHotels(a),f=this.getNearbyRentals(a),
c=h.extend({},a,{id:this.getItemId(a),displayName:c,label:[c,g,f].filter(function(a){return!!a}).join(" "),parentPath:a.parentPath||a.rc||"",nearbyHotels:g,nearbyRentals:f});"ap"===a.loctype||"apnc"===a.loctype?c.shortName=a.shortdisplayname||"":"city"===a.loctype?c.shortName=a.cityonly||"":"geocode"===a.loctype&&(c.shortName=a.structured_formatting.main_text);"ctry"===a.loctype&&a.cc&&!b&&(c.icon="/images/flags/a-small-flag."+a.cc.toLowerCase()+".png");c.svgIcon=this.getSvgIcon(a);return c},getDisplayName:function(a){return"geocode"===
a.loctype?a.description:this.base(a)},getItemId:function(a){if(this.isSmartyUIV1())switch(a.loctype){case "hotel":case "hood":case "lm":case "freereg":return a.id;case "addr":return a.displayname;case "rest":return a.rtid}return this.base(a)},getDisplayNameHtml:function(a){var b=a.locationname||a.searchFormSecondary,c=a.airportname,e=a.cityname,f=a.smartyDisplay,d=a.displayname,h=a.nearbyInfo;if("ap"===a.loctype||"apnc"===a.loctype)return d=[],"apnc"!==a.loctype&&c===this.options.allAirportsLocalizedText?
d.push("\x3cdiv\x3e%s\x3c/div\x3e".format([e,c].join(", "))):(d.push("\x3cdiv\x3e%s\x3c/div\x3e".format("apnc"===a.loctype?f||c:a.sub?c:b)),d.push("\x3cdiv\x3e%s\x3c/div\x3e".format("apnc"===a.loctype?h||b:a.sub?b:c))),"\x3cdiv class\x3d'item-info'\x3e%s\x3c/div\x3e".format(d.join(""));if("ctgroup"===a.loctype)return"\x3cdiv class\x3d'item-info'\x3e\x3cdiv\x3e%s\x3c/div\x3e\x3c/div\x3e".format(d);"hotel"===a.loctype?(d=[],d.push("\x3cdiv\x3e%s\x3c/div\x3e".format(a.hotelname||a.name)),d.push("\x3cdiv\x3e%s\x3c/div\x3e".format(e))):
"geocode"===a.loctype?(d=[],d.push("\x3cdiv\x3e%s\x3c/div\x3e".format(a.structured_formatting.main_text)),d.push("\x3cdiv\x3e%s\x3c/div\x3e".format(a.structured_formatting.secondary_text))):"addr"===a.loctype?(d=[],d.push("\x3cdiv\x3e%s\x3c/div\x3e".format(a.searchFormPrimary)),d.push("\x3cdiv\x3e%s\x3c/div\x3e".format(a.searchFormSecondary))):d="rail"===a.loctype?["\x3cdiv\x3e%s\x3c/div\x3e".format(this.getDisplayName(a)),"\x3cdiv\x3e%s\x3c/div\x3e".format(this.locationTypeMessages[a.loctype])]:
["\x3cdiv\x3e%s\x3c/div\x3e".format(d),"\x3cdiv\x3e%s\x3c/div\x3e".format(this.locationTypeMessages[a.loctype])];return"\x3cdiv class\x3d'item-info'\x3e%s\x3c/div\x3e".format(d.join(""))},getAirportCodeHtml:function(a,b){return"ap"===a.loctype||"apnc"===a.loctype?"\x3cdiv class\x3d'ap-code'\x3e\x3cspan\x3e"+(a.ap||a.airportcode)+"\x3c/span\x3e\x3c/div\x3e":""},getSvgIcon:function(a){var b;switch(a.loctype){case "ap":case "apnc":b="smartyFlightSVG";this.options.allAirportsLocalizedText&&a.airportname===
this.options.allAirportsLocalizedText&&(b="smartyCitySVG");break;case "hotel":b="smartyHotelSVG";break;case "rail":b="smartyTrainSVG";break;case "city":b="smartyCitySVG";break;case "ctgroup":b=this.getCtGroupIcon(a);break;default:b="smartyMapSVG"}return"\x3cdiv class\x3d'smarty-icon-wrapper'\x3e"+e.template.render(b)+"\x3c/div\x3e"},getDestinationImages:function(a){if(!this.isDestinationImagesEnabled())return null;switch(a.loctype){case "city":case "ctry":case "reg":case "freereg":case "lm":case "hood":return this.createDestinationImageNode(a)}return null},
createDestinationImageNode:function(a){a=a.destination_images;return a.image_jpeg?a.image_webp?'\x3cdiv class\x3d"destination-images"\x3e\x3cdiv class\x3d"img-wrapper"\x3e\x3cpicture\x3e'+'\x3csource srcset\x3d"%s" type\x3d"image/webp"\x3e'.format(a.image_webp)+'\x3csource srcset\x3d"%s" type\x3d"image/jpeg"\x3e'.format(a.image_jpeg)+'\x3cimg src\x3d"%s" onerror\x3d"this.style.display\x3d\'none\'" onload\x3d"this.style.opacity\x3d1"/\x3e'.format(a.image_jpeg)+"\x3c/picture\x3e\x3c/div\x3e\x3c/div\x3e":
'\x3cdiv class\x3d"destination-images"\x3e\x3cdiv class\x3d"img-wrapper"\x3e'+'\x3cimg src\x3d"%s" onerror\x3d"this.style.display\x3d\'none\'" onload\x3d"this.style.opacity\x3d1"/\x3e'.format(a.image_jpeg)+"\x3c/div\x3e\x3c/div\x3e":null},getCtGroupIcon:function(a){switch(a.cg){case "AS":case "AF":case "EU":case "NA":case "SA":case "SP":case "CB":case "ME":return"smartyCtGroup"+a.cg;default:return"smartyCtGroup"}}})})(window.R9,window.jq||window.jQuery);(function(g,k){function h(a){return/[A-Z]{3}/.test(a)}function l(a){if(!a)return[];a=a.split(",").map(function(a){return a.trim()});return 1<a.length&&a.every(h)?a:[]}function e(a){return a.trim().toUpperCase().split("/")[0]}g.createComponentClass("flights.search.FlightAirportField",{options:{airportMultiSelectEnabled:!1,airportFlareSmartyType:13,initialAirportMultiSelections:[],onChangeAirportMultiSelection:function(a,b){},onDisableNearbyToggle:function(){}},inputEl:null,codeEl:null,smarty:null,
inputModal:null,airportMultiSelections:[],airportMultiSelectVisible:!1,init:function(){this.inputEl=this.getChildElement("airport");this.codeEl=this.getChildElement("code")},addEventHandlers:function(){},inlineComponentsReady:function(){this.inputModal=this.inputEl.data("inputModal");this.smarty=this.inputEl.getWidget();this.options.airportMultiSelectEnabled&&(this.inputModal&&this.initAirportMultiSelectInput(),this.smarty&&this.bindAirportMultiSelectSmarty())},setOptions:function(a){k.extend(this.options,
a)},val:function(){if(arguments.length&&void 0!==arguments[0]&&null!==arguments[0]&&!this.airportMultiSelectVisible)this.setValue(arguments[0]);else return this.getValue()},code:function(){if(arguments.length&&void 0!==arguments[0]&&null!==arguments[0]&&!this.airportMultiSelectVisible)this.setCode(arguments[0]);else return this.getCode()},getSmarty:function(){return this.smarty||this.inputEl.getWidget()},getValue:function(){return this.airportMultiSelectVisible?this.getAirportMultiSelectValue():this.inputEl.val()},
setValue:function(a){this.inputEl.val(a)},getCode:function(){return this.codeEl.val()},setCode:function(a){this.codeEl.val(a)},initAirportMultiSelectInput:function(){this.inputModal.onRemoveMultiSelection=this.removeAirportMultiSelection.bind(this);this.inputModal.onToggleMultiSelectVisibility=this.toggleAirportMultiSelectVisible.bind(this);if(this.options.initialAirportMultiSelections.length)this.addAirportMultiSelections(this.options.initialAirportMultiSelections);else{var a=l(this.getValue()),
b=e(this.getCode());a.length?a.forEach(function(a){this.addAirportMultiSelection(a)},this):h(b)&&this.addAirportMultiSelection(b,this.getValue())}},bindAirportMultiSelectSmarty:function(){this.smarty.setOptions({onAddAirportMultiSelection:this.addAirportMultiSelection.bind(this),onRemoveAirportMultiSelection:this.removeAirportMultiSelection.bind(this),getAirportMultiSelections:this.getAirportMultiSelections.bind(this),hasAirportMultiSelectionCode:this.hasAirportMultiSelectionCode.bind(this),allowAddAirportMultiSelection:this.allowAddAirportMultiSelection.bind(this),
onInputValueChange:this.onInputValueChange.bind(this),airportMultiSelectEnabled:!0})},originalFlareSmartyType:null,toggleAirportMultiSelectVisible:function(a){(this.airportMultiSelectVisible=a)?(this.originalFlareSmartyType=this.smarty.getFlareSmartyType(),this.smarty.setFlareSmartyType(this.options.airportFlareSmartyType),this.smarty.setAirportMultiSelectActive(!0)):(this.smarty.setFlareSmartyType(this.originalFlareSmartyType),this.smarty.setAirportMultiSelectActive(!1),this.setValue(""));this.toggleNearbyAllowed(!a||
2>this.airportMultiSelections.length)},onInputValueChange:function(a){if(this.airportMultiSelectVisible&&this.smarty){var b=1===this.airportMultiSelections.length,c=this.smarty.isNearbyEnabled();b&&c&&a.length?this.smarty.toggleNearbyAllowed(!1):!b||c||a.length||this.smarty.toggleNearbyAllowed(!0)}},toggleNearbyAllowed:function(a){this.smarty&&(this.smarty.toggleNearbyAllowed(a),a||(this.smarty.setIsNearbyChecked(!1),this.smarty.hideNearbyCheckbox(),this.options.onDisableNearbyToggle()))},getAirportMultiSelectValue:function(){return this.getAirportMultiSelectionCodes().join(",")},
refreshAirportMultiSelectValue:function(){this.setValue("");this.setCode(this.getAirportMultiSelectValue())},allowAddAirportMultiSelection:function(){return 3>this.airportMultiSelections.length},pendingMultiSelectAdditions:0,addAirportMultiSelections:function(a){a&&(this.pendingMultiSelectAdditions=a.length,a.forEach(function(a){this.addAirportMultiSelection(a.code,a.display,a.description)},this))},addAirportMultiSelection:function(a,b,c,d){if(a&&this.allowAddAirportMultiSelection()){var f=e(a);this.getAirportMultiSelectionCodes().some(function(a){return a===
f})||(a=this.airportMultiSelections.length?"multi":"single",b=b||f,this.airportMultiSelections.push({code:f,display:b,description:c}),0<this.pendingMultiSelectAdditions&&--this.pendingMultiSelectAdditions,this.refreshAirportMultiSelectValue(),this.options.onChangeAirportMultiSelection(this.getAirportMultiSelectValue(),d),this.toggleNearbyAllowed(2>this.airportMultiSelections.length),this.inputModal&&(this.inputModal.toggleMultiSelectionCompactLayout(1<this.airportMultiSelections.length+this.pendingMultiSelectAdditions),
this.inputModal.addMultiSelection(f,b),this.allowAddAirportMultiSelection()||this.inputModal.toggleInputVisibility(!1)),this.smarty&&!this.allowAddAirportMultiSelection()&&this.smarty.toggleMultiCheckboxEnabled(!1),d&&this.trackAirportMultiSelect("add",d,a))}},removeAirportMultiSelection:function(a,b){var c=e(a),d=this.getAirportMultiSelectionCodes().findIndex(function(a){return a===c});0>d||(a=1>=this.airportMultiSelections.length?"single":"multi",this.airportMultiSelections.splice(d,1),this.refreshAirportMultiSelectValue(),
this.options.onChangeAirportMultiSelection(this.getAirportMultiSelectValue(),b),this.toggleNearbyAllowed(2>this.airportMultiSelections.length),this.inputModal&&(d=2===this.airportMultiSelections.length,this.inputModal.removeMultiSelection(c,d),this.inputModal.toggleMultiSelectionCompactLayout(1<this.airportMultiSelections.length),this.allowAddAirportMultiSelection()&&this.inputModal.toggleInputVisibility(!0,d&&250)),this.smarty&&this.allowAddAirportMultiSelection()&&(this.smarty.toggleMultiCheckboxEnabled(!0),
this.smarty.toggleMultiCheckbox(c,!1)),b&&this.trackAirportMultiSelect("remove",b,a))},resetAirportMultiSelect:function(){this.airportMultiSelections.length&&(this.airportMultiSelections=[],this.inputModal&&this.inputModal.resetMultiSelection())},getAirportMultiSelections:function(){return this.airportMultiSelections.slice()},getAirportMultiSelectionCodes:function(){return this.airportMultiSelections.map(function(a){return a.code})},hasAirportMultiSelectionCode:function(a){var b=e(a);return this.airportMultiSelections.some(function(a){return a.code===
b})},trackAirportMultiSelect:function(a,b,c){g.Analytics.api.trackEvent({category:"airportMultiSelect",action:a,label:b,value:c})}})})(window.R9,window.jQuery);(function(a,e){a.createComponentClass("flights.search.OdSwitch",{options:{animated:!1,showFocusIndication:!1,focusedElementClass:""},arrowDirection:1,init:function(){this.arrows=this.element.find("svg")},flipArrows:function(){var a=0<this.arrowDirection?"rotate(180deg)":"none";this.arrowDirection*=-1;this.arrows.css("transform",a)},addEventHandlers:function(){var c=this,d=function(){a.Analytics.api.trackEvent({category:"od-switch",action:"click"});a.events.publish("flights.search.swapLocations",{id:this._id});
this.options.animated&&a.dom.schedule(this.flipArrows.bind(this))}.bind(this);this.registerEvent("click",function(a){e(this).blur();d()});this.registerEvent("keypress",function(b){switch(b.which){case a.globals.keyCodes.SPACE:case a.globals.keyCodes.RETURN:b.preventDefault(),d()}});this.subscribe("flights.search.form.sticky.toggle",function(b){this.options.isStickyEnabled&&(b?a.dom.swapClasses(this.element,this.options.styleJamParams.defaultOdResponsive,this.options.styleJamParams.stickyOdResponsive):
a.dom.swapClasses(this.element,this.options.styleJamParams.stickyOdResponsive,this.options.styleJamParams.defaultOdResponsive))}.bind(this));this.options.showFocusIndication&&this.subscribe("body.accessibilityMode.enabled",function(b){b?a.dom.swapClasses(c.element,"",c.options.focusedElementClass):a.dom.swapClasses(c.element,c.options.focusedElementClass,"")})}})})(R9,jQuery);(function(b,c){b.createWidgetClass("datepicker.FlexDateDisplay",{options:{group:"",updateGroup:"",msg:{OPEN_FLEX_DURATION_FORMAT:""},rising:!1},input:null,init:function(){this.input=this.getChildElement("input")},addEventHandlers:function(){var a=this;this.subscribe("DatePicker.update",{updateGroup:this.options.updateGroup},this.onDatePickerUpdate.bind(this));this.input.click(function(){b.events.publish("DateInput.startDate.focus",a.options.group)});this.options.rising&&(this.subscribe("DateRangeInput.opened",
this.options.group,function(){a.element.addClass("parentFocused")}),this.subscribe("DateRangeInput.closed",this.options.group,function(){a.element.removeClass("parentFocused")}))},onDatePickerUpdate:function(a){if(a.flex&&a.group&&a.group===this.options.group)switch(a=a.data,this.element.removeClass("empty"),a.flex_category){case "weekend":this.input.html("%s \x26ndash; %s".format(a.weekend_depart_time_display,a.weekend_return_time_display));break;case "openflex":a.openflex_length_of_stay?this.input.html(b.Common.Utils.String.formatChoice(this.options.msg.OPEN_FLEX_DURATION_FORMAT,
"1"==a.openflex_length_of_stay?1:2,a.openflex_length_of_stay)):(this.element.addClass("empty"),this.input.html(this.options.msg.OPEN_FLEX_DURATION_PLACEHOLDER));break;default:this.input.html("")}}})})(R9,jQuery);(function(c,f){c.createWidgetClass("datepicker.StyleJamDateInput",{options:{placeholder:"",displayFormat:"ddd M/D",inputFormat:"MM/DD/YYYY",field:"startDate",group:"",updateGroup:"",isoDate:"",rising:!1,change:null,wrapper:null,minDateFunc:null,flexDisplayEnabled:!1,responsive:!1,responsiveMobileOnly:!0,optional:!1,elementFocused:null,elementBlurred:null,inputFull:null,inputEmpty:null,spinners:!1,showFocusIndication:!1,showToolTipImmediately:!1,focusedElementClass:"",mwebOrTweb:!1,noDateSetup:!1},
inputElement:null,date:null,previewDate:null,now:null,maxDate:null,minDate:null,tempDate:null,inModal:!1,inSticky:!1,flexDisplay:null,clearIcon:null,focusData:null,Keys:{LEFT:37,UP:38,RIGHT:39,DOWN:40,TAB:9,RETURN:13,PAGE_UP:33,PAGE_DOWN:34,SPACE:32,HOME:36,SHIFT:16,END:35,ESC:27},currentEvent:null,focusTriggered:!1,init:function(){this.focusData={data:null,triggering:!1};this.inputElement=this.getChildElement("input");this.inModal=1===this.element.closest(".R9-Overlay").length;this.inSticky=1===
this.element.closest(".R9-Sticky").length;this.now=moment().startOf("day");this.maxDate=moment().add(1,"year");this.flexDisplay=this.getChildElement("flexDisplay");if(!this.options.noDateSetup){var a=moment(this.options.isoDate);this.validateDate(a)?this.setDate(a.valueOf()):this.showPlaceholder()}this.options.spinners&&(this.decSpinner=this.getChildElement("spinner-dec"),this.incSpinner=this.getChildElement("spinner-inc"));this.options.optional&&(this.clearIcon=this.getChildElement("clear"))},inlineComponentsReady:function(){var a=
moment(this.options.isoDate);!this.options.noDateSetup&&this.validateDate(a)&&this.afterSetDate(a.valueOf());this.options.optional&&(a=this.clearIcon.data("message"))&&this.clearIcon.toolTip({content:a,showImmediately:this.options.showToolTipImmediately,position:"bottom",size:"s",delay:1E3})},addEventHandlers:function(){var a=this;this.subscribe("DatePicker.update",{updateGroup:this.options.updateGroup},this.onDatePickerUpdate.bind(this));this.subscribe("DateInput.%s.focus".format(this.options.field),
this.options.group,function(){a.focus()});this.registerEvent("focus",this.inputElement,this.handleFocusEvent.bind(this));this.registerEvent("blur",this.inputElement,function(b){a.onBlur.call(a,this,b)});this.registerEvent("keydown",this.inputElement,function(b){a.onKeydown.call(a,this,b)});this.registerEvent("click",this.element,function(b){f(b.target).is("#"+a.id("input"))||a.inputElement.focus()});this.answer("DateInput.%s.%s".format(this.options.group,this.options.field),this.getInputData.bind(this));
this.options.optional&&this.clearIcon&&this.registerEvent("click",this.clearIcon,function(){a.onClearIconClick()});this.options.spinners&&(this.bindSpinners(),this.options.showFocusIndication&&this.subscribe("body.accessibilityMode.enabled",function(b){b?(c.dom.swapClasses(a.decSpinner,"",a.options.focusedElementClass),c.dom.swapClasses(a.incSpinner,"",a.options.focusedElementClass)):(c.dom.swapClasses(a.decSpinner,a.options.focusedElementClass,""),c.dom.swapClasses(a.incSpinner,a.options.focusedElementClass,
""))}))},bindSpinners:function(){var a=function(a){this.publishUpdate({action:"change",currentValue:this.getDate(),delta:a,field:this.options.field,picking:this.options.field,spinner:!0,force:!0});c.Analytics.api.trackEvent({category:this.options.field,label:"arrow",action:"click",value:0<a?"inc":"dec"})};this.incSpinner&&(this.registerEvent("click",this.incSpinner,a.bind(this,1)),this.registerEvent("keydown",this.incSpinner,this.handleKeyboardSpinner.bind(this,this.incSpinner)));this.decSpinner&&
(this.registerEvent("click",this.decSpinner,a.bind(this,-1)),this.registerEvent("keydown",this.decSpinner,this.handleKeyboardSpinner.bind(this,this.decSpinner)))},handleKeyboardSpinner:function(a,b){switch(a.which){case this.Keys.SPACE:case this.Keys.RETURN:a.preventDefault();b.click();break;case this.Keys.TAB:this.onKeydown.call(this,b,a)}},handleFocusEvent:function(a){this.focusTriggered=!0;this.focusData.refocus||this.onFocus.call(this,this.inputElement[0],a,this.focusData.data);this.focusData.triggering=
!1;this.focusData.data=null;delete this.focusData.refocus},getInputData:function(){var a={offset:this.element.offset(),height:this.element.outerHeight(),value:this.getValue()};this.options.wrapper&&(a.wrapper="#%s".format(this.options.wrapper));return a},onDatePickerUpdate:function(a){if(a&&a.group===this.options.group&&a.fields&&a.fields.hasOwnProperty(this.options.field))switch(a.action){case "change":this.receiveDateChange(a);break;case "preview":this.receiveDatePreview(a);break;case "focus":this.options.group===
a.group&&(this.focusData={data:a,triggering:!0},this.focus());this.toggleInputFocused(!0);break;case "blur":this.showDate();this.toggleInputFocused(!1);c.events.publish("DateInput.%s.onBlur".format(this.options.field),this.options.group);a.tabForward&&(this.focusData={refocus:!0},this.options.spinners?this.incSpinner.focus():this.focus());break;case "flex":this.options.flexDisplayEnabled&&this.receiveFlexChange(a)}},focus:function(){var a=this;this.focusTriggered=!1;this.isTouchDevice()?window.setTimeout(function(){a.inputElement.trigger("focus")},
200):(this.inputElement.trigger("focus"),!1===this.focusTriggered&&this.options.phoenixRising&&c.globals.isSeo&&this.handleFocusEvent())},isTouchDevice:function(){return"ontouchstart"in window||navigator&&0<navigator.maxTouchPoints},onFocus:function(a,b,e){var d=this;this.options.mwebOrTweb&&d.hideKeyboard(this.inputElement);b="input";e&&e.format&&(b=e.format);"function"===typeof this.options.minDateFunc&&this.options.minDateFunc.call(this,this);this.focusData.triggering||setTimeout(function(){d.summonDatePicker()},
100);(e=this.getValue())&&this.showDate(e,b);"input"!==b||this.isPlaceholder||this.selectAll(a);this.toggleInputFocused(!0);c.dom.swapClasses(this.inputElement,this.options.inputEmpty,this.options.inputFull);c.events.publish("DateInput.%s.onFocus".format(this.options.field),this.options.group)},hideKeyboard:function(a){a.attr("contenteditable","false");setTimeout(function(){a.blur();a.attr("contenteditable","true")},100)},toggleInputFocused:function(a){a?c.dom.swapClasses(this.element,this.options.elementBlurred,
this.options.elementFocused):c.dom.swapClasses(this.element,this.options.elementFocused,this.options.elementBlurred)},onBlur:function(a,b){},onKeydown:function(a,b){a=moment(this.inputElement.html(),this.options.inputFormat);this.currentEvent=null;switch(b.which){case this.Keys.RETURN:this.handleKeyboardNavigationReturn(b,a);break;case this.Keys.TAB:this.handleKeyboardNavigationTab(b,a);break;case this.Keys.ESC:this.dismissDatePicker();this.inputElement.trigger("blur");break;case this.Keys.UP:case this.Keys.RIGHT:this.handleKeyboardIncrementDate(b,
a,1);break;case this.Keys.DOWN:case this.Keys.LEFT:this.handleKeyboardIncrementDate(b,a,-1)}this.isPlaceholder&&this.hidePlaceholder()},handleKeyboardNavigationTab:function(a,b){this.validateDate(b)&&(this.currentEvent=a,a.shiftKey||!this.options.spinners||this.incSpinner.is(a.target)?this.publishUpdate({action:"tab",value:b.valueOf(),field:this.options.field,focused:!0,tabForward:!a.shiftKey,tabBackward:a.shiftKey,event:a}):this.decSpinner.focus())},handleKeyboardNavigationReturn:function(a,b){this.currentEvent=
a;a.preventDefault();this.validateDate(b)&&this.sendDateChange(b,!1,!1);this.dismissDatePicker(!1,!1,!0)},handleKeyboardIncrementDate:function(a,b,c){this.validateDate(b)&&(this.sendDateChange(b.add(c,"d"),!0),a.preventDefault())},onKeyup:function(a,b){a=moment(this.inputElement.html(),this.options.inputFormat);this.validateDate(a)&&b.which!==this.Keys.TAB&&b.which!==this.Keys.RETURN&&this.sendDatePreview(a,this.date?this.date.clone():null,{preventUpdate:!0})},setDate:function(a,b){var c=moment(a);
a&&this.validateDate(c)?this.date=c:null!==a&&""!==a||this.clearDate();this.afterSetDate(a,b)},afterSetDate:function(a,b){if(this.date&&this.validateDate(this.date))c.events.publish("DateInput.%s.%s.setDate".format(this.options.group,this.options.field),{date:this.date}),this.options.optional&&this.toggleClearIcon(!1);else if(null===a||""===a)c.events.publish("DateInput.%s.%s.clearDate".format(this.options.group,this.options.field)),"endDate"===this.options.field&&this.options.optional&&this.toggleClearIcon(!0);
b||this.showDate()},setMinDate:function(a){a&&this.validateDate(moment(a))&&(this.minDate=a)},clearDate:function(){this.date=null},getValue:function(){return this.date?this.date.valueOf():0},getDate:function(){return this.date?this.date.clone():null},validateDate:function(a){return a.isValid()&&a.isSameOrAfter(this.now)&&a.isBefore(this.maxDate)},receiveDatePreview:function(a){var b=a.fields[this.options.field];a=this.options.field===a.picking&&!a.clear;b?this.showDate(b,"input"):this.getValue()?
this.showDate(this.getValue(),a?"input":"display"):this.showPlaceholder()},receiveDateChange:function(a){var b=a.fields[this.options.field],c=this.options.field===a.picking;a.tabForward&&(this.focusData={refocus:!0},this.focus());this.setDate(b,!0);"function"===typeof this.options.change&&this.date&&this.options.change.call(this,{field:this.options.field,date:this.date.format("YYYY-MM-DD")});this.showDate(c?"input":"display")},sendDatePreview:function(a,b,c){var d={action:"preview",date:0,field:this.options.field};
a&&(d.value=a.valueOf(),b&&f.extend(d,{previous:b.valueOf()}),f.extend(d,c));this.publishUpdate(d)},receiveFlexChange:function(a){var b=a.data;switch(a.flex){case "plusminusthree":case "weekend":case "openflex":case "duration":b.inputDisplay&&b.inputDisplay.hasOwnProperty(this.options.field)?(this.element.addClass("show-flex-display"),this.flexDisplay.html(b.inputDisplay[this.options.field]).show()):(this.element.removeClass("show-flex-display"),this.flexDisplay.html("").hide());break;default:this.element.removeClass("show-flex-display"),
this.flexDisplay.html("").hide()}c.events.publish("DateInput."+this.options.group+"."+this.options.field+".flexChange",this.flexDisplay.html())},sendDateChange:function(a,b,c){this.publishUpdate({action:"change",value:a.valueOf(),field:this.options.field,focused:!!b,tabForward:!!c,event:this.currentEvent})},publishUpdate:function(a){f.extend(a,{updateGroup:this.options.updateGroup,group:this.options.group});c.events.publish("DateInput.update",a)},summonDatePicker:function(){var a={modal:this.inModal,
sticky:this.inSticky,updateGroup:this.options.updateGroup,group:this.options.group,field:this.options.field,rising:this.options.rising};this.minDate&&f.extend(a,{minDate:this.minDate});c.events.publish("DateInput.summon",a)},dismissDatePicker:function(a,b,e){var d={updateGroup:this.options.updateGroup,group:this.options.group,field:this.options.field};a&&!b?(d.tabForward=!0,d.event=this.currentEvent):a&&b&&(d.tabBackward=!0);e&&(d.returnEvent=e);c.events.publish("DateInput.dismiss",d)},showDate:function(a,
b){0===arguments.length?(b="display",a=this.getValue()):"string"===typeof arguments[0]?(b=a,a=this.getValue()):"undefined"===typeof b&&(b="display");a?(this.hidePlaceholder(),"input"===b?this.inputElement.html(moment(a).format(this.options.inputFormat)):"display"===b&&this.inputElement.html(moment(a).format(this.options.displayFormat))):this.showPlaceholder()},showPlaceholder:function(){this.inputElement.html(this.options.placeholder);this.isPlaceholder=!0;c.dom.swapClasses(this.inputElement,this.options.inputFull,
this.options.inputEmpty)},hidePlaceholder:function(){this.inputElement.html("");this.isPlaceholder=!1;c.dom.swapClasses(this.inputElement,this.options.inputEmpty,this.options.inputFull)},selectAll:function(a){var b=document.createRange();b.selectNodeContents(a);a=window.getSelection();a.removeAllRanges();try{a.addRange(b)}catch(e){}},clearOptional:function(){this.clearIcon.trigger("click")},onClearIconClick:function(){var a={updateGroup:this.options.updateGroup,group:this.options.group,field:this.options.field};
this.clearDate();this.dismissDatePicker();this.toggleClearIcon(!0);c.events.publish("DateInput.clear",a);c.Analytics.api.trackEvent({category:"Date-Input",action:"click",label:"clear-optional"})},toggleClearIcon:function(a){null==this.clearIcon&&(this.clearIcon=this.getChildElement("clear"));this.clearIcon.toggleClass("hidden",a)},destroy:function(){this.base();c.events.publish("DateInput.destroy",{group:this.options.group})}})})(R9,jQuery);(function(e,f){e.createWidgetClass("datepicker.DateInput",{options:{placeholder:"",displayFormat:"ddd M/D",inputFormat:"MM/DD/YYYY",field:"startDate",group:"",updateGroup:"",isoDate:"",change:null,wrapper:null,minDateFunc:null,flexDisplayEnabled:!1,responsive:!1,responsiveMobileOnly:!1,optional:!1,notEditableInputInMobile:!1,isMobileOrTablet:!1,noDateSetup:!1},inputElement:null,date:null,previewDate:null,now:null,maxDate:null,minDate:null,tempDate:null,inModal:!1,inSticky:!1,flexDisplay:null,clearIcon:null,
focusData:null,Keys:{LEFT:37,UP:38,RIGHT:39,DOWN:40,TAB:9,RETURN:13,PAGE_UP:33,PAGE_DOWN:34,SPACE:32,HOME:36,SHIFT:16,END:35,ESC:27},currentEvent:null,init:function(){this.focusData={data:null,triggering:!1};this.inputElement=this.getChildElement("input");this.inModal=1===this.element.closest(".R9-Overlay").length;this.inSticky=1===this.element.closest(".R9-Sticky").length;this.now=moment().startOf("day");this.maxDate=moment().add(1,"year");this.flexDisplay=this.getChildElement("flexDisplay");this.options.optional&&
(this.clearIcon=this.getChildElement("clear"))},inlineComponentsReady:function(){this.options.noDateSetup||(this.validateDate(moment(this.options.isoDate))?this.setDate(moment(this.options.isoDate).valueOf()):this.showPlaceholder());if(this.options.optional){var a=this.clearIcon.data("message");if(a){var b=this.clearIcon.is(":visible")&&this.options.showToolTipImmediately;this.clearIcon.toolTip({content:a,showImmediately:b,position:"bottom",size:"s",delay:b?1E3:200})}}},addEventHandlers:function(){var a=
this;this.subscribe("DatePicker.update",{updateGroup:this.options.updateGroup},this.onDatePickerUpdate.bind(this));this.subscribe("DateInput.%s.focus".format(this.options.field),this.options.group,function(){a.focus()});this.inputElement.on("focus",function(b,c){a.focusData.refocus||a.onFocus.call(a,this,b,a.focusData.data);a.focusData.triggering=!1;a.focusData.data=null;delete a.focusData.refocus});this.inputElement.on("blur",function(b){a.onBlur.call(a,this,b)});this.inputElement.on("keydown",function(b){a.onKeydown.call(a,
this,b)});this.inputElement.on("keyup",function(b){a.onKeyup.call(a,this,b)});this.element.find("[data-proxy-click]").click(function(){a.inputElement.trigger("click")});this.answer("DateInput.%s.%s".format(this.options.group,this.options.field),this.getInputData.bind(this));if(this.options.optional)this.clearIcon.on("click",function(b){a.onClearIconClick(a,this,b)})},getInputData:function(){var a={offset:this.element.offset(),height:this.element.outerHeight(),value:this.getValue()};this.options.wrapper&&
(a.wrapper="#%s".format(this.options.wrapper));return a},onDatePickerUpdate:function(a){if(a&&a.fields&&a.fields.hasOwnProperty(this.options.field)&&a.group&&a.group===this.options.group)switch(a.action){case "change":this.receiveDateChange(a);break;case "preview":this.receiveDatePreview(a);break;case "focus":this.options.group===a.group&&(this.focusData={data:a,triggering:!0},this.focus());break;case "blur":this.showDate();this.element.removeClass("focused");e.events.publish("DateInput.%s.onBlur".format(this.options.field),
this.options.group);a.tabForward&&(this.focusData={refocus:!0},this.focus());break;case "flex":this.options.flexDisplayEnabled&&this.receiveFlexChange(a)}},focus:function(){this.inputElement.trigger("focus")},onFocus:function(a,b,c){var d=this;!0===this.options.isMobileOrTablet&&!0===this.options.notEditableInputInMobile&&d.hideKeyboard(a);b="input";c&&c.format&&(b=c.format);"function"===typeof this.options.minDateFunc&&this.options.minDateFunc.call(this,this);this.focusData.triggering||setTimeout(function(){d.summonDatePicker()},
100);(c=this.getValue())&&this.showDate(c,b);"input"!==b||this.isPlaceholder||this.selectAll(a);this.element.addClass("focused");e.events.publish("DateInput.%s.onFocus".format(this.options.field),this.options.group)},hideKeyboard:function(a){a.setAttribute("contenteditable","false");setTimeout(function(){a.blur();a.setAttribute("contenteditable","true")},100)},onBlur:function(a,b){},onKeydown:function(a,b){var c=a=!1;switch(b.which){case this.Keys.RETURN:c=a=!0;this.currentEvent=b;break;case this.Keys.TAB:c=
!0;this.currentEvent=b;b.shiftKey||(a=!0);break;case this.Keys.ESC:c=!0}this.isPlaceholder&&this.hidePlaceholder();var d=moment(this.inputElement.html(),this.options.inputFormat);if(this.validateDate(d)||c)this.handleKeyboardNavigation(b,d),a&&b.preventDefault()},handleKeyboardNavigation:function(a,b){var c,d=b.clone();switch(a.which){case this.Keys.TAB:c=!1;a.shiftKey?"startDate"===this.options.field&&this.dismissDatePicker(!0,!0):this.publishUpdate({field:this.options.field,action:"tab"});break;
case this.Keys.RETURN:c=!1;this.validateDate(b)?this.sendDateChange(b):this.dismissDatePicker();break;case this.Keys.ESC:c=!1;this.dismissDatePicker();this.inputElement.trigger("blur");break;default:c=!1}c&&this.sendDatePreview(b,d)},onKeyup:function(a,b){a=moment(this.inputElement.html(),this.options.inputFormat);this.validateDate(a)&&b.which!==this.Keys.TAB&&b.which!==this.Keys.RETURN&&this.sendDatePreview(a,this.date?this.date.clone():null,{preventUpdate:!0})},setDate:function(a,b){if(a&&this.validateDate(moment(a)))this.date=
moment(a),e.events.publish("DateInput.%s.%s.setDate".format(this.options.group,this.options.field),{date:this.date}),this.options.optional&&this.toggleClearIcon(!1);else if(null===a||""===a)this.clearDate(),"endDate"===this.options.field&&this.options.optional&&this.toggleClearIcon(!0);b||this.showDate()},setMinDate:function(a){a&&this.validateDate(moment(a))&&(this.minDate=a)},clearDate:function(){this.date=null},getValue:function(){return this.date?this.date.valueOf():0},getDate:function(){return this.date?
this.date.clone():null},validateDate:function(a){return this.hasFunctions(a,"isValid","isSameOrAfter","isBefore")?a.isValid()&&a.isSameOrAfter(this.now)&&a.isBefore(this.maxDate):!1},hasFunctions:function(){var a=Array.prototype.slice.call(arguments);return a.slice(1).reduce(function(b,c){return b&&a[0][c]&&"function"===typeof a[0][c]},!!a[0])},receiveDatePreview:function(a){var b=a.fields[this.options.field];a=this.options.field===a.picking&&!a.clear;b?this.showDate(b,"input"):this.getValue()?this.showDate(this.getValue(),
a?"input":"display"):this.showPlaceholder()},receiveDateChange:function(a){var b=a.fields[this.options.field],c=this.options.field===a.picking;a.tabForward&&(this.focusData={refocus:!0},this.focus());this.setDate(b,!0);"function"===typeof this.options.change&&this.options.change.call(this,{field:this.options.field,date:this.date.format("YYYY-MM-DD")});this.showDate(c?"input":"display")},sendDatePreview:function(a,b,c){var d={action:"preview",date:0,field:this.options.field};a&&(d.value=a.valueOf(),
b&&f.extend(d,{previous:b.valueOf()}),f.extend(d,c));this.publishUpdate(d)},receiveFlexChange:function(a){var b=a.data;switch(a.flex){case "plusminusthree":case "weekend":case "openflex":b.inputDisplay&&b.inputDisplay.hasOwnProperty(this.options.field)?(this.element.addClass("show-flex-display"),this.flexDisplay.html(b.inputDisplay[this.options.field])):(this.element.removeClass("show-flex-display"),this.flexDisplay.html(""));break;default:this.element.removeClass("show-flex-display"),this.flexDisplay.html("")}},
sendDateChange:function(a,b,c){this.publishUpdate({action:"change",value:a.valueOf(),field:this.options.field,focused:!!b,tabForward:!!c,event:this.currentEvent})},publishUpdate:function(a){f.extend(a,{updateGroup:this.options.updateGroup,group:this.options.group});e.events.publish("DateInput.update",a)},summonDatePicker:function(){var a={modal:this.inModal,sticky:this.inSticky,updateGroup:this.options.updateGroup,group:this.options.group,field:this.options.field};this.minDate&&f.extend(a,{minDate:this.minDate});
e.events.publish("DateInput.summon",a)},dismissDatePicker:function(a,b){var c={updateGroup:this.options.updateGroup,group:this.options.group,field:this.options.field};a&&!b?(c.tabForward=!0,c.event=this.currentEvent):a&&b&&(c.tabBackward=!0);e.events.publish("DateInput.dismiss",c)},showDate:function(a,b){0===arguments.length?(b="display",a=this.getValue()):"string"===typeof arguments[0]?(b=a,a=this.getValue()):"undefined"===typeof b&&(b="display");0!==a?(this.hidePlaceholder(),"input"===b?this.inputElement.html(moment(a).format(this.options.inputFormat)):
"display"===b&&this.inputElement.html(moment(a).format(this.options.displayFormat))):this.showPlaceholder()},showPlaceholder:function(){this.inputElement.html(this.options.placeholder);this.isPlaceholder=!0;this.element.addClass("Placeholder")},hidePlaceholder:function(){this.inputElement.html("");this.isPlaceholder=!1;this.element.removeClass("Placeholder")},selectAll:function(a){var b=document.createRange();b.selectNodeContents(a);a=window.getSelection();a.removeAllRanges();try{a.addRange(b)}catch(c){}},
clearOptional:function(){this.clearIcon.trigger("click")},onClearIconClick:function(a,b){a={updateGroup:this.options.updateGroup,group:this.options.group,field:this.options.field};this.clearDate();this.dismissDatePicker();this.toggleClearIcon(!0);e.events.publish("DateInput.clear",a);e.Analytics.api.trackEvent({category:"Date-Input",action:"click",label:"clear-optional"})},toggleClearIcon:function(a){null==this.clearIcon&&(this.clearIcon=this.getChildElement("clear"));this.clearIcon.toggleClass("hidden",
a)},destroy:function(){this.base();e.events.publish("DateInput.destroy",{group:this.options.group})}})})(R9,jQuery);var _typeof="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(d){return typeof d}:function(d){return d&&"function"===typeof Symbol&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},_extends=Object.assign||function(d){for(var e=1;e<arguments.length;e++){var a=arguments[e],b;for(b in a)Object.prototype.hasOwnProperty.call(a,b)&&(d[b]=a[b])}return d};
(function(d,e){d.createWidgetClass("datepicker.StyleJamCalendar",{aboveCalendarContainer:null,belowCalendarContainer:null,backToTodayHeader:null,backToTodayBtn:null,months:null,currentPickerId:null,animating:!1,isOpen:!1,calId:"",monthApproxHeight:260,showOnlyOneMonth:!1,DateMode:{SINGLE:"single",RANGE:"range",WEEKEND:"weekend",OPENFLEX:"openflex"},now:null,maxDate:null,pickers:{},options:{monthTitleFormat:"MMMM YYYY",allowPastDates:!1,fullCssClass:"Common-Widgets-Datepicker-SingletonCalendar",shortDayNameLen:1,
mobileBreakpoint:568,presentationClasses:{},backToTodayHeader:!1,messages:{greatPrice:""}},daysSelector:".col.day[data-val]:not([disabled])",appended:null,addPicker:function(a){var b=a.dateMode,c=a.group;if("undefined"===typeof a.id||"undefined"===typeof b||"undefined"===typeof c)throw Error("id, dateMode and group should not be empty.");this.pickers[a.id]=_extends({},a,{state:{currentDate:this.getInitDate(a.initDate),minDate:null}})},init:function(){this.now=moment().startOf("day");this.maxDate=
moment().add(1,"year");this.createCalendar();d.events.ready("common.widgets.datepicker.stylejamcalendar.initialized",{instance:this})},createCalendar:function(){this.element=d.template.renderElement("styleJamCalendarTemplate");this._id=this.element.attr("id");this.aboveCalendarContainer=this.element.find("#"+this.id("aboveCalendar"));this.belowCalendarContainer=this.element.find("#"+this.id("belowCalendar"));this.tabContainer=this.element.find("#"+this.id("tabContainer"));this.months=this.element.find("#"+
this.id("monthsGrid"));this.title=this.element.find("#"+this.id("title"));this.animation=this.element.find("#"+this.id("animationWrapper"));this.displayWrapper=this.element.find("#"+this.id("displayWrapper"));this.defaultView=this.element.find("#"+this.id("defaultView"));this.next=this.element.find("#"+this.id("nextMonth"));this.prev=this.element.find("#"+this.id("prevMonth"));this.pointer=this.element.find("#"+this.id("pointer"));this.curtain=this.element.find("#"+this.id("curtain"));this.options.backToTodayHeader&&
(this.backToTodayHeader=this.element.find("#"+this.id("backToTodayHeader")),this.backToTodayBtn=this.element.find("#"+this.id("backToTodayBtn")))},addEventHandlers:function(){var a=this,b=function(b){return function(c){b.call(a,this,c)}};this.next.on("click.next",this.onNextClick.bind(this));this.prev.on("click.prev",this.onPrevClick.bind(this));this.next.on("keypress.next",this.proxyClick.bind(this));this.prev.on("keypress.prev",this.proxyClick.bind(this));this.element.on("click.day",this.daysSelector,
b(this.onDayClick));this.element.on("mouseenter.day",this.daysSelector,b(this.onDayOver));this.element.on("mouseleave.day",this.daysSelector,b(this.onDayOut));this.element.on("keydown.day",this.daysSelector,b(this.onDayKeydown));this.options.backToTodayHeader&&(this.backToTodayBtn.on("click",this.onBackToTodayClick.bind(this)),this.backToTodayBtn.on("keypress",function(b){if(b.which===d.globals.keyCodes.SPACE||b.which===d.globals.keyCodes.RETURN)b.preventDefault(),a.onBackToTodayClick.bind(a)}));
e(window).resize(function(){a.ariaHideHiddenMonths()})},proxyClick:function(a){32!=a.which&&13!=a.which||this.trigger("click")},ariaHideHiddenMonths:function(){var a=this;d.utils.presentation.isSmallTablet()?a.months.children().each(function(b){e(this).hasClass(a.getStyles({child:"colMonth",state:"hidden-on-small-tablet"}))&&e(this).attr("aria-hidden","true")}):a.months.children().each(function(b){e(this).hasClass(a.getStyles({child:"colMonth",state:"hidden-on-small-tablet"}))&&e(this).attr("aria-hidden",
"false")})},changeMonth:function(a){var b=this,c=this.getCurrentDate(),f=c.add(a,"month");1!==Math.abs(a)||500>this.animation.outerWidth()?(this.update(f),this.onMonthChange()):(this.animating=!0,this.animation.addClass(this.getStyles({child:"animationWrapper",state:"animating"})).css("transform","translateX(%spx)".format(-260*a)),this.months.children().addClass(this.getStyles({child:"colMonth",state:"animating"})),setTimeout(function(){b.animating=!1;b.animation.removeClass(b.getStyles({child:"animationWrapper",
state:"animating"})).css("transform","translateX(0px)");b.months.children().removeClass(b.getStyles({child:"colMonth",state:"animating"}));-1==a?(b.removeMonth(b.months.children().last()),b.addMonth(b.makeMonthHTML(c.clone(),-1,!0),!0),b.months.children().eq(1).attr("aria-hidden","false"),d.dom.swapClasses(b.months.children().eq(1),b.getStyles({child:"colMonth",state:"hidden"}),b.getStyles({child:"colMonth",state:"base"})),b.months.children().eq(3).attr("aria-hidden","true"),d.dom.swapClasses(b.months.children().eq(3),
b.getStyles({child:"colMonth",state:"base"}),b.getStyles({child:"colMonth",state:"hidden"}))):1==a&&(b.removeMonth(b.months.children().first()),b.addMonth(b.makeMonthHTML(c.clone(),2,this.showOnlyOneMonth),!1),b.months.children().eq(2).attr("aria-hidden","false"),d.dom.swapClasses(b.months.children().eq(2),b.getStyles({child:"colMonth",state:"hidden"}),b.getStyles({child:"colMonth",state:"base"})),b.months.children().eq(0).attr("aria-hidden","true"),d.dom.swapClasses(b.months.children().eq(0),b.getStyles({child:"colMonth",
state:"base"}),b.getStyles({child:"colMonth",state:"hidden"})));b.setDisplayHeight();b.onMonthChange()},200),this.updateNav())},removeMonth:function(a){a.remove()},addMonth:function(a,b){b?this.months.prepend(a):this.months.append(a)},onNextClick:function(a){e(a.currentTarget).is("[disabled]")||this.animating?a.preventDefault():this.changeMonth(1)},onPrevClick:function(a){e(a.currentTarget).is("[disabled]")||this.animating?a.preventDefault():this.changeMonth(-1)},onBackToTodayClick:function(){var a=
this.now.clone().startOf("month").diff(this.getCurrentDate(),"months");-1<a&&1>a||(this.changeMonth(a),this.updateBackToTodayDisplay(!1))},updateBackToTodayDisplay:function(a){null==a&&(a=this.now.clone().startOf("month").diff(this.getCurrentDate(),"months"),a=1<=a||-1>=a);a?this.swapClasses(this.backToTodayBtn,"Calendar__NavBtn--hidden",""):this.swapClasses(this.backToTodayBtn,"","Calendar__NavBtn--hidden")},onDayClick:function(a,b){var c=this.getCurrentPicker();if(c.onDayClick)c.onDayClick(a,b);
b.preventDefault();b.stopPropagation()},onDayOver:function(a,b){var c=this.getCurrentPicker();if(c&&c.onDayOver)c.onDayOver(a,b)},onDayOut:function(a,b){var c=this.getCurrentPicker();if(c&&c.onDayOut)c.onDayOut(a,b)},onDayKeydown:function(a,b){var c=this.getCurrentPicker();if(c&&c.onDayKeydown)c.onDayKeydown(a,b)},setMinDate:function(a,b){if(b=this.pickers[b]){var c=b.state.currentDate,d=b.state.minDate;null!=d&&d.isSame(a,"d")||(d=moment(a),b.state.minDate=d,a=d.clone().startOf("month"),a.isAfter(c)&&
(b.state.currentDate=a))}},getMinDate:function(a){return a&&this.pickers[a]?this.pickers[a].state.minDate:this.getCurrentPicker()?this.getCurrentPicker().state.minDate:null},setCurrentDate:function(a){this.getCurrentPicker().state.currentDate=a},getCurrentDate:function(){return this.getCurrentPicker().state.currentDate},checkDate:function(a){return!this.options.allowPastDates&&a.isBefore(this.now)||a.isAfter(this.maxDate)||null!==this.getMinDate()&&a.isBefore(this.getMinDate())?!1:!0},makeWeekHeaderHTML:function(){for(var a=
{},b=moment().startOf("week"),c=1;7>=c;c++)a["day-"+c]=b.format("dd").substr(0,this.options.shortDayNameLen),a["ariaLabel-"+c]=b.format("dddd"),b.add(1,"day");return d.template.render("styleJamCalendarWeekDayGrid",a)},makeCalendarHTML:function(a){var b=[];b.push(this.makeMonthHTML(a.clone(),-1,!0));b.push(this.makeMonthHTML(a.clone(),0));b.push(this.makeMonthHTML(a.clone(),1,this.showOnlyOneMonth));b.push(this.makeMonthHTML(a.clone(),2,!0));return b.join("")},makeMonthHTML:function(a,b,c){var f=a.clone().add(b,
"month").startOf("month"),e=f.month();a=this.id(f.format("YYYYMM"));var g=f.format(this.options.monthTitleFormat),p=!1;if(-1===b||2===b)p=!0;b=[];for(var l=[],h=0;h<f.weekday();h++)l.push(this.makeDayHTML(a));for(;f.month()==e;)l.push(this.makeDayHTML(a,f)),6===f.weekday()&&(b.push(d.template.render("styleJamCalendarWeekGrid",{weekDays:l.join("")})),l=[]),f.add(1,"day");l.length&&b.push(d.template.render("styleJamCalendarWeekGrid",{weekDays:l.join("")}));f=this.animating?this.getStyles({child:"colMonth",
state:"animating"}):"";f=c?f+(" "+this.getStyles({child:"colMonth",state:"hidden"})):f+(" "+this.getStyles({child:"colMonth",state:"base"}));return d.template.render("styleJamCalendarMonthTemplate",{monthId:a,ariaHidden:p,monthTitle:g,weeksGrids:b.join(""),weekDayGrid:this.makeWeekHeaderHTML(),classes:f})},makeDayHTML:function(a,b){a=-1;var c=b?b.date():"",f=b?"data-val\x3d"+b.valueOf():"",e=b?" aria-label\x3d'"+b.format("MMMM D")+"'":"",g="";b?this.checkDate(b)?(b=b.isSame(this.now)?this.getStyles({child:"colDay",
state:"today"}):this.getStyles({child:"colDay",state:"active"}),a=0):(b=this.getStyles({child:"colDay",state:"disabled"}),g="disabled"):b=this.getStyles({child:"colDay",state:"empty"});return d.template.render("styleJamCalendarWeekDay",{classes:b,tabindex:a,dataVal:f,dayInner:c,disabled:g,dayLabel:e})},getCurrentPicker:function(){return this.pickers[this.currentPickerId]},setTitle:function(){var a=this.getCurrentPicker().title;"undefined"===typeof a||""===a?this.title.addClass("hidden"):this.title.text(a)},
populateMonthsGrid:function(a){a=a||this.getCurrentPicker().initDate||this.now;var b=this.makeCalendarHTML(a);this.setCurrentDate(a.clone());this.months.html(b)},switchPicker:function(a){if(null!==this.currentPickerId){var b=this.pickers[this.currentPickerId];if(b.onUnload)b.onUnload(this.element)}if(b=this.pickers[a]){this.currentPickerId=a;this.setTitle();0===this.element.closest("body").length&&this.element.appendTo("body");if(b.onLoad)b.onLoad(this);this.update(b.state.minDate);this.element.attr("data-date-group",
b.group)}},update:function(a){d.utils.presentation.isSmallTablet()&&this.displayWrapper.height()<1.9*this.monthApproxHeight?this.showOnlyOneMonth=!0:this.showOnlyOneMonth=!1;this.populateMonthsGrid(a);this.updateNav();this.setDisplayHeight()},updateNav:function(){var a=this.getStyles({child:"navItemSVG",state:"active"}),b=this.getStyles({child:"navItemSVG",state:"disabled"});this.checkDate(this.getMonthDate(-1,!0))?(this.prev.removeAttr("disabled"),d.dom.swapClasses(this.prev.children("svg"),b,a)):
(this.prev.attr("disabled","disabled"),d.dom.swapClasses(this.prev.children("svg"),a,b));this.checkDate(this.getMonthDate(2))?(this.next.removeAttr("disabled"),d.dom.swapClasses(this.next.children("svg"),b,a)):(this.next.attr("disabled","disabled"),d.dom.swapClasses(this.next.children("svg"),a,b))},setDisplayHeight:function(){if(this.defaultView.is(":visible")){var a=0;this.months.children().each(function(b){if(1==b||2==b)a=Math.max(a,e(this).find(".month").outerHeight())});this.options.backToTodayHeader&&
this.backToTodayHeader&&(a+=this.backToTodayHeader.height());this.displayWrapper.height(a)}},position:function(a,b){if(this.isOpen){var c=this.getCurrentPicker(),f=c.dateMode,n=c.group,c=c.hasPointer,g={},p=0,l=0,h=0,m=Math.round(e(window).outerWidth()),k=d.question.ask("DateInput.%s.startDate".format(n));if(m<=this.options.mobileBreakpoint)this.isOpen&&this.element.removeAttr("style");else{if(f===this.DateMode.RANGE){var t=d.question.ask("DateInput.%s.endDate".format(n)),r,q;t||console.error("Missing end input field, if this is a single date, set the dateMode parameter to 'single'");
var u=t.offset.left-k.offset.left;k.wrapper&&k.wrapper===t.wrapper&&e(k.wrapper).length&&(r=e(k.wrapper),q=r.offset());r?(g.left=q.left,p=q.top,l=r.outerHeight(),h="endDate"===a?t.offset.left-q.left:k.offset.left-q.left):k.height===t.height&&k.offset.top===t.offset.top&&this.element.outerWidth()-60>u&&(g.left=k.offset.left,p=k.offset.top,l=k.height,h="endDate"===a?u:0)}else k.wrapper&&e(k.wrapper).length&&(r=e(k.wrapper),q=r.offset()),r&&(g.left=q.left,p=q.top,l=r.outerHeight(),h=k.offset.left-q.left);
g.hasOwnProperty("left")&&"undefined"!==typeof l||(a=d.question.ask("DateInput.%s.%s".format(n,f===this.DateMode.RANGE?a:"startDate")),p=a.offset.top,l=a.height,g.left=a.offset.left);this.shouldFlipDirection(p,l)?(g.top=p-this.element.outerHeight(),this.element.addClass("up")):(g.top=p+l,this.element.removeClass("up"));a=Math.round(g.left);g=Math.round(g.top);h=Math.round(h);m=Math.round(this.element.outerWidth())+a-m;0<m&&(a-=m,h+=m);m=0;this.element.parent()[0]===jq(document.body)[0]&&(m=parseInt((jq(document.body).css("top")||
"0").replace("-",""))||0);m="translateX(%spx) translateY(%spx)".format(a,g+m);h="translateX(%spx)".format(h);m={transform:m,msTransform:m};h={transform:h,msTransform:h};b||this.element.css(m);c?this.pointer.css(h).removeClass("hidden"):this.pointer.addClass("hidden")}}},shouldFlipDirection:function(a,b){var c=e(window).scrollTop(),d=c+e(window).outerHeight(),n=this.element.outerHeight();return a+b+n>d&&!(a-n<c)},getMonthDate:function(a,b){a=this.getCurrentDate().clone().add(a,"month");return b?a.endOf("month"):
a.startOf("month")},onMonthChange:function(){d.events.publish("Calendar.monthchange",{group:this.getCurrentPicker().group});this.options.backToTodayHeader&&this.updateBackToTodayDisplay()},open:function(a){var b=this;if("undefined"===typeof this.pickers[a])throw Error("Picker %s not attached to the calendar. Please use 'addPicker' to attach it to the calendar",a);this.isOpen&&a===this.currentPickerId||this.switchPicker(a);this.element.attr("aria-hidden",!1);d.dom.swapClasses(this.element,this.getStyles({state:"hidden"}),
this.getStyles({state:"summon"}));setTimeout(function(){b.element.addClass(b.getStyles({state:"animate"}))},1);this.isOpen=!0},close:function(a){if(this.isOpen&&this.currentPickerId===a){this.element.attr("aria-hidden",!0);d.dom.swapClasses(this.element,this.getStyles({state:"summon"}),this.getStyles({state:"hidden"}));this.element.removeClass(this.getStyles({state:"animate"}));if(null!==this.currentPickerId&&(a=this.pickers[this.currentPickerId],a.onUnload))a.onUnload(this.element);this.isOpen=!1}},
getInitDate:function(a){a=a?moment(a):this.now.clone();a.isBefore(this.now)&&!this.options.allowPastDates&&(a=this.now.clone());return a},getSelectableDays:function(a){var b=this.months.children().find(".col.day[data-val]").not("[disabled]");return a&&0>a.indexOf("%s")?b.filter(a):b},getDayElement:function(a){a=moment(a).valueOf();return this.element.find(".col.day[data-val\x3d%s]".format(a))},hideTooltip:function(){this.element.find(".dayTip").hide()},highlightDates:function(a,b){"function"===typeof b?
this.getSelectableDays(a.join(",")).addClass("highlighted "+b()):this.getSelectableDays(a.join(",")).addClass("highlighted "+this.getStyles({child:"colDay",state:"highlighted"}))},markFlex:function(a){this.getSelectableDays(a.join(",")).addClass("flex")},markStartDate:function(a,b){"function"===typeof b?this.selectDate(a).addClass("startDate "+b()):this.selectDate(a).addClass("startDate "+this.getStyles({child:"colDay",state:"startDate"}))},selectDates:function(a,b,c){return"function"===typeof b||
"function"===typeof c?(b="function"===typeof b?b():" ",c="function"===typeof c?c():" ",this.getSelectableDays(a.join(",")).removeClass(c).addClass("selected "+b).attr("aria-selected","true")):this.getSelectableDays(a.join(",")).addClass("selected "+this.getStyles({child:"colDay",state:"selected"})).attr("aria-selected","true")},selectDate:function(a,b,c){a=this.getDayElement(a);"function"===typeof b||"function"===typeof c?(b="function"===typeof b?b():" ",c="function"===typeof c?c():" ",a.removeClass("highlighted hover "+
c).addClass("selected "+b).attr("aria-selected","true")):a.addClass("selected "+this.getStyles({child:"colDay",state:"selected"})).attr("aria-selected","true").removeClass("highlighted hover "+this.getStyles({child:"colDay",state:"highlighted"})+" "+this.getStyles({child:"colDay",state:"hover"}));return a},markEndDate:function(a,b){"function"===typeof b?this.selectDate(a).addClass("endDate "+b()):this.selectDate(a).addClass("endDate "+this.getStyles({child:"colDay",state:"endDate"}))},markPreviewDates:function(a,
b,c){"function"===typeof b||"function"===typeof c?(b="function"===typeof b?b():" ",c="function"===typeof c?c():" ",this.getSelectableDays(a.join(",")).filter(":not(.startDate)").filter(":not(.endDate)").removeClass(c).addClass("preview "+b)):this.getSelectableDays(a.join(",")).filter(":not(.startDate)").filter(":not(.endDate)").addClass("preview "+this.getStyles({child:"colDay",state:"preview"}))},hoverDay:function(a,b,c){a=this.getDayElement(a);a.is(":not(.startDate, .endDate)")&&("function"===typeof b||
"function"===typeof c?(b="function"===typeof b?b():" ",c="function"===typeof c?c():" ",a.removeClass("preview "+c).addClass("hover "+b)):a.addClass("hover "+this.getStyles({child:"colDay",state:"hover"})).removeClass("preview "+this.getStyles({child:"colDay",state:"preview"})))},showTooltip:function(a){},isDifferentPicker:function(a){return this.currentPickerId!==a},calculateMonthOffset:function(a){a=moment(a).startOf("month").diff(this.getCurrentDate().startOf("month"));a=Math.round(moment.duration(a).asMonths());
0<a&&--a;return a},clearDayState:function(a,b,c){if(""!==a.trim()){var d=this,n=this.getSelectableDays("%s".format(a.split(" ").map(function(a){return"."+a}).join()));"function"===typeof b||"function"===typeof c?(c="function"===typeof c?c():" ",n.removeClass(c+" "+a),"function"===typeof b&&n.each(function(a,c){a=e(c);a.addClass(b(a))})):n.removeClass(a.split(" ").map(function(a){return d.getStyles({child:"colDay",state:a})}).join(" ")+" "+a);0<=a.indexOf("selected")&&(n.removeAttr("aria-selected"),
this.getSelectableDays(".flex").removeClass("flex"))}},getStyles:function(a){return a.child?this.options.presentationClasses[a.child][a.state]:this.options.presentationClasses.main[a.state]},handleBuzzUpdate:function(a){var b=this,c=[];window.subData&&(a=window.subData);if("object"===_typeof(a.dates))for(var f in a.dates)a.dates.hasOwnProperty(f)&&"LOW"===a.dates[f]&&c.push(moment(f).valueOf());this.removeBuzzFlaggedItems();e.each(c,function(a,c){a=b.getDayElement(c).attr("data-tip","BUZZ_LOW");var e=
a.children("div");a.length&&(a.attr("aria-label",d.Common.Utils.String.formatString(b.options.messages.greatPrice,moment(c).format(d.globals.dateFormats.short))),d.dom.swapClasses(e,b.getStyles({child:"day",state:"default"}),b.getStyles({child:"day",state:"buzz"})),a.is(".highlighted")?e.addClass(b.getStyles({child:"day",state:"previewBuzz"})):a.is(".selected")?e.addClass(b.getStyles({child:"day",state:"selectedBuzz"})):e.addClass(b.getStyles({child:"day",state:"defaultBuzz"})))})},removeBuzzFlaggedItems:function(){var a=
this.months.find("[data-tip\x3dBUZZ_LOW]");d.dom.swapClasses(a.removeAttr("data-tip").children("div"),this.getStyles({child:"day",state:"buzz"}),this.getStyles({child:"day",state:"default"}));a.children("div").removeClass(this.getStyles({child:"day",state:"defaultBuzz"})+" "+this.getStyles({child:"day",state:"previewBuzz"})+" "+this.getStyles({child:"day",state:"selectedBuzz"}));a.each(function(a,c){a=e(c);c=a.attr("data-val");c=moment(parseInt(c));a.attr("aria-label",c.format(d.globals.dateFormats.short))})},
handlePriceUpdate:function(){this.removeBuzzFlaggedItems()},append:function(a){var b=this.getAppendElement(a);return null!==b&&this.appended!==a?(b.append(this.element.detach()),this.appended=a,!0):!1},buffer:function(a){return null!==this.getAppendElement(a)&&this.appended===a?(e("body").append(this.element.detach()),this.appended=null,!0):!1},getAppendElement:function(a){return a&&e(a).length?e(a):null},toggleDefaultView:function(a){a?this.swapClasses(this.defaultView,"Calendar__defaultView--hidden",
""):this.swapClasses(this.defaultView,"","Calendar__defaultView--hidden")}})})(R9,jQuery);(function(a,c){a.createWidgetClass("dropdown.StyleJamDropdown",{status:null,select:null,selectEl:null,refreshTimer:null,lastSelectedIndex:-1,options:{click:null,change:null,statusClientTemplate:"",presentationStates:{}},init:function(){this.status=this.getChildElement("status");this.status.length||(this.status=this.element.find(".status"));this.select=this.getChildElement("select");this.select.length||(this.select=this.element.find("select"));this.selectEl=this.select.get(0)},addEventHandlers:function(){this.select.click(this.handleSelectClickEvent.bind(this));
this.select.keydown(this.handleSelectKeydownEvent.bind(this));this.select.keyup(this.handleSelectKeyupEvent.bind(this));this.select.focus(this.handleSelectFocusEvent.bind(this));this.select.blur(this.handleSelectBlurEvent.bind(this));this.select.change(this.handleSelectChangeEvent.bind(this));this.options.presentationStates&&this.styleInvalidState()},refresh:function(){this.select.is(":disabled")?this.element.addClass("disabled"):this.element.removeClass("disabled");var b=this.selectEl.selectedIndex;
0>b&&(b=0);b=this.selectEl.options[b];"undefined"!==typeof b&&(this.options.statusClientTemplate?this.status.html(a.template.render(this.options.statusClientTemplate,b)):(this.status.html(a.utils.escapeHTML(b.title||b.text||b.value)),this.selectEl.title=b.title||b.text||b.value))},startRefreshLoop:function(){var b=this;this.lastSelectedIndex=this.selectEl.selectedIndex;this.refreshTimer=setInterval(function(){b.doRefresh()},100)},stopRefreshLoop:function(){null!=this.refreshTimer&&(clearTimeout(this.refreshTimer),
this.refreshTimer=null,this.lastSelectedIndex=-1)},doRefresh:function(){this.selectEl.selectedIndex!=this.lastSelectedIndex&&(this.lastSelectedIndex=this.selectEl.selectedIndex,this.refresh())},handleSelectClickEvent:function(){"function"===typeof this.options.click&&this.options.click(this);this.stopRefreshLoop()},handleSelectKeydownEvent:function(){this.startRefreshLoop()},handleSelectKeyupEvent:function(){this.refresh();this.stopRefreshLoop()},handleSelectFocusEvent:function(){this.selectEl.disabled||
(this.element.addClass("focused"),this.options.presentationStates?(this.element.removeClass(this.options.presentationStates.invalid),a.dom.swapClasses(this.element,this.options.presentationStates.regular,this.options.presentationStates.focus)):this.element.is(".TEXT")?(a.dom.swapClasses(c(this.element),a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownTextBlurred,a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownTextFocused),a.dom.swapClasses(this.element.children(".icon"),a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownIconText,
a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownIconTextFocused)):a.dom.swapClasses(c(this.element),a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownBlurred,a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownFocused))},handleSelectBlurEvent:function(){this.selectEl.disabled||(this.element.removeClass("focused"),this.options.presentationStates?a.dom.swapClasses(this.element,this.options.presentationStates.focus,this.options.presentationStates.regular):(this.element.is(".TEXT")?
(a.dom.swapClasses(c(this.element),a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownTextFocused,a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownTextBlurred),a.dom.swapClasses(this.element.children(".icon"),a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownIconTextFocused,a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownIconText)):a.dom.swapClasses(c(this.element),a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownFocused,a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownBlurred),
this.refresh(),this.stopRefreshLoop()))},handleSelectChangeEvent:function(b){"function"===typeof this.options.change&&this.options.change.call(this,b);this.refresh();this.stopRefreshLoop()},styleInvalidState:function(b){b?a.dom.swapClasses(this.element,this.options.presentationStates.regular,this.options.presentationStates.invalid):a.dom.swapClasses(this.element,this.options.presentationStates.invalid,this.options.presentationStates.regular)},getSelectedElement:function(){return this.selectEl.options[0<=
this.selectEl.selectedIndex?this.selectEl.selectedIndex:0]},getName:function(){return this.selectEl.name},hasOptions:function(){return 0!==this.selectEl.options.length},getValue:function(){return this.hasOptions()?this.getSelectedElement().value:null},val:function(b){if("undefined"!==typeof b)this.setValue(b);else return this.getValue()},getText:function(){return c(this.getSelectedElement()).text()},setText:function(b){this.status.text(b)},setValue:function(b,a){this.select.val(b);a?this.select.trigger("change"):
this.refresh()},setOptions:function(a,e){var b=c("\x3cselect\x3e");c.each(a,function(a,d){d.value===e&&(d.selected=!0);b.append(c("\x3coption\x3e",d))});this.select.html(b.html());this.refresh()}})})(R9,jQuery);(function(c,b){c.createWidgetClass("dropdown.Dropdown",{status:null,select:null,selectEl:null,refreshTimer:null,lastSelectedIndex:-1,options:{click:null,change:null,statusClientTemplate:""},init:function(){this.status=this.getChildElement("status");this.status.length||(this.status=this.element.find(".status"));this.select=this.getChildElement("select");this.select.length||(this.select=this.element.find("select"));this.selectEl=this.select.get(0)},addEventHandlers:function(){this.select.click(this.handleSelectClickEvent.bind(this));
this.select.keydown(this.handleSelectKeydownEvent.bind(this));this.select.keyup(this.handleSelectKeyupEvent.bind(this));this.select.focus(this.handleSelectFocusEvent.bind(this));this.select.blur(this.handleSelectBlurEvent.bind(this));this.select.change(this.handleSelectChangeEvent.bind(this))},refresh:function(){this.select.is(":disabled")?this.element.addClass("disabled"):this.element.removeClass("disabled");var a=this.selectEl.selectedIndex;0>a&&(a=0);a=this.selectEl.options[a];"undefined"!==typeof a&&
(this.options.statusClientTemplate?this.status.html(c.template.render(this.options.statusClientTemplate,a)):(this.status.html(c.utils.escapeHTML(a.title||a.text||a.value)),this.selectEl.title=a.title||a.text||a.value))},startRefreshLoop:function(){var a=this;this.lastSelectedIndex=this.selectEl.selectedIndex;this.refreshTimer=setInterval(function(){a.doRefresh()},100)},stopRefreshLoop:function(){null!=this.refreshTimer&&(clearTimeout(this.refreshTimer),this.refreshTimer=null,this.lastSelectedIndex=
-1)},doRefresh:function(){this.selectEl.selectedIndex!=this.lastSelectedIndex&&(this.lastSelectedIndex=this.selectEl.selectedIndex,this.refresh())},handleSelectClickEvent:function(){"function"===typeof this.options.click&&this.options.click(this);this.stopRefreshLoop()},handleSelectKeydownEvent:function(){this.startRefreshLoop()},handleSelectKeyupEvent:function(){this.refresh();this.stopRefreshLoop()},handleSelectFocusEvent:function(){this.selectEl.disabled||this.element.addClass("focused")},handleSelectBlurEvent:function(){this.selectEl.disabled||
(this.element.removeClass("focused"),this.refresh(),this.stopRefreshLoop())},handleSelectChangeEvent:function(a){"function"===typeof this.options.change&&this.options.change.call(this,a);this.refresh();this.stopRefreshLoop()},getSelectedElement:function(){return this.selectEl.options[0<=this.selectEl.selectedIndex?this.selectEl.selectedIndex:0]},getName:function(){return this.selectEl.name},hasOptions:function(){return 0!==this.selectEl.options.length},getValue:function(){return this.hasOptions()?
this.getSelectedElement().value:null},val:function(a){if("undefined"!==typeof a)this.setValue(a);else return this.getValue()},getText:function(){return b(this.getSelectedElement()).text()},setText:function(a){this.status.text(a)},setValue:function(a,b){this.select.val(a);b?this.select.trigger("change"):this.refresh()},setOptions:function(a,c){var e=b("\x3cselect\x3e");b.each(a,function(a,d){d.value===c&&(d.selected=!0);e.append(b("\x3coption\x3e",d))});this.select.html(e.html());this.refresh()}})})(R9,
jQuery);(function(d,c){d.extend("DatePicker.BuzzData",{});var a={},b=null,e=null,g=d.DatePicker.BuzzData=function(){if(e)return e;e=this;return this};g.prototype={constructor:g,datePicker:null,form:null,vertical:"",update:function(a,b){this.datePicker=a;this.form=b;this.vertical=b.vertical;a=d.config.getBoolean("ui.calendar.buzz.hotels.enabled",!1);b=d.config.getBoolean("ui.calendar.buzz.flights.enabled",!1);a&&"hotels"===this.vertical&&this.updatePickerAccordingData(this.form.cityId,this.updateDatePicker.bind(this));
b&&"flights"===this.vertical&&this.updatePickerAccordingData(this.getFlightUrl(),this.updateDatePicker.bind(this))},fetch:function(a,b){this.form=a;this.vertical=a.vertical;a=d.config.getBoolean("ui.calendar.buzz.hotels.enabled",!1);var e=d.config.getBoolean("ui.calendar.buzz.flights.enabled",!1);a&&"hotels"===this.vertical&&this.updatePickerAccordingData(this.form.cityId,b);e&&"flights"===this.vertical&&this.updatePickerAccordingData(this.getFlightUrl(),b)},getFlightUrl:function(){var a=this.form,
b=this.getAirportCode(a.origin),e=this.getAirportCode(a.destination),c=a.departDate,a=a.isOneWay,g="";if(this.isEmpty(b))return null;g+=b+"/";if(this.isEmpty(e))return null;g=g+(e+"")+("?oneWay\x3d"+(a?"true":"false"));c&&(g+="\x26departDate\x3d"+c);return g},isEmpty:function(a){return!a||0===a.length},getAirportCode:function(a){if("undefined"!==typeof a){var b=/(([A-Z]{3}))/g,e=a.substr(0,3);if(""==e||0==e.indexOf("C-"))e=a.value+"",e=e.replace(/ /g,""),-1!=e.indexOf("(")&&(a=b.exec(e),null!=a&&
(e=a[0]));return c.trim(e)}return null},updatePickerAccordingData:function(a,e){if(a){var g=this.getCacheData(a),f=this;null!==g?e(g):(b&&4!==b.readyState&&b.abort(),b=c.ajax({type:"GET",url:"/api/search/buzzCalendar/"+this.vertical+"/"+a,dataType:"json"}).done(function(b){b.success&&(f.putCacheData(a,b),e(b))}))}},getCacheData:function(b){b=this.getKey(b);return a.hasOwnProperty(b)?a[b]:null},putCacheData:function(b,e){b=this.getKey(b);a[b]=e},getKey:function(a){return this.vertical+"_"+a},updateDatePicker:function(a){var b=
d.config.getBoolean("ui.calendar.buzz.prices",!1),e=d.config.getBoolean("ui.calendar.buzz.prices.low",!1),g="buzz-date-low";b&&(g="buzz-prices-low");c(".r9-datepicker-item",this.datePicker).each(function(){var f=c(this);f.removeClass(g);b&&c(".buzz-price",f).html("");var d=f.data("val");"undefined"!==typeof d&&(d=moment(d).format("YYYY-MM-DD"),a.dates&&a.dates.hasOwnProperty(d)&&"LOW"===a.dates[d]&&f.addClass("buzz-date-low"),b&&a.prices&&a.prices.hasOwnProperty(d)&&(d=a.prices[d],c(".buzz-price",
f).html(d.price),e&&"LOW"===d.rate&&f.addClass("buzz-prices-low")))})}}})(window.R9,window.jq||window.jQuery);
(function(d){R9.extend("Widgets.BaseCalendarWidget",{});(R9.Widgets.BaseCalendarWidget=function(){this.updateSettings()}).prototype={advanceStyling:!0,loadBuzzData:!1,buzzDataClass:"",buzzPrices:!1,updateSettings:function(){this.advanceStyling=R9.config.getBoolean("ui.calendar.advanceStyling",!0);this.loadBuzzData=R9.config.getBoolean("ui.calendar.loadBuzzData",!1);this.buzzDataClass=(this.buzzPrices=R9.config.getBoolean("ui.calendar.buzz.prices",!1))?"datepicker-buzz-prices":"datepicker-buzz-data";
this.wholeMonthSearch=!1;jq("body").hasClass("FlightsSearch")&&0<jq(".flexOpenflex").length&&0<jq(".Flights-Search-FlightSearchPage.vm-fd").length&&(this.wholeMonthSearch=R9.config.getBoolean("ui.flights.whole-month-search.enabled",!1),this.daterangePickerDefaultNavTab="specificDate",this.noOfNightsValue="6-8",this.flexSelectedYear=this.flexSelectedMonth="",this.flexPlusMinusChecked=!1)},buzzGraph:jq("\x3cdiv\x3e",{"class":"r9-datepicker-buzz-graph"}),buzzGraphFooter:jq("\x3cdiv\x3e",{"class":"r9-datepicker-buzz-graph-footer"}),
buzzGraphFooterInner1:jq("\x3cdiv\x3e",{"class":"noairports hidden"}),buzzGraphFooterInner2:jq("\x3cdiv\x3e",{"class":"duration hidden"}),buzzGraphFooterInner3:jq("\x3cdiv\x3e",{"class":"fixedstart hidden"}),buzzGraphFooterInner4:jq("\x3cdiv\x3e",{"class":"oneway hidden"}),buzzGraphFooterDetail:jq("\x3cspan\x3e",{"class":"detail"}),buzzGraphPriceRule:jq("\x3cdiv\x3e",{id:"graphpricebar","class":"r9-datepicker-buzz-graph-price"}),buzzGraphLowestPriceRule:jq("\x3cdiv\x3e",{id:"graphlowpricebar","class":"r9-datepicker-buzz-graph-price"}),
buzzGraphPriceValue:jq("\x3cdiv\x3e",{id:"graphprice","class":"r9-datepicker-buzz-graph-price-value"}),makeCalendarHTML:function(c){var a=function(){var a=this.makeBelowCalendarHTML();a&&0<a.length&&(b.push("\x3cdiv id\x3d'%s' class\x3d'belowCalendar'\x3e".format("below")),b.push(a),b.push("\x3c/div\x3e"))},b=[];this.options.showBuzzGraph&&(this.buzzGraph.html(this.buzzGraphPriceRule.prop("outerHTML")+this.buzzGraphLowestPriceRule.prop("outerHTML")+this.buzzGraphPriceValue.prop("outerHTML")),this.buzzGraphFooterInner1.html("Select airports to see recent best prices. \x3cspan class\x3d'detail'\x3e\x3c/span\x3e"),
this.buzzGraphFooterInner2.html("Best prices for \x3cspan id\x3d\"durationNumber\"\x3e\x3c/span\x3e day trips. \x3cspan class\x3d'detail'\x3e\x3c/span\x3e"),this.buzzGraphFooterInner3.html("Best prices for trips departing on \x3cspan id\x3d\"flexDepartDate\"\x3e\x3c/span\x3e. \x3cspan class\x3d'detail'\x3e\x3c/span\x3e"),this.buzzGraphFooterInner4.html("Best prices for one-way trips \x3cspan class\x3d'detail'\x3e\x3c/span\x3e"),this.buzzGraphFooter.html(this.buzzGraphFooterInner1.prop("outerHTML")+
this.buzzGraphFooterInner2.prop("outerHTML")+this.buzzGraphFooterInner3.prop("outerHTML")+this.buzzGraphFooterInner4.prop("outerHTML")));b.push("\x3cdiv class\x3d'r9-datepicker-pointer'\x3e\x3c/div\x3e");b.push("\x3cspan role\x3d'button' class\x3d'r9-datepicker-close'\x3e\x26times;\x3c/span\x3e");!0===this.options.belowContentOnTop&&a.call(this);b.push(this.makeTitleHTML(this.options.title));this.wholeMonthSearch&&b.push(this.makeCalendarTabNavHTML());var e=moment().startOf("day"),g=this.minDate,
g=g?moment(g):e;c=c?moment(c):g;if(null==c||!this.isPastDateAllowed()&&c<e)c=e;e=moment(c).subtract(1,"months");g=moment(c).add(1,"months");b.push(this.makeMonthCalendarHTML(c,e,"r9-datepicker-month-first",this.options.prevTitle));c.add(1,"months");b.push(this.makeMonthCalendarHTML(c,g,"r9-datepicker-month-last",this.options.nextTitle));b.push("\x3cdiv class\x3d'r9-datepicker-month-break'\x3e\x3c/div\x3e");this.options.showBuzzGraph&&(b.push(this.buzzGraph.prop("outerHTML")),b.push(this.buzzGraphFooter.prop("outerHTML")));
this.wholeMonthSearch&&b.push(this.makeCalendarSelectMonthHTML());this.options.belowContentOnTop||a.call(this);return b.join("")},makeTitleHTML:function(c){return'\x3cdiv class\x3d"r9-datepicker-title"\x3e\x3cspan\x3e'+c+'\x3c/span\x3e\x3ca class\x3d"r9-datepicker-title-close"\x3eX\x3c/a\x3e\x3c/div\x3e'},makeCalendarTabNavHTML:function(){var c=jq(document.createElement("div")),a=jq(document.createElement("div")).addClass("CalendarWidget-TabNav"),b=jq(document.createElement("div")).addClass("keel-grid distribute mainGrid"),
e=jq(document.createElement("div")).addClass("col-auto leftNavItems"),g=jq(document.createElement("div")).addClass("col-auto rightNavItems"),f=jq(document.createElement("div")).addClass("keel-grid leftNavItemsGrid"),d=jq(document.createElement("div")).addClass("keel-grid rightNavItemsGrid"),h=jq(document.createElement("div")).addClass("tabWrapper specificDate"),n=jq(document.createElement("div")).addClass("col-auto dateCol"),m=jq(document.createElement("span")).addClass("icon calendar").html('\x3csvg viewBox\x3d"0 0 13 14" xmlns\x3d"http://www.w3.org/2000/svg"\x3e\x3cpath d\x3d"M9.75 1.647h1.247c1.106 0 2.003.888 2.003 1.999v8.356A1.999 1.999 0 0 1 10.997 14H2.003A1.997 1.997 0 0 1 0 12.002V3.646a2 2 0 0 1 2.003-1.999H3.25V0h.813v1.647h4.875V0h.812v1.647zm0 .824h1.428c.558 0 1.01.446 1.01 1.007v8.691c0 .557-.446 1.007-1.01 1.007H1.822c-.558 0-1.01-.446-1.01-1.007V3.478c0-.556.446-1.007 1.01-1.007H3.25v.823h.813v-.823h4.875v.823h.812v-.823zM.812 4.94h11.376v.824H.812V4.94zM2.6 6.364h2v2h-2v-2z" fill\x3d"currentColor" fill-rule\x3d"evenodd"/\x3e\x3c/svg\x3e'),
l=jq(document.createElement("div")).addClass("tabWrapper wholeMonth"),r=jq(document.createElement("div")).addClass("col-auto dateMonth"),w=jq(document.createElement("span")).addClass("icon trend").html('\x3csvg viewBox\x3d"0 0 15 12" xmlns\x3d"http://www.w3.org/2000/svg"\x3e\x3cpath d\x3d"M0 12V5h3v7H0zm4 0V0h3v12H4zm4 0V5h3v7H8zm4 0V8h3v4h-3z" fill\x3d"currentColor" fill-rule\x3d"evenodd"/\x3e\x3c/svg\x3e'),p=jq(document.createElement("div")).addClass("col-auto plusMinus"),q=jq(document.createElement("span")).addClass("input flexPlusMinus"),
u=jq(document.createElement("div")).addClass("tabUnderlay no-transition");"undefined"!==typeof R9.storage&&(null!==R9.storage.get("daterangePickerDefaultNavTab")&&"wholeMonth"!==R9.storage.get("daterangePickerDefaultNavTab")||R9.storage.set("daterangePickerDefaultNavTab","specificDate"),this.daterangePickerDefaultNavTab=R9.storage.get("daterangePickerDefaultNavTab"),null===R9.storage.get("flexPlusMinusChecked")&&R9.storage.set("flexPlusMinusChecked",!1),this.flexPlusMinusChecked=R9.storage.get("flexPlusMinusChecked"));
"wholeMonthSearch"==this.daterangePickerDefaultNavTab?(l.addClass("selected"),u.addClass("wholeMonth"),p.hide()):(h.addClass("selected"),u.addClass("specificDate"));this.flexPlusMinusChecked&&q.addClass("checked");c.append(a.append(b.append(e.append(f.append(n.append(h.text("Date").addClass("v-c-p").prepend(m)),r.append(l.text("Flex Month").prepend(w).append(jq(document.createElement("span")).addClass("newTag").text("new"))))),g.append(d.append(p.append(jq(document.createElement("div")).addClass("likeTabWrapper").append(q.text("\u00b1 3 days")))))),
u));return c.html()},makeCalendarSelectMonthHTML:function(){"undefined"!==typeof R9.storage&&(null===R9.storage.get("flexNoOfNights")&&R9.storage.set("flexNoOfNights","6-8"),this.noOfNightsValue=R9.storage.get("flexNoOfNights"));var c=jq(document.createElement("div")),a=jq(document.createElement("div")).addClass("CalendarWidget-MonthSelect"),b=jq(document.createElement("div")).addClass("keel-grid mainGrid"),e=jq(document.createElement("div")).addClass("col"),g=jq(document.createElement("div")).addClass("col"),
f=jq(document.createElement("div")).addClass("keel-grid keel-form topColGrid"),d=jq(document.createElement("div")).addClass("keel-grid bottomColGrid"),h=jq(document.createElement("div")).addClass("col"),n=jq(document.createElement("div")).addClass("col noOfNightsInputCol"),m=jq(document.createElement("input")).addClass("Common-Widgets-Text-TextInput selectTextOnFocus noOfNightsInput").attr({type:"text",id:"noOfNightsInput",name:"noOfNightsInput",value:this.noOfNightsValue}),l=jq(document.createElement("label")).addClass("nightsAtDestination").text("nights"),
r=jq(document.createElement("div")).addClass("col subTextCol"),w=jq(document.createElement("div")).addClass("col"),p=jq(document.createElement("div")).addClass("keel-grid monthSelectGrid");c.append(a.append(b.append(e.append(f.append(h.text("Number of nights:"),n.append(m,l),r.text("Not sure how long? Use a range, like 10-12 nights."))),g.append(d.append(w.append(p))))));for(a=0;12>a;a++)"undefined"!==typeof R9.storage&&(null===R9.storage.get("flexSelectedMonth")&&R9.storage.set("flexSelectedMonth",
moment().format("M")),null===R9.storage.get("flexSelectedYear")&&R9.storage.set("flexSelectedYear",moment().format("Y")),this.flexSelectedMonth=R9.storage.get("flexSelectedMonth"),this.flexSelectedYear=R9.storage.get("flexSelectedYear")),b=jq(document.createElement("div")).addClass("col-1-3 col-1-4-l centre"),e=jq(document.createElement("div")).addClass("monthWrapper"),g=moment().add(a,"M").format("M"),f=moment().add(a,"M").daysInMonth(),d=moment().add(a,"M").format("Y"),h=jq(document.createElement("div")).addClass("monthName").text(moment().add(a,
"M").format("MMMM")),n=jq(document.createElement("div")).addClass("shortMonthName").text(moment().add(a,"M").format("MMM")),m=jq(document.createElement("div")).addClass("monthYear").text(moment().add(a,"M").format("Y")),this.flexSelectedMonth==g&&this.flexSelectedYear==d&&e.addClass("selected"),p.append(b.append(e.append(h,n,m).attr("data-month",g).attr("data-year",d).attr("data-end-of-month",f)));return c.html()},makeBelowCalendarHTML:function(){return""},runBelowCalendarCallback:function(){},makeMonthCalendarHTML:function(c,
a,b,e){var g=[];g.push("\x3cdiv class\x3d'r9-datepicker-month "+b+"'\x3e");g.push(this.makeMonthHeaderHTML(c,a,e));g.push(this.makeMonthBodyHTML(c,e));g.push("\x3c/div\x3e");return g.join("")},showMonth:function(c){var a=[];a.push("\x3cspan class\x3d'r9-datepicker-month-name'\x3e");a.push(c.format(this.options.titleMonthFormat).substring(0,1).toUpperCase()+c.format(this.options.titleMonthFormat).substring(1,this.options.titleMonthFormatLen));a.push("\x3c/span\x3e");return a.join("")},showYearWithSpecialSymbol:function(c){var a=
[],b;R9&&R9.globals&&(b=R9.globals.reverseDatePickerMonthAndYear);a.push("\x3cspan class\x3d'r9-datepicker-year'\x3e");a.push(c.format(this.options.titleYearFormat)+b+" ");a.push("\x3c/span\x3e");return a.join("")},showMonthAndYear:function(c){var a=[];a.push(this.showMonth(c));a.push(this.showYearWithSpecialSymbol(c));return a.join("")},makeMonthHeaderHTML:function(c,a,b){var e=[],g=moment().startOf("month"),f=moment().add(11,"months"),d=moment(a).startOf("month"),h=moment(a).endOf("month"),n=this.maxDate,
m=this.minDate,l=this.getStartDate&&moment(this.getStartDate()),r=this.getEndDate&&moment(this.getEndDate()),l=l&&h.isBefore(l)&&this.isPastDateAllowed(),r=r&&h.isBefore(r),m=m&&h.isBefore(m),n=n&&d.isAfter(n),g=!l&&!r&&(m||n||!this.isPastDateAllowed()&&h.isBefore(g)||d.isAfter(f));e.push("\x3cspan class\x3d'r9-datepicker-month-header'\x3e");e.push("\x3ca title\x3d'"+b+"' class\x3d'r9-datepicker-switch-month "+(g?"r9-datepicker-disabled":"r9-datepicker-enabled")+"' data-val\x3d'"+a.valueOf()+"'\x3e");
e.push(this.makeMonthHeaderPickerHTML(b));e.push("\x3c/a\x3e");e.push("\x3cspan class\x3d'r9-datepicker-month-title'\x3e");e.push(this.showMonthAndYear(c));e.push("\x3c/span\x3e");e.push("\x3c/span\x3e");return e.join("")},makeMonthHeaderPickerHTML:function(c){var a=[];a.push("\x3cspan\x3e");a.push(c);a.push("\x3c/span\x3e");return a},makeMonthBodyHTML:function(c,a){var b=[];b.push("\x3cspan class\x3d'r9-datepicker-month-body'\x3e");b.push(this.makeWeekDaysHTML(c));b.push(this.makeMonthDatesHTML(c,
a));b.push("\x3c/span\x3e");return b.join("")},makeWeekDaysHTML:function(c){c=[];c.push("\x3cspan class\x3d'r9-datepicker-month-days'\x3e");for(var a=0+this.getFirstWeekDay();a<7+this.getFirstWeekDay();a++){var b=a%7;c.push("\x3cspan class\x3d'r9-datepicker-day'\x3e");c.push(this.getVeryShortDayName(b));c.push("\x3c/span\x3e")}c.push("\x3c/span\x3e");return c.join("")},makeMonthDatesHTML:function(c,a){var b=[];b.push("\x3cspan class\x3d'r9-datepicker-month-dates'\x3e");var e=this.getMonthLeadDays(c),
g=this.getDaysInMonth(c),f=moment().startOf("day"),d=moment(c).subtract(1,"months").startOf("month"),h=d.daysInMonth(),n=moment(c).add(1,"months").startOf("month"),m=moment(f).add(1,"year"),l=this.maxDate,r,w,p,q,u=this.minDate,t=1;a=a.toLowerCase();this.getStartDate&&this.getStartDate();for(var v=0;42>v;v++){r=v-e+1;q=moment([c.year(),c.month(),r]);w=v%7;p=Math.ceil((v+1)/7);0==w&&b.push("\x3cspan class\x3d'r9-datepicker-month-row "+(this.loadBuzzData?this.buzzDataClass:"")+"' aria-label\x3d'Week "+
p+"' role\x3d'week'\x3e");if(v<e&&"prev"===a&&!this.advanceStyling){var x=moment([d.year(),d.month(),h+v-e+1]);p="r9-datepicker-item r9-datepicker-othermonth-item";p=(q.isBefore(f)||q.isAfter(m))&&!this.isPastDateAllowed()||u&&q.isBefore(u)||l&&q.isAfter(l)?p+" r9-datepicker-disabled":p+" r9-datepicker-enabled";this.addGraphBar(!1,x.valueOf());b.push("\x3cspan role\x3d'gridcell' class\x3d'"+p+"' data-val\x3d'"+x.valueOf()+"'\x3e");b.push("\x3cspan\x3e"+(h+v-e+1));this.loadBuzzData&&(this.buzzPrices?
b.push("\x3cspan class\x3d'buzz-price'\x3e\x3c/span\x3e"):(b.push("\x3cspan class\x3d'buzz-message'\x3eGreat price\x3c/span\x3e"),b.push("\x3ci\x3e\x3c/i\x3e")));b.push("\x3c/span\x3e\x3c/span\x3e")}else if(v>=e+g&&"next"===a&&!this.advanceStyling)x=moment([n.year(),n.month(),t]),p="r9-datepicker-othermonth-item r9-datepicker-item",p=(q.isBefore(f)||q.isAfter(m))&&!this.isPastDateAllowed()||u&&q.isBefore(u)||l&&q.isAfter(l)?p+" r9-datepicker-disabled":p+" r9-datepicker-enabled",b.push("\x3cspan role\x3d'gridcell' class\x3d'"+
p+"' data-val\x3d'"+x.valueOf()+"'\x3e"),b.push("\x3cspan\x3e"+t++),this.loadBuzzData&&(this.buzzPrices?b.push("\x3cspan class\x3d'buzz-price'\x3e\x3c/span\x3e"):(b.push("\x3cspan class\x3d'buzz-message'\x3eGreat price\x3c/span\x3e"),b.push("\x3ci\x3e\x3c/i\x3e"))),b.push("\x3c/span\x3e\x3c/span\x3e"),this.addGraphBar(!1,x.valueOf());else if(v>=e+g&&("next"!==a||this.advanceStyling))break;else v<e&&("Prev"!==a||this.advanceStyling)?b.push("\x3cspan role\x3d'gridcell' class\x3d'r9-datepicker-item r9-datepicker-disabled'\x3e\x3cspan\x3e\x26nbsp;\x3c/span\x3e\x3c/span\x3e"):
(p="r9-datepicker-item",(q.isBefore(f)||q.isAfter(m))&&!this.isPastDateAllowed()||u&&q.isBefore(u)||l&&q.isAfter(l)?(p+=" r9-datepicker-disabled",x=!1):(p+=" r9-datepicker-enabled",x=!0),q.isSame(f)&&(p+=" r9-datepicker-today"),b.push("\x3cspan role\x3d'gridcell' class\x3d'"+p+"' "),this.addGraphBar(x,q.valueOf()),b.push("data-val\x3d'"+q.valueOf()+"'"),b.push("\x3e\x3cspan\x3e"),b.push(r),this.loadBuzzData&&(this.buzzPrices?b.push("\x3cspan class\x3d'buzz-price'\x3e\x3c/span\x3e"):(b.push("\x3cspan class\x3d'buzz-message'\x3eGreat price\x3c/span\x3e"),
b.push("\x3ci\x3e\x3c/i\x3e"))),b.push("\x3c/span\x3e\x3c/span\x3e"));if(6==w&&(b.push("\x3c/span\x3e"),r===g||1<t))break}b.push("\x3c/span\x3e");return b.join("")},getFirstWeekDay:function(){return moment().startOf("week").day()},getVeryShortDayName:function(c){return moment().day(c).format("dd").substring(0,this.options.shortDayNameLen)},getMonthLeadDays:function(c){c=this.getFirstMonthDay(c)-this.getFirstWeekDay();0>c&&(c=6);return c},getFirstMonthDay:function(c){c=moment(c);c.startOf("month");
return c.day()},getDaysInMonth:function(c){return c.daysInMonth()},insideLastCalendar:function(c){return!!this.dropdown.find(".r9-datepicker-item-"+c).closest(".r9-datepicker-month").hasClass("r9-datepicker-month-last")},isPastDateAllowed:function(){return"undefined"!=this.options.allowPastDate?this.options.allowPastDate:!1},addGraphBar:function(c,a){this.options.showBuzzGraph&&(c=jq("\x3cdiv\x3e",{"class":"r9-datepicker-buzz-day "+(c?"r9-datepicker-enabled":"r9-datepicker-disabled"),"data-val":a}),
c.append(jq("\x3cdiv\x3e",{"class":"r9-datepicker-buzz-bar"})),this.buzzGraph.append(c))}}})(jq||jQuery);
(function(d){function c(a,b,e){var c,f,d,h,n,m=Date.now||function(){return(new Date).getTime()},l=function(){var g=m()-h;g<b&&0<=g?c=setTimeout(l,b-g):(c=null,e||(n=a.apply(d,f),c||(d=f=null)))};return function(){d=this;f=arguments;h=m();var g=e&&!c;c||(c=setTimeout(l,b));g&&(n=a.apply(d,f),d=f=null);return n}}R9.extend("Widgets",{DaterangePicker:function(a,b){R9.Widgets.BaseCalendarWidget.apply(this);this.elementNode=a;this.element=d(this.elementNode);this.validateElement()&&(this.startSection=d(R9.Widgets.DaterangePicker.findStartSection(this.elementNode)),
this.startDisplay=d(R9.Widgets.DaterangePicker.findStartDisplay(this.elementNode)),this.startPlaceholderDisplay=d(R9.Widgets.DaterangePicker.findStartPlaceholderDisplay(this.elementNode)),this.endSection=d(R9.Widgets.DaterangePicker.findEndSection(this.elementNode)),this.endDisplay=d(R9.Widgets.DaterangePicker.findEndDisplay(this.elementNode)),this.endPlaceholderDisplay=d(R9.Widgets.DaterangePicker.findEndPlaceholderDisplay(this.elementNode)),this.summaryDisplay=d(R9.Widgets.DaterangePicker.findSummaryDisplay(this.elementNode)),
this.clearDisplay=d(R9.Widgets.DaterangePicker.findClearDisplay(this.elementNode)),this.closeLink=d(R9.Widgets.DaterangePicker.findCloseLink(this.elementNode)),this.tabInput=d(R9.Widgets.DaterangePicker.findTabInput(this.elementNode)),this.startInput=d(R9.Widgets.DaterangePicker.findStartInput(this.elementNode)),this.endInput=d(R9.Widgets.DaterangePicker.findEndInput(this.elementNode)),this.options=d.extend({},this.options,b),this.init())}});R9.extend("Widgets.DaterangePicker",{isDatepicker:function(a){return a&&
a.nodeName&&"div"==a.nodeName.toLowerCase()},isWidgetControlled:function(a){return d(a).hasClass(R9.Widgets.DaterangePicker.prototype.widgetBaseClass+"-wrapper")},findStartSection:function(a){return d(a).closest("form").find("#"+a.id+"-start")},findStartDisplay:function(a){return d(a).closest("form").find("#"+a.id+"-start-display")},findStartPlaceholderDisplay:function(a){return d(a).closest("form").find("#"+a.id+"-start-placeholder")},findEndSection:function(a){return d(a).closest("form").find("#"+
a.id+"-end")},findEndDisplay:function(a){return d(a).closest("form").find("#"+a.id+"-end-display")},findEndPlaceholderDisplay:function(a){return d(a).closest("form").find("#"+a.id+"-end-placeholder")},findSummaryDisplay:function(a){return d(a).closest("form").find("#"+a.id+"-summary-display")},findClearDisplay:function(a){return d(a).closest("form").find("#"+a.id+"-clear")},findCloseLink:function(a){return d(a).closest("form").find("#"+a.id+" .r9-datepicker-title-close")[0]},findStartInput:function(a){return d(a).closest("form").find("#"+
a.id+" .r9-datepicker-input.r9-datepicker-start")[0]},findEndInput:function(a){return d(a).closest("form").find("#"+a.id+" .r9-datepicker-input.r9-datepicker-end")[0]},findTabInput:function(a){return d(a).closest("form").find("#"+a.id+"-tab")},getDropdownId:function(a){return"datepicker"},getDropdownEl:function(a){return jq(a).find("#datepicker")}});R9.extend("Widgets.DaterangePicker.prototype",!0,R9.Widgets.BaseCalendarWidget.prototype,{widgetName:"datepicker",widgetId:"datepicker",widgetBaseClass:"r9-datepicker",
accessibilityBreakpoint:768,elementNode:null,element:null,startSection:null,startDisplay:null,startPlaceholderDisplay:null,endSection:null,endDisplay:null,endPlaceholderDisplay:null,summaryDisplay:null,clearDisplay:null,closeLink:null,startInput:null,endInput:null,tabInput:null,clicks:[],timers:null,hideTimeoutValue:100,unitFormat:null,unitAdjustment:0,preventBlur:!1,actOnStart:!0,buzzCall:!1,canShowCalendar:!0,canCloseCalendar:!0,options:{initAccessibility:!1,accessible:!0,appendTo:"body",dateItemsSelector:"span.r9-datepicker-item",
shortDayNameLen:1,title:"Prev",prevTitle:"Prev",nextTitle:"Next",offsetWidth:0,titleMonthFormat:"MMMM",titleYearFormat:"YYYY",startFormat:"ddd MMM D",startInputFormat:"YYYY/M/D",endFormat:"ddd MMM D",endInputFormat:"YYYY/M/D",nightsFormat:"0#same day|1#{0} night|2#{0} nights",daysFormat:"0#same day|1#{0} day|2#{0} days",useDaysFormat:!1,secondClickHideDelay:200,minRangeDays:0,change:null,show:null,hide:null,minDateFunc:null,focusAfterClick:!0,allowPastDate:!1,widgetId:null,useLongDisplayFormat:!1,
singlePickerWithSingleField:!1,showBuzzGraph:!1,originControl:!1,destControl:!1,isOneWay:!1,skipForceSetDefaultStartOnFocusBlur:!1,skipForceSetDefaultEndOnFocusBlur:!1,doNotFillWhenEmpty:!1,datepickerWrapperSelector:".r9-datepicker-wrapper",handleNegativeSummary:!0,delayShowDropdown:null,showDropdownDelay:200},getWidgetId:function(){this.options&&this.options.widgetId&&(this.widgetId=this.options.widgetId);return this.widgetId},getDropdownId:function(a){return this.options&&this.options.widgetId?
this.options.widgetId:R9.Widgets.DaterangePicker.getDropdownId(a)},getDropdownEl:function(a){return this.options&&this.options.widgetId?jq(a).find("#"+this.options.widgetId):R9.Widgets.DaterangePicker.getDropdownEl(a)},isAccessibilityEnabled:function(){return this.options.initAccessibility},init:function(){this.options.useDaysFormat?(this.unitFormat=this.options.daysFormat,this.unitAdjustment=1):(this.unitFormat=this.options.nightsFormat,this.unitAdjustment=0);this.options.useLongDisplayFormat&&(this.options.startFormat=
this.options.startInputFormat,this.options.endFormat=this.options.endInputFormat);this.advanceStyling&&(this.options.skipForceSetDefaultStartOnFocusBlur=!0,this.options.skipForceSetDefaultEndOnFocusBlur=!0,this.options.doNotFillWhenEmpty=!0);this.options.offsetWidth=2;this.initDropdown();this.timers={};this.bindEvent(this.tabInput,"focus",this.handleInputFocusEvent);this.bindEvent(this.tabInput,"blur",this.handleInputBlurEvent);this.bindEvent(this.tabInput,"keydown",this.handleInputKeydownEvent);
this.bindEvent(this.element,"mousedown",this.handleElementClickEvent);this.endStartIsSameField()||this.bindEvent(this.endSection,"mousedown",this.handleEndClickEvent);this.bindEvent(this.startSection,"mousedown",this.handleStartClickEvent);this.bindEvent(this.clearDisplay,"mousedown",this.handleClearClickEvent);this.bindEvent(this.closeLink,"mousedown",this.handleClearClickEvent);this.bindEvent(this.dropdown,"mousedown",this.handleDropdownClickEvent);this.bindEvent(this.overlay,"mousedown",this.handleItemClickEvent);
this.element.data(this.widgetName,this);this.update();var a=this.element.find(".r9-datepicker-display");void 0!==a&&1<a.length||(this.element.off("mousedown focus").on("mousedown focus",function(a){a.preventDefault();a.stopPropagation();jq(this).find(".r9-datepicker-display").focus();jq("body").trigger("event",[a])}),this.bindCommandUtilities(),this.start_custom_value=this.end_custom_value="",this.utils=this.options.commands.utilities,this.today=moment().startOf("day").toDate(),this.bindAccessibilityEvents(),
this.updateClicks(),this.updateDOM())},validateElement:function(){return R9.Widgets.DaterangePicker.isDatepicker(this.elementNode)&&R9.Widgets.DaterangePicker.isWidgetControlled(this.elementNode)&&void 0===this.element.data(this.widgetName)},bindEvent:function(a,b,e){var c=this;b+="."+this.getWidgetId();a.off(b).on(b,function(a){return e.call(c,this,a)})},bindCommandUtilities:function(){var a=this;this.options.commands={keys:{TAB:9,ENTER:13,UP:38,DOWN:40,LEFT:37,RIGHT:39,DOLLAR:52,CARAT:54,ESC:27},
utilities:{changeCalendar:function(b,e){e=e||1;var c=a.dropdown.find(".r9-datepicker-switch-month.r9-datepicker-enabled"),c="prev"===b?c.first():c.last();for(b=Math.abs(e);0<b;b--)a.handleNextPrevClickEvent(c);return a},isCharacterKeyPress:function(b){var e=a.options.commands.keys;return"undefined"==typeof b.which?!0:"number"==typeof b.which&&0<b.which?!b.ctrlKey&&!b.metaKey&&!b.altKey&&b.keyCode!=e.TAB&&b.keyCode!=e.ENTER&&16!=b.keyCode&&b.keyCode!=e.UP&&b.keyCode!=e.DOWN&&b.keyCode!=e.LEFT&&b.keyCode!=
e.RIGHT:!1},getRowInfo:function(b){b=a.dropdown.find(".r9-datepicker-item-"+b);var e=b.parent().children().not(".r9-datepicker-disabled");return{len:e.length-1,index:e.index(b)}},isValidDateObject:function(a){return a instanceof Date?!isNaN(a.getTime()):this.isValidDate(new Date(a))},isValidDatePair:function(a,e){return moment(a).isBefore(moment(e))},isValidDate:function(b){return this.isValidDateObject(b)&&(this.isValidDatePair(moment().subtract(1,"d"),moment(b))||a.isPastDateAllowed())},applyEndVal:function(){if(""!==
a.end_custom_value&&moment(a.end_custom_value,a.options.endInputFormat).isValid()){var b=this.formatLocaleDate(a.end_custom_value,a.options.endInputFormat);if(b&&this.isValidDate(b)){var e=a.getStartDate()||a.today;this.isValidDatePair(e,b)&&a.setEndDate(b);a.fetchBuzzData();a.options.change&&a.options.change.call(a);a.end_custom_value=""}}},applyStartVal:function(){if(""!==a.start_custom_value&&moment(a.start_custom_value,a.options.startInputFormat).isValid()){var b=this.formatLocaleDate(a.start_custom_value,
a.options.startInputFormat);if(b&&this.isValidDate(b)){a.setStartDate(b);var e=a.getEndDate()||a.today;this.isValidDatePair(b,e)||a.setEndDate(b);a.start_custom_value="";a.fetchBuzzData();a.options.change&&a.options.change.call(a)}}},validate:function(b){b=b||moment().startOf("day").toDate();return!a.isPastDateAllowed()&&b.getTime()<=a.today.getTime()?a.today:b},formatLocaleDate:function(b,e){e=e||a.options.startInputFormat;try{var c=b.split(/\D+/g)[2];4!==c.length&&(b=b.substr(0,b.length-2)+"20"+
c);return moment(b,e).toDate()}catch(f){return new Date}},incrementDay:function(b,e,c){c=c||jq.noop;b=moment(b).add(e||1,"days");c.call(a,this.validate(b.toDate()));return b},decrementDay:function(b,e,c){c=c||jq.noop;b=moment(b).subtract(e||1,"days");c.call(a,this.validate(b.toDate()));return b},dateDiff:function(a,e){return(a.getTime()-e.getTime())/864E5}}};this.utils=this.options.commands.utilities;return this},bindAccessibilityEvents:function(){var a=this;this.options.accessible="true"===jq(this.startDisplay).attr("contenteditable");
jq(this.startDisplay).attr("aria-label")||jq(this.startDisplay).attr({"aria-label":this.options.startLabel||"Start Date"});jq(this.endDisplay).attr("aria-label")||jq(this.endDisplay).attr({"aria-label":this.options.endLabel||"End Date"});this.clickTarget=this.blurTarget=null;jq(document).mousedown(function(b){a.clickTarget=jq(b.target);a.isDropdownVisible()&&jq(a.blurTarget).blur()}).mouseup(function(b){a.clickTarget=null});this.endStartIsSameField()||(this.bindEvent(this.endDisplay,"focus",this.handleEndDisplayFocusEvent),
this.bindEvent(this.endDisplay,"blur",this.handleEndDisplayBlurEvent),this.bindEvent(this.endDisplay,"keydown",this.handleEndDisplayKeydownEvent),this.bindEvent(this.endDisplay,"keyup",this.handleEndDisplayKeyupEvent));this.bindEvent(this.startDisplay,"focus",this.handleStartDisplayFocusEvent);this.bindEvent(this.startDisplay,"blur",this.handleStartDisplayBlurEvent);this.bindEvent(this.startDisplay,"keydown",this.handleStartDisplayKeydownEvent);this.bindEvent(this.startDisplay,"keyup",this.handleStartDisplayKeyupEvent);
this.isAccessibilityEnabled()&&(this.bindEvent(jq(document),"keypress",this.handleItemKeypressEvent),this.bindEvent(jq(document),"click",this.handleOutsideClickEvent))},handleClearClickEvent:function(a,b){this.clearDaterange();b.stopPropagation();this.fetchBuzzData();this.options.change&&this.options.change.apply(this,arguments);jq("body").trigger("event",[b]);return!this.element.hasClass("r9-datepicker-focus")},handleElementClickEvent:function(a,b){return this.isDropdownVisible()?this.handleClickEvent(a,
b,this.actOnStart):this.handleStartClickEvent(a,b)},handleStartClickEvent:function(a,b){return this.handleClickEvent(a,b,!0)},handleEndClickEvent:function(a,b){return this.handleClickEvent(a,b,!1)},handleClickEvent:function(a,b,e){this.actOnStart=e;var c=this.getWrapperElement(),f=this;!this.isDropdownVisible()&&this.options.focusAfterClick?setTimeout(function(){f.isDropdownVisible()||c.find(".r9-datepicker-tab").focus()},1):(this.markDropdownElements(),this.preventBlur=!0);b.stopPropagation();jq("body").trigger("event",
[b]);return!0},getWrapperElement:function(){return this.element},getStartWrapperElement:function(){return this.element},getEndWrapperElement:function(){return this.element},handleDropdownClickEvent:function(a,b){return!1},handleInputKeydownEvent:function(a,b){if(!a.disabled){var e=b.keyCode?b.keyCode:b.which,c=jq(a).parent();switch(e){case 9:return!0;case 27:this.isDropdownVisible()&&this.hideDropdown(c);break;case 32:this.isDropdownVisible()?this.hideDropdown(c):(this.actOnStart=!0,this.showDropdown(c));
break;case 8:this.clearDaterange(),this.fetchBuzzData(),this.options.change&&this.options.change.apply(this,arguments)}return!1}},handleInputFocusEvent:function(a,b){if(!a.disabled){this.preventBlur=!1;var e=jq(a).parent();this.addFocusClass(e);this.isDropdownVisible()||this.showDropdown(e);this.options.focus&&this.options.focus.apply(this,arguments)}},handleInputBlurEvent:function(a,b){if(this.preventBlur)return this.preventBlur=!1,setTimeout(function(){a.focus()},1),!1;if(a.disabled)return!0;this.hideDropdown(jq(a).parent());
this.options.blur&&this.options.blur.apply(this,arguments);return!0},handleItemHoverEvent:function(a,b){a=jq(a);a.hasClass("r9-datepicker-enabled")&&this.updateDropdownSelection(a);jq(".r9-datepicker-buzz-day[data-val\x3d%s]".format(a.attr("data-val"))).addClass("hover");return!1},handleItemHoverEndEvent:function(a,b){this.updateDropdownSelection(null);jq(".r9-datepicker-buzz-day[data-val\x3d%s]".format(jq(a).attr("data-val"))).removeClass("hover");return!1},handleItemKeypressEvent:function(a,b){if(13===
b.which&&jq(b.target).is(this.options.dateItemsSelector))return a=jq(b.target).closest(this.options.dateItemsSelector),b.stopPropagation(),b.preventDefault(),b.cancelBubble=!0,this.clickTarget=a,this.handleItemClickEvent(a,b),!1;if(13===b.which&&jq(b.target).is(".r9-datepicker-switch-month.r9-datepicker-enabled"))return a=jq(b.target).closest(".r9-datepicker-switch-month.r9-datepicker-enabled"),b.stopPropagation(),b.preventDefault(),b.cancelBubble=!0,this.clickTarget=a,this.handleNextPrevClickEvent(a,
b),!1},handleOutsideClickEvent:function(a,b){this.clickTarget=d(b.target);this.isDropdownVisible()&&!this.clickTarget.closest(".r9-datepicker, .r9-datepicker-wrapper").length&&(this.clickTarget=null,b.stopPropagation(),this.hideDropdown())},focusSelectedDay:function(a){var b=this;this.isAccessibilityEnabled()&&a&&a.length&&(this.clickTarget=null,this.dropdown.attr("tabindex",-1),this.dropdown.removeClass("r9-calendar-no-outline").addClass("r9-calendar-no-outline"),this.setTabIndexes(this.dropdown.find(".r9-datepicker-switch-month.r9-datepicker-enabled, .r9-datepicker-item.r9-datepicker-enabled")),
this.timers.focusTimeout&&clearTimeout(this.timers.focusTimeout),b.setCanClose(!1),this.timers.focusTimeout=window.setTimeout(function(){var e=b.isEndWrapper(a)?b.dropdown.find(".r9-datepicker-item-end"):b.dropdown.find(".r9-datepicker-item-start");e.length||(e=b.dropdown.find(".r9-datepicker-item.r9-datepicker-enabled").first()||null);e&&e.length&&e.focus();b.timers.setCanClose&&clearTimeout(b.timers.setCanClose);b.timers.setCanClose=setTimeout(function(){b.setCanClose(!0)},200)},300))},isEndWrapper:function(a){return a&&
this.isEndWrapperId(a.attr("id"))},isEndWrapperId:function(a){return a&&"travel_dates-end-wrapper"==a},setTabIndexes:function(a){(a=jq(a))&&0!==a.length&&a.each(function(){jq(this).attr("tabindex","0")})},focusDisplay:function(a){var b=this;if(this.isAccessibilityEnabled()){var e=jq("#"+a);e&&0!==e.length&&(this.timers.focusDisplayTimeout&&clearTimeout(this.timers.focusDisplayTimeout),!this.isDropdownVisible()&&this.clickTarget&&this.clickTarget.closest(".r9-datepicker").length&&(this.clickTarget=
null,this.addFocusClass(e),this.setCanShow(!1),this.setCanClose(!1),this.timers.focusDisplayTimeout=window.setTimeout(function(){e.find(".r9-datepicker-tab").focus();b.timers.setCanShow&&clearTimeout(b.timers.setCanShow);b.timers.setCanShow=setTimeout(function(){b.setCanShow(!0);b.setCanClose(!0)},200)},1)))}},canShow:function(){return!this.isAccessibilityEnabled()||this.canShowCalendar},setCanShow:function(a){this.canShowCalendar=a},canClose:function(){return!this.isAccessibilityEnabled()||this.canCloseCalendar},
setCanClose:function(a){this.canCloseCalendar=a},clearFocusClass:function(){this.removeFocusClass(jq(".r9-datepicker-focus"))},removeFocusClass:function(a){a.removeClass("r9-datepicker-focus")},addFocusClass:function(a){this.clearFocusClass();a.addClass("r9-datepicker-focus")},handleItemClickEvent:function(a,b){if(!0===this.isBeforeStart(a)&&!1===this.actOnStart)return this.preventBlur=!0,b.preventDefault(),this;var e=this,c=jq(a),f,d;if(c.hasClass("r9-datepicker-enabled")){f=parseInt(c.attr("data-val"));
var h=this.actOnStart;d=h?1:0;this.clicks[h?0:1]=f;this.clicks[0]&&this.clicks[1]&&(c=moment(this.clicks[1]).diff(this.clicks[0],"days"),c<this.options.minRangeDays&&(this.clicks[d]=0));this.updateDropdownSelection(null);this.clicks[0]&&this.clicks[1]?setTimeout(function(){e.hideDropdown(e.element);e.options.change&&e.options.change.apply(e,[f,h]);e.options.nextFieldSelector&&jq(e.options.nextFieldSelector).focus()},this.options.secondClickHideDelay):this.switchActOn()}this.updateDOM();jq(a).trigger("daterangepicker.itemclicked");
jq("body").trigger("event",[b]);return!1},switchActOn:function(){this.actOnStart=!this.actOnStart;this.markDropdownElements()},computeHighlitedRange:function(a){var b=[this.clicks[0],this.clicks[1]];return b[0]&&b[1]?b:0==a?[0,0]:this.actOnStart?[a,this.clicks[1]]:this.clicks[0]?[this.clicks[0],a]:[0,0]},computeItemState:function(a,b,e,c,f){var g=!1;this.advanceStyling||(a==b?this.actOnStart?(c.hover=!0,c.start=!0):(c.hover=!0,c.end=!0,c.highlighted=f&&f.highlighted):(c.beforeStart=a<this.clicks[0]&&
!this.actOnStart,a==this.clicks[0]?(c.start=!0,c.selected=!0):a==this.clicks[1]&&(c.selected=!0,c.end=!0,c.highlighted=f&&f.highlighted,f&&f.selected&&(c.tight=!0,g=f.tight=!0)),a>e[0]&&a<e[1]&&(c.highlighted=!0,f&&f.start&&(g=f.highlighted=!0))));this.advanceStyling&&(delete c.beforeStart,delete c.hover,a>e[0]&&a<e[1]&&(c.highlighted=!0),a===this.clicks[0]&&(c.start=!0,c.selected=!0),a===this.clicks[1]&&(c.selected=!0,c.end=!0),0<b&&(e=this.getStateStartPoint(b),(this.actOnStart&&e===this.clicks[0]||
!this.actOnStart&&e===this.clicks[1])&&e&&(f=Math.max(e,b),a>Math.min(e,b)&&a<f&&(c.tempHighlight=!0))));return g},getStateStartPoint:function(a){var b=[],e=!0,c=!0,f=this.clicks[0];0<f&&(e=e&&f<a,c=c&&f>a,b.push(f));f=this.clicks[1];0<f&&(e=e&&f<a,c=c&&f>a,b.push(f));a=e?Math.max.apply(null,b):Math.min.apply(null,b);e=!(!1===c&&!1===e);return isFinite(a)?e?a:0:null},updateItem:function(a,b){var e,c;e=[];c=[];b.highlighted?e.push("r9-datepicker-item-highlighted"):c.push("r9-datepicker-item-highlighted");
b.hover?e.push("r9-datepicker-item-hover"):c.push("r9-datepicker-item-hover");b.selected?(e.push("r9-datepicker-item-selected"),a.attr("aria-selected",!0)):(c.push("r9-datepicker-item-selected"),a.attr("aria-selected",!1));b.start?e.push("r9-datepicker-item-start"):c.push("r9-datepicker-item-start");b.beforeStart?e.push("r9-datepicker-before-start"):c.push("r9-datepicker-before-start");b.end?e.push("r9-datepicker-item-end"):c.push("r9-datepicker-item-end");b.tight?e.push("r9-datepicker-item-tight"):
c.push("r9-datepicker-item-tight");this.advanceStyling&&(b.tempHighlight?e.push("r9-datepicker-item-tempHighlight"):c.push("r9-datepicker-item-tempHighlight"));a.removeClass(c.join(" "));a.addClass(e.join(" "))},updateDropdownSelection:function(a){if(!this.advanceStyling&&!0===this.isBeforeStart(a)&&!1===this.actOnStart)return this;var b=this,c=[0,0],g=null,f=null,d=this.dropdown.find(this.options.dateItemsSelector),h=0;a&&(h=parseInt(jq(a).attr("data-val")));c=this.computeHighlitedRange(h);d.each(function(a,
e){e=jq(e);a=parseInt(e.attr("data-val"));var d={};b.computeItemState(a,h,c,d,f)&&b.updateItem(g,f);b.updateItem(e,d);g=e;f=d});this.updateHoverDOM(a)},clearDaterange:function(a){"undefined"!=typeof a?this.clicks[a]=0:this.clicks=[0,0];this.isDropdownVisible()&&this.updateDropdownSelection();this.updateDOM()},updateHoverDOM:function(a){var b,c,d,f;c=this.clicks[0];d=this.clicks[1];a&&(b=parseInt(a.attr("data-val")),this.actOnStart?c=b:d=b);c?(f=moment(c),this.startDisplay.text(f.format(this.options.startFormat)),
this.getStartWrapperElement().removeClass("r9-datepicker-start-empty")):this.getStartWrapperElement().addClass("r9-datepicker-start-empty");d?(b=moment(d),this.endDisplay.text(b.format(this.options.endFormat)),this.summaryDisplay&&(f=b.diff(f,"days"),(b=this.options.handleNegativeSummary&&0>f)&&a&&this.actOnStart?(this.endDisplay.text(this.endPlaceholderDisplay.text()),this.summaryDisplay.text("")):b||this.summaryDisplay.text(R9.Common.Utils.String.formatChoice(this.unitFormat,f+this.unitAdjustment,
f+this.unitAdjustment))),this.getEndWrapperElement().removeClass("r9-datepicker-end-empty")):this.getEndWrapperElement().addClass("r9-datepicker-end-empty")},updateDOM:function(){var a,b,c;if(0!=this.clicks[0]){if(a=moment(this.clicks[0]),this.startDisplay.text(a.format(this.options.startFormat)),this.startInput.val(a.format(this.options.startInputFormat)),this.wholeMonthSearch){var d,f;"wholeMonthSearch"==("undefined"!==typeof R9.storage.get("daterangePickerDefaultNavTab")?R9.storage.get("daterangePickerDefaultNavTab"):
"specificDate")&&jq(".searchform.rtow").hasClass("roundtrip")&&("undefined"!==typeof R9.storage&&(null===R9.storage.get("flexSelectedMonth")&&R9.storage.set("flexSelectedMonth",moment(this.clicks[0]).format("M")),null===R9.storage.get("flexSelectedYear")&&R9.storage.set("flexSelectedYear",moment(this.clicks[0]).format("Y")),null===R9.storage.get("flexNoOfNights")&&R9.storage.set("flexNoOfNights","6-8"),d=R9.storage.get("flexSelectedMonth"),f=R9.storage.get("flexSelectedYear"),c=R9.storage.get("flexNoOfNights")),
a=moment(new Date(f,d-1,1)),a.isBefore(moment())&&(a=moment().add(1,"d")),d="string"===typeof c?c.replace("-"," to "):c,c=1==c?"night":"nights",this.startDisplay.text(a.format("MMMM")+" "+a.format("Y")+", "+d+" "+c),this.startInput.val(a.format(this.options.startInputFormat)))}}else this.startDisplay.text(""),this.startInput.val("");this.endStartIsSameField()||(0!=this.clicks[1]?(b=moment(this.clicks[1]),this.endDisplay.text(b.format(this.options.endFormat)),this.endInput.val(b.format(this.options.endInputFormat))):
(this.endDisplay.text(""),this.endInput.val("")));this.summaryDisplay&&(null!=a&&null!=b?(c=b.diff(a,"days"),this.summaryDisplay.text(R9.Common.Utils.String.formatChoice(this.unitFormat,c+this.unitAdjustment,c+this.unitAdjustment))):this.summaryDisplay.text(""));null==a?this.getStartWrapperElement().addClass("r9-datepicker-start-empty"):this.getStartWrapperElement().removeClass("r9-datepicker-start-empty");this.endStartIsSameField()||(null==b?this.getEndWrapperElement().addClass("r9-datepicker-end-empty"):
this.getEndWrapperElement().removeClass("r9-datepicker-end-empty"))},endStartIsSameField:function(){var a=this.getStartWrapperElement().get(0).id,b=this.getEndWrapperElement().get(0).id;return a===b&&!0===this.options.singlePickerWithSingleField},updateClicks:function(){this.clicks=[0,0];var a;this.startInput.val()&&(a=moment(this.startInput.val(),this.options.startInputFormat),null!=a&&a.isValid()&&(this.clicks[0]=a.valueOf()));this.endInput.val()&&(a=moment(this.endInput.val(),this.options.endInputFormat),
null!=a&&a.isValid()&&(this.clicks[1]=a.valueOf()))},handleNextPrevClickEvent:function(a,b){a=moment(parseInt(jq(a).attr("data-val")));this.dropdown[0].innerHTML=this.makeCalendarHTML(a);this.runBelowCalendarCallback();this.options.showBuzzGraph&&(this.bindBuzzGraphEvents(),this.displayBuzzGraph());this.updateDropdownSelection(null);this.loadBuzzData&&this.displayBuzzData();this.focusSelectedDay(jq("#"+this.dropdown.prop("data-owner")));return!1},bindItemEvent:function(a,b){var c=this;this.dropdown.off(a,
this.options.dateItemsSelector).on(a,this.options.dateItemsSelector,function(a){return b.call(c,this,a)})},bindOverlayEvent:function(a,b){var c=this;this.overlay.off(a).on(a,function(a){return b.call(c,this,a)})},bindNextPrevEvent:function(a,b){var c=this;this.dropdown.off(a,".r9-datepicker-switch-month.r9-datepicker-enabled").on(a,".r9-datepicker-switch-month.r9-datepicker-enabled",function(a){return b.call(c,this,a)})},bindCloseEvent:function(a,b){var c=this;this.dropdown.off(a,".r9-datepicker-close").on(a,
".r9-datepicker-close",function(a){return b.call(c,this,a)})},initDropdown:function(){var a=this.getDropdownId(this.element),b=this.getDropdownEl(this.element).get(0);if(null==b){var c=R9.Widgets.DaterangePicker.prototype.widgetBaseClass;this.options.dropdownClass&&(c=c+" "+this.options.dropdownClass);b=jq("\x3cdiv\x3e\x3c/div\x3e",{id:a,css:{display:"none",position:"absolute",zIndex:10009}}).appendTo(this.options.appendTo)[0];jq(b).addClass(c);this.advanceStyling&&jq(b).addClass("r9-advance-styling");
this.wholeMonthSearch&&jq(b).addClass("CalendarWidget-WholeMonthSearch")}this.dropdown=jq(b);this.overlay=jq("#"+this.widgetBaseClass+"-overlay");this.overlay.length||(this.overlay=jq('\x3cdiv id\x3d"'+this.widgetBaseClass+'-overlay" class\x3d"'+this.widgetBaseClass+'-overlay"\x3e\x3c/div\x3e').appendTo(this.options.appendTo))},debounceChangeFn:function(){this._debouncedChange&&this._debouncedChange.apply(this,arguments);this._debouncedChange=c(this.options.change||function(){},20);this._debouncedChange.apply(this,
arguments)},isDropdownVisible:function(){return"none"!=this.dropdown.css("display")},markDropdownElements:function(){this.unmarkDropdownElements();this.element.addClass("r9-datepicker-dropdown");this.actOnStart?this.element.addClass("r9-datepicker-dropdown-start"):this.element.addClass("r9-datepicker-dropdown-end")},unmarkDropdownElements:function(){this.element.removeClass("r9-datepicker-dropdown r9-datepicker-dropdown-start r9-datepicker-dropdown-end")},positionDropdown:function(a){var b=a.offset(),
c=jq(this.options.appendTo).offset(),d=0,f=this.dropdown[0].style;this.dropdown.parent()[0]===jq(document.body)[0]&&(d=parseInt((jq(document.body).css("top")||"0").replace("-",""))||0);jq("#datepicker").removeClass("r9-datepicker-responsive-right-position");if(606>jq(window).width()&&jq(".fdSearchForm-hotel").length&&jq("#travel_dates-end-wrapper").hasClass("r9-datepicker-focus")){jq("#datepicker").addClass("r9-datepicker-responsive-right-position");var k=b.left-c.left-144}else{var k=b.left-c.left,
h=k+this.dropdown.outerWidth();h>window.innerWidth&&(h-=window.innerWidth,k=k-h-15,this.dropdown.find(".r9-datepicker-pointer").css("left",h+36+"px"))}f.left=k+"px";f.top=d+b.top+a.outerHeight()-c.top+"px"},_hideDropdown:function(a){if("none"==this.dropdown.css("display")||null!=a&&this.dropdown.prop("data-owner")!=a.attr("id"))return!1;this.clearFocusClass();this.options.hide&&this.options.hide.apply(this,arguments);this.hideOverlay();this.preventBlur=!1;this.updateDOM();this.unmarkDropdownElements();
this.dropdown.hide();this.actOnStart=!0;this.focusDisplay(this.dropdown.prop("data-owner"));jq(window).unbind("resize",this.resizeHandler);return!0},hideDropdown:function(a){var b=this;if(!this.canClose())return!1;this.clearFocusClass();if("none"==this.dropdown.css("display")||null!=a&&this.dropdown.prop("data-owner")!=a.attr("id")||this.preventBlur)return this.preventBlur=!1;this.options.hide&&this.options.hide.apply(this,arguments);this.preventBlur=!1;this.updateDOM();this.unmarkDropdownElements();
this.actOnStart=!0;this.timers.hideTimeout&&clearTimeout(this.timers.hideTimeout);this.timers.hideTimeout=setTimeout(function(){b._hideDropdown.call(b,a)},this.hideTimeoutValue)},hideMultipleDropdowns:function(){this.options.datepickerWrapperSelector&&jq(this.options.datepickerWrapperSelector).not(this.getStartWrapperElement()).not(this.getEndWrapperElement()).each(function(a,b){jq(b).daterangePickerTwoFields("hideDropdown")})},showDropdown:function(a){this.timers.hideTimeout&&clearTimeout(this.timers.hideTimeout);
if("function"===typeof this.options.delayShowDropdown&&this.options.delayShowDropdown()&&!this.showDropdownTimeout)this.showDropdownTimeout=setTimeout(this.showDropdown.bind(this,a),this.options.showDropdownDelay);else if(null!==this.showDropdownTimeout&&(clearTimeout(this.showDropdownTimeout),this.showDropdownTimeout=null),this.canShow()){this.options.show&&this.options.show.apply(this,arguments);this.hideMultipleDropdowns();this.showOverlay();this.markDropdownElements();this.updateClicks();"function"===
typeof this.options.minDateFunc&&this.options.minDateFunc(this);this.dropdown[0].innerHTML=this.makeCalendarHTML(!this.actOnStart&&this.clicks[1]?this.clicks[1]:this.clicks[0]);this.updateDropdownSelection(null);var b=R9.Widgets.DaterangePicker.prototype.widgetBaseClass;this.options.dropdownClass&&(b=b+" "+this.options.dropdownClass);this.addFocusClass(a);this.dropdown.addClass(b);b=this.dropdown[0].style;this.runBelowCalendarCallback();this.positionDropdown(a);var c=this,d=jq(window).width();this.resizeHandler=
function(){var b=jq(window).width();10<Math.abs(b-d)&&(d=b,c.positionDropdown(a))};jq(window).on("resize",this.resizeHandler);this.bindItemEvent("mousedown",this.handleItemClickEvent);if(R9.globals.isTouch){var f=this;this.bindOverlayEvent("mousedown",function(){f.hideDropdown(f.element)})}else this.bindItemEvent("mouseover",this.handleItemHoverEvent),this.bindItemEvent("mouseout",this.handleItemHoverEndEvent);this.options.showBuzzGraph&&(this.bindBuzzGraphEvents(),this.displayBuzzGraph());this.bindNextPrevEvent("mousedown",
this.handleNextPrevClickEvent);this.bindCloseEvent("mousedown",function(){c.hideDropdown(c.element)});this.dropdown.prop("data-owner",a.attr("id"));this.loadBuzzData&&this.displayBuzzData();b.display="inline";this.focusSelectedDay(a)}},showOverlay:function(){this.overlay.show()},displayBuzzData:function(){"function"===typeof this.options.getFormData&&(new R9.DatePicker.BuzzData).update(this.dropdown,this.options.getFormData(this.actOnStart))},hideOverlay:function(){this.overlay.hide()},getStartDate:function(){this.updateClicks();
return 0!=this.clicks[0]?new Date(this.clicks[0]):null},getEndDate:function(){this.updateClicks();return 0!=this.clicks[1]?new Date(this.clicks[1]):null},parseDateString:function(a,b){try{return moment(a,b||this.options.startInputFormat)._d}catch(e){return""}},setFocusAfterClick:function(a){this.options.focusAfterClick=a},setStartDate:function(a){a?("string"===typeof a?a=this.parseDateString(a,this.options.startInputFormat):"number"===typeof a?a=new Date(a):"object"===typeof a?moment.isMoment(a)?
a.isValid()&&(a=a.toDate()):moment(a).isValid()&&(a="toDate"in a?a.toDate():a):a=new Date(0),void 0!=a.getTime&&(this.clicks[0]=a.getTime())):this.clicks[0]=0;this.updateDOM()},setEndDate:function(a){a?("string"===typeof a?a=this.parseDateString(a,this.options.endInputFormat):"number"===typeof a?a=new Date(a):"object"===typeof a?moment.isMoment(a)?a.isValid()&&(a=a.toDate()):moment(a).isValid()&&(a="toDate"in a?a.toDate():a):a=new Date(0),void 0!=a.getTime&&(this.clicks[1]=a.getTime())):this.clicks[1]=
0;this.updateDOM()},setUseDaysFormat:function(a){this.options.useDaysFormat=a;this.options.useDaysFormat?(this.unitFormat=this.options.daysFormat,this.unitAdjustment=1):(this.unitFormat=this.options.nightsFormat,this.unitAdjustment=0)},update:function(){this.updateClicks();this.updateDOM()},isBeforeStart:function(a){a instanceof jq&&(a=jq(a).attr("data-val"));return a&&null!==this.getStartDate()&&moment(parseInt(a)).isBefore(this.getStartDate())?!0:!1},decrementEndDay:function(a){var b=this.insideLastCalendar("end"),
c=this.getEndDate()||this.today,d=this.getStartDate()||this.today;a=this.utils.decrementDay(c,a);a.date()!==a.daysInMonth()||b||this.prevCalendar();d&&moment(c)>moment(d)&&this.setEndDate(a.toDate());this.fetchBuzzData();this.debounceChangeFn();this.updateDropdownSelection();return this.getEndDate()},decrementStartDay:function(a){var b=this.insideLastCalendar("start");a=this.utils.decrementDay(this.utils.validate(this.getStartDate()),a,this.setStartDate);a.date()!==a.daysInMonth()||b||this.prevCalendar();
this.fetchBuzzData();this.debounceChangeFn();this.updateDropdownSelection();return this.getEndDate()},incrementEndDay:function(a){var b=this.insideLastCalendar("end"),c=this.getEndDate();a=this.utils.incrementDay(c||this.today,a,this.setEndDate);1<=a.date()&&a.month()!==c.getMonth()&&b&&this.nextCalendar();this.fetchBuzzData();this.debounceChangeFn();this.updateDropdownSelection();return this.getEndDate()},incrementStartDay:function(a){var b=this.insideLastCalendar("start"),c=this.getStartDate()||
this.today,d=this.getEndDate();1===this.utils.incrementDay(c,a,this.setStartDate).date()&&b&&this.nextCalendar();(!d||moment(c)>=moment(d))&&this.setEndDate(this.getStartDate());this.fetchBuzzData();this.debounceChangeFn();this.updateDropdownSelection();return this.getStartDate()},handleStartDisplayFocusEvent:function(a,b){var c="",d=this.getStartWrapperElement(),f=this;this.markDropdownElements();this.addFocusClass(d);var k=jq(a);k.text()||!0!==this.options.skipForceSetDefaultStartOnFocusBlur&&this.setStartDate(this.today);
null!==(startdate=this.getStartDate())&&(c=jq(this.startInput).val()||moment(startdate).format(this.options.startInputFormat));this.actOnStart=!0;this.hideDropdown(this.getEndWrapperElement());this.showDropdown(d);this.options.accessible&&setTimeout(function(){k.text(c);f.selectDisplayBox(a)},1);b.stopPropagation();b.stopImmediatePropagation();jq("body").trigger("event",[b]);return this},handleStartDisplayBlurEvent:function(a,b){if(null!==this.clickTarget&&0<this.clickTarget.closest(".r9-datepicker").length)this.blurTarget=
a;else{var c=this.getStartWrapperElement(),d=this.getStartDate();this.hideDropdown(c);a=jq(a);""===a.text()&&!0===this.options.doNotFillWhenEmpty&&(this.setStartDate(null),this.options.change&&this.options.change.apply(this,arguments));""===a.text()&&null===d?!0!==this.options.skipForceSetDefaultStartOnFocusBlur&&this.setStartDate(this.today):""!==this.start_custom_value&&this.utils.applyStartVal();this.updateDropdownSelection();this.updateClicks();return this}},callNTimes:function(a,b){for(var c=
0;c<b;c++)a.call(this)},handleStartDisplayKeydownEvent:function(a,b){var c=b.keyCode||b.which,g=this.options.commands.keys,f=jq(this.endDisplay);a=jq(a);var k=0!==f.length&&!f.is(":hidden");if((c===g.TAB&&k||c===g.ENTER)&&!b.shiftKey){if(!1===f.is(":hidden")){var k=d(this.options.nextFieldAfterStartDateSelector),h=d(".gridCellFlexDepartPlusMinus").first();k.length?k.focus():0===h.length||!1===h.is(":visible")?(b.preventDefault(),b.stopPropagation(),setTimeout(function(){f.focus()},1)):0<h.length&&
h.find("select").focus()}if(c===g.ENTER&&f.is(":hidden"))return a.closest("form").find("[type\x3dsubmit]").trigger("click"),b.preventDefault(),b.stopPropagation(),!1;this.utils.applyStartVal();this.updateDropdownSelection();return!1}a=this.options.commands.keys;switch(c){case a.UP:this.callNTimes(this.decrementStartDay,7);b.preventDefault();b.stopPropagation();break;case a.RIGHT:this.incrementStartDay();b.preventDefault();b.stopPropagation();break;case a.LEFT:this.decrementStartDay();b.preventDefault();
b.stopPropagation();break;case a.DOWN:this.callNTimes(this.incrementStartDay,7);b.preventDefault();b.stopPropagation();break;case a.ESC:this.isDropdownVisible()&&this.hideDropdown(this.getStartWrapperElement())}this.vim(b,"start");jq("body").trigger("event",[b]);return this},handleEndDisplayFocusEvent:function(a,b){var c="",d=this.getEndWrapperElement(),f=this;f.markDropdownElements();this.addFocusClass(jq(d));var k=jq(a),h=f.clicks[0]||f.today.getTime();(!k.text()||f.clicks[1]<=h)&&!0!==this.options.skipForceSetDefaultEndOnFocusBlur&&
f.setEndDate(moment(h).toDate());null!==(enddate=f.getEndDate())&&(c=jq(f.endInput).val()||moment(enddate).format(f.options.endInputFormat));f.actOnStart=!1;f.showDropdown(d);f.options.accessible&&(jq(f.endDisplay).attr("contenteditable","true"),setTimeout(function(){k.text(c);f.selectDisplayBox(a)},1));b.stopPropagation();b.stopImmediatePropagation();jq("body").trigger("event",[b]);return this},handleEndDisplayBlurEvent:function(a,b){var c=this.getEndWrapperElement();this.options.accessible&&jq(this.endDisplay).attr("contenteditable",
"false");if(null!==this.clickTarget&&0<this.clickTarget.closest(".r9-datepicker").length)this.blurTarget=a;else return this.hideDropdown(c),a=jq(a),""===a.text()&&!0===this.options.doNotFillWhenEmpty&&(this.setEndDate(null),this.options.change&&this.options.change.apply(this,arguments)),""==a.text()&&null===this.getEndDate()?!0!==this.options.skipForceSetDefaultEndOnFocusBlur&&(null!==this.getStartDate()?this.setEndDate(moment(this.getStartDate()).add(1,"days")):this.setEndDate(moment().toDate())):
this.utils.applyEndVal(),this.updateDropdownSelection(),this},handleEndDisplayKeydownEvent:function(a,b){var c=b.keyCode||b.which;a=jq(a);a.text();var g=this.options.commands.keys;if(c===g.TAB&&!0===b.shiftKey){var f=d(this.options.nextFieldAfterStartDateSelector),k=d(".gridCellFlexDepartPlusMinus").first(),h=jq(this.startDisplay);f.length?setTimeout(function(){f.focus()}):k.is(":visible")?setTimeout(function(){k.children(".flexPlusMinusChoices").focus()}):!1===h.is(":hidden")&&(b.preventDefault(),
b.stopPropagation(),setTimeout(function(){h.focus()}))}else{if(c===g.ENTER)return this.utils.applyEndVal(),a.closest("form").find("[type\x3dsubmit]").trigger("click"),this.updateDropdownSelection(),b.preventDefault(),b.stopPropagation(),this.hideDropdown(this.getEndWrapperElement()),!1;a=this.options.commands.keys||{};switch(c){case a.UP:this.callNTimes(this.decrementEndDay,7);b.preventDefault();b.stopPropagation();break;case a.RIGHT:this.incrementEndDay();b.preventDefault();b.stopPropagation();break;
case a.LEFT:this.decrementEndDay();b.preventDefault();b.stopPropagation();break;case a.DOWN:this.callNTimes(this.incrementEndDay,7);b.preventDefault();b.stopPropagation();break;case a.ESC:this.isDropdownVisible()&&this.hideDropdown(this.getEndWrapperElement())}this.vim(b,"end")}jq("body").trigger("event",[b]);return this},handleStartDisplayKeyupEvent:function(a,b){this.utils.isCharacterKeyPress(b)&&(this.start_custom_value=jq(a).text());return this},handleEndDisplayKeyupEvent:function(a,b){this.utils.isCharacterKeyPress(b)&&
(this.end_custom_value=jq(a).text());return this},nextCalendar:function(a){return this.utils.changeCalendar("next",a)},prevCalendar:function(a){return this.utils.changeCalendar("prev",a)},selectDisplayBox:function(a){clearTimeout(this.timers.selectDisplayBox);this.timers.selectDisplayBox=window.setTimeout(function(){var b,c;window.getSelection&&document.createRange?(b=window.getSelection(),b.removeAllRanges(),c=document.createRange(),c.selectNodeContents(a),b.addRange(c)):document.body.createTextRange&&
(c=document.body.createTextRange(),c.moveToElementText(a),R9.Common.Utils.Browsers.isIE(8)||c.select())},1)},vim:function(a,b){var c=this.options.commands.keys||{};switch(a.keyCode||a.which){case c.DOLLAR:a.shiftKey&&(this.endOfLine(b),a.preventDefault());break;case c.CARAT:a.shiftKey&&(this.startOfLine(b),a.preventDefault())}return this},startOfLine:function(a){var b=this.utils.getRowInfo(a);"start"==a?this.decrementStartDay(b.index):this.decrementEndDay(b.index)},endOfLine:function(a){var b=this.utils.getRowInfo(a),
b=b.len-b.index;"start"==a?this.incrementStartDay(b):this.incrementEndDay(b)},bindBuzzGraphEvents:function(){var a=this;jq(".r9-datepicker-buzz-day").hover(function(){jq(".r9-datepicker-item[data-val\x3d%s]".format(jq(this).attr("data-val"))).addClass("r9-datepicker-item-hover");jq(".r9-datepicker-buzz-graph-footer \x3e div \x3e .detail").html(jq(this).children(".r9-datepicker-buzz-bar").attr("footertitle"))},function(){jq(".r9-datepicker-item[data-val\x3d%s]".format(jq(this).attr("data-val"))).removeClass("r9-datepicker-item-hover");
jq(".r9-datepicker-buzz-graph-footer \x3e div \x3e .detail").html("")});jq(".r9-datepicker-buzz-day").click(function(){var b=Number(jq(this).children(".r9-datepicker-buzz-bar").attr("dtstart"));if(a.actOnStart){var c=Number(jq(this).children(".r9-datepicker-buzz-bar").attr("dtend"));a.clearDaterange();a.setStartDate(b);a.options.isOneWay||a.setEndDate(c);a.updateDropdownSelection(null);a.options.isOneWay?(a.setEndDate(b),jq(".r9-datepicker-item[data-val\x3d%s]".format(jq(this).attr("data-val"))).mousedown(),
R9.Analytics.api.trackEvent("/flexgraph/oneway/click")):(a.endDisplay.focus(),R9.Analytics.api.trackEvent("/flexgraph/startdate/click"))}else a.setEndDate(b),jq(".r9-datepicker-item[data-val\x3d%s]".format(jq(this).attr("data-val"))).mousedown(),R9.Analytics.api.trackEvent("/flexgraph/enddate/click")})},fetchBuzzGraphData:function(){var a=this;jq("#flexgraphOK").size();var b="y"==jq("#onewaytrip").filter(":checked").val()||"y"==jq("#multi").filter(":checked").val();a.options.isOneWay=b;var c=a.getStartDate()||
a.today,d=a.getEndDate(),f=b?1:3;null==d||b||(f=Math.floor(a.utils.dateDiff(d,c)+1));var k=Number(jq(".r9-datepicker-month-first").find(".r9-datepicker-enabled:first").attr("data-val"));if(""==a.options.originControl.val()||""==a.options.destControl.val())jq(".r9-datepicker-buzz-graph-footer \x3e div").addClass("hidden"),jq(".r9-datepicker-buzz-graph-footer .noairports").removeClass("hidden");else if(a.actOnStart){var h=moment(k).format("YYYY-MM-DD");a.buzzCall&&a.buzzCall.abort();a.buzzCall=b?jq.ajax({type:"GET",
url:"/h/run/flexgraph",data:{q:"oneway",o:a.options.originControl.val().substr(0,3),d:a.options.destControl.val().substr(0,3),depart:h,daysout:70,duration:f,json:1},dataType:"json",success:function(b){try{responseObject=b,a.graphDataReadyCallback(responseObject,f,k,!0,c.getTime())}catch(l){}a.buzzCall=!1},error:function(b,c,e){a.buzzCall=!1},cache:!1}):jq.ajax({type:"GET",url:"/h/run/flexgraph",data:{q:"fixed",o:a.options.originControl.val().substr(0,3),d:a.options.destControl.val().substr(0,3),depart:h,
daysout:70,duration:f,json:1},dataType:"json",success:function(b){try{responseObject=b,a.graphDataReadyCallback(responseObject,f,k,!1,c.getTime())}catch(l){}a.buzzCall=!1},error:function(b,c,e){a.buzzCall=!1},cache:!1})}else{var h=moment(c.getTime()).format("YYYY-MM-DD"),n=(d||a.today).getTime();a.buzzCall&&a.buzzCall.abort();a.buzzCall=jq.ajax({type:"GET",url:"/h/run/flexgraph",data:{q:"start",o:a.options.originControl.val().substr(0,3),d:a.options.destControl.val().substr(0,3),depart:h,daysout:70,
json:1},dataType:"json",success:function(b){try{responseObject=b,a.graphDataReadyCallback(responseObject,f,c.getTime(),!1,n)}catch(l){}a.buzzCall=!1},error:function(b,c,e){a.buzzCall=!1},cache:!1})}},displayBuzzGraph:function(){this.fetchBuzzData(!0)},fetchBuzzData:function(a){this.options.showBuzzGraph&&a&&(jq(".r9-datepicker-buzz-day.r9-datepicker-enabled .r9-datepicker-buzz-bar").each(function(){jq(this).css("height","2px").attr("footertitle","")}),this.fetchBuzzGraphData())},graphDataReadyCallback:function(a,
b,c,d,f){this.actOnStart?d?(jq(".r9-datepicker-buzz-graph-footer \x3e div").addClass("hidden"),jq(".r9-datepicker-buzz-graph-footer .oneway").removeClass("hidden")):(jq(".r9-datepicker-buzz-graph-footer \x3e div").addClass("hidden"),jq(".r9-datepicker-buzz-graph-footer .duration #durationNumber").html(b),jq(".r9-datepicker-buzz-graph-footer .duration").removeClass("hidden")):(jq(".r9-datepicker-buzz-graph-footer \x3e div").addClass("hidden"),jq(".r9-datepicker-buzz-graph-footer .fixedstart #flexDepartDate").html(moment(c).format(this.options.startInputFormat)),
jq(".r9-datepicker-buzz-graph-footer .fixedstart").removeClass("hidden"));c=b=500;var e=0,g=0,n=0,m;for(m in a){n++;var l=Number(a[m].localPrice);l>b&&(b=l);l<c&&1<l&&(c=l,g=m);m==f&&(e=l)}if(0==n)jq(".r9-datepicker-buzz-graph").hide(),jq(".r9-datepicker-buzz-graph-footer").hide();else{n=0;for(m in a){var l=a[m].localPrice,r=a[m].localPriceAsString,w=a[m].departMilli,p=a[m].returnMilli,q=moment(a[m].departMilli).format(this.options.startInputFormat),u=moment(a[m].returnMilli).format(this.options.startInputFormat),
t=this.actOnStart?jq(".r9-datepicker-buzz-day[data-val\x3d'"+m+"']").find("div"):jq(".r9-datepicker-buzz-day[data-val\x3d'"+p+"']").find("div");1==t.size()&&(l=Math.floor(l/b*100),t.css("height",l+"%"),n++,d?t.attr("footertitle",q+" "+r):t.attr("footertitle",q+"-"+u+" "+r),this.actOnStart?t.attr("dtstart",w):t.attr("dtstart",p),t.attr("dtend",p),this.actOnStart?m==f&&(t.addClass("selected"),jq("#graphpricebar").css("bottom",l-1+"px").show(),jq("#graphprice").html(r).css("bottom",l-7+"px").show()):
p==f&&(t.addClass("selected"),jq("#graphpricebar").css("bottom",l-1+"px").show(),jq("#graphprice").html(r).css("bottom",l-7+"px").show()),m==g&&(0<e&&e>c&&c<.9*e?jq("#graphlowpricebar").css("bottom",l-1+"px").show():jq("#graphlowpricebar").hide()))}0==n?(jq(".r9-datepicker-buzz-graph").hide(),jq(".r9-datepicker-buzz-graph-footer").hide()):jq(".r9-datepicker-buzz-graph").is(":visible")||(jq(".r9-datepicker-buzz-graph").show(),jq(".r9-datepicker-buzz-graph-footer").show())}}})})(jq||jQuery);
(function(d){d.extend("Widgets.DaterangePicker.prototype.options",{prevTitle:"Prev",nextTitle:"Next",nightsFormat:"0#same day|1#1 night|2#{0} nights",daysFormat:"0#same day|1#1 day|2#{0} days",startInputFormat:"MM/DD/YYYY",endInputFormat:"MM/DD/YYYY",startFormat:"ddd M/D",endFormat:"ddd M/D"})})(window.R9);
(function(d){R9.extend("Widgets",{DaterangePickerTwoFields:function(c,a){R9.Widgets.BaseCalendarWidget.apply(this);this.endNode=c;this.endElement=d(this.endNode);this.startElement=jq(this.endElement).closest("form").find('[id$\x3d"start-wrapper"]');1!=this.startElement.length&&(this.startElement=jq("#"+this.endElement.attr("id").replace("end-wrapper","start-wrapper")));this.validateElement()&&(this.startDisplay=d(R9.Widgets.DaterangePickerTwoFields.findDisplay(this.startElement[0])),this.startClearDisplay=
d(R9.Widgets.DaterangePickerTwoFields.findClearDisplay(this.startElement[0])),this.startPlaceholderDisplay=d(R9.Widgets.DaterangePickerTwoFields.findPlaceholderDisplay(this.startElement[0])),this.startInputTab=d(R9.Widgets.DaterangePickerTwoFields.findInputTab(this.startElement[0])),this.startInput=d(R9.Widgets.DaterangePickerTwoFields.findInput(this.startElement[0])),this.endDisplay=d(R9.Widgets.DaterangePickerTwoFields.findDisplay(this.endElement[0])),this.endClearDisplay=d(R9.Widgets.DaterangePickerTwoFields.findClearDisplay(this.endElement[0])),
this.endPlaceholderDisplay=d(R9.Widgets.DaterangePickerTwoFields.findPlaceholderDisplay(this.endElement[0])),this.endInputTab=d(R9.Widgets.DaterangePickerTwoFields.findInputTab(this.endElement[0])),this.endInput=d(R9.Widgets.DaterangePickerTwoFields.findInput(this.endElement[0])),this.options=d.extend({},this.options,a),this.init())}});R9.extend("Widgets.DaterangePickerTwoFields",{isDatepicker:function(c){return c&&c.nodeName&&"div"==c.nodeName.toLowerCase()},isWidgetControlled:function(c){return d(c).hasClass(R9.Widgets.DaterangePicker.prototype.widgetBaseClass+
"-wrapper")},findDisplay:function(c){var a=d(c).closest("form").find("#"+c.id.replace("wrapper","display"))[0];a||(a=document.getElementById(c.id.replace("wrapper","display")));return a},findClearDisplay:function(c){var a=d(c).closest("form").find("#"+c.id.replace("wrapper","clear"))[0];a||(a=document.getElementById(c.id.replace("wrapper","clear")));return a},findPlaceholderDisplay:function(c){var a=d(c).closest("form").find("#"+c.id.replace("wrapper","placeholder"))[0];a||(a=document.getElementById(c.id.replace("wrapper",
"placeholder")));return a},findInputTab:function(c){var a=d(c).closest("form").find("#"+c.id.replace("wrapper","tab"))[0];a||(a=document.getElementById(c.id.replace("wrapper","tab")));return a},findInput:function(c){var a=jq(c).closest("form").find("#"+c.id+" .r9-datepicker-input")[0];a||(a=jq("#"+c.id+" .r9-datepicker-input")[0]);return a},getDropdownId:function(c){return"datepicker"}});R9.extend("Widgets.DaterangePickerTwoFields.prototype",!0,R9.Widgets.DaterangePicker.prototype,{endNode:null,startElement:null,
endElement:null,startDisplay:null,startClearDisplay:null,startPlaceholderDisplay:null,startInputTab:null,startInput:null,endDisplay:null,endClearDisplay:null,endPlaceholderDisplay:null,endInputTab:null,endInput:null,singleDateMode:!1,init:function(){this.advanceStyling&&(this.options.skipForceSetDefaultStartOnFocusBlur=!0,this.options.skipForceSetDefaultEndOnFocusBlur=!0,this.options.doNotFillWhenEmpty=!0);this.initDropdown();this.timers={};this.options.useLongDisplayFormat&&(this.options.startFormat=
this.options.startInputFormat,this.options.endFormat=this.options.endInputFormat);this.endStartIsSameField()||(this.bindEvent(this.endInputTab,"focus",this.handleEndInputFocusEvent),this.bindEvent(this.endInputTab,"blur",this.handleInputBlurEvent),this.bindEvent(this.endInputTab,"keydown",this.handleInputKeydownEvent),this.bindEvent(this.endElement,"mousedown",this.handleEndClickEvent),this.bindEvent(this.endClearDisplay,"mousedown",this.handleEndClearClickEvent));this.bindEvent(this.startInputTab,
"focus",this.handleStartInputFocusEvent);this.bindEvent(this.startInputTab,"blur",this.handleInputBlurEvent);this.bindEvent(this.startInputTab,"keydown",this.handleInputKeydownEvent);this.bindEvent(this.startElement,"mousedown",this.handleStartClickEvent);this.bindEvent(this.startClearDisplay,"mousedown",this.handleStartClearClickEvent);this.endElement.data(this.widgetName,this);jq(".r9-datepicker-wrapper").each(function(){var c=jq(this).find(".r9-datepicker-display");if(!(void 0!==c&&1<c.length))jq(this).off("mousedown focus").on("mousedown focus",
function(a){a.preventDefault();a.stopPropagation();jq("body").trigger("event",[a]);jq(this).find(".r9-datepicker-display").focus()})});this.bindCommandUtilities();this.start_custom_value=this.end_custom_value="";this.utils=this.options.commands.utilities;this.today=moment().startOf("day").toDate();this.bindAccessibilityEvents();this.updateClicks();this.updateDOM()},validateElement:function(){return R9.Widgets.DaterangePicker.isDatepicker(this.endNode)&&R9.Widgets.DaterangePicker.isWidgetControlled(this.endNode)&&
void 0===this.endElement.data(this.widgetName)},getWrapperElement:function(){return this.actOnStart?this.startElement:this.endElement},getStartWrapperElement:function(){return this.startElement},getEndWrapperElement:function(){return this.endElement},switchActOn:function(){var c=!this.actOnStart;this.hideDropdown(this.getWrapperElement());this.actOnStart=c;(this.actOnStart?this.startInputTab:this.endInputTab).focus()},markDropdownElements:function(){this.unmarkDropdownElements();this.actOnStart?this.startElement.addClass("r9-datepicker-dropdown r9-datepicker-dropdown-start"):
this.endElement.addClass("r9-datepicker-dropdown r9-datepicker-dropdown-end")},unmarkDropdownElements:function(){this.startElement.removeClass("r9-datepicker-dropdown r9-datepicker-dropdown-start");this.endElement.removeClass("r9-datepicker-dropdown r9-datepicker-dropdown-end")},setSingleDateMode:function(c,a){this.singleDateMode!=c&&(this.singleDateMode=c,a||this.updateDOM())},getSingleDateMode:function(){return this.singleDateMode},handleStartClearClickEvent:function(c,a){this.clearDaterange(0);
this.options.change&&this.options.change.apply(this,arguments);return!this.startElement.hasClass("r9-datepicker-focus")},handleEndClearClickEvent:function(c,a){this.clearDaterange(1);this.options.change&&this.options.change.apply(this,arguments);return!this.endElement.hasClass("r9-datepicker-focus")},handleStartInputFocusEvent:function(c,a){if(!c.disabled){this.preventBlur=!1;var b=this.getStartWrapperElement();b.addClass("r9-datepicker-focus");this.startDisplay.text()||this.setStartDate(this.today);
this.actOnStart=!0;this.showDropdown(b);this.options.focus&&this.options.focus.apply(this,arguments)}},handleEndInputFocusEvent:function(c,a){if(!c.disabled){this.preventBlur=!1;var b=this.getEndWrapperElement();b.addClass("r9-datepicker-focus");this.endDisplay.text()||this.setEndDate(moment(this.getStartDate()).toDate());this.actOnStart=!1;this.showDropdown(b);this.options.focus&&this.options.focus.apply(this,arguments)}},handleItemClickEvent:function(c,a){var b=this,e=jq(c);return this.singleDateMode?
(e.hasClass("r9-datepicker-enabled")&&(c=parseInt(e.attr("data-val")),this.clicks[0]=c,this.clicks[1]<this.clicks[0]&&(this.clicks[1]=this.clicks[0]),this.updateDropdownSelection(null),setTimeout(function(){b.hideDropdown(null);b.options.change&&b.options.change.apply(b,arguments);b.options.nextFieldSelector&&jq(b.options.nextFieldSelector).focus()},this.options.secondClickHideDelay)),this.updateDOM(),!1):R9.Widgets.DaterangePicker.prototype.handleItemClickEvent.call(this,c,a)},handleClickEvent:function(c,
a,b){return!0},updateItem:function(c,a){this.singleDateMode?(a.hover?c.addClass("r9-datepicker-item-hover"):c.removeClass("r9-datepicker-item-hover"),c.removeClass("r9-datepicker-item-selected"),c.removeClass("r9-datepicker-item-start"),a.selected&&!a.end?(c.addClass("r9-datepicker-item-selected"),c.attr("aria-selected",!0)):a.selected||c.attr("aria-selected",!1),a.start&&c.addClass("r9-datepicker-item-start")):R9.Widgets.DaterangePicker.prototype.updateItem.call(this,c,a)}})})(jq||jQuery);
(function(d){R9.extend("Widgets",{DaterangePickerFixed:function(c,a){this.elementNode=c;this.element=d(this.elementNode);this.validateElement()&&(this.startDisplay=d(R9.Widgets.DaterangePicker.findStartDisplay(this.elementNode)),this.sepDisplay=d(R9.Widgets.DaterangePicker.findSepDisplay(this.elementNode)),this.endDisplay=d(R9.Widgets.DaterangePicker.findEndDisplay(this.elementNode)),this.clearDisplay=d(R9.Widgets.DaterangePicker.findClearDisplay(this.elementNode)),this.nightsDisplay=d(R9.Widgets.DaterangePicker.findNightsDisplay(this.elementNode)),
this.placeholderDisplay=d(R9.Widgets.DaterangePicker.findPlaceholderDisplay(this.elementNode)),this.input=d(R9.Widgets.DaterangePicker.findInputNode(this.elementNode)),this.startInput=d(R9.Widgets.DaterangePicker.findStartInput(this.elementNode)),this.endInput=d(R9.Widgets.DaterangePicker.findEndInput(this.elementNode)),this.options=d.extend({},this.options,a),this.init())}});R9.extend("Widgets.DaterangePickerFixed",{isDatepicker:function(c){return c&&c.nodeName&&"div"==c.nodeName.toLowerCase()},
isWidgetControlled:function(c){return d(c).hasClass(R9.Widgets.DaterangePicker.prototype.widgetBaseClass+"-wrapper")},findStartDisplay:function(c){return document.getElementById(c.id+"-start")},findEndDisplay:function(c){return document.getElementById(c.id+"-end")},findSepDisplay:function(c){return document.getElementById(c.id+"-sep")},findClearDisplay:function(c){return document.getElementById(c.id+"-clear")},findNightsDisplay:function(c){return document.getElementById(c.id+"-nights")},findPlaceholderDisplay:function(c){return document.getElementById(c.id+
"-placeholder")},findStartInput:function(c){return jq("#"+c.id+" .r9-datepicker-input.r9-datepicker-start")[0]},findEndInput:function(c){return jq("#"+c.id+" .r9-datepicker-input.r9-datepicker-end")[0]},findInputNode:function(c){return document.getElementById(c.id+"-tab")},getDropdownId:function(c){return"datepicker"}});R9.extend("Widgets.DaterangePickerFixed.prototype",!0,R9.Widgets.DaterangePicker.prototype,{options:{rangeDays:34},handleItemClickEvent:function(c,a){var b=this;c=jq(c);c.hasClass("r9-datepicker-enabled")&&
(c=parseInt(c.attr("data-val")),this.clicks[0]=c,this.clicks[1]=moment(c).add(this.options.rangeDays,"days").valueOf(),this.updateDropdownSelection(null),setTimeout(function(){b.hideDropdown(null);b.options.change&&b.options.change.apply(b,arguments);b.options.nextFieldSelector&&jq(b.options.nextFieldSelector).focus()},this.options.secondClickHideDelay));this.updateDOM();return!1},getHighlitedRange:function(c,a){c=[0,0];if(null==a)return c;c[0]=parseInt(a.attr("data-val"));c[1]=moment(c[0]).add(34,
"days").valueOf();return c},setStartDate:function(c){null!=c&&(this.clicks[0]=c.getTime(),this.clicks[1]=moment(this.clicks[0]).add(this.options.rangeDays,"days").valueOf(),this.updateDOM())},setEndDate:function(c){null!=c&&(this.clicks[1]=c.getTime(),this.clicks[0]=moment(this.clicks[1]).subtract(this.options.rangeDays,"days").valueOf(),this.updateDOM())}})})(jq||jQuery);
(function(d){R9.extend("Widgets",{DaterangePickerOrSingleDate:function(c,a){R9.Widgets.DaterangePicker.call(this,c,a)}});R9.extend("Widgets.DaterangePickerOrSingleDate",{});R9.extend("Widgets.DaterangePickerOrSingleDate.prototype",!0,R9.Widgets.DaterangePicker.prototype,{minDate:null,singleDateMode:!1,setSingleDateMode:function(c,a){this.singleDateMode=c;a||this.updateDOM()},getSingleDateMode:function(){return this.singleDateMode},updateDOM:function(){var c;this.singleDateMode?(this.element.addClass("r9-datepicker-single-date-mode"),
this.dropdown.addClass("r9-datepicker-single-date-mode"),this.endDisplay.text(""),this.endInput.val(""),0!=this.clicks[0]?(c=moment(this.clicks[0]),this.startDisplay.text(c.format(this.options.startFormat)),this.startInput.val(c.format(this.options.startInputFormat))):(this.startDisplay.text(""),this.startInput.val("")),null==c?this.element.addClass("r9-datepicker-start-empty"):this.element.removeClass("r9-datepicker-start-empty")):(this.element.removeClass("r9-datepicker-single-date-mode"),this.dropdown.removeClass("r9-datepicker-single-date-mode"),
R9.Widgets.DaterangePicker.prototype.updateDOM.call(this))},updateHoverDOM:function(c){this.singleDateMode||R9.Widgets.DaterangePicker.prototype.updateHoverDOM.call(this,c)},computeState:function(c,a,b,e,d,f){this.singleDateMode?a==b[0]?d.start=!0:a==c&&(d.highlited=!0):R9.Widgets.DaterangePicker.prototype.computeState.call(this,c,a,b,e,d,f)},handleItemClickEvent:function(c,a){var b=this,e=jq(c);return this.singleDateMode?(e.hasClass("r9-datepicker-enabled")&&(c=parseInt(e.attr("data-val")),this.clicks[0]=
c,this.updateDropdownSelection(null),setTimeout(function(){b.hideDropdown(null);b.options.change&&b.options.change.apply(b,arguments);b.options.nextFieldSelector&&jq(b.options.nextFieldSelector).focus()},this.options.secondClickHideDelay)),this.updateDOM(),!1):R9.Widgets.DaterangePicker.prototype.handleItemClickEvent.call(this,c,a)}})})(jq||jQuery);
(function(d,c){d.publish("common.widgets.datepicker.BaseCalendar.prototype",c.extend({},d.Widgets.BaseCalendarWidget.prototype,{useSpecialCharacters:!1,options:{language:null,title:"",prevTitle:"",nextTitle:"",titleYearFormat:"YYYY",titleMonthFormat:"MMMM",reverseMonthAndYearOrder:!1,yearSymbol:null},showYearWithSpecialSymbol:function(a){var b=[],c=this.getYearSymbol();b.push("\x3cspan class\x3d'r9-datepicker-year'\x3e");b.push(a.format(this.options.titleYearFormat)+c+" ");b.push("\x3c/span\x3e");
return b.join("")},showMonthAndYear:function(a){var b=[];this.isReverseMonthAndYearOrder()?(b.push(this.showYearWithSpecialSymbol(a)),b.push(this.showMonth(a))):(b.push(this.showMonth(a)),b.push(this.showYearWithSpecialSymbol(a)));return b.join("")},isReverseMonthAndYearOrder:function(){return!0===this.options.reverseMonthAndYearOrder||!0===d.config.getBoolean("ui.datepicker.reverse.order.month.year",!1)},getYearSymbol:function(){return null!=this.options.yearSymbol?this.options.yearSymbol:this.isReverseMonthAndYearOrder()?
d.config.getString("ui.datepicker.year.symbol",""):""}}));d.createWidgetClass("datepicker.DaterangePicker",c.extend({},d.Widgets.DaterangePickerTwoFields.prototype,d.common.widgets.datepicker.BaseCalendar.prototype,{widgetName:"daterangePicker",widgetBaseClass:"r9-datepicker",calendarBaseClass:"r9-datepicker-calendar",dropdownId:"datepicker",html:null,singleDateMode:!1,maxDate:null,options:c.extend({},d.common.widgets.datepicker.BaseCalendar.prototype.options,d.Widgets.DaterangePickerTwoFields.prototype.options,
{skipForceSetDefaultStartOnFocusBlur:!1,skipForceSetDefaultEndOnFocusBlur:!1,doNotFillWhenEmpty:!1,minRangeDays:1,alwaysShowEndDatepicker:!1,responsive:!1,presentationCheck:function(){return d.utils.presentation.isTablet()}}),init:function(a){this.html=c("html");d.Widgets.BaseCalendarWidget.apply(this);this.options.useDaysFormat?(this.unitFormat=this.options.daysFormat,this.unitAdjustment=1):(this.unitFormat=this.options.nightsFormat,this.unitAdjustment=0);this.advanceStyling&&(this.options.skipForceSetDefaultStartOnFocusBlur=
!0,this.options.skipForceSetDefaultEndOnFocusBlur=!0,this.options.doNotFillWhenEmpty=!0);this.options.maxDate&&(this.maxDate=this.options.maxDate);this.elementNode=this.element.get(0);a=this.element.closest(".R9-Overlay");0<a.length&&(this.options.appendTo="#%s".format(a.attr("id")));this.startSection=this.findStartSection();this.startDisplay=this.findStartDisplay();this.startPlaceholderDisplay=this.findStartPlaceholderDisplay();this.startElement=this.startWrapper=this.findStartWrapperElement();this.startInput=
this.findStartInput();this.startInputTab=this.findStartInputTab();this.endSection=this.findEndSection();this.endDisplay=this.findEndDisplay();this.endPlaceholderDisplay=this.findEndPlaceholderDisplay();this.endElement=this.endWrapper=this.findEndWrapperElement();this.endInput=this.findEndInput();this.endInputTab=this.findEndInputTab();this.element.hasClass("singleDate")&&this.setSingleDateMode(!0,!0);this.summaryDisplay=this.findSummaryDisplay();this.setUseDaysFormat(this.options.useDaysFormat);this.initDropdown();
this.timers={};this.bindCommandUtilities();this.start_custom_value=this.end_custom_value="";this.utils=this.options.commands.utilities;this.today=moment().startOf("day").toDate();this.isResponsive()&&this.handleResponsive();this.wholeMonthSearch&&(this.options.skipForceSetDefaultStartOnFocusBlur=!0,this.options.skipForceSetDefaultEndOnFocusBlur=!0,this.options.doNotFillWhenEmpty=!0);this.update();this.updateClicks();this.updateDOM()},addEventHandlers:function(){var a=function(a){a.off("mousedown focus").on("mousedown focus",
function(b){b.preventDefault();b.stopPropagation();a.removeClass("r9-datepicker-end-empty r9-datepicker-start-empty");c(this).find(".r9-datepicker-display").focus()})};a(this.startWrapper);a(this.endWrapper);this.bindAccessibilityEvents();this.bindEvent(this.startInputTab,"focus",this.handleStartInputFocusEvent);this.bindEvent(this.startInputTab,"blur",this.handleInputBlurEvent);this.bindEvent(this.startInputTab,"keydown",this.handleInputKeydownEvent);this.bindEvent(this.startElement,"mousedown",
this.handleStartClickEvent);this.bindEvent(this.endInputTab,"focus",this.handleEndInputFocusEvent);this.bindEvent(this.endInputTab,"blur",this.handleInputBlurEvent);this.bindEvent(this.endInputTab,"keydown",this.handleInputKeydownEvent);this.bindEvent(this.endElement,"mousedown",this.handleEndClickEvent);this.bindEvent(this.dropdown,"mousedown",this.handleDropdownClickEvent);this.bindEvent(this.overlay,"mousedown",this.handleItemClickEvent);this.isResponsive()&&c(window).resize(this.handleResponsive.bind(this))},
handleDropdownClickEvent:function(){return!!this.wholeMonthSearch},isSelectingEndDate:function(){return this.endWrapper.hasClass("r9-datepicker-focus")},handleCloseEvent:function(){this.isDropdownVisible()&&this.hideDropdown()},handleItemClickEvent:function(a,b){if(!0===this.isBeforeStart(a)&&!1===this.actOnStart)return this.preventBlur=!0,this.wholeMonthSearch&&(this.preventBlur=!1),b.preventDefault(),this;var e=this;b=c(a);var d,f,k;b.hasClass("r9-datepicker-enabled")&&(f=parseInt(b.attr("data-val")),
d=(k=this.actOnStart)?0:1,b=this.actOnStart?1:0,this.clicks[d]=f,this.clicks[0]&&this.clicks[1]&&(d=moment(this.clicks[1]).diff(this.clicks[0],"days"),d<this.options.minRangeDays&&(this.clicks[b]=0)),this.updateDropdownSelection(null),!this.options.alwaysShowEndDatepicker||this.singleDateMode||this.isSelectingEndDate()?!this.singleDateMode&&this.clicks[0]&&this.clicks[1]||this.singleDateMode&&this.clicks[0]?setTimeout(function(){e.hideDropdown();e.options.change&&e.options.change.apply(e,[f,k]);e.options.nextFieldSelector&&
c(e.options.nextFieldSelector).focus()},this.options.secondClickHideDelay):this.switchActOn():(this.switchActOn(),e.options.change&&e.options.change.apply(e,[f,k]),this.loadBuzzData&&k&&this.displayBuzzData()));this.updateDOM();c(a).trigger("daterangepicker.itemclicked");return!1},handleStartDisplayFocusEvent:function(a,b){if(this.clickTarget&&c(this.clickTarget[0]).hasClass("FormView"))return this;var e=null,g="",f=this.getStartWrapperElement(),k=this;this.markDropdownElements();c(".r9-datepicker-focus").removeClass("r9-datepicker-focus");
c(f).addClass("r9-datepicker-focus");var h=c(a);h.text()||!0!==this.options.skipForceSetDefaultStartOnFocusBlur&&this.setStartDate(this.today);null!==(e=this.getStartDate())&&(g=c(this.startInput).val()||moment(e).format(this.options.startInputFormat));this.actOnStart=!0;this.hideDropdown(this.getEndWrapperElement());this.showDropdown(f);this.options.accessible&&setTimeout(function(){h.text(g);k.wholeMonthSearch&&("wholeMonthSearch"===(null!==d.storage.get("daterangePickerDefaultNavTab")?d.storage.get("daterangePickerDefaultNavTab"):
"specificDate")?k.startDisplay.text("Select a month..."):h.text(g));k.selectDisplayBox(a)},1);b.stopPropagation();b.stopImmediatePropagation();c("body").trigger("event",[b]);return this},handleStartDisplayBlurEvent:function(a,b){if(null!==this.clickTarget&&(0<this.clickTarget.closest(".r9-datepicker").length||this.wholeMonthSelect))this.blurTarget=a;else{var e=this.getStartWrapperElement(),d=this.getStartDate();a=c(a);""===a.text()&&!0===this.options.doNotFillWhenEmpty&&(this.setStartDate(null),this.options.change&&
this.options.change.apply(this,arguments));this.hideDropdown(e);c(e).removeClass("r9-datepicker-focus");""===a.text()&&null===d?!0!==this.options.skipForceSetDefaultStartOnFocusBlur&&this.setStartDate(this.today):""!==this.start_custom_value?this.utils.applyStartVal():(null===this.getEndDate()||moment(this.getStartDate()).isSame(this.getEndDate()))&&this.setEndDate(moment(this.getStartDate()).add(1,"days").toDate());this.updateDropdownSelection();this.updateClicks();return this}},handleEndDisplayFocusEvent:function(a,
b){var c="",d=this.getEndWrapperElement(),f=this;f.markDropdownElements();jq(".r9-datepicker-focus").removeClass("r9-datepicker-focus");jq(d).addClass("r9-datepicker-focus");var k=jq(a),h=f.clicks[0]||f.today.getTime();(!k.text()||f.clicks[1]<=h)&&!0!==this.options.skipForceSetDefaultEndOnFocusBlur&&f.setEndDate(moment(h).toDate());var n;null!==(n=f.getEndDate())&&(c=jq(f.endInput).val()||moment(n).format(f.options.endInputFormat));f.actOnStart=!1;f.showDropdown(d);f.options.accessible&&(jq(f.endDisplay).attr("contenteditable",
"true"),setTimeout(function(){k.text(c);f.selectDisplayBox(a)},1));b.stopPropagation();b.stopImmediatePropagation();jq("body").trigger("event",[b]);return this},handleEndDisplayBlurEvent:function(a,b){var c=this.getEndWrapperElement();this.options.accessible&&jq(this.endDisplay).attr("contenteditable","false");if(null!==this.clickTarget&&0<this.clickTarget.closest(".r9-datepicker").length)this.blurTarget=a;else return a=jq(a),""===a.text()&&!0===this.options.doNotFillWhenEmpty&&(this.setEndDate(null),
this.options.change&&this.options.change.apply(this,arguments)),this.hideDropdown(c),""===a.text()&&null===this.getEndDate()?!0!==this.options.skipForceSetDefaultEndOnFocusBlur&&(null!==this.getStartDate()?this.setEndDate(moment(this.getStartDate()).add(1,"days")):this.setEndDate(moment().toDate())):this.utils.applyEndVal(),this.updateDropdownSelection(),this},switchActOn:function(){var a=!this.actOnStart;this.hideDropdown(this.getWrapperElement());this.actOnStart=a;c(this.actOnStart?this.startInputTab:
this.endInputTab).focus()},findStartSection:function(){return this.getChildElement("start")},findStartDisplay:function(){return this.getChildElement("start-display")},findStartPlaceholderDisplay:function(){return this.getChildElement("start-placeholder")},findEndSection:function(){return this.getChildElement("end")},findEndDisplay:function(){return this.getChildElement("end-display")},findEndPlaceholderDisplay:function(){return this.getChildElement("end-placeholder")},findSummaryDisplay:function(){return this.getChildElement("summary-display")},
findClearDisplay:function(){return this.getChildElement("clear")},findCloseLink:function(){return c(".r9-datepicker-title-close",this.dropdown)},findTitle:function(){return c(".r9-datepicker-title \x3e span",this.dropdown)},findStartInput:function(){return this.getChildElement("start-formField")},findEndInput:function(){return this.getChildElement("end-formField")},findTabInput:function(){return this.getChildElement("tab")},findStartInputTab:function(){return this.getChildElement("start-tab")},findEndInputTab:function(){return this.getChildElement("end-tab")},
findStartWrapperElement:function(){return this.getChildElement("start-wrapper")},findEndWrapperElement:function(){return this.getChildElement("end-wrapper")},getDropdownEl:function(){return c("#datepicker")},getWrapperElement:function(){return this.actOnStart?this.startWrapper:this.endWrapper},getStartWrapperElement:function(){return this.startWrapper},getEndWrapperElement:function(){return this.endWrapper},handleNextPrevClickEvent:function(a,b){b=this.saveDropdownPositionState(this.dropdown);a=moment(parseInt(c(a).attr("data-val")));
this.dropdown[0].innerHTML=this.makeCalendarHTML(a);this.restoreDropdownPositionState(this.dropdown,b);this.runBelowCalendarCallback();this.updateDropdownSelection(null);this.loadBuzzData&&this.displayBuzzData();this.isResponsive()&&this.presentationCheck()&&(this.updateTitle(),this.bindEvent(this.findCloseLink(),"click",this.handleCloseEvent));this.wholeMonthSearch&&(this.createCalendarTabNavBindings(),this.createWholeMonthClickBindings(),this.createNoOfNightsChangedBinding(),jq(".tabWrapper.wholeMonth").hasClass("selected")?
jq(".tabWrapper.wholeMonth").trigger("click"):jq(".tabWrapper.specificDate").trigger("click"),jq(".searchform.rtow").hasClass("oneway")&&(jq(".tabWrapper.wholeMonth").hide(),jq(".tabWrapper.specificDate").click()));return!1},saveDropdownPositionState:function(a){if(a){var b=a.find(".r9-datepicker-pointer");a=c(a);if(0<b.length&&0<a.length)return{pointerPos:b.position(),wrapperPos:a.position(),wrapperHeight:a.height(),topPointer:0>b.position().top}}return null},restoreDropdownPositionState:function(a,
b){if(b&&a){var e=c(a);if(0<e.length){if(!b.topPointer){var d=e.height()-b.wrapperHeight;e.css("top",b.wrapperPos.top-d+"px")}a.find(".r9-datepicker-pointer").css("left",b.pointerPos.left+"px")}}},showDropdown:function(a){this.hideTimeout&&clearTimeout(this.hideTimeout);this.options.show&&this.options.show.apply(this,arguments);this.dropdown.parent().is(this.options.appendTo)||this.dropdown.appendTo(this.options.appendTo);this.showOverlay();this.markDropdownElements();this.updateClicks();"function"===
typeof this.options.minDateFunc&&this.options.minDateFunc(this);this.wholeMonthSearch&&jq(".searchform.rtow").hasClass("oneway")&&(d.events.publish("flights.search.rt.form.wholeMonthSelect.setSpecificDateCategory",{group:"wholeMonthSelect"}),this.daterangePickerDefaultNavTab="specificDate");this.dropdown[0].innerHTML=this.makeCalendarHTML(!this.actOnStart&&this.clicks[1]?this.clicks[1]:this.clicks[0]);this.updateDropdownSelection(null);this.runBelowCalendarCallback();this.wholeMonthSearch&&(this.createCalendarTabNavBindings(),
this.createWholeMonthClickBindings(),this.createNoOfNightsChangedBinding(),jq(".tabWrapper.wholeMonth").hasClass("selected")?jq(".tabWrapper.wholeMonth").trigger("click"):jq(".tabWrapper.specificDate").trigger("click"),jq(".searchform.rtow").hasClass("oneway")&&(jq(".tabWrapper.wholeMonth").hide(),jq(".tabWrapper.specificDate").click()));var b=this.calendarBaseClass;this.options.dropdownClass&&(b=b+" "+this.options.dropdownClass);c(a).addClass("r9-datepicker-focus");this.dropdown.addClass(b);this.advanceStyling&&
this.dropdown.addClass("r9-advance-styling");this.wholeMonthSearch?this.dropdown.addClass("CalendarWidget-WholeMonthSearch"):this.dropdown.hasClass("CalendarWidget-WholeMonthSearch")&&this.dropdown.removeClass("CalendarWidget-WholeMonthSearch");b=this.dropdown[0].style;this.positionDropdown(a);d.events.publish("common.widgets.datepicker.DaterangePicker.showDropdown",{wrapper:a});var e=this,g=c(window).width();this.resizeHandler=function(){var b=c(window).width();10<Math.abs(b-g)&&(g=b,e.positionDropdown(a))};
c(window).on("resize",this.resizeHandler);this.bindItemEvent("mousedown",this.handleItemClickEvent);if("ontouchstart"in document.documentElement){var f=this;this.overlay.addClass("touch");this.bindOverlayEvent("mousedown",function(){f.hideDropdown()})}else this.bindItemEvent("mouseover",this.handleItemHoverEvent),this.bindItemEvent("mouseout",this.handleItemHoverEndEvent);this.isResponsive()&&this.presentationCheck()&&(this.updateTitle(),this.bindEvent(this.findCloseLink(),"click",this.handleCloseEvent));
this.bindNextPrevEvent("mousedown",this.handleNextPrevClickEvent);this.dropdown.prop("data-owner",a.attr("id"));this.loadBuzzData&&this.displayBuzzData();b.display=this.isResponsive()&&this.presentationCheck()?"block":"inline";this.wholeMonthSearch&&(e=this,jq(".noOfNightsInput").on("click",function(){jq(this).change().select()}),setTimeout(function(){jq(".noOfNightsInput").is(":focus")||(e.clickTarget=jq(".noOfNightsInput"),jq(".noOfNightsInput").trigger("click"))},300));this.isResponsive()&&(this.presentationCheck()?
this.html.addClass("mobile-overlay-fix-content"):this.html.removeClass("mobile-overlay-fix-content"))},createCalendarTabNavBindings:function(){var a=this;jq(a.dropdown).find(".tabWrapper").on("click",function(){var b=this;jq(a.dropdown).find(".tabWrapper:not(no-click)").removeClass("selected");jq(this).addClass("selected");jq(a.dropdown).removeClass("SelectedNavTab-Date").removeClass("SelectedNavTab-Month");if(jq(this).hasClass("specificDate"))setTimeout(function(){var c=jq(b).width(),e=jq(b).position().left-
25;jq(a.dropdown).find(".tabUnderlay").css({left:e,width:c})},10),setTimeout(function(){var b=jq(a.dropdown).find(".tabUnderlay");b.hasClass("no-transition")&&b.removeClass("no-transition")},100),jq(a.dropdown).addClass("SelectedNavTab-Date"),jq(a.dropdown).find(".plusMinus").stop().fadeIn(),"undefined"!==typeof d.storage&&d.storage.set("daterangePickerDefaultNavTab","specificDate"),d.events.publish("flights.search.rt.form.wholeMonthSelect.setSpecificDateCategory",{group:"wholeMonthSelect"}),this.daterangePickerDefaultNavTab=
"specificDate";else{var c=jq(a.dropdown).find(".tabUnderlay");setTimeout(function(){var a=jq(b).width(),e=jq(b).position().left-25;c.css({left:e,width:a})},10);setTimeout(function(){var b=jq(a.dropdown).find(".tabUnderlay");b.hasClass("no-transition")&&b.removeClass("no-transition")},100);jq(a.dropdown).addClass("SelectedNavTab-Month");jq(a.dropdown).find(".plusMinus").stop().fadeOut();"undefined"!==typeof d.storage&&d.storage.set("daterangePickerDefaultNavTab","wholeMonthSearch");setTimeout(function(){jq(".noOfNightsInput").is(":focus")||
(a.clickTarget=jq(".noOfNightsInput"),jq(".noOfNightsInput").trigger("click"))},300);d.events.publish("flights.search.rt.form.wholeMonthSelect.setWholeMonthCategory",{group:"wholeMonthSelect"});this.daterangePickerDefaultNavTab="wholeMonthSearch"}});jq(a.dropdown).find(".input.flexPlusMinus").on("click",function(){jq(this).toggleClass("checked");jq(this).hasClass("checked")?("undefined"!==typeof d.storage&&d.storage.set("flexPlusMinusChecked",!0),d.events.publish("flights.search.rt.form.wholeMonthSelect.enablePlusMinusSearch",
{group:"wholeMonthSelect"})):("undefined"!==typeof d.storage&&d.storage.set("flexPlusMinusChecked",!1),d.events.publish("flights.search.rt.form.wholeMonthSelect.disablePlusMinusSearch",{group:"wholeMonthSelect"}))})},createWholeMonthClickBindings:function(){var a=this;jq(a.dropdown).off("click").on("click",".monthWrapper",function(){jq(a.dropdown).find(".monthWrapper").removeClass("selected");jq(this).addClass("selected");var b=jq(this).data("month"),c=jq(this).data("end-of-month"),g=jq(this).data("year"),
f=new Date(g,b-1,1),c=new Date(g,b-1,c);moment(f).isBefore(moment())&&(f=moment().toDate());"undefined"!==typeof d.storage&&(d.storage.set("flexSelectedMonth",b),d.storage.set("flexSelectedYear",g));d.events.publish("flights.search.rt.form.wholeMonthSelect",{group:"wholeMonthSelect",startDate:f,endDate:c});d.Analytics.api.trackEvent({category:"sw16-flex-to-the-max",action:"searchByWholeMonthClick",label:"month",value:b-1});a.handleCloseEvent()})},createNoOfNightsChangedBinding:function(){var a=jq(this.dropdown).find(".noOfNightsInput");
jq(this.dropdown).off("change").on("change",".noOfNightsInput",function(){var b,c;b=a.val().replace(" ","").replace("nights","").split("-");1<b.length?(c=b[0],b=b[1]):(c=b[0],b=b[0]);7<b-c&&(c=b-7);var g=c+"-"+b;c===b&&(g=c);a.val(g);"undefined"!==typeof d.storage&&d.storage.set("flexNoOfNights",g);d.events.publish("flights.search.rt.form.noOfNightsChanged",{group:"wholeMonthSelect",noOfNights:a.val()})})},endStartIsSameField:function(){return this.options.singleDateMode||this.options.singlePickerWithSingleField},
refreshWidth:function(){var a=this.dropdown[0].style;a.width="inherit";var b=this.dropdown.outerWidth();this.options.minWidth&&(b=Math.max(this.options.minWidth,b));this.options.maxWidth&&(b=Math.min(this.options.maxWidth,b));a.width=b+this.options.offsetWidth+"px"},positionDropdown:function(a){var b=a.offset(),e=jq(this.options.appendTo).offset(),g=this.dropdown[0].style;g.zIndex=10009;c("#datepicker").removeClass("r9-datepicker-responsive-right-position");if(this.isResponsive()&&this.presentationCheck())this.dropdown.css({left:"0",
top:d.utils.presentation.isMobile()?"0":"4%"});else{var f=b.left-e.left,k=f+this.dropdown.outerWidth();k>window.innerWidth&&(k-=window.innerWidth,f=f-k-15,this.dropdown.find(".r9-datepicker-pointer").css("left",k+36+"px"));g.left=f+"px";f=0;this.element.parent()[0]===jq(document.body)[0]&&(f=parseInt((jq(document.body).css("top")||"0").replace("-",""))||0);this.shouldFlipDirection()?(this.dropdown.addClass("up"),g.top=f+b.top-this.dropdown.outerHeight()-e.top+"px"):(this.dropdown.removeClass("up"),
g.top=f+b.top+a.outerHeight()-e.top+"px")}},shouldFlipDirection:function(){var a=c(window).scrollTop(),b=a+c(window).outerHeight(),e=this.dropdown.outerHeight(),d=this.element.offset().top;return d+this.element.outerHeight()+e>b&&!(d-e<a)},initDropdown:function(){var a=this.getDropdownId(this.element),b=this.getDropdownEl(this.element).get(0);if("undefined"===typeof b){var c=d.Widgets.DaterangePicker.prototype.widgetBaseClass+" R9-Overlay";this.options.dropdownClass&&(c=c+" "+this.options.dropdownClass);
b=jq("\x3cdiv\x3e\x3c/div\x3e",{id:a,css:{display:"none",position:"absolute"}}).appendTo(this.options.appendTo)[0];jq(b).addClass(c);this.advanceStyling&&jq(b).addClass("r9-advance-styling");this.wholeMonthSearch&&(jq(b).addClass("CalendarWidget-WholeMonthSearch"),a="specificDate","undefined"!==typeof d.storage&&(a="undefined"!==typeof d.storage.get("daterangePickerDefaultNavTab")?d.storage.get("daterangePickerDefaultNavTab"):"specificDate"),"wholeMonthSearch"===a?jq(b).addClass("SelectedNavTab-Month"):
jq(b).addClass("SelectedNavTab-Date"))}this.dropdown=jq(b);this.overlay=jq("#"+this.widgetBaseClass+"-overlay");this.overlay.length||(this.overlay=jq('\x3cdiv id\x3d"'+this.widgetBaseClass+'-overlay" class\x3d"'+this.widgetBaseClass+'-overlay R9-Overlay"\x3e\x3c/div\x3e').appendTo(this.options.appendTo))},isResponsive:function(){return this.options.responsive},presentationCheck:function(){return this.options.presentationCheck()},handleResponsive:function(){this.presentationCheck()?(this.dropdown.addClass("mobile-datepicker"),
this.overlay.addClass("mobile-overlay"),this.isDropdownVisible()&&!this.html.hasClass("mobile-overlay-fix-content")&&(this.html.addClass("mobile-overlay-fix-content"),this.updateTitle(),this.bindEvent(this.findCloseLink(),"click",this.handleCloseEvent))):(this.dropdown.removeClass("mobile-datepicker"),this.overlay.removeClass("mobile-overlay"),this.html.removeClass("mobile-overlay-fix-content"));this.positionDropdown(this.actOnStart?this.getStartWrapperElement():this.getEndWrapperElement())},updateTitle:function(){var a=
"",b,c="";null!==(b=this.getStartDate())&&(a=moment(b).format(this.options.titleFormat));null!==(c=this.getEndDate())&&b!==c&&(a+=(a?" - ":"")+moment(c).format(this.options.titleFormat));this.findTitle().text(a)}}))})(R9,jQuery);(function(d){d.extend("common.widgets.datepicker.DaterangePicker.prototype.options",{startInputFormat:"MM/DD/YYYY",endInputFormat:"MM/DD/YYYY",startFormat:"ddd M/D",endFormat:"ddd M/D",inlineDisplayFormat:"MMM D",titleFormat:"MMM D"})})(window.R9);(function(){var g=function(a){a=a.split("-");return new Date(parseInt(a[0]),parseInt(a[1])-1,parseInt(a[2]))};R9.extend("PredictedPriceSource",{API:function(){}});R9.extend("PredictedPriceSource.API",{searchInfos:{},getPriceDataSetKey:function(a){return a?[a.origin,a.destination].join("|"):null},getFetchUrl:function(){return"/a/api/flightPricePrediction/predictCalendar"},updateSearchInfo:function(a,b,c){var f=this.searchInfos[a]||{pendingReqs:[]};c&&(f={});this.searchInfos[a]=$.extend({},f,b);return this.searchInfos[a]},
sendFetchRequest:function(a,b){return $.ajax(a,b)},failPendingReqs:function(a,b){if(a&&a.pendingReqs)for(;a.pendingReqs.length;)a.pendingReqs.pop().reject(b)},passPendingReqs:function(a){if(a&&a.pendingReqs)for(;a.pendingReqs.length;)a.pendingReqs.pop().resolve({dataSet:a.dataSet,parameters:a.parameters,lowestMean:a.lowestMean,highestMean:a.highestMean})},onPriceFetchFail:function(a){var b=this.getPriceDataSetKey(a),b=this.updateSearchInfo(b,{fetched:!0,failed:!0});this.failPendingReqs(b,a)},onPriceDataPollSuccess:function(a,
b){var c=this.getPriceDataSetKey(a);this.updateSearchInfo(c,{error:b.error,success:b.success,parameters:b.parameters});if(b.success)this.onPricePredictionFetch(a,b);else this.onPriceFetchFail(a)},dateToStr:function(a){return moment(a).format("YYYY-MM-DD")},getPriceDatum:function(a,b){if(b)return a=this.dateToStr(a),b[a]},createPriceDatum:function(a,b){a=this.dateToStr(a);b[a]={date:a,returnDates:null,value:null,lastValue:null};return b[a]},onPricePredictionFetch:function(a,b){var c=b.predictions,
f=this.getPriceDataSetKey(a),d=this.updateSearchInfo(f,{dataSet:{},fetched:!0,expiresOn:moment().add(1,"days").toDate().getTime(),parameters:b.parameters}),e=d.dataSet;e&&(c.forEach(function(a){var b=e[a.startDate];b||(b={date:a.startDate,returnDates:null,value:null,lastValue:null},e[a.startDate]=b);b.returnDates||(b.returnDates={});b.lOSBucket||(b.lOSBucket=[[],[],[],[]]);var c;c=a.startDate;c=Math.round((g(a.endDate)-g(c))/864E5);b.lOSBucket[3>=c?0:7>=c?1:14>=c?2:3].push(a.minPrice);b.returnDates[a.endDate]=
{price:a.minPrice,priceDisplay:R9.Common.Utils.formatPrice(a.minPrice,d.parameters.currency),returnDate:a.endDate}}),this.calculateMeanPrices(d),this.passPendingReqs(d,a))},calculateMeanPrices:function(a){var b=a.dataSet,c=Infinity,f=0;Object.keys(b).forEach(function(d){b.hasOwnProperty(d)&&(d=b[d],d.meanPrice=.28*this.calcMean(d.lOSBucket[0])+.33*this.calcMean(d.lOSBucket[1])+.21*this.calcMean(d.lOSBucket[2])+.18*this.calcMean(d.lOSBucket[3]),d.meanPriceDisplay=R9.Common.Utils.formatPrice(d.meanPrice,
a.parameters.currency),c=Math.min(c,d.meanPrice),f=Math.max(f,d.meanPrice))}.bind(this));a.lowestMean={price:c,display:R9.Common.Utils.formatPrice(c,a.parameters.currency)};a.highestMean={price:f,display:R9.Common.Utils.formatPrice(f,a.parameters.currency)}},calcMean:function(a){return a.reduce(function(a,c){return a+c},0)/a.length},fetchData:function(a,b){var c=new $.Deferred;if(!a)return c.reject("Incorrect url parameters"),c;var f=this.getPriceDataSetKey(a),d=this.getFetchUrl(),e=this.updateSearchInfo(f,
{});e.pendingReqs.push(c);e.expiresOn&&e.expiresOn<Date.now()&&(e=this.updateSearchInfo(f,{},!0));if(e.dataSet)return e.success?this.passPendingReqs(e,a):this.failPendingReqs(e,a),c;if(e.xhr&&4!==e.xhr.readyState)return c;a=$.extend({},{data:a,success:this.onPriceDataPollSuccess.bind(this,a),error:this.onPriceFetchFail.bind(this,a)},b);e.xhr=this.sendFetchRequest(d,a);return c}})})();(function(c,d){c.createComponentClass("common.widgets.datepicker.PredictionDataProvider",{state:{searchInfos:{}},options:{formId:"",onFetchSuccess:d.noop(),onFetchFail:d.noop(),origDestListenersOff:!1,origin:null,destination:null,loadingDataCallback:d.noop(),doneLoadingCallback:d.noop()},init:function(){this.origin=this.options.origin;this.destination=this.options.destination},addEventHandlers:function(){var a=this;this.options.origDestListenersOff||(this.options.formId&&(this.subscribe("flights.search.rtow.form.origin",
{id:this.options.formId},function(b){a.setOrigin(b)}),this.subscribe("flights.search.rtow.form.destination",{id:this.options.formId},function(b){a.setDestination(b)})),this.subscribe("flights.inline.search.rtow.form.origin",function(b){a.setOrigin(b)}),this.subscribe("flights.inline.search.rtow.form.destination",function(b){a.setDestination(b)}))},setOrigin:function(a){a&&a.originCode?this.origin&&this.origin.originCode===a.originCode||(this.origin=a,this.fetchPricesInCalendar()):this.origin=null},
setDestination:function(a){a&&a.destinationCode?this.destination&&this.destination.destinationCode===a.destinationCode||(this.destination=a,this.fetchPricesInCalendar()):this.destination=null},fetchPricesInCalendar:function(a){(a=a||this.getPostData())&&c.PredictedPriceSource.API.fetchData(a,{beforeSend:this.beforeSend.bind(this),onComplete:this.onComplete.bind(this)}).then(this.options.onFetchSuccess.bind(this)).catch(this.options.onFetchFail.bind(this))},beforeSend:function(){this.options.loadingDataCallback&&
this.options.loadingDataCallback()},onComplete:function(){this.options.doneLoadingCallback&&this.options.doneLoadingCallback()},getPostData:function(){if(this.origin&&this.destination&&""!==this.origin.originCode&&""!==this.destination.destinationCode)return{origin:this.origin.originCode.split("/")[0],destination:this.destination.destinationCode.split("/")[0]}},getDataSet:function(a){a=a||this.getPostData();return c.PredictedPriceSource.API.fetchData(a,{beforeSend:this.beforeSend.bind(this),onComplete:this.onComplete.bind(this)})},
getPriceDatum:function(a,b){return c.PredictedPriceSource.API.getPriceDatum(a,b)},setOptions:function(a){var b=Object.getOwnPropertyNames(this.options),c=Object.getOwnPropertyNames(a).reduce(function(c,d){0<=b.indexOf(d)&&(c[d]=a[d]);return c},{});this.options=d.extend({},this.options,c)}})})(R9,jQuery);(function(d,c){d.createWidgetClass("datepicker.StyleJamFlexDatePickerHorizontal","common.widgets.datepicker.StyleJamFlexDatePicker",{tabContent:null,headerContent:null,inlineComponentsReady:function(){this.base();d.dom.schedule(this.adjustFlexHeaderClasses.bind(this))},addAboveCalendarContent:function(a,b){this.base(a,b);b.append(this.flexOptions)},removeAboveCalendarContent:function(){this.base();this.flexOptions.appendTo(this.aboveCalContent)},makeAboveCalendarContent:function(){this.base();this.flexOptions=
c(this.makeFlexOptionsHTML());this.aboveCalContent.append(this.flexOptions)},adjustFlexHeaderClasses:function(){var a=this.getPresentationState("form","active"),b=this.getPresentationState("form","hidden");d.dom.swapClasses(this.flexHeader.find(".form-"+this.flexCategory),b,a)},makeFlexDatesHTML:function(){var a=this,b=[];c.each(this.options.categories,function(d,c){b.push(a.makeFlexForm(c.value));a.categories[c.value]=!0});return d.template.render("flexDatePickerHorizontalHeader",{headerId:this.id("flexHeader"),
dayTipId:this.id("BUZZ_LOW"),closeBtnId:this.id("closeBtn"),formsId:this.id("flexDateForms"),forms:b.join("")})},getFlexDateOptions:function(){return this.flexOptions.find(".js-flexDateOption")},getWeekendTimeText:function(a){return c(a.getSelectedElement()).data("title")}})})(R9,jQuery);(function(c,e){c.createWidgetClass("datepicker.StyleJamFlexDatePicker","common.widgets.datepicker.StyleJamDatePicker",{flexCategory:"plusminusthree",defaultDateMode:"",flexHeader:null,flexOptions:null,flexDateForms:null,plusMinusThreeDepart:null,plusMinusThreeReturn:null,openFlexDuration:null,categories:{exact:!1,openflex:!1,plusminusthree:!1,weekend:!1},options:{openFlexDefaultDuration:"",openFlexAllowBlankDuration:!1,inlineSearchForm:!1,separateExactDateOption:!0,presentationStateKey:"",isUpdateOnDisplayChange:!0},
init:function(){this.options.flexCategory&&(this.flexCategory=this.options.flexCategory);this.base();this.defaultDateMode=this.dateMode},addEventHandlers:function(){var a=this;this.base();this.flexOptions.on("click","[data-flex-value]",this.handleFlexDateChange.bind(this)).on("mousedown","[data-flex-value]",function(){a.keyboardNav=!1});this.bindTabOrderEvents();this.categories.openflex&&this.openFlexDuration&&(this.openFlexDuration.styleJamTextInput(this.id("openFlexDuration"),{}),this.openFlexDuration.blur(this.onOpenFlexDurationBlur.bind(this)),
this.openFlexDuration.keydown(function(b){b.which===a.Keys.RETURN?(b.preventDefault(),a.onDismiss()):b.which===a.Keys.TAB&&(b.preventDefault(),b.shiftKey?a.getLastVisibleFlexDateOption().focus():a.calendar.getDayElement(a.getCurrentDayVal()).focus())}),c.dom.schedule(function(){a.openFlexDuration.val().length||a.openFlexDuration.val(a.options.openFlexDefaultDuration)}));this.options.flexCategory&&this.changeFlexCategory(this.options.flexCategory)},addMeToCalendar:function(){this.base();c.events.ready("datepicker.FlexDatePicker.loaded_"+
this.id())},addAboveCalendarContent:function(a){this.base(a);this.flexHeader.length&&a.append(this.flexHeader)},removeAboveCalendarContent:function(){this.base();this.flexHeader.length&&this.aboveCalContent.append(this.flexHeader)},bindDropdown:function(a,b){a.on("keydown.taborder",this.onFlexDateDropdownKeyDown.bind(this));return a.styleJamDropdown({change:b.bind(this)}).getWidget()},onPlusMinusThreeDepartChange:function(){this.publishFlexUpdate();this.markSelectedDays();c.Analytics.api.trackEvent({category:"flexDates",
label:"plusMinusThree",action:"changeDepart",value:this.plusMinusThreeDepart.getValue()})},onPlusMinusThreeReturnChange:function(){this.publishFlexUpdate();this.markSelectedDays();c.Analytics.api.trackEvent({category:"flexDates",label:"plusMinusThree",action:"changeReturn",value:this.plusMinusThreeReturn.getValue()})},onWeekendDepartChange:function(a){var b=this.weekendDepartTime.getValue();this.weekendStartTime=this.parseWeekendTimes(b);a||c.Analytics.api.trackEvent({category:"flexDates",label:"weekend",
action:"changeDepart",value:b});this.markSelectedDays();this.publishFlexUpdate()},onWeekendReturnChange:function(a){var b=this.weekendReturnTime.getValue();this.weekendEndTime=this.parseWeekendTimes(b);a||c.Analytics.api.trackEvent({category:"flexDates",label:"weekend",action:"changeReturn",value:b});this.markSelectedDays();this.publishFlexUpdate()},onOpenFlexDurationBlur:function(){var a=this.validateOpenFlexDuration();this.openFlexDuration&&(a?(this.openFlexDuration.removeClass("error"),this.openFlexDuration.val(a)):
(this.openFlexDuration.addClass("error"),c.Analytics.api.trackEvent({category:"flexDates",label:"openflex",action:"error",value:encodeURIComponent(this.openFlexDuration.val())})),this.publishFlexUpdate())},makeAboveCalendarContent:function(){this.aboveCalContent=e(this.makeFlexDatesHTML()).appendTo(this.element);this.flexHeader=this.getChildElement("flexHeader");this.toolTip=this.getChildElement("BUZZ_LOW");this.flexOptions=this.getChildElement("flexDateOptions");this.flexDateForms=this.getChildElement("flexDateForms");
this.categories.openflex&&(this.openFlexDuration=this.getChildElement("openFlexDuration"));this.plusMinusThreeDepart=this.bindDropdown(this.getChildElement("plusMinusThreeDepart"),this.onPlusMinusThreeDepartChange);this.plusMinusThreeReturn=this.bindDropdown(this.getChildElement("plusMinusThreeReturn"),this.onPlusMinusThreeReturnChange);this.weekendReturnTime=this.bindDropdown(this.getChildElement("weekendReturnTime"),this.onWeekendReturnChange);this.weekendDepartTime=this.bindDropdown(this.getChildElement("weekendDepartTime"),
this.onWeekendDepartChange)},makeFlexDatesHTML:function(){var a=this,b=[];e.each(this.options.categories,function(f,d){b.push(a.makeFlexForm(d.value));a.categories[d.value]=!0});return c.template.render("flexDatePickerHeader",{headerId:this.id("flexHeader"),dayTipId:this.id("BUZZ_LOW"),closeBtnId:this.id("closeBtn"),formsId:this.id("flexDateForms"),forms:b.join(""),options:this.makeFlexOptionsHTML()})},makeFlexOptionsHTML:function(){var a=[],b=this;e.each(this.options.categories,function(f,d){f=d.value===
b.flexCategory;a.push(c.template.render("flexDatePickerCatHeader",{optionType:"weekend"===d.value||"openflex"===d.value?"read-only":"",catId:b.id(d.value),catVal:d.value,catTitle:d.title,catLabel:d.label,ariaSelected:f,extraStyles:f?b.getPresentationState("cat","selected"):b.getPresentationState("cat","default")}))});return c.template.render("flexDatePickerOptions",{optionsId:this.id("flexDateOptions"),cats:a.join("")})},makeFlexForm:function(a){var b=a===this.flexCategory;return"plusminusthree"===
a?c.template.render("flexDatePickerPlusMinusThreeForm",{formId:this.id(a)+"Form",departId:this.id("plusMinusThreeDepart"),returnId:this.id("plusMinusThreeReturn"),ariaExpanded:b,departLabelId:this.id("flexDepartLabel"),returnLabelId:this.id("flexReturnLabel")}):"weekend"===a?c.template.render("flexDatePickerWeekendForm",{formId:this.id(a)+"Form",departTimeId:this.id("weekendDepartTime"),returnTimeId:this.id("weekendReturnTime"),ariaExpanded:b,departLabelId:this.id("weekendDepartTimeLabel"),returnLabelId:this.id("weekendReturnTimeLabel")}):
"openflex"===a?c.template.render("flexDatePickerOpenFlexForm",{formId:this.id(a)+"Form",flexDurationId:this.id("openFlexDuration"),ariaExpanded:b,labelId:this.id("openFlexDurationLabel")}):null},setDateMode:function(a,b){switch(a){case this.DateMode.RANGE:case this.DateMode.SINGLE:this.defaultDateMode=a,c.dom.schedule(this.adjustHeaderFlexHeaderClasses.bind(this,a)),"weekend"!==this.flexCategory&&"openflex"!==this.flexCategory||this.changeFlexCategory("exact")}this.base(a,b)},adjustHeaderFlexHeaderClasses:function(a){var b=
this,f=this.getPresentationState("catHeader","hidden"),d=this.getPresentationState("cat","hidden"),g=this.getPresentationState("pmtSection","hidden"),k=this.getPresentationState("pmtSection","default"),h=this.flexHeader.find(".form-plusminusthree");a===this.DateMode.SINGLE?("exact"!==this.flexCategory&&"plusminusthree"!==this.flexCategory&&this.changeFlexCategory("exact"),c.dom.swapClasses(this.flexOptions.find(".weekend, .openflex"),"",d),this.swapClasses(h,"FlexDateForms__FlexDateForm--range","FlexDateForms__FlexDateForm--single"),
h.find(".col").each(function(){b.swapClasses(e(this),"col-pmtSection","col-pmtSection--centered");b.swapClasses(e(this),"PlusMinusThreeGrid__pmtDepart","PlusMinusThreeGrid__pmtDepart--centered")}),c.dom.swapClasses(this.flexHeader.find(".range-only"),k,g),this.swapClasses(this.flexHeader.find(".range-only"),"col-pmtSection--centered","col-pmtSection--hidden"),this.hasExactTab()||this.getChildElement("flexDateOptions").addClass(f)):(this.getChildElement("flexDateOptions").removeClass(f),this.swapClasses(h,
"FlexDateForms__FlexDateForm--single","FlexDateForms__FlexDateForm--range"),h.find(".col").each(function(){b.swapClasses(e(this),"col-pmtSection--centered","col-pmtSection");b.swapClasses(e(this),"PlusMinusThreeGrid__pmtDepart--centered","PlusMinusThreeGrid__pmtDepart")}),c.dom.swapClasses(this.flexOptions.find(".exact, .weekend, .plusminusthree, .openflex"),d,""),c.dom.swapClasses(this.flexHeader.find(".range-only"),g,k))},handleFlexDateChange:function(a){var b=e(a.currentTarget).attr("data-flex-value");
this.changeFlexCategory(b);setTimeout(function(){c.Analytics.api.trackEvent({category:"flexDates",label:"dateMode",action:"change",value:b})},100)},hasExactTab:function(){return this.options.separateExactDateOption},resolveFlexCategory:function(a){return this.categories.hasOwnProperty(a)?a:"exact"},changeFlexCategory:function(a,b){var f=this.getPresentationState("cat","default"),d=this.getPresentationState("cat","focused"),g=this.getPresentationState("cat","selected"),e=this.getPresentationState("form",
"active"),h=this.getPresentationState("form","hidden");a=this.resolveFlexCategory(a);this.tempDate=0;this.hasExactTab()||"exact"!==a||(a="plusminusthree");if(b||a!==this.flexCategory){""!==this.flexCategory&&c.dom.schedule(function(a){var b=this.flexOptions.find("."+a);c.dom.swapClasses(b,[g,d].join(" "),f);b.attr("aria-selected",!1);c.dom.swapClasses(this.flexHeader.find(".form-"+a),e,h)}.bind(this,this.flexCategory));this.flexCategory=a;c.dom.schedule(function(a){var b=this.flexOptions.find("."+
a);c.dom.swapClasses(b,[f,d].join(" "),g);b.attr("aria-selected",!0);this.categories.openflex&&this.openFlexDuration&&this.openFlexDuration.removeClass("error");c.dom.swapClasses(this.flexHeader.find(".form-"+a),h,e)}.bind(this,this.flexCategory));switch(a){case "plusminusthree":case "exact":this.setDateMode(this.defaultDateMode);break;case "weekend":this.setDateMode(this.DateMode.WEEKEND);break;case "openflex":this.setDateMode(this.DateMode.OPENFLEX)}this.publishFlexUpdate()}},shouldDismiss:function(){if("openflex"===
this.flexCategory&&this.openFlexDuration)if(this.validateOpenFlexDuration())this.openFlexDuration.removeClass("error");else return this.openFlexDuration.addClass("error"),!1;return this.base()},onClear:function(a){a.hasOwnProperty("field")&&"endDate"===a.field&&(this.plusMinusThreeReturn.setValue("exact"),this.onPlusMinusThreeReturnChange());this.base()},getFlexDatesDisplayData:function(){var a=this.getFlexDatesData();switch(this.flexCategory){case "plusminusthree":var b={};"exact"!==a.depart_date_flex&&
(b.startDate=this.plusMinusThreeDepart.getText());this.dateMode!==this.DateMode.SINGLE&&"exact"!==a.return_date_flex&&(b.endDate=this.plusMinusThreeReturn.getText());e.extend(a,{inputDisplay:b});break;case "weekend":e.extend(a,{weekend_depart_time_display:this.getWeekendTimeText(this.weekendDepartTime),weekend_return_time_display:this.getWeekendTimeText(this.weekendReturnTime),inputDisplay:{startDate:this.options.msg.WEEKEND_INPUT_DISPLAY_WEEKS}});break;case "openflex":e.extend(a,{inputDisplay:{startDate:this.options.msg.OPEN_FLEX_INPUT_DISPLAY_WEEKS}})}return a},
getWeekendTimeText:function(a){return a.getText()},getFlexDatesData:function(a){if(a)return a=null,this.validateOpenFlexDuration()&&"openflex"===this.flexCategory&&(a=this.validateOpenFlexDuration()),{flex_category:"anywhere",explore_length_of_stay:a};a={flex_category:this.flexCategory};switch(this.flexCategory){case "plusminusthree":this.plusMinusThreeDepart&&e.extend(a,{depart_date_flex:this.plusMinusThreeDepart.getValue()});this.dateMode!==this.DateMode.SINGLE&&this.plusMinusThreeReturn&&e.extend(a,
{return_date_flex:this.plusMinusThreeReturn.getValue()});break;case "weekend":this.weekendDepartTime&&this.weekendReturnTime&&e.extend(a,{weekend_depart:this.weekendDepartTime.getValue(),weekend_return:this.weekendReturnTime.getValue()});break;case "openflex":e.extend(a,{openflex_length_of_stay:this.validateOpenFlexDuration()})}return a},publishFlexUpdate:function(){this.publishUpdate({action:"flex",flex:this.flexCategory,fields:{startDate:!0,endDate:!0},data:this.getFlexDatesDisplayData()});"function"===
typeof this.options.change&&this.options.change.apply(this,[])},getFlexCategory:function(){return this.flexCategory},validateOpenFlexDuration:function(){var a=[];(this.openFlexDuration?this.openFlexDuration.val()||"":"").split(",").forEach(function(b){var f=b.split("-");b=e.trim(f[0]);var d=Math.round(b);if(1===f.length)e.isNumeric(b)?30<d?a=null:a.push(d.toString()):a=null;else if(2==f.length){var f=e.trim(f[1]),g=Math.round(f);e.isNumeric(b)&&e.isNumeric(f)?g<d||30<d||30<d||7<g-d?a=null:d===g?a.push(b):
a.push("%s-%s".format(d.toString(),g.toString())):a=null}});return null===a?this.options.openFlexAllowBlankDuration?null:this.options.openFlexDefaultDuration:a.join(", ")},loadFlexData:function(a){c.events.when("datepicker.FlexDatePicker.loaded_"+this.id(),function(a){a.flex_category&&this.changeFlexCategory(a.flex_category);a.weekend_depart&&this.weekendDepartTime.setValue(a.weekend_depart);a.weekend_return&&this.weekendReturnTime.setValue(a.weekend_return);a.depart_date_flex&&this.plusMinusThreeDepart.setValue(a.depart_date_flex);
a.return_date_flex&&this.plusMinusThreeReturn.setValue(a.return_date_flex);if(a.openflex_length_of_stay&&this.openFlexDuration&&(this.openFlexDuration.val(a.openflex_length_of_stay),this.categories.openflex&&"openflex"===a.flex_category))this.onOpenFlexDurationBlur();this.publishFlexUpdate(a)}.bind(this,a))},getStartDayElements:function(){var a=this.base();if("plusminusthree"===this.flexCategory){var b=this.getFlexDateRange(this.plusMinusThreeDepart.getValue(),this.startDate);e.extend(a,{flex:b})}return a},
getEndDayElements:function(){var a=this.base();if("plusminusthree"===this.flexCategory){var b=this.getFlexDateRange(this.plusMinusThreeReturn.getValue(),this.endDate);e.extend(a,{flex:b})}return a},getFlexDateRange:function(a,b){var f=0,d=0,g=[];switch(a){case "plusminusthree":d=f=3;break;case "plusminustwo":d=f=2;break;case "plusminusone":d=f=1;break;case "plusone":d=1;break;case "minusone":f=1}if(this.validateDate(b)){a=moment(b);g.push("[data-val\x3d%s]".format(b));for(b=1;b<=f;b++){var c=a.clone().subtract(b,
"days").valueOf();this.validateDate(c)&&g.push("[data-val\x3d%s]".format(c))}for(f=1;f<=d;f++)b=a.clone().add(f,"days").valueOf(),this.validateDate(b)&&g.push("[data-val\x3d%s]".format(b))}return g},getPresentationState:function(){var a=Array.prototype.slice.call(arguments);a.unshift("flexDatePickerPresentationStates");return this.base.apply(this,a)},handleTabIntoEvent:function(a){document.getSelection().removeAllRanges();this.base(a)},handleFocusAfterDateInput:function(a,b){this.dateMode===this.DateMode.SINGLE&&
b.tabForward&&!this.hasExactTab()?(b.event&&b.event.preventDefault(),this.plusMinusThreeDepart.select.focus()):!a&&b.tabForward?this.getFlexDateOptions().first().focus():this.base(a,b)},onFlexDateDropdownKeyDown:function(a){var b,c=a.shiftKey,d=this.getLastVisibleFlexDateOption(),g=e(a.target);a.which===this.Keys.TAB&&(this.dateMode!==this.DateMode.RANGE?b=this.calendar.getDayElement(this.getCurrentDayVal()):g.closest(this.plusMinusThreeDepart.element).length?(this.plusMinusThreeDepart.select.blur(),
b=c?d:this.plusMinusThreeReturn.select):g.closest(this.weekendDepartTime.element).length?(this.plusMinusThreeReturn.select.blur(),b=c?d:this.weekendReturnTime.select):g.closest(this.plusMinusThreeReturn.element).length?(this.plusMinusThreeReturn.select.blur(),this.setPicking("startDate"),b=c?this.plusMinusThreeDepart.select:this.calendar.getDayElement(this.getCurrentDayVal())):g.closest(this.weekendReturnTime.element).length&&(this.weekendReturnTime.select.blur(),this.setPicking("startDate"),b=c?
this.weekendDepartTime.select:this.calendar.getDayElement(this.getCurrentDayVal())),b&&(a.preventDefault(),b.focus()))},bindTabOrderEvents:function(){var a=this,b=a.getPresentationState("cat","default"),f=a.getPresentationState("cat","focused"),d=a.getPresentationState("cat","selected");this.flexOptions.on("keydown",".js-flexDateOption",function(b){var c=e(this).attr("data-flex-value");if(b.which===a.Keys.RETURN||b.which===a.Keys.SPACE)b.preventDefault(),a.handleFlexDateChange({currentTarget:this});
if(b.which===a.Keys.TAB)if(a.keyboardNav=!0,b.shiftKey&&(a.hasExactTab()&&"exact"===c||!a.hasExactTab()&&"plusminusthree"===c))b.preventDefault(),a.publishCurrentInputFocus();else if(!b.shiftKey&&e(this).attr("id")===a.getLastVisibleFlexDateOptionId())switch(b.preventDefault(),a.flexCategory){case "plusminusthree":case "exact":a.hasExactTab()&&"plusminusthree"!==a.flexCategory?"startDate"===a.picking?(0<a.startDate||a.changeDate(moment(new Date).startOf("day").valueOf(),!0),a.calendar.getDayElement(a.startDate).focus()):
"endDate"===a.picking&&(0<this.endDate?a.calendar.getDayElement(a.endDate).focus():a.changeDate(moment(new Date).startOf("day").valueOf(),!0),a.calendar.getDayElement(a.endDate).focus()):a.plusMinusThreeDepart.select.focus();break;case "weekend":a.weekendDepartTime.select.focus();break;case "openflex":a.openFlexDuration.focus()}}).on("blur",".js-flexDateOption",function(){c.dom.schedule(function(a){c.dom.swapClasses(a,f,b);a.is("[aria-selected\x3dtrue]")&&c.dom.swapClasses(a,b,d)}.bind(null,e(this)))}).on("focus",
".js-flexDateOption",function(g){a.keyboardNav&&c.dom.schedule(function(a){a.is("[aria-selected\x3dtrue]")&&c.dom.swapClasses(a,d,b);c.dom.swapClasses(a,b,f)}.bind(null,e(this)))})},getFlexDateOptions:function(){return this.flexOptions.find(".js-flexDateOption")},getLastVisibleFlexDateOption:function(){return e("#"+this.getLastVisibleFlexDateOptionId())},getLastVisibleFlexDateOptionId:function(){return this.dateMode===this.DateMode.SINGLE?this.id("plusminusthreeOption"):this.categories.openflex?this.id("openflexOption"):
this.id("weekendOption")},toggleFlexMode:function(a){this.flexHeader.toggleClass(this.getPresentationState("dateHeader","hidden"),!a);a||(this.changeFlexCategory("exact",!0),this.plusMinusThreeReturn.setValue("exact"),this.onPlusMinusThreeReturnChange(),this.plusMinusThreeDepart.setValue("exact"),this.onPlusMinusThreeDepartChange())}})})(R9,jQuery);(function(e,f){e.createWidgetClass("datepicker.StyleJamDatePicker",{DateMode:{SINGLE:"single",RANGE:"range",WEEKEND:"weekend",OPENFLEX:"openflex"},Keys:{LEFT:37,UP:38,RIGHT:39,DOWN:40,TAB:9,RETURN:13,PAGE_UP:33,PAGE_DOWN:34,SPACE:32,HOME:36,SHIFT:16,END:35,ESC:27},options:{msg:{},title:"",initDate:"",fullCssClass:"",startDate:"",endDate:"",dateMode:"range",group:"",updateGroup:"",minRange:0,change:null,dismiss:null,closeDelay:0,getFormData:null,consecutive:!0,delayShowDropdown:f.noop,showDropdownDelay:200,
keepOpenOnRangeStartChange:!0,hasPointer:!0,mobileBreakpoint:568,presentationStates:{},optionalReturn:!1,appendTo:null,hasCloseButton:!0},dateMode:"range",startDate:0,endDate:0,tempDate:0,weekendStartTime:{day:4,partial:""},weekendEndTime:{day:0,partial:""},picking:"startDate",prevState:null,visible:!1,html:null,fullScreen:!1,calendar:null,toolTip:null,init:function(){this.html=f("html");this.makeAboveCalendarContent();this.makeBelowCalendarContent();e.events.when("common.widgets.datepicker.stylejamcalendar.initialized",
function(a){this.calendar=a.instance;this.options.startDate&&this.validateDate(this.options.startDate)&&(this.startDate=moment(this.options.startDate).valueOf());this.options.endDate&&this.validateDate(this.options.endDate)&&(this.endDate=moment(this.options.endDate).valueOf());this.options.dateMode&&this.setDateMode(this.options.dateMode);this.addMeToCalendar()}.bind(this))},addMeToCalendar:function(){this.calendar.addPicker({id:this.id(),dateMode:this.dateMode,initDate:this.options.initDate,title:this.options.title,
cssClass:this.options.fullCssClass,group:this.options.group,onLoad:this.onLoad.bind(this),onUnload:this.onUnload.bind(this),onDayClick:this.onDayClick.bind(this),onDayOver:this.onDayPreviewOver.bind(this),onDayOut:this.onDayPreviewOut.bind(this),onDayKeydown:this.onDayKeydown.bind(this)})},onLoad:function(a){this.addAboveCalendarContent(a.aboveCalendarContainer,a.tabContainer);this.addBelowCalendarContent(a.belowCalendarContainer,a.tabContainer)},onUnload:function(){this.removeAboveCalendarContent();
this.removeBelowCalendarContent()},addAboveCalendarContent:function(a){this.aboveCalContent.length&&(a.append(this.aboveCalContent),this.toolTip.length&&a.append(this.toolTip))},addBelowCalendarContent:function(){},removeAboveCalendarContent:function(){this.aboveCalContent.length&&(this.element.append(this.aboveCalContent),this.toolTip.length&&this.aboveCalContent.append(this.toolTip))},removeBelowCalendarContent:function(){},addEventHandlers:function(){this.subscribe("DateInput.update",{group:this.options.group},
this.onDateInputUpdate.bind(this));this.subscribe("DateInput.summon",{group:this.options.group},this.onSummon.bind(this));this.subscribe("DateInput.dismiss",{group:this.options.group},this.onDismiss.bind(this));this.subscribe("DateInput.destroy",{group:this.options.group},this.destroy.bind(this));this.subscribe("DateInput.publishUpdate",this.publishUpdate.bind(this));this.subscribe("Calendar.monthchange",{group:this.options.group},this.onMonthChange.bind(this));this.subscribe("forceDismiss.DatePicker",
this.onDismiss.bind(this));f(document).on("click.DatePicker",this.hideOnClickOut.bind(this));f(window).on("resize.DatePicker",this.handleWindowResize.bind(this));this.options.optionalReturn&&this.subscribe("DateInput.clear",{group:this.options.group},this.onClear.bind(this))},destroy:function(){f(window).off("resize.DatePicker"+this.id());f(document).off("click.DatePicker"+this.id());this.base();this.element.remove()},getCssClass:function(){return[this.base(),"R9-Overlay"].join(" ")},hideOnClickOut:function(a){var b=
f(a.target).closest("[data-date-group\x3d%s]".format(this.options.group));if((a.originalEvent||!e.config.getBoolean("ui.xp.autoopen-dp",!1))&&this.isCalendarOpen()&&0===b.length)this.onDismiss()},handleWindowResize:function(){this.isCalendarOpen()&&(this.calendar.append(this.options.appendTo)||this.calendar.position(this.picking))},publishUpdate:function(a){f.extend(a,{updateGroup:this.options.updateGroup,group:this.options.group});e.events.publish("DatePicker.update",a)},onDateInputUpdate:function(a){if(this.isCalendarOpen()||
a.force)switch(a.clear&&this.clear(),a.picking&&this.updatePickingVal(a.picking),a.weekendStartTime&&(this.weekendStartTime=this.parseWeekendTimes(a.weekendStartTime)),a.weekendEndTime&&(this.weekendEndTime=this.parseWeekendTimes(a.weekendEndTime)),a.dateMode&&this.setDateMode(a.dateMode),a.action){case "preview":this.updatePickingVal(a.field);!a.previous&&a.value||this.removeDatePreview(a.previous,!0);a.value&&this.previewDate(a.value,a.preventUpdate);break;case "change":a.spinner&&this.handleSpinnerUpdate(a);
this.changeDate(a.value,a.focused||a.spinner,a.tabForward,a.event);break;case "tab":this.handleTabIntoEvent(a)}},onSummon:function(a){if(this.calendar)if(this.tempDate=0,"function"===typeof this.options.delayShowDropdown&&this.options.delayShowDropdown()&&!this.showDropdownTimeout)this.showDropdownTimeout=setTimeout(this.onSummon.bind(this,a),this.options.showDropdownDelay);else{null!==this.showDropdownTimeout&&(clearTimeout(this.showDropdownTimeout),this.showDropdownTimeout=null);this.setPicking(a.field,
!0);null!==this.options.getFormData?this.element.addClass("Buzz"):this.element.removeClass("Buzz");a.modal?this.element.addClass("InModal"):this.element.removeClass("InModal");a.sticky?this.element.addClass("InSticky"):this.element.removeClass("InSticky");this.validateDate(a.minDate,!0)&&this.setMinDate(a.minDate);if(!this.isCalendarOpen()||this.calendar.isDifferentPicker(this.id())){this.calendar.open(this.id());e.dom.swapClasses(this.aboveCalContent,this.getPresentationState("aboveCalContent","hidden"),
this.getPresentationState("aboveCalContent","visible"));var b=e.question.ask("DateInput.%s.startDate".format(this.options.group));b&&(this.startDate=b.value);if(this.dateMode===this.DateMode.RANGE){var c=e.question.ask("DateInput.%s.endDate".format(this.options.group));this.validateDateRange(b.value,c.value)&&(this.startDate=b.value,this.endDate=c.value);c&&(this.endDate=c.value)}"function"===typeof this.options.open&&this.options.open.call(this);e.events.publish("DatePicker.opened",this.options.group);
this.setDateMode(this.dateMode)}this.calendar.setDisplayHeight();this.calendar.append(this.options.appendTo)||this.calendar.position(this.getPicking());this.moveDateIntoView(this[a.field]);this.markSelectedDays();this.updateBuzzData();this.options.hasCloseButton&&this.bindEvent(this.findCloseLink(),"click",this.handleCloseEvent)}},onDismiss:function(a){this.shouldDismiss(a)&&(this.options.closeDelay?setTimeout(this.dismissDatePicker.bind(this,a),this.options.closeDelay):this.dismissDatePicker(a))},
dismissDatePicker:function(a){this.calendar&&(a=a||{},this.visible=!1,this.hideTooltip(),0!==this.tempDate&&this.changeDate(this.tempDate,!1,!1,null),this.calendar.buffer(this.options.appendTo),this.calendar.close(this.id()),e.dom.swapClasses(this.aboveCalContent,this.getPresentationState("aboveCalContent","visible"),this.getPresentationState("aboveCalContent","hidden")),this.publishUpdate(f.extend(a,{action:"blur",fields:{startDate:!0,endDate:!0},format:"display"})),"function"===typeof this.options.dismiss&&
this.options.dismiss(a),e.events.publish("DatePicker.closed",f.extend({},a,{group:this.options.group})))},shouldDismiss:function(a){return this.dateMode===this.DateMode.RANGE&&a&&this.options.consecutive&&(a.tabForward&&"startDate"===this.getPicking()||a.tabBackward&&"endDate"===this.getPicking())?!1:!0},onClear:function(a){},onDayClick:function(a){this.changeDate(f(a).data("val"))},canIncludeStartDateInRange:function(a,b){return this.validateDateRange(a,b)},changeDate:function(a,b,c,d){var g=!1,
e=!0,f=this.getPicking(),h={action:"change",fields:{}};this.tempDate=0;if(this.dateMode===this.DateMode.RANGE){if("startDate"===this.getPicking()&&this.validateDate(a))this.startDate===a&&this.options.consecutive?(e=!1,this.setPicking("endDate",c,void 0,c)):(this.startDate=a,h.fields.startDate=a,this.canIncludeStartDateInRange(a,this.endDate)||(this.endDate=0,this.options.optionalReturn?h.fields.endDate=null:(h.fields.endDate=this.getMinEndDate(),this.endDate=h.fields.endDate)),this.moveDateIntoView(a),
this.markSelectedDays(),!b&&this.isCalendarOpen()&&((0===this.endDate||this.options.keepOpenOnRangeStartChange)&&this.options.consecutive?this.setPicking("endDate",c,void 0,c):g=!1===b)),"endDate"===this.wasPicking&&this.endDate&&(h.fields.endDate=this.endDate);else if("endDate"===this.getPicking()&&this.validateDate(a))if(this.endDate===a)e=!1,0===this.startDate&&this.options.consecutive?this.setPicking("startDate"):g=!b;else{if(this.validateDateRange(this.startDate,a)||!this.startDate)this.endDate=
a,h.fields.endDate=a;this.startDate||(this.startDate=this.getMinStartDate(),h.fields.startDate=this.startDate);this.moveDateIntoView(this.endDate);this.markSelectedDays();b||(0===this.startDate&&this.options.consecutive?this.setPicking("startDate"):g=!0)}h.picking=this.getPicking()}else{this.moveDateIntoView(a);h.fields.startDate=a;if(this.validateDate(this.endDate)&&!this.validateDateRange(a,this.endDate)){var l=Math.max(this.options.minRange,1),l=moment(a).add(l,"days");h.fields.endDate=l.valueOf();
this.endDate=h.fields.endDate}this.startDate=a;this.markSelectedDays();b||(g=!0)}h.tabForward=c;e&&this.publishUpdate(h);"function"===typeof this.options.change&&(a=[this.startDate],a.push(this.endDate?this.endDate:null),a.push(f),this.options.change.apply(this,a));g&&(g={},g.field=this.picking,g.tabForward=c,g.event=d,this.onDismiss(g))},moveDateIntoView:function(a){this.isCalendarOpen()&&0!==a&&(a=this.calendar.calculateMonthOffset(a),0!==a&&this.calendar.changeMonth(a))},clear:function(){this.endDate=
this.startDate=0;this.setPicking("startDate");this.clearDayState("preview hover highlighted selected startDate endDate");this.publishUpdate({action:"clear",fields:{startDate:0,endDate:0}})},onMonthChange:function(){this.updateBuzzData();this.markSelectedDays()},clearDayState:function(a){this.calendar.clearDayState(a)},validateDate:function(a,b){if("undefined"===typeof a||0===a||!this.calendar)return!1;a=moment(a);var c=this.calendar.getMinDate(this.id());if(a.isValid()){if(a.isBefore(this.calendar.now)&&
!this.options.allowPastDates||!b&&null!==c&&a.isBefore(c))return!1}else return!1;return!0},validateDateRange:function(a,b){return a&&b?this.validateMinRange(a,b)&&this.validateDate(a)&&this.validateDate(b):!1},validateMinRange:function(a,b){a=moment(a);return moment(b).diff(a,"days")>=this.options.minRange},getMinStartDate:function(){return this.endDate?moment(this.endDate).subtract(this.options.minRange,"days").valueOf():0},getMinEndDate:function(){return this.startDate?moment(this.startDate).add(this.options.minRange,
"days").valueOf():0},onDayPreviewOver:function(a){var b=f(a).data("val");this.previewDate(b);f(a).attr("data-tip")&&this.showTooltip(f(a))},previewDate:function(a,b){var c=moment(a),d={action:"preview",fields:{},picking:this.getPicking()};!a||c.isBefore(this.calendar.now)?(c=this.calendar.now.clone(),a=c.valueOf()):c.isSameOrAfter(this.calendar.maxDate)&&(c=this.calendar.maxDate.clone(),a=c.valueOf());this.dateMode===this.DateMode.RANGE?"endDate"===this.getPicking()&&0!==this.startDate?this.validateMinRange(this.startDate,
a)?this.validateDateRange(this.startDate,a)?d.fields[this.getPicking()]=a:d.endDate=this.getMinEndDate():(0===this.endDate?(this.endDate=this.startDate,this.startDate=0,d.fields={startDate:a,endDate:this.endDate}):d.fields={startDate:a,endDate:0},this.wasPicking=this.getPicking(),this.setPicking("startDate",!1,!0),d.picking="startDate"):d.fields[this.getPicking()]=a:d.fields.startDate=a;b||this.publishUpdate(d);this.moveDateIntoView(a);this.markPreviewedDays(a)},removeDatePreview:function(a,b){if(this.isCalendarOpen()){a=
{action:"preview",fields:{startDate:0,endDate:0},clear:!0};this.clearDayState("preview hover");this.hideTooltip();if(this.wasPicking){var c=this[this.wasPicking],d=this[this.getPicking()];if(0===d||0===c)this[this.wasPicking]=d,this[this.getPicking()]=c;delete a.fields[this.wasPicking];this.setPicking(this.wasPicking,!1,!0);this.wasPicking=null;this.markSelectedDays()}a.picking=this.getPicking();b||this.publishUpdate(a)}},onDayPreviewOut:function(a){a=f(a).data("val");this.removeDatePreview(a)},setDateMode:function(a){this.dateMode=
a;this.dateMode!==this.DateMode.RANGE&&this.setPicking("startDate");this.isCalendarOpen()&&this.markSelectedDays();e.events.publish("datepicker.setdatemode",{dateMode:a})},computeActiveDates:function(a,b){switch(this.dateMode){case this.DateMode.RANGE:return this.computeActiveRangeDates(a,b);default:return a?[a.format(b)]:[b]}},canSelectAsStartDate:function(a,b){return a<=b},computePreSelectedRangeDates:function(a){var b;if(a&&a.length){var c=this.calendar.getSelectableDays(".highlighted,.selected");
b=c.not(a.join());if(c.length===b.length)return null}return b},computeActiveRangeDates:function(a,b){var c;b||(b=this[this.getPicking()]);b&&(c=moment(b));var d=[];if(c)if("startDate"===this.getPicking()&&this.endDate&&c.valueOf()<=this.endDate){var g=this.endDate;for(this.calendar.getMonthDate(3).isSameOrBefore(moment(this.endDate))&&(g=this.calendar.getMonthDate(3).valueOf());this.canSelectAsStartDate(c.valueOf(),g);)a?d.push(a.format(c.valueOf())):d.push(c.valueOf()),c.add(1,"day")}else if("endDate"===
this.getPicking()&&this.startDate&&c.valueOf()>=this.startDate)for(g=this.startDate,this.calendar.getMonthDate(-1).isSameOrAfter(moment(this.startDate))&&(g=this.calendar.getMonthDate(-1).valueOf());c.valueOf()>=g;)a?d.unshift(a.format(c.valueOf())):d.unshift(c.valueOf()),c.add(-1,"day");else a?d.push(a.format(b)):d.push(b);d.length||(a?d.push(a.format(b)):d.push(b));return d},computeActiveWeekendDates:function(a,b){b=b?moment(b):moment(this.startDate);for(var c=b.clone().add(5,"weeks"),d={selected:[],
highlighted:[]},g=!1,e=[],f=[];b.isSameOrBefore(c);)!g&&b.day()>this.weekendStartTime.day||(b.day()===this.weekendStartTime.day?(g=!0,e=[],f=[],a?e.push(a.format(b.valueOf())):e.push(b.valueOf())):b.day()===this.weekendEndTime.day&&g?(a?e.push(a.format(b.valueOf())):e.push(b.valueOf()),d.selected=d.selected.concat(e),d.highlighted=d.highlighted.concat(f)):(b.day()>this.weekendStartTime.day||b.day()<this.weekendEndTime.day)&&g&&(a?f.push(a.format(b.valueOf())):f.push(b.valueOf()))),b.add(1,"day");
return d},computeActiveOpenFlexDates:function(a,b){b=b?moment(b):moment(this.startDate);for(var c=b.clone().add(5,"weeks"),d=[];b.isSameOrBefore(c);)a?d.push(a.format(b.valueOf())):d.push(b.valueOf()),b.add(1,"day");return d},parseWeekendTimes:function(a){var b=a.split("_");a=b[0];b=b[1];return{day:moment().set("day",a).day(),partial:"ANYTIME"!==b?b:""}},markSelectedDays:function(){var a;if(this.isCalendarOpen())switch(this.clearDayState("highlighted preview selected startDate endDate hover"),this.dateMode){case this.DateMode.RANGE:a=
this.computeActiveDates("[data-val\x3d%s]");1<a.length&&this.highlightDates(a);this.startDate&&(a=this.getStartDayElements(),a.flex&&this.calendar.markFlex(a.flex),a.exact&&this.markStartDate(a.exact));this.endDate&&(a=this.getEndDayElements(),a.flex&&this.calendar.markFlex(a.flex),a.exact&&this.markEndDate(a.exact));break;default:this.calendar.selectDate(this.startDate)}},highlightDates:function(a){this.calendar.highlightDates(a)},markStartDate:function(a){this.calendar.markStartDate(a)},markEndDate:function(a){this.calendar.markEndDate(a)},
getStartDayElements:function(){return{exact:this.startDate}},getEndDayElements:function(){return{exact:this.endDate}},markPreviewedDays:function(a){if(this.isCalendarOpen()){this.clearDayState("preview hover");var b=this.computeActiveDates("[data-val\x3d%s]",a);this.calendar.markPreviewDates(b);this.calendar.hoverDay(a)}},setPicking:function(a,b,c,d){if(this.getPicking()!==a){this.tempDate=0;var e={},f={};e[this.getPicking()]=!0;f[a]=!0;this.updatePickingVal(a);this.isCalendarOpen()&&(this.calendar.position(this.getPicking(),
c),b||this.publishUpdate({action:"focus",fields:f,format:"input"}),this.publishUpdate({action:"blur",fields:e,tabForward:d}))}},updatePickingVal:function(a){this.picking=a},getPicking:function(){return this.picking},findCloseLink:function(){return this.getChildElement("closeBtn")},handleCloseEvent:function(){this.onDismiss()},bindEvent:function(a,b,c){var d=this;b+="."+this.id();a.off(b).on(b,function(a){return c.call(d,this,a)})},isBuzzEnabled:function(){return"function"===typeof this.options.getFormData&&
e.DatePicker&&e.DatePicker.BuzzData},updateBuzzData:function(){this.isBuzzEnabled()&&(new e.DatePicker.BuzzData).fetch(this.options.getFormData(),this.handleBuzzUpdate.bind(this))},handleBuzzUpdate:function(a){this.calendar&&this.calendar.handleBuzzUpdate(a)},makeAboveCalendarContent:function(){this.aboveCalContent=e.template.renderElement("aboveCalContent",{dayTipId:this.id("BUZZ_LOW"),closeBtnId:this.id("closeBtn")}).appendTo(this.element);this.toolTip=this.getChildElement("BUZZ_LOW")},makeBelowCalendarContent:function(){},
showTooltip:function(a){a=a.offset();var b=this.calendar.element.offset();a={top:Math.round(a.top-b.top),left:Math.round(a.left-b.left)};this.toolTip.length&&(this.toolTip.css(a),e.dom.swapClasses(this.toolTip,this.getPresentationState("toolTip","hidden"),this.getPresentationState("toolTip","visible")))},hideTooltip:function(){this.toolTip&&e.dom.swapClasses(this.toolTip,this.getPresentationState("toolTip","visible"),this.getPresentationState("toolTip","hidden"))},setMinDate:function(a){this.calendar.setMinDate(a,
this.id())},getPresentationState:function(){var a=Array.prototype.slice.call(arguments),b=0,c=this.options.presentationStates;do c=c.hasOwnProperty(a[b])?c[a[b]]:null,b++;while(null!=c&&b<a.length);return c},onDayKeydown:function(a,b){a=moment(this.getCurrentDayVal());var c=!0,d=!1,e=this.picking,f,k=!0,h;switch(b.which){case this.Keys.UP:a.subtract(1,"week");break;case this.Keys.DOWN:a.add(1,"week");break;case this.Keys.LEFT:a.subtract(1,"day");break;case this.Keys.RIGHT:a.add(1,"day");break;case this.Keys.PAGE_UP:b.ctrlKey||
b.metaKey?a.subtract(1,"year"):a.subtract(1,"month");break;case this.Keys.PAGE_DOWN:b.ctrlKey||b.metaKey?a.add(1,"year"):a.add(1,"month");break;case this.Keys.HOME:a=a.startOf("month");break;case this.Keys.END:a=a.endOf("month");break;case this.Keys.SPACE:this.tempDate=0;d=!0;c=!1;f=!0;break;case this.Keys.TAB:case this.Keys.RETURN:this.tempDate=0;c=!1;d=!b.shiftKey;k=!1;h=!0;break;case this.Keys.ESC:this.tempDate=0;this.onDismiss();break;default:c=k=!1}c&&this.validateDate(a.valueOf(),!1)&&("endDate"!==
this.picking||this.validateDateRange(this.startDate,a.valueOf()))&&(this.tempDate=a.valueOf(),this.previewDate(this.tempDate),this.calendar.getDayElement(this.tempDate).focus());d&&this.changeDate(a.valueOf(),f,void 0,b);k&&b.preventDefault();h&&this.handleDayNextFocus(b,e)},getCurrentDayVal:function(){var a=this.tempDate?this.tempDate:this[this.getPicking()];0===a&&(a="startDate"===this.getPicking()||0===this.startDate?moment().startOf("day").valueOf():this.getMinEndDate());return a},publishCurrentInputFocus:function(){var a=
{};a[this.getPicking()]=!0;this.publishUpdate({action:"focus",fields:a,format:"input"})},handleTabIntoEvent:function(a){this.setPicking(a.field);"startDate"===this.getPicking()?0<this.startDate?(this.changeDate(this.startDate,!0,a.tabForward,a.event),this.handleFocusAfterDateInput(!0,a)):(this.changeDate(moment(this.calendar.getMinDate()).startOf("day").valueOf(),!0),this.calendar.getDayElement(this.startDate).focus()):"endDate"===this.getPicking()&&(0<this.endDate?(this.changeDate(this.endDate,!0,
a.tabForward,a.event),this.handleFocusAfterDateInput(!1,a)):this.startDate?this.changeDate(moment(this.getMinEndDate()).startOf("day").valueOf(),!0):this.changeDate(moment((new Date).valueOf()).startOf("day").valueOf(),!0))},handleFocusAfterDateInput:function(a,b){b=f.extend(b,{tabBackward:!b.tabForward});if(a)if(b.tabForward&&this.dateMode===this.DateMode.RANGE)b.event&&b.event.preventDefault(),this.setPicking("endDate"),this.publishCurrentInputFocus();else this.onDismiss(b);else b.event&&b.event.preventDefault(),
b.tabForward?(this.setPicking("startDate"),this.calendar.getDayElement(this.startDate).focus()):(this.setPicking("startDate"),this.publishCurrentInputFocus())},handleDayNextFocus:function(a,b){var c,d=a.shiftKey;"endDate"===b?d?(a.preventDefault(),this.setPicking("startDate"),this.calendar.getDayElement(this.startDate).focus()):c=!0:d?(a.preventDefault(),this.publishCurrentInputFocus()):this.dateMode===this.DateMode.RANGE?(a.preventDefault(),this.setPicking("endDate"),this.calendar.getDayElement(this.endDate).focus()):
c=!0;if(c)this.onDismiss({event:a,returnEvent:a.which===this.Keys.RETURN,tabForward:!d,tabBackward:d})},handleSpinnerUpdate:function(a){var b=a.currentValue,c=a.delta;b||("endDate"===this.getPicking()&&this.startDate?b=this.getMinEndDate():(b=(new Date).valueOf(),c=1));a.value=moment(b).add(c,"day").valueOf()},isCalendarOpen:function(){return this.calendar&&this.calendar.isOpen&&this.calendar.currentPickerId===this.id()}})})(R9,jQuery);(function(e,g,h){e.createWidgetClass("datepicker.ColorCodedDatePicker","common.widgets.datepicker.StyleJamFlexDatePickerHorizontal",{footerContent:null,formDataQuestion:"flights.fd.searchform",formDataQuestionRP:"flights.rp.searchform",priceType:{GOOD:0,AVERAGE:50,EXPENSIVE:90},options:{priceInCalendarEnabled:!1,withHoverPrice:!1,messages:{displayPriceFmt:""},formId:""},state:{dataSet:null,currencyCode:"",economyCabin:!0,noChildren:!0},init:function(){this.base();this.priceDataProvider=new e.common.widgets.datepicker.PredictionDataProvider(this.id("predictionProvider"),
{formId:this.options.formId,onFetchSuccess:this.handleFetchSuccess.bind(this),onFetchFail:this.handleFetchFail.bind(this)})},addEventHandlers:function(){this.base();this.subscribe("flights.search.travelers.change",this._handleTravelersChange.bind(this));this.subscribe("flights.search.cabinType.change",this._handleCabinChange.bind(this))},handleFetchSuccess:function(){this.checkAndUpdatePriceIndicators()},handleFetchFail:function(){this.clearPriceIndicators();this.state.dataSet=null},_handleTravelersChange:function(a){if(a=
a&&a.data)this.state.noChildren=0===a.child+a.seatInfant+a.lapInfant},_handleCabinChange:function(a){if(a=a&&a.value)this.state.economyCabin="e"===a},addBelowCalendarContent:function(a){this.footerContent&&this.footerContent.length&&a.empty().append(this.footerContent)},removeBelowCalendarContent:function(){this.footerContent&&this.footerContent.length&&this.element.append(this.footerContent)},makeBelowCalendarContent:function(){this.options.priceInCalendarEnabled&&(this.footerContent=g(this.createFooter()).appendTo(this.element))},
createFooter:function(){return e.template.render("flexDatePickerFooter",{footerId:this.id("footer")})},changeFlexCategory:function(a,b){this.base(a,b);this.checkAndUpdatePriceIndicators()},isExactTab:function(){return"exact"===this.flexCategory||"plusminusthree"===this.flexCategory},checkAndUpdatePriceIndicators:function(){this.isCalendarOpen()&&(this.state.economyCabin&&this.state.noChildren&&("exact"===this.flexCategory||"plusminusthree"===this.flexCategory)&&this.dateMode===this.DateMode.RANGE?
(this.calendar.clearDayState("highlighted preview selected startDate endDate hover"),this.markSelectedDays(),this.updatePriceDataInDates()):(this.swapClasses(this.footerContent,"FlexDateFooter--visible","FlexDateFooter--hidden"),this.clearPriceIndicators(),this.calendar.getSelectableDays().addClass(this.getStlBlocks("Calendar__ColDay--pic Calendar__ColDay--pic--active")),this.markSelectedDays()))},changeDate:function(a,b,d,c){if("startDate"===this.getPicking()&&this.validateDate(a)){if(!this.calendar.getCurrentPicker()){this.base(a,
b,d,c);return}this.clearDayState("previnrange")}this.base(a,b,d,c)},highlightDates:function(a){this.isExactTab()&&this.dateMode===this.DateMode.RANGE?(this.clearPriceIndicators(a),this.calendar.highlightDates(a,function(){return this.getStlBlocks("Calendar__ColDay--pic--highlighted")}.bind(this))):this.base(a)},markStartDate:function(a){if(this.isExactTab()&&this.dateMode===this.DateMode.RANGE){var b=this;this.clearPriceIndicators(["[data-val\x3d%s]".format(a)]);this.calendar.selectDate(a,function(){return"startDate "+
b.getStlBlocks("Calendar__ColDay--pic--selected")},function(){return b.dayStateClasses("hover highlighted")})}else this.base(a)},markEndDate:function(a){if(this.isExactTab()&&this.dateMode===this.DateMode.RANGE){var b=this;this.clearPriceIndicators(["[data-val\x3d%s]".format(a)]);this.calendar.selectDate(a,function(){return"endDate "+b.getStlBlocks("Calendar__ColDay--pic--selected")},function(){return b.dayStateClasses("hover highlighted")})}else this.base(a)},onMonthChange:function(){this.isExactTab()?
(this.markSelectedDays(),this.checkAndUpdatePriceIndicators(),this.logEvent({action:"month-change"})):this.base()},onDismiss:function(a){this.base(a);this.swapClasses(this.footerContent,"FlexDateFooter--visible","FlexDateFooter--hidden");this.logEvent({action:"dismiss"})},onSummon:function(a){this.base(a);this.isCalendarOpen()&&(this.dateMode===this.DateMode.RANGE?"weekend"!==this.flexCategory&&"openflex"!==this.flexCategory?(this.updateTravelersAndCabinType(),this.checkAndUpdatePriceIndicators()):
this.swapClasses(this.footerContent,"FlexDateFooter--visible","FlexDateFooter--hidden"):(this.swapClasses(this.footerContent,"FlexDateFooter--visible","FlexDateFooter--hidden"),this.calendar.getSelectableDays().addClass(this.getStlBlocks("Calendar__ColDay--pic Calendar__ColDay--pic--active"))),this.calendar.setDisplayHeight())},updateTravelersAndCabinType:function(){var a=e.question.ask("SearchPage.view");if(a=e.question.ask("RP"===a?this.formDataQuestionRP:this.formDataQuestion))this.state.noChildren=
0===a.child+a.seatInfant+a.lapInfant,this.state.economyCabin="e"===a.cabin},updatePriceDataInDates:function(){if(this.calendar.getCurrentPicker()&&this.isCalendarOpen()){var a=h(this.calendar.getCurrentDate()).startOf("month"),b=a.clone().add(1,"months").endOf("month"),d=a.clone(),c=h().startOf("day");this.calendar.getSelectableDays().addClass(this.getStlBlocks("Calendar__ColDay--pic Calendar__ColDay--pic--active"));this.priceDataProvider.getDataSet().then(function(a){var f=this.state.dataSet=a.dataSet;
this.state.currencyCode=a.parameters.currency;var e=[];if(f)for(;d.isSameOrBefore(b);){if(!d.isBefore(c)){var k=this.priceDataProvider.getPriceDatum(d,f),g={};if(k){var h=this.dateToStr(d);g.forDate=h;g.price=k.meanPrice;g.displayPrice=k.meanPriceDisplay;e.push(g)}}d.add(1,"days")}f=e.reduce(function(a,b){return Math.min(a,b.price)},Infinity);k=e.reduce(function(a,b){return Math.max(a,b.price)},-1);this.updateFooterBar(a,f,k);this.updateCalendarDates(e,f,k);this.logEvent({action:"update-colors"})}.bind(this)).fail(function(){this.state.dataSet=
null}.bind(this))}},updateFooterBar:function(a,b,d){if(this.footerContent)if(d<b)this.swapClasses(this.footerContent,"FlexDateFooter--visible","FlexDateFooter--hidden");else{this.swapClasses(this.footerContent,"FlexDateFooter--hidden","FlexDateFooter--visible");var c=e.Common.Utils.String.formatString(this.options.messages.displayPriceFmt,e.Common.Utils.formatPrice(b,a.parameters.currency)),f=e.Common.Utils.String.formatString(this.options.messages.displayPriceFmt,e.Common.Utils.formatPrice(b+.9*
(d-b),a.parameters.currency)),l=e.Common.Utils.String.formatString(this.options.messages.displayPriceFmt,e.Common.Utils.formatPrice(b+.3*(d-b),a.parameters.currency));0===d-b&&(l=e.Common.Utils.String.formatString(this.options.messages.displayPriceFmt,e.Common.Utils.formatPrice(1.3*b,a.parameters.currency)),f=e.Common.Utils.String.formatString(this.options.messages.displayPriceFmt,e.Common.Utils.formatPrice(1.9*b,a.parameters.currency)));this.footerContent.find(".min-price").text(c);this.footerContent.find(".mid-price").text(l);
this.footerContent.find(".max-price").text(f);this.logEvent({action:"update-legends"})}},updateCalendarDates:function(a,b,d){a=a.reduce(function(a,f){var c=f.forDate,e=this.priceType.GOOD;if(b<=d){var g=(f.price-b)/(d-b)*100;90<g?e=this.priceType.EXPENSIVE:30<g&&(e=this.priceType.AVERAGE)}a[c]={date:f.forDate,val:f.price,display:f.displayPrice,priceType:e};return a}.bind(this),{});this.updateDatesWithPriceData({minVal:b,maxVal:d,dataSet:a})},updateDatesWithPriceData:function(a){var b=a.dataSet;this.calendar.getSelectableDays().each(function(a,
c){a=g(c);c=a.attr("data-val");c=h(parseInt(c));a.addClass(this.getStlBlocks("Calendar__ColDay--pic Calendar__ColDay--pic--active"));c.isValid()?(a.data("pricedata",null),c=c.format("YYYY-MM-DD"),b[c]&&(a.data("pricedata",JSON.stringify(b[c])),a.is(".selected")||a.is(".highlighted")||e.dom.swapClasses(a,this.getStlBlocks("Calendar__ColDay--pic--0 Calendar__ColDay--pic--50 Calendar__ColDay--pic--90"),this.getStlBlocks("Calendar__ColDay--pic Calendar__ColDay--pic--active Calendar__ColDay--pic--"+b[c].priceType))),
c="",a.is(".selected")&&(c+=" Calendar__ColDay--pic--selected"),a.is(".highlighted")&&(c+=" Calendar__ColDay--pic--highlighted"),e.dom.swapClasses(a,"",this.getStlBlocks(c))):e.dom.swapClasses(a,this.dayStateClasses("preview hover"),"")}.bind(this))},dayStateClasses:function(a){var b="Calendar__ColDay--pic--0 Calendar__ColDay--pic--50 Calendar__ColDay--pic--90 ",b=a?b+a.split(" ").map(function(a){return"Calendar__ColDay--pic--"+a}).join(" "):b+" Calendar__ColDay--pic--selected Calendar__ColDay--pic--highlighted Calendar__ColDay--pic--hover Calendar__ColDay--pic--preview";
return this.getStlBlocks(b)},resetColColors:function(a,b){var d=this;return function(c){if(!d.isWeekendOrMonthView()){var f;try{f=JSON.parse(g(c).data("pricedata"))}catch(n){}var e=["Calendar__ColDay--pic","Calendar__ColDay--pic--active"],h=c.is(".highlighted")&&!a,k=c.is(".selected")&&!b;!f||h||k?c.is(".highlighted")?e.push("Calendar__ColDay--pic--highlighted"):c.is(".selected")&&e.push("Calendar__ColDay--pic--selected"):e.push("Calendar__ColDay--pic--"+f.priceType);return d.getStlBlocks(e.join(" "))}}},
clearDayState:function(a,b,d){var c=this;if(this.isWeekendOrMonthView())return this.base(a);this.calendar.clearDayState(a,b||this.resetColColors(),d||function(){return c.dayStateClasses(a)})},clearPriceIndicators:function(a){this.calendar.getSelectableDays(a?a.join(","):null).removeClass(this.dayStateClasses())},dateToStr:function(a){return h(a).format("YYYY-MM-DD")},strToDate:function(a){return h(a,"YYYY-MM-DD")},isWeekendOrMonthView:function(){return"exact"!==this.flexCategory&&"plusminusthree"!==
this.flexCategory},markPreviewedDays:function(a){if(this.isWeekendOrMonthView())this.base(a);else if(this.isCalendarOpen()){this.clearDayState("preview hover");var b=this.computeActiveDates("[data-val\x3d%s]",a),d=this.calendar.getSelectableDays(b.join()),c=this.computePreSelectedRangeDates(b),f=this;c&&(c.addClass("previnrange"),this.clearDayState("previnrange",this.resetColColors(!0,!0),function(){return f.getStlBlocks("Calendar__ColDay--pic--highlighted Calendar__ColDay--pic--selected")}));this.calendar.markPreviewDates(b,
function(){return f.getStlBlocks("Calendar__ColDay--pic Calendar__ColDay--pic--active Calendar__ColDay--pic--preview")},function(){return f.dayStateClasses("")});d.filter(".startDate,.endDate").removeClass(this.dayStateClasses()+" previnrange").addClass(function(){var b=g(this),c=b.data("val");return"startDate"===f.getPicking()&&b.is(".startDate")&&!b.is(".endDate")&&c!==a||"endDate"===f.getPicking()&&b.is(".endDate")&&!b.is(".startDate")&&c!==a?f.getStlBlocks("Calendar__ColDay--pic--preview")+" preview":
f.getStlBlocks("Calendar__ColDay--pic--selected")});this.calendar.hoverDay(a,function(){return f.getStlBlock("Calendar__ColDay--pic--hover")},function(){return f.dayStateClasses("preview")+" preview"})}},removeDatePreview:function(a,b){this.base(a,b);this.isWeekendOrMonthView()||(a=this.calendar.getSelectableDays(".day.highlighted,.day.startDate,.day.endDate"),a.removeClass(this.getStlBlocks("Calendar__ColDay--pic--preview")+" preview"),a.filter(".startDate").removeClass(this.dayStateClasses()).addClass(this.getStlBlocks("Calendar__ColDay--pic--startDate Calendar__ColDay--pic--selected")),
a.filter(".endDate").removeClass(this.dayStateClasses()).addClass(this.getStlBlocks("Calendar__ColDay--pic--endDate Calendar__ColDay--pic--selected")),a.filter(".highlighted").removeClass(this.dayStateClasses()).addClass(this.getStlBlocks("Calendar__ColDay--pic--highlighted")))},onDayPreviewOver:function(a){var b=g(a).data("val");this.previewDate(b);this.options.withHoverPrice&&this.dateMode===this.DateMode.RANGE&&this.showTooltip(g(a))},showTooltip:function(a){var b=a.offset(),d=this.calendar.element.offset(),
c=this.calendar.element.outerWidth(),b={top:Math.round(b.top-d.top-2),left:Math.round(b.left-d.left)};(d=this.calcTooltipVal(a))&&this.toolTip.length&&(this.toolTip.text(e.Common.Utils.String.formatString(this.options.messages.displayPriceFmt,d)),e.dom.swapClasses(this.toolTip,this.getPresentationState("toolTip","hidden"),this.getPresentationState("toolTip","visible")),a=this.toolTip.outerWidth()/2-a[0].offsetWidth,b.left-=a,this.toolTip.css(b),c<b.left+this.toolTip.outerWidth()?(this.toolTip.css("left",
c-this.toolTip.outerWidth()),this.toolTip.addClass(this.getStlBlock("ColorCodedTip--touchedRight"))):this.toolTip.removeClass(this.getStlBlock("ColorCodedTip--touchedRight")),this.logEvent({action:"show-tooltip"}))},calcTooltipVal:function(a){var b=g(a).data("pricedata"),d=h(parseInt(g(a).data("val"))),c=0<this.startDate&&h(this.startDate),f=0<this.endDate&&h(this.endDate),e=this.getPicking();if(!this.state.dataSet)return null;try{b=JSON.parse(b||"{}")}catch(m){this.log.warn("Error parsing priceData for date, "+
g(a).data("val")),b=null}if("endDate"===e&&this.startDate&&d.isSameOrAfter(c)){if((f=this.state.dataSet[c.format("YYYY-MM-DD")])&&f.returnDates&&f.returnDates[d.format("YYYY-MM-DD")])return f.returnDates[d.format("YYYY-MM-DD")].priceDisplay}else if("startDate"===e&&(!this.endDate||f&&d.isSameOrBefore(f))){if((d=this.state.dataSet[d.format("YYYY-MM-DD")])&&d.returnDates&&this.endDate&&d.returnDates[f.format("YYYY-MM-DD")])return d.returnDates[f.format("YYYY-MM-DD")].priceDisplay}else return b?b.display:
null;return null},logEvent:function(a){a=g.extend({},a,{category:this.options.withHoverPrice?"color-coded-calendar-with-hover-price":"color-coded-calendar"});e.Analytics.api.trackEvent(a)},isBuzzEnabled:function(){return!1}})})(R9,jQuery,moment);(function(b,c){b.createWidgetClass("datepicker.StyleJamDateRangeInput",{separator:null,options:{group:"",dateMode:"range",datePickerId:null,responsive:!1,responsiveMobileOnly:!1,dateRangeInputFlex:null,dateRangeInputBlurred:null,dateRangeInputFocused:null,flexIconVisible:null,flexIconHidden:null,displayFlexHidden:null,endInputHidden:null,presentationBase:"",changeEvent:null},startWrapper:null,endWrapper:null,flexWrapper:null,suspendBlur:!1,init:function(){this.separator=this.getChildElement("separator");
this.$flexIcon=this.element.find(".js-flexIcon");this.endCol=this.getChildElement("end");this.endWrapper=this.getChildElement("endWrapper");this.flexWrapper=this.getChildElement("flexWrapper")},addEventHandlers:function(){var a=this;this.subscribe("DatePicker.update",{group:this.options.group},this.onDatePickerUpdate.bind(this));this.options.changeEvent&&(this.subscribe(this.options.changeEvent+".change",function(b){if(!b.namespace||a.id().startsWith(b.namespace))a.onDisplayCatChange(b.value)}),this.subscribe(this.options.changeEvent+
".set",this.onDisplayCatChange.bind(this)));this.subscribe("DatePicker.opened",this.options.group,this.toggleFocusState.bind(this,!0));this.subscribe("DatePicker.closed",{group:this.options.group},this.toggleFocusState.bind(this,!1))},toggleFocusState:function(a){a?(b.dom.swapClasses(this.element,this.options.dateRangeInputBlurred,this.options.dateRangeInputFocused),b.events.publish("DateRangeInput.opened",this.options.group)):(b.dom.swapClasses(this.element,this.options.dateRangeInputFocused,this.options.dateRangeInputBlurred),
b.events.publish("DateRangeInput.closed",this.options.group))},onInputFocus:function(){var a=this;this.toggleFocusState(!0);this.suspendBlur=!0;setTimeout(function(){a.suspendBlur=!1},100)},onInputBlur:function(){this.suspendBlur||this.toggleFocusState(!1)},onDatePickerUpdate:function(a){"flex"===a.action&&("openflex"===a.data.flex_category||"weekend"==a.data.flex_category?(this.setDateMode("range",a.data.flex_category),this.showFlexDisplay()):(this.toggleFlex(a.data.flex_category),this.hideFlexDisplay()),
this.options.flexDisplayEnabled&&("plusminusthree"===a.data.flex_category?"exact"===a.data.depart_date_flex&&"exact"===a.data.return_date_flex?this.hideFlexIcon():this.showFlexIcon():"exact"===a.data.flex_category?this.hideFlexIcon():this.showFlexIcon()))},onDisplayCatChange:function(a){switch(a){case "oneway":this.setDateMode("single");break;case "roundtrip":this.setDateMode("range")}},getField:function(a){return"range"===this.options.dateMode?a.offsetX<=this.separator.position().left?"startDate":
"endDate":"startDate"},setDateMode:function(a,b){this.options.dateMode=a;"single"===a?(this.endCol.attr("aria-hidden","true"),this.separator.attr("aria-hidden","true"),this.hideEndDate()):(this.endCol.attr("aria-hidden","false"),this.separator.attr("aria-hidden","false"),this.showEndDate(),this.options.changeEvent&&this.subscribe(this.options.changeEvent,this.onDisplayCatChange.bind(this)));"undefined"!==typeof b&&this.toggleFlex(b)},toggleFlex:function(a){"weekend"===a||"openflex"===a?(this.element.addClass("mode-flex"),
this.flexWrapper.attr("aria-hidden","false"),this.endWrapper.attr("aria-hidden","true")):(this.element.removeClass("mode-flex"),this.flexWrapper.attr("aria-hidden","true"),this.endWrapper.attr("aria-hidden","false"))},getStlChildrenClasses:function(){return b.stylejam.common.widgets.datepicker.StyleJamDateRangeInput[this.options.presentationBase]},showEndDate:function(){b.dom.swapChildrenClasses(this.element,this.getStlChildrenClasses(),"single","range")},hideEndDate:function(){b.dom.swapChildrenClasses(this.element,
this.getStlChildrenClasses(),"range","single")},showFlexIcon:function(){b.dom.swapChildrenClasses(this.element,this.getStlChildrenClasses(),"noflex","flex")},hideFlexIcon:function(){b.dom.swapChildrenClasses(this.element,this.getStlChildrenClasses(),"flex","noflex")},showFlexDisplay:function(){b.dom.swapClasses(this.endWrapper,"",this.options.endInputHidden);b.dom.swapClasses(this.flexWrapper,this.options.displayFlexHidden,"")},hideFlexDisplay:function(){b.dom.swapClasses(this.flexWrapper,"",this.options.displayFlexHidden);
b.dom.swapClasses(this.endWrapper,this.options.endInputHidden,"")},focus:function(){var a=this.element.data("dateModal");a?a.toggleOverlayWindow(!0):b.events.publish("DateInput.startDate.focus",{group:this.options.group})}})})(R9,jQuery);(function(a,e){a.createWidgetClass("datepicker.DateModal",{display:null,overlayWindow:null,overlayContent:null,overlayBackground:null,inputWrapper:null,endInput:null,placeholderUpdateInterval:null,overlayInit:!1,triggeringFocus:!1,clicking:!1,open:!1,focusTimeout:-1,spinnerIds:null,startDate:null,startTime:null,startTimeSelect:null,endDate:null,endTime:null,endTimeSelect:null,timeValuesMap:null,displayMode:null,options:{mobileBreakpoint:568,desktopBreakpoint:1024,dateFormat:"ddd M/D",spinners:!1,
isDateTime:!1,isSingle:!1,timeDropdown:!1,timeDropdownOpenStartAfterDate:!1,timeDropdownOpenEndAfterStart:!1,timeDropdownSyncEndToStart:!1,flexEnabled:!1,alignment:"left",responsive:!1,compressedLayout:!1,startDateField:"",startDateId:"",endDateField:"",endDateId:"",datePickerId:"",datePickerClassName:""},displayStart:null,inputStartDec:null,inputStartInc:null,inputSeparator:null,displayEnd:null,inputEndDec:null,inputEndInc:null,displayStartIcon:null,displayEndIcon:null,displayStartChevron:null,displayEndChevron:null,
init:function(){var b=this;this.display=this.getChildElement("display");this.displayStartInner=this.getChildElement("display-start-inner");this.displayEndInner=this.getChildElement("display-end-inner");this.overlayWindow=this.getChildElement("overlay-window");this.overlayContent=this.getChildElement("overlay-content");this.overlayBackground=this.getChildElement("overlay-bg");this.inputWrapper=this.getChildElement("input-wrapper");this.close=this.getChildElement("close");this.options.startDate&&(this.startDate=
moment(this.options.startDate).valueOf());this.options.endDate&&(this.endDate=moment(this.options.endDate).valueOf());this.options.spinners&&(this.spinnerIds="#"+this.id("start-inc")+", #"+this.id("end-inc")+", #"+this.id("start-dec")+", #"+this.id("end-dec"));this.displayMode=this.options.flex?"flex":this.options.dateMode;this.options.flexEnabled&&(this.flexStartDisplay=this.getChildElement("start-flex"),this.flexEndDisplay=this.getChildElement("end-flex"));this.endInput=this.inputWrapper.find(".js-end-input");
this.startTime=this.getChildElement("start-time");this.startTimeSelect=this.getChildElement("start-time-select").getWidget();this.endTime=this.getChildElement("end-time");this.endTimeSelect=this.getChildElement("end-time-select").getWidget();setTimeout(function(){b.overlayWindow.css("display","block")},200);this.options.compressedLayout&&(this.displayStart=this.getChildElement("display-start"),this.inputStartDec=this.getChildElement("start-dec"),this.inputStartInc=this.getChildElement("start-inc"),
this.inputSeparator=this.getChildElement("input-separator"),this.displayEnd=this.getChildElement("display-end"),this.inputEndDec=this.getChildElement("end-dec"),this.inputEndInc=this.getChildElement("end-inc"),this.displayStartIcon=this.getChildElement("display-start-icon-wrapper"),this.displayEndIcon=this.getChildElement("display-end-icon-wrapper"),this.displayStartChevron=this.getChildElement("display-start-chevron-wrapper"),this.displayEndChevron=this.getChildElement("display-end-chevron-wrapper"))},
bindComponent:function(){(this.options.isSingle||this.options.isDateTime)&&this.base();this.element.data("dateModal",this)},inlineComponentsReady:function(){var b=this;a.dom.schedule(function(){b.positionOverlayWindow()})},addEventHandlers:function(){var b=this;this.registerEvent("mousedown",this.display,function(){b.clicking=!0});this.registerEvent("click",this.display,function(a){b.clicking=!1;e(a.target).closest("#"+b.id("start-time-select")+",#"+b.id("end-time-select")).length||(b.options.spinners&&
0===e(a.target).closest(b.spinnerIds).length||!b.options.spinners)&&b.toggleOverlayWindow(!0,0<e(a.target).closest("#"+b.id("display-end")).length)});this.registerEvent("mouseup",function(){b.clicking=!1});this.registerEvent("click",this.close,function(){b.toggleOverlayWindow(!1)});this.registerEvent("focus",this.display,function(){b.clicking||(b.triggeringFocus?(b.toggleOverlayWindow(!1),b.triggeringFocus=!1,clearTimeout(b.focusTimeout)):b.toggleOverlayWindow(!0))});this.registerEvent("keydown",
this.display,function(c){c.which===a.globals.keyCodes.TAB&&(clearTimeout(b.focusTimeout),b.toggleOverlayWindow(!1))});this.subscribe("overlay.setitem.complete",function(){b.toggleOverlayWindow(!1)});this.subscribe("DateModal.toggleOverlayWindow",function(a){b.toggleOverlayWindow(a)});this.subscribe("DateInput."+this.options.group+".setDateMode",function(a){b.setDateMode(a)});this.options.flexEnabled&&(this.subscribe("DateInput."+this.options.group+".startDate.flexChange",function(a){b.flexStartDisplay.html(a)}),
this.subscribe("DateInput."+this.options.group+".endDate.flexChange",function(a){b.flexEndDisplay.html(a)}));this.subscribe("DateInput."+this.options.group+".startDate.setDate",function(a){var c=a&&a.date&&a.date.valueOf();null!==c&&(b.startDateChanged|=b.open&&b.startDate!==c,b.startDate=c);b.refreshInput(b.displayStartInner,a.date)});this.subscribe("DateInput."+this.options.group+".startDate.clearDate",function(a){a=a&&a.date&&a.date.valueOf();null!==a&&(b.startDateChanged|=b.open&&b.startDate!==
a);b.startDate=null;b.refreshInput(b.displayStartInner,null)});this.subscribe("DateInput."+this.options.group+".endDate.setDate",function(a){var c=a&&a.date&&a.date.valueOf();null!==c&&(b.endDateChanged|=b.open&&b.endDate!==c,b.endDate=c);b.refreshInput(b.displayEndInner,a.date)});this.subscribe("DateInput."+this.options.group+".endDate.clearDate",function(a){if(a=a&&a.date&&a.date.valueOf())b.endDateChanged|=b.open&&b.endDate!==a;b.endDate=null;b.refreshInput(b.displayEndInner,null)});this.options.compressedLayout&&
this.subscribe("DatePicker.layout.compressed.toggle",function(a){b.toggleCompressedLayout(a)});this.options.isDateTime&&(this.timeValuesMap={},this.options.timeValues.forEach(function(b){this.timeValuesMap[b.value]=b},this),this.subscribe("DateInput.update",{group:this.options.group,action:"time"},function(a){var c=a.fields.startDate;if(c||0===c)b.startTimeSelect?b.startTimeSelect.setValue(c):(c=b.getTimeDisplay(c),b.startTime.html(c));if((a=a.fields.endDate)||0===a)b.endTimeSelect?b.endTimeSelect.setValue(a):
(a=b.getTimeDisplay(a),b.endTime.html(a))}),this.startTimeSelect&&(this.startTimeSelect.options.change=this.onStartTimeChange.bind(this)),this.endTimeSelect&&(this.endTimeSelect.options.change=this.onEndTimeChange.bind(this)));this.options.flexEnabled&&this.subscribe("DatePicker.update",{group:this.options.group,action:"flex"},this.onFlexUpdate.bind(this));this.subscribe("DatePicker.closed",{group:this.options.group},function(a){b.toggleOverlayWindow(!1);if(a.tabForward||a.tabBackward)b.triggeringFocus=
!0,b.display.focus();var c=b.startTimeSelect;b.options.isDateTime&&b.openTimeDropdown&&(b.startDateChanged||b.endDateChanged)&&c&&setTimeout(function(){b.openTimeDropdown=!1;c.focusInlineElement();c.open()}.bind(b),100)});this.subscribe("DateInput.startDate.focus",b.options.group,function(){b.openTimeDropdown=b.options.timeDropdownOpenStartAfterDate;b.startDateChanged=!1;b.endDateChanged=!1});this.options.spinners&&(this.bindSpinner("start-inc","startDate",1),this.bindSpinner("start-dec","startDate",
-1),this.bindSpinner("end-inc","endDate",1),this.bindSpinner("end-dec","endDate",-1));this.registerEvent("click.overlay",e(document),function(a){0===e(a.target).closest("#"+b.id("overlay-window")+", #"+b.id("display")+", [data-date-group\x3d"+b.options.group+"]").length&&b.toggleOverlayWindow(!1)});this.registerEvent("resize",e(window),this.positionOverlayWindow.bind(this));this.options.changeEvent&&(this.subscribe(this.options.changeEvent+".change",function(a){if(!a.namespace||b.id().startsWith(a.namespace))b.onDisplayCatChange(a.value)}),
this.subscribe(this.options.changeEvent+".set",this.onDisplayCatChange.bind(this)));this.options.compressedLayout&&this.subscribe("hotels.detailsv2.sticky.toggle",function(a){a?this.hotelDetailsStickyShow():this.hotelDetailsStickyHide()}.bind(this))},onStartTimeChange:function(a,c,d){if((d=e("#"+this.options.startDateId).getWidget())&&d.setTime){d.setTime(c);var b=this.options,f=this.endTimeSelect;f&&(b.timeDropdownOpenEndAfterStart?setTimeout(function(){b.timeDropdownSyncEndToStart&&(this.onEndTimeChange(a,
c),f.val(c));f.focusInlineElement();f.open()}.bind(this),100):b.timeDropdownSyncEndToStart&&setTimeout(function(){this.onEndTimeChange(a,c);f.val(c)}.bind(this),100))}},onEndTimeChange:function(a,c,d){(a=e("#"+this.options.endDateId).getWidget())&&a.setTime&&a.setTime(c)},bindSpinner:function(b,c,d){var e=this;this.registerEvent("click",this.getChildElement(b),function(){e.publishEvent("DateInput.update",{action:"change",currentValue:e[c],delta:d,field:c,picking:c,force:!0,spinner:!0});a.Analytics.api.trackEvent({category:c,
label:"arrow",action:"click",value:0<d?"inc":"dec"})})},destroy:function(){this.base();this.element.data("dateModal",null);window.clearInterval(this.placeholderUpdateInterval)},positionOverlayWindow:function(){var a=this.display.offset(),c=this.display.outerWidth(!0),d=parseInt(this.display.css("margin-left"),10),d="right"===this.options.alignment&&this.canRightAlign()?Math.floor(a.left+(c-this.overlayWindow.outerWidth())-8):"center"===this.options.alignment?Math.floor(a.left+(c-this.overlayWindow.outerWidth())/
2):Math.floor(a.left-d+8);this.overlayBackground.css({width:c-16,height:this.display.outerHeight()-16});this.positionOverlayInputWrapper(c);this.isFullScreen()?this.overlayContent.css({minWidth:0}):this.overlayContent.css({minWidth:Math.max(c,516)});d+this.overlayWindow.outerWidth()>e(window).outerWidth()&&(c=e(window).outerWidth()-this.overlayWindow.outerWidth(),d=0<c?c:0);this.open&&"parentIFrame"in window&&window.parentIFrame.sendMessage({action:"DatePicker.opened",mode:this.isFullScreen()?"FullScreen":
"Normal"});this.overlayWindow.css({maxWidth:e(window).outerWidth(),transform:"translate("+d+"px,"+Math.floor(a.top+8)+"px)"})},toggleOverlayWindow:function(b,c){var d=this,e=this.isFullScreen()?1:200;b!==this.open&&((this.open=b)?(d.positionOverlayWindow(),a.dom.swapChildrenClasses(d.overlayWindow,d.getStlClasses().OverlayWindow,"hidden","visible"),d.overlayContent.addClass("visible"),this.focusTimeout=setTimeout(function(){c?a.events.publish("DateInput.endDate.focus",d.options.group):a.events.publish("DateInput.startDate.focus",
d.options.group)},e)):(a.dom.swapChildrenClasses(d.overlayWindow,d.getStlClasses().OverlayWindow,"visible","hidden"),d.overlayContent.removeClass("visible"),this.publishEvent("DatePicker.dismiss",{}),"parentIFrame"in window&&window.parentIFrame.sendMessage({action:"DatePicker.closed"})))},positionOverlayInputWrapper:function(a){"undefined"===typeof a&&(a=this.display.outerWidth(!0));this.inputWrapper.css({width:a})},refreshInput:function(a,c){null!==c?(a.html(c.format(this.options.dateFormat)),this.swapClasses(a,
this.getStlClasses().inputDateEmpty,this.getStlClasses().inputDateFull)):(a.html(a.attr("data-placeholder")),this.swapClasses(a,this.getStlClasses().inputDateFull,this.getStlClasses().inputDateEmpty))},getOverlayWrapper:function(){return this.overlayContent},focus:function(){var a=this;setTimeout(function(){a.display.trigger("focus")},50)},isFullScreen:function(){return this.options.mobileBreakpoint>=e(window).outerWidth()},canRightAlign:function(){return this.options.mobileBreakpoint<=e(window).outerWidth()},
publishEvent:function(b,c){e.extend(c,{updateGroup:this.options.updateGroup,group:this.options.group});a.events.publish(b,c)},getTimeDisplay:function(a){return this.timeValuesMap[a].text},onDisplayCatChange:function(a){switch(a){case "oneway":this.setDateMode("single");break;case "roundtrip":this.setDateMode("range")}},setDateMode:function(a){this.setDisplayMode(a);this.options.dateMode=a},setDisplayMode:function(b){var c=this.displayMode;a.dom.swapChildrenClasses(this.display,this.getStlClasses().DisplayInput,
c,b);this.displayMode=b;this.endInput&&this.endInput.length&&this.endInput.toggleClass(this.getStlBlock("OverlayInput--hidden"),"single"===b);this.swapClasses(this.overlayContent,"Overlay-"+this.options.datePickerClassName+"--"+c,"Overlay-"+this.options.datePickerClassName+"--"+b)},onFlexUpdate:function(a){switch(a.flex){case "weekend":case "openflex":this.setFlex(!0);break;case "duration":break;default:this.setFlex(!1)}setTimeout(function(){this.positionOverlayInputWrapper()}.bind(this),0)},setFlex:function(a){(this.options.flex=
a)?this.setDisplayMode("flex"):this.setDisplayMode(this.options.dateMode)},toggleCompressedLayout:function(b){b?(a.dom.swapClasses(this.display,a.stylejam.common.widgets.datepicker.DateModal.inputResponsive,a.stylejam.common.widgets.datepicker.DateModal.inputStatic),a.dom.swapClasses(this.displayStart,a.stylejam.common.widgets.datepicker.DateModal.inputDateResponsive,a.stylejam.common.widgets.datepicker.DateModal.inputDateStatic),a.dom.swapClasses(this.displayStart,a.stylejam.common.widgets.datepicker.DateModal.inputDateStartResponsive,
a.stylejam.common.widgets.datepicker.DateModal.inputDateStartStatic),a.dom.swapClasses(this.inputStartDec,a.stylejam.common.widgets.datepicker.DateModal.inputDateSpinnerResponsive,a.stylejam.common.widgets.datepicker.DateModal.inputDateSpinnerStatic),a.dom.swapClasses(this.inputStartInc,a.stylejam.common.widgets.datepicker.DateModal.inputDateSpinnerResponsive,a.stylejam.common.widgets.datepicker.DateModal.inputDateSpinnerStatic),a.dom.swapClasses(this.inputSeparator,a.stylejam.common.widgets.datepicker.DateModal.inputSeparatorResponsive,
a.stylejam.common.widgets.datepicker.DateModal.inputSeparatorStatic),a.dom.swapClasses(this.displayEnd,a.stylejam.common.widgets.datepicker.DateModal.inputDateResponsive,a.stylejam.common.widgets.datepicker.DateModal.inputDateStatic),a.dom.swapClasses(this.inputEndDec,a.stylejam.common.widgets.datepicker.DateModal.inputDateSpinnerResponsive,a.stylejam.common.widgets.datepicker.DateModal.inputDateSpinnerStatic),a.dom.swapClasses(this.inputEndInc,a.stylejam.common.widgets.datepicker.DateModal.inputDateSpinnerResponsive,
a.stylejam.common.widgets.datepicker.DateModal.inputDateSpinnerStatic),a.dom.swapClasses(this.displayStartIcon,a.stylejam.common.widgets.datepicker.DateModal.inputDisplayIcon,a.stylejam.common.widgets.datepicker.DateModal.inputDisplayIconHidden),a.dom.swapClasses(this.displayEndIcon,a.stylejam.common.widgets.datepicker.DateModal.inputDisplayIcon,a.stylejam.common.widgets.datepicker.DateModal.inputDisplayIconHidden)):(a.dom.swapClasses(this.display,a.stylejam.common.widgets.datepicker.DateModal.inputStatic,
a.stylejam.common.widgets.datepicker.DateModal.inputResponsive),a.dom.swapClasses(this.displayStart,a.stylejam.common.widgets.datepicker.DateModal.inputDateStatic,a.stylejam.common.widgets.datepicker.DateModal.inputDateResponsive),a.dom.swapClasses(this.displayStart,a.stylejam.common.widgets.datepicker.DateModal.inputDateStartStatic,a.stylejam.common.widgets.datepicker.DateModal.inputDateStartResponsive),a.dom.swapClasses(this.inputStartDec,a.stylejam.common.widgets.datepicker.DateModal.inputDateSpinnerStatic,
a.stylejam.common.widgets.datepicker.DateModal.inputDateSpinnerResponsive),a.dom.swapClasses(this.inputStartInc,a.stylejam.common.widgets.datepicker.DateModal.inputDateSpinnerStatic,a.stylejam.common.widgets.datepicker.DateModal.inputDateSpinnerResponsive),a.dom.swapClasses(this.inputSeparator,a.stylejam.common.widgets.datepicker.DateModal.inputSeparatorStatic,a.stylejam.common.widgets.datepicker.DateModal.inputSeparatorResponsive),a.dom.swapClasses(this.displayEnd,a.stylejam.common.widgets.datepicker.DateModal.inputDateStatic,
a.stylejam.common.widgets.datepicker.DateModal.inputDateResponsive),a.dom.swapClasses(this.inputEndDec,a.stylejam.common.widgets.datepicker.DateModal.inputDateSpinnerStatic,a.stylejam.common.widgets.datepicker.DateModal.inputDateSpinnerResponsive),a.dom.swapClasses(this.inputEndInc,a.stylejam.common.widgets.datepicker.DateModal.inputDateSpinnerStatic,a.stylejam.common.widgets.datepicker.DateModal.inputDateSpinnerResponsive),a.dom.swapClasses(this.displayStartIcon,a.stylejam.common.widgets.datepicker.DateModal.inputDisplayIconHidden,
a.stylejam.common.widgets.datepicker.DateModal.inputDisplayIcon),a.dom.swapClasses(this.displayEndIcon,a.stylejam.common.widgets.datepicker.DateModal.inputDisplayIconHidden,a.stylejam.common.widgets.datepicker.DateModal.inputDisplayIcon));a.dom.swapClasses(this.displayStartChevron,a.stylejam.common.widgets.datepicker.DateModal.inputDisplayChevronHidden,a.stylejam.common.widgets.datepicker.DateModal.inputDisplayChevron);a.dom.swapClasses(this.displayEndChevron,a.stylejam.common.widgets.datepicker.DateModal.inputDisplayChevronHidden,
a.stylejam.common.widgets.datepicker.DateModal.inputDisplayChevron)},hotelDetailsStickyShow:function(){a.dom.swapClasses(this.inputStartDec,this.options.styles.dateSpinner,this.options.styles.dateSpinnerSticky);a.dom.swapClasses(this.inputStartInc,this.options.styles.dateSpinner,this.options.styles.dateSpinnerSticky);a.dom.swapClasses(this.inputEndInc,this.options.styles.dateSpinner,this.options.styles.dateSpinnerSticky);a.dom.swapClasses(this.inputEndDec,this.options.styles.dateSpinner,this.options.styles.dateSpinnerSticky);
a.dom.swapClasses(this.displayEndIcon,this.options.styles.iconWrapper,this.options.styles.iconWrapperSticky);a.dom.swapClasses(this.inputSeparator,this.options.styles.inputSeparator,this.options.styles.inputSeparatorSticky);a.dom.swapClasses(this.displayEnd,this.options.styles.displayEnd,this.options.styles.displayEndSticky)},hotelDetailsStickyHide:function(){a.dom.swapClasses(this.inputStartDec,this.options.styles.dateSpinnerSticky,this.options.styles.dateSpinner);a.dom.swapClasses(this.inputStartInc,
this.options.styles.dateSpinnerSticky,this.options.styles.dateSpinner);a.dom.swapClasses(this.inputEndInc,this.options.styles.dateSpinnerSticky,this.options.styles.dateSpinner);a.dom.swapClasses(this.inputEndDec,this.options.styles.dateSpinnerSticky,this.options.styles.dateSpinner);a.dom.swapClasses(this.displayEndIcon,this.options.styles.iconWrapperSticky,this.options.styles.iconWrapper);a.dom.swapClasses(this.inputSeparator,this.options.styles.inputSeparatorSticky,this.options.styles.inputSeparator);
a.dom.swapClasses(this.displayEnd,this.options.styles.displayEndSticky,this.options.styles.displayEnd)}})})(R9,jQuery);/*
 @r9/cmp2-ui - 1.7.1 generated: 2019-04-03T13:34:50.564Z */
(function(e){function b(k){if(a[k])return a[k].exports;var g=a[k]={i:k,l:!1,exports:{}};return e[k].call(g.exports,g,g.exports,b),g.l=!0,g.exports}var a={};b.m=e;b.c=a;b.d=function(a,g,l){b.o(a,g)||Object.defineProperty(a,g,{configurable:!1,enumerable:!0,get:l})};b.n=function(a){var g=a&&a.__esModule?function(){return a.default}:function(){return a};return b.d(g,"a",g),g};b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};b.p="";b(b.s=37)})([function(e,b,a){function k(c){var d="function"==
typeof Symbol&&c[Symbol.iterator],m=0;return d?d.call(c):{next:function(){return c&&m>=c.length&&(c=void 0),{value:c&&c[m++],done:!c}}}}function g(c,d){var m="function"==typeof Symbol&&c[Symbol.iterator];if(!m)return c;var n,a;c=m.call(c);var f=[];try{for(;(void 0===d||0<d--)&&!(n=c.next()).done;)f.push(n.value)}catch(r){a={error:r}}finally{try{n&&!n.done&&(m=c.return)&&m.call(c)}finally{if(a)throw a.error;}}return f}function l(c){return this instanceof l?(this.v=c,this):new l(c)}Object.defineProperty(b,
"__esModule",{value:!0});b.__extends=function(c,d){function a(){this.constructor=c}f(c,d);c.prototype=null===d?Object.create(d):(a.prototype=d.prototype,new a)};a.d(b,"__assign",function(){return h});b.__rest=function(c,d){var a={},n;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&0>d.indexOf(n)&&(a[n]=c[n]);if(null!=c&&"function"==typeof Object.getOwnPropertySymbols){var f=0;for(n=Object.getOwnPropertySymbols(c);f<n.length;f++)0>d.indexOf(n[f])&&(a[n[f]]=c[n[f]])}return a};b.__decorate=function(c,
d,a,n){var m,f=arguments.length,h=3>f?d:null===n?n=Object.getOwnPropertyDescriptor(d,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)h=Reflect.decorate(c,d,a,n);else for(var b=c.length-1;0<=b;b--)(m=c[b])&&(h=(3>f?m(h):3<f?m(d,a,h):m(d,a))||h);return 3<f&&h&&Object.defineProperty(d,a,h),h};b.__param=function(c,d){return function(a,n){d(a,n,c)}};b.__metadata=function(c,d){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(c,d)};b.__awaiter=
function(c,d,a,n){return new (a||(a=Promise))(function(m,f){function h(c){try{p(n.next(c))}catch(q){f(q)}}function b(c){try{p(n.throw(c))}catch(q){f(q)}}function p(c){c.done?m(c.value):(new a(function(d){d(c.value)})).then(h,b)}p((n=n.apply(c,d||[])).next())})};b.__generator=function(c,d){function a(c){return function(d){return n([c,d])}}function n(a){if(f)throw new TypeError("Generator is already executing.");for(;g;)try{if(f=1,h&&(b=h[2&a[0]?"return":a[0]?"throw":"next"])&&!(b=b.call(h,a[1])).done)return b;
switch(h=0,b&&(a=[0,b.value]),a[0]){case 0:case 1:b=a;break;case 4:return g.label++,{value:a[1],done:!1};case 5:g.label++;h=a[1];a=[0];continue;case 7:a=g.ops.pop();g.trys.pop();continue;default:if(b=g.trys,!(b=0<b.length&&b[b.length-1])&&(6===a[0]||2===a[0])){g=0;continue}if(3===a[0]&&(!b||a[1]>b[0]&&a[1]<b[3]))g.label=a[1];else if(6===a[0]&&g.label<b[1])g.label=b[1],b=a;else if(b&&g.label<b[2])g.label=b[2],g.ops.push(a);else{b[2]&&g.ops.pop();g.trys.pop();continue}}a=d.call(c,g)}catch(q){a=[6,q],
h=0}finally{f=b=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}var f,h,b,l,g={label:0,sent:function(){if(1&b[0])throw b[1];return b[1]},trys:[],ops:[]};return l={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l};b.__exportStar=function(a,d){for(var c in a)d.hasOwnProperty(c)||(d[c]=a[c])};b.__values=k;b.__read=g;b.__spread=function(){for(var a=[],d=0;d<arguments.length;d++)a=a.concat(g(arguments[d]));return a};b.__await=l;b.__asyncGenerator=
function(a,d,f){function c(a){e[a]&&(k[a]=function(c){return new Promise(function(d,n){1<q.push([a,c,d,n])||h(a,c)})})}function h(a,c){try{var d=e[a](c);d.value instanceof l?Promise.resolve(d.value.v).then(m,b):g(q[0][2],d)}catch(z){g(q[0][3],z)}}function m(a){h("next",a)}function b(a){h("throw",a)}function g(a,c){a(c);q.shift();q.length&&h(q[0][0],q[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var k,e=f.apply(a,d||[]),q=[];return k={},c("next"),c("throw"),
c("return"),k[Symbol.asyncIterator]=function(){return this},k};b.__asyncDelegator=function(a){function c(c,d){a[c]&&(f[c]=function(f){return(n=!n)?{value:l(a[c](f)),done:"return"===c}:d?d(f):f})}var f,n;return f={},c("next"),c("throw",function(a){throw a;}),c("return"),f[Symbol.iterator]=function(){return this},f};b.__asyncValues=function(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var c=a[Symbol.asyncIterator];return c?c.call(a):"function"==typeof k?k(a):
a[Symbol.iterator]()};b.__makeTemplateObject=function(a,d){return Object.defineProperty?Object.defineProperty(a,"raw",{value:d}):a.raw=d,a};b.__importStar=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var f in a)Object.hasOwnProperty.call(a,f)&&(c[f]=a[f]);return c.default=a,c};b.__importDefault=function(a){return a&&a.__esModule?a:{default:a}};var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,d){a.__proto__=d}||function(a,d){for(var c in d)d.hasOwnProperty(c)&&
(a[c]=d[c])},h=Object.assign||function(a){for(var c,f=1,n=arguments.length;f<n;f++){c=arguments[f];for(var h in c)Object.prototype.hasOwnProperty.call(c,h)&&(a[h]=c[h])}return a}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var k=function(){function a(){}return a.getInstance=function(){return this._instance||(this._instance=new this),this._instance},a.prototype.setLogger=function(a){this._method=a},a.prototype.getLogger=function(){return this._method||this._methodPlaceholder()},
a.prototype.debug=function(){for(var a=[],h=0;h<arguments.length;h++)a[h]=arguments[h];this.getLogger().debug.apply(this,a)},a.prototype.error=function(){for(var a=[],h=0;h<arguments.length;h++)a[h]=arguments[h];this.getLogger().error.apply(this,a)},a.prototype.info=function(){for(var a=[],h=0;h<arguments.length;h++)a[h]=arguments[h];this.getLogger().info.apply(this,a)},a.prototype.warn=function(){for(var a=[],h=0;h<arguments.length;h++)a[h]=arguments[h];this.getLogger().warn.apply(this,a)},a.prototype._methodPlaceholder=
function(){return{debug:g,error:g,info:g,warn:g}},a}(),g=function(){console.error("cmp2-ui: You should really consider adding logger")};b.getLogger=function(){return k.getInstance().getLogger()};b.setLogger=function(a){return k.getInstance().setLogger(a)}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var k=a(0);e=a(24);var g=a(7),l=a(6),f=a(3),h=a(5).default(),c=f.default();a=function(a){function d(d){var c=a.call(this)||this;return c.options=d,c}return k.__extends(d,a),d.prototype.onDirectClick=
function(a,d){a=c.forDirect(a);a=new l.default(this.options,a);(new g.default(a)).start(!1)},d.prototype.onDirectMouseUp=function(a,d){},d.prototype.onDirectMouseDown=function(a,d){},d.prototype.onItemChange=function(a,d,c){},d.prototype.onItemMouseDown=function(a,d){},d.prototype.onItemMouseUp=function(a,d){},d.prototype.onFormClick=function(a,d,c){c([],[])},d.prototype.onFormButtonMouseDown=function(a){},d.prototype.onFormButtonMouseUp=function(a){},d.prototype.navigateToResults=function(a,d,c){return!1},
d.prototype.showRPCompareAll=function(){return!0},d.prototype.pushHandleHistory=function(a,d){d&&h.addHistory(a,d)},d.prototype.getWindowNamePrefix=function(){return c.getWindowNamePrefix()},d.prototype.onResultPageOpen=function(a,d,f){void 0===f&&(f="");a=new l.default(this.options,c.forSubmit(a));a=new g.default(a);a.setWindowNamePrefix(f);a.start(!0)},d.prototype.setIgnoreWindowErrors=function(a){h.setIgnoreWindowErrors(a)},d}(e.Observer);b.Base=a;b.default=a},function(e,b,a){Object.defineProperty(b,
"__esModule",{value:!0});var k=a(32),g=a(21),l=a(11),f=a(33).default(),h=function(){function a(){this.windowNamePrefix="k"+(new Date).getTime()+l.default.randomString(8)}return a.getInstance=function(){return this._instance||(this._instance=new this),this._instance},a.prototype.getWindowNamePrefix=function(){return this.windowNamePrefix},a.prototype.hidden=function(a,c){return{url:this.getUrl(a),name:a.code,features:f.hidden(!1,c)}},a.prototype.hiddenSmall=function(a,c){return{url:this.getUrl(a),
name:a.code,features:f.hidden(!0,c)}},a.prototype.tiled=function(a,c,h,b){return{url:this.getUrl(a),name:a.code,features:f.tiled(c,h,b)}},a.prototype.empty=function(a){return{url:this.getUrl(a),name:a.code,features:{}}},a.prototype.forDirect=function(a){for(var d=[],c=f.getWindowHandleInformation(),h=0,b=0,g;g=a[b];b++)g.visible&&h++;for(b=0;g=a[b];b++)g.visible&&d.push(this.tiled(g,b,h,c));return d},a.prototype.forBlank=function(a){return[{url:a||this.getUrl(),name:"_blank",features:{}}]},a.prototype.forMultiProviderWindow=
function(a,c){void 0===a&&(a=[]);void 0===c&&(c={});var d,h=[];if(0<a.length){for(var f=0,b;b=a[f];f++)b.deepLink&&"CLOSE"!==b.deepLink&&(h.push(b.code),d=b.deepLink);if(0<h.length)return 1===h.length&&d?k.formatUrl(d):k.formatUrl("/s/compareresults/multi",g.extend({forcehttp:!0,providerCodes:h.join(",")},c||{}))}return""},a.prototype.forSubmit=function(a,c){void 0===c&&(c=0);for(var d=[],h=f.getWindowHandleInformation(),b=0,m=0,g;g=a[m];m++)g.visible&&g.checked&&b++;for(m=0;g=a[m];m++)g.visible&&
g.checked&&(4===c&&d.push(this.empty(g)),0===c&&d.push(this.tiled(g,m,b,h)),2===c&&d.push(this.hidden(g,h)),3===c&&d.push(this.hiddenSmall(g,h)));return d},a.prototype.getSpinnerPath=function(){return k.formatUrl("/s/compareresults/spinner")},a.prototype.getUrl=function(a){return a?a.deepLink?k.formatUrl(a.deepLink):k.formatUrl("/s/compareresults/spinner",{code:a.code}):this.getSpinnerPath()},a}();b.WindowHandleOptions=h;b.default=function(){return h.getInstance()}},function(e,b,a){function k(a,c,
d){return void 0===d&&(d=!0),a===c?0:a?c?a.localeCompare(c):d?1:-1:d?-1:1}function g(a){switch(a){case "fd":case "pn":return"FD";case "bb":case "rr":case "sa":case "pu":case "md":return"RP"}}function l(a){switch(a){case "right":return"R";case "top":case "inline":case "panel":case "fdct":return"M";case "bottom":return"B";case "popup":return"P"}return""}Object.defineProperty(b,"__esModule",{value:!0});b.isLocationEqual=function(a,c){return a.type===c.type&&a.id===c.id&&a.name===c.name};b.sortLocations=
function(a){return a&&1<a.length&&a.sort(function(a,d){var c=k(a.type,d.type);return 0===c?(c=k(a.name,d.name),0===c?k(a.id,d.id):c):c}),a};b.setLogoSize=function(a,c){c&&c.width&&c.height&&(a.logoSize=c.width+"x"+c.height)};var f=/-/g;b.prepareDate=function(a){return a.replace(f,"")};b.getPageOrigin=function(a){var c=[];if(a.placement){var d=a.placement;c.push(d.vertical?d.vertical:a.type);c.push(d.type||"");c.push(g(d.showOn)||"");c.push(d.page||"");c.push(l(d.displayRail)+(d.position||0))}return c.join(".")};
b.getPostHeader=function(){return{"Content-Type":"application/json; charset\x3dUTF-8"}}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var k=a(25),g=a(1);e=a(31);b.isSystemTargetName=function(a){return void 0===a&&(a=""),-1!==["_blank","_parent","_self","_top"].indexOf(a)};b.getWindowName=function(a){return void 0===a&&(a=""),b.isSystemTargetName(a)?a:a.replace(/[^a-z0-9]+/gi,"")};"undefined"!=typeof window&&e.addEvent(window,"popstate",function(a){(a=a.originalEvent?a.originalEvent:
a)&&a.state&&a.state.hasOwnProperty("cmp2-workaround-back-Key")&&window.location.replace(a.state["cmp2-workaround-back-Key"])});var l=function(){function a(){this._ignoreWindowErrors=!1}return a.getInstance=function(){return this._instance||(this._instance=new this),this._instance},a.prototype.getIgnoreWindowErrors=function(){return this._ignoreWindowErrors},a.prototype.setIgnoreWindowErrors=function(a){this._ignoreWindowErrors=a},a.prototype.open=function(a,c,d){void 0===c&&(c="");void 0===d&&(d=
{});"object"==typeof d&&(d=k.param(d,!0,","));return(a=open(a,b.getWindowName(c),d))&&!a.closed?a:null},a.prototype.getActiveWindowHandles=function(a){for(var c=[],d=0,b;b=a[d];d++)(b=this.getWindowHandle(b))&&c.push(b);return c},a.prototype.getFirstActiveHandle=function(a){for(var c=0,d;d=a[c];c++)if(this.getWindowHandle(d))return d;return null},a.prototype.getLastActiveHandle=function(a){for(var c=a.length-1,d;d=a[c];c--)if(this.getWindowHandle(d))return d;return null},a.prototype.getWindowHandle=
function(a){try{return!a||a.closed?null:a}catch(c){return null}},a.prototype.addHistory=function(a,c){if(a&&c&&void 0!==history.pushState&&void 0!==history.replaceState)try{var d=a.location.href;a.history.replaceState((b={},b["cmp2-workaround-back-Key"]=c,b),"",c);a.history.pushState((f={},f["cmp2-workaround-back-Key"]=d,f),a.document.title,d)}catch(p){g.getLogger().warn("cmp2-workaround: WindowHandle unable to add history",p)}var b,f},a.prototype.updateHandleName=function(a,c,d){void 0===d&&(d="");
a=this.getWindowHandle(a);if(!a)return g.getLogger().warn("cmp2-workaround: WindowHandle handle is not found",d),!1;try{if(a.name=c,a.name!==c)return g.getLogger().warn("cmp2-workaround: WindowHandle unable to change name",d),!1}catch(m){return g.getLogger().warn("cmp2-workaround: WindowHandle unable to change name",m,d),!1}return!0},a.prototype.resizeBeforeMove=function(a,c){var d=this.getWindowHandle(a);if(d)try{if(void 0!==c.left&&void 0!==c.top){d.resizeTo(100,100);var b=this.moveToLeftTop(a);
d.moveTo(b[0]+c.left,b[1]+c.top)}void 0!==c.width&&void 0!==c.height&&d.resizeTo(c.width,c.height)}catch(n){g.getLogger().warn("cmp2-workaround: WindowHandle unable resize handler in resizeBeforeMove",n,n.stack)}},a.prototype.moveAccordingFeatures=function(a,c){if((a=this.getWindowHandle(a))&&c)try{void 0!==c.left&&void 0!==c.top&&a.moveTo(c.left,c.top),void 0!==c.width&&void 0!==c.height&&a.resizeTo(c.width,c.height)}catch(d){g.getLogger().warn("cmp2-workaround: WindowHandle unable resize handler in moveAccordingFeatures",
d,d.stack)}},a.prototype.moveToLeftTop=function(a){if(a=this.getWindowHandle(a))try{return a.moveTo(-1E7,-1E7),["screenX"in a?a.screenX:a.screenLeft,"screenY"in a?a.screenY:a.screenTop]}catch(c){g.getLogger().warn("cmp2-workaround: WindowHandle unable to move handler in moveToLeftTop",c,c.stack)}return[0,0]},a}();b.WindowHandle=l;b.default=function(){return l.getInstance()}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});e=function(){return function(a,b){this.items=[];this.options=
a;this.items=b;this.resize=a.resizeWindows||!1}}();b.WindowHandleConstructor=e;b.default=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var k=a(0);e=a(24);var g=a(1),l=a(5);a=a(3);var f=l.default(),h=a.default();a=function(a){function c(c){var d=a.call(this)||this;return d.windowNamePrefix="",d.windowHandleInformation=c,d.items=c.items,c.resize&&d.resizeHandle(c),c.preOpen&&d.preOpen(c.preOpen),c.postOpen&&d.postOpen(c.postOpen),c.preItemOpen&&d.preItemOpen(c.preItemOpen),c.postItemOpen&&
d.postItemOpen(c.postItemOpen),d}return k.__extends(c,a),c.prototype.setWindowNamePrefix=function(a){void 0===a&&(a="");a&&(this.windowNamePrefix=a)},c.prototype.getWindowNamePrefix=function(){return this.windowNamePrefix||(this.windowNamePrefix=h.getWindowNamePrefix()),this.windowNamePrefix},c.prototype.start=function(a){var c=this.items;this.publish("preOpen",[c]);for(var d=this.getWindowNamePrefix(),b=[],h=[],m=0,k;k=c[m];m++){this.publish("preItemOpen",[k,c]);var e=l.isSystemTargetName(k.name)?
k.name:l.getWindowName(d+k.name),q=f.open(k.url,e,k.features),w=this.windowHandleInformation.options;if(w.expectWindowReference)if(q)b.push(e),h.push(q),this.publish("handleCreated",[k,c,q]);else if(!f.getIgnoreWindowErrors()){var y=a?"":" in the RP";g.getLogger().warn("cmp2-workaround: unable to open handle in StandardWindowHandleExecutor"+y,{workaround:w,name:e,item:k})}this.publish("postItemOpen",[k,c,q])}this.publish("postOpen",[h,b])},c.prototype.handleCreated=function(a){return this.subscribe("handleCreated",
a),this},c.prototype.preOpen=function(a){return this.subscribe("preOpen",a),this},c.prototype.postOpen=function(a){return this.subscribe("postOpen",a),this},c.prototype.preItemOpen=function(a){return this.subscribe("preItemOpen",a),this},c.prototype.postItemOpen=function(a){return this.subscribe("postItemOpen",a),this},c.prototype.getItems=function(){return this.items},c.prototype.resizeHandle=function(a){this.postItemOpen(function(c,d,b){(d=f.getWindowHandle(b))&&c.features&&(c=c.features,a.options.resizeBeforeOpening?
f.resizeBeforeMove(d,c):f.moveAccordingFeatures(d,c))})},c}(e.Observer);b.StandardWindowHandleExecutor=a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});e=a(49);var k=a(2);b.Base=k.default;var g=e.default();b.setWorkaround=function(a){g.setWorkaround(a,!1)};b.getWorkaround=function(){return g.getWorkaround()};e=a(1);b.getLogger=e.getLogger;b.setLogger=e.setLogger;e=a(21);b.extend=e.extend;a=a(32);b.updateBasePath=a.updateBasePath},function(e,b,a){Object.defineProperty(b,
"__esModule",{value:!0});e=a(39);b.List=e.List;e=a(43);b.Impression=e.Impression;e=a(47);b.WindowInfo=e.WindowInfo;e=a(48);b.ApiCompareToSettings=e.CompareToSettings;a=a(4);b.getPageOrigin=a.getPageOrigin},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var k=a(9),g=a(12),l=a(8);e=function(){function a(){this._queue=[];this._isInProgress=!1}return a.getInstance=function(){return this._instance||(this._instance=new this),this._instance},a.prototype.setSettings=function(a){this._settings=
a;l.setWorkaround(a.workaround)},a.prototype.isSettings=function(){return!!this._settings},a.prototype.getSettings=function(a,c){var d=this;if(this._settings)return void a(this._settings);if(this._queue.push({onSuccess:a,onError:c}),!this._isInProgress){this._isInProgress=!0;a=k.ApiCompareToSettings.getInstance().getRequest();var b=function(){d._isInProgress=!1;d._queue.forEach(function(a){a.onError&&a.onError(void 0)});d._queue=[]};g.Ajax.getInstance().request(a,function(a){if(!a||!a.success)return l.getLogger().error("cmp2-ui: AJAX error on getSettings",
a.errors),void b();var c=a.content;d.setSettings(c);d._isInProgress=!1;d._queue.forEach(function(a){a.onSuccess(c)});d._queue=[]},function(a){l.getLogger().error("cmp2-ui: AJAX error on getSettings",a);b()},b)}},a.prototype.getSettingsSync=function(){return this.isSettings()?this._settings:void l.getLogger().error("cmp2-ui: getSettingsSync failed. Refactor")},a}();b.CompareToSettings=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});e=function(){function a(){}return a.UUID=function(){var a=
(new Date).getTime();return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(b){var f=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"===b?f:3&f|8).toString(16)})},a.randomString=function(a){void 0===a&&(a=6);for(var b="",f=0;f<a;f++)b+="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".charAt(Math.floor(62*Math.random()));return b},a}();b.StringGenerators=e;b.default=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var k=a(8);e=function(){function a(){}
return a.getInstance=function(){return this._instance||(this._instance=new this),this._instance},a.prototype.setMethod=function(a){this._method=a},a.prototype.request=function(a,b,h,c){return this._method?(this._method(a,b,h),!0):(k.getLogger().error("cmp2-ui: Ajax method is not set"),c&&c(),!1)},a}();b.Ajax=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var k=a(10),g=a(35);e=function(){function a(){var a=g.StorageHelper.getInstance().getItem("cmp2.state");this._setCompareToState(a)}
return a.getInstance=function(){return this._instance||(this._instance=new this),this._instance},a.prototype.apiToDisplayCompareToItem=function(a,b,c){var d=this;k.CompareToSettings.getInstance().getSettings(function(c){var f=[],h=g.StorageHelper.getInstance().getItem("cmp2.check.all");c=c.rendering;var m=c.storeStateSession,l=c.limited,k=c.usePreCheckItems,e=c.maxCheckedItems,x=0;a.forEach(function(a){var c=!1;(!l||x<e)&&(c=d._isItemChecked(a,m,k,h))&&x++;f.push({name:a.name,code:a.code,id:a.id,
visible:a.visible,checked:c,prechecked:k&&a.prechecked,termId:a.termId,idInState:a.idInState,rank:a.rank,logo:a.logo,logoLarge:a.logoLarge})});b(f)},c)},a.prototype.updateDisplayItemsDeepLink=function(a,b){var c={};b.forEach(function(a){c[a.code]=a.url});for(b=0;b<a.length;b++){var d=a[b],f=c[d.code];"CLOSE"===f?d.visible=!1:d.deepLink=f}return a},a.prototype.getCompareToItemsFromImpressionState=function(a,b){var c=[],d={};b.forEach(function(a){d[a.code]=a.url});for(b=0;b<a.length;b++){var f=a[b];
f.visible&&f.checked&&c.push({checked:f.checked,code:f.code,id:f.id,prechecked:f.prechecked,idInState:!0,rank:f.rank,termId:f.termId,visible:f.visible,name:"",logo:"",logoLarge:"",deepLink:d[f.code]})}return c},a.prototype.getImpressionRequestState=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];b.push({checked:d.checked,code:d.code,id:d.id,prechecked:d.prechecked,rank:d.rank,termId:d.termId,visible:d.visible})}return b},a.prototype.getVisibleItem=function(a){var b=[];if(a&&"object"==typeof a&&
a.constructor===Array&&0<a.length)for(var c=0;c<a.length;c++){var d=a[c];d.visible&&b.push(d)}return b},a.prototype.getVisibleItemCount=function(a){return this.getVisibleItem(a).length},a.prototype.isCheckedItem=function(a){for(var b=0;b<a.length;b++){var c=a[b];if(c.visible&&c.checked)return!0}return!1},a.prototype.updateCheckedItemState=function(a,b){b.id&&b.idInState?this._compareTosStates[b.id]=b.checked:b.code&&(this._compareTosStates[b.code]=b.checked);b=g.StorageHelper.getInstance();b.setItem("cmp2.state",
this._compareTosStates);var c=0;a.forEach(function(a){a.visible&&a.checked&&c++});0===c?b.setItem("cmp2.check.all","false"):this.getVisibleItemCount(a)===c?b.setItem("cmp2.check.all","true"):b.removeItem("cmp2.check.all")},a.prototype._isItemChecked=function(a,b,c,d){if(!a.visible)return!1;if(b){if(null!==d)return!0===d;if(a.id&&a.idInState&&this._compareTosStates.hasOwnProperty(a.id))return this._compareTosStates[a.id];if(a.code&&!a.idInState&&this._compareTosStates.hasOwnProperty(a.code))return this._compareTosStates[a.code]}return a.prechecked&&
c},a.prototype._setCompareToState=function(a){this._compareTosStates=a&&"object"==typeof a?a:{}},a}();b.CompareToList=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var k=a(4);e=function(){function a(){}return a.prototype._populateBaseListRequest=function(a,b){a.placement&&k.setLogoSize(b.params,a.placement.logo)},a}();b.ListHelper=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});b.ignoreRequestInformation=function(a){var b=a.details;a=b[0].startLocation[0];
b=b[1].startLocation[0];return"POINT"===a.type&&!a.cityId||"POINT"===b.type&&!b.cityId||!1}},function(e,b,a){function k(a){return 2<a.details.length||2===a.details.length&&(a.details[0].other.cabin!==a.details[1].other.cabin||!g.isLocationEqual(a.details[0].startLocation[0],a.details[1].endLocation[0])||!g.isLocationEqual(a.details[0].endLocation[0],a.details[1].startLocation[0]))}Object.defineProperty(b,"__esModule",{value:!0});var g=a(4);b.ignoreRequestInformation=function(a){return k(a)};b.isMultiCity=
k;b.getTravelersCount=function(a){if(!a.requestInformation)return 0;a=a.requestInformation.other;return a.adults+a.seniors+a.youths+a.children+a.seatInfants+a.lapInfants}},function(e,b,a){function k(a,b){var f=null;switch(b.type){case "CITY":f={type:"CITY",id:b.id};break;case "AIRPORT":a.near=b.id;a.cityCode=b.cityId;break;case "HOTEL":f={type:"HOTEL",id:b.id};a.cityCode=b.cityId;break;case "LANDMARK":f={type:"LANDMARK",id:b.id};a.cityCode=b.cityId;break;case "NEIGHBORHOOD":f={type:"NEIGHBORHOOD",
id:b.id};a.cityCode=b.cityId;break;case "REGION":f={type:"REGION",id:b.id};break;case "FREE_REGION":f={type:"FREE_REGION",id:b.id};break;case "COUNTRY":f={type:"COUNTRY",id:b.id};break;case "POINT":f={type:"POINT",id:b.latitude+","+b.longitude};break;case "ADDRESS":f={type:"ADDRESS",id:b.name},a.cityCode=b.cityId}return f||!1}function g(a,b){switch(b.type){case "CITY":a.cityCode=b.id;break;case "AIRPORT":a.near=b.id;a.cityCode=b.cityId;break;case "HOTEL":case "LANDMARK":case "NEIGHBORHOOD":case "ADDRESS":case "POINT":a.cityCode=
b.cityId}}Object.defineProperty(b,"__esModule",{value:!0});b.ignoreRequestInformation=function(a,b){if(!a.requestInformation)return!0;var f=a.requestInformation.details[0].startLocation[0];switch(f.type){case "REGION":case "FREE_REGION":case "COUNTRY":return!(10<=b)&&!f.cityId;case "ADDRESS":return!(10>b&&f.cityId||10<=b&&a.placement&&"right"===a.placement.displayRail||25<=b);case "POINT":return!(10>b&&f.cityId||25<=b);default:return!1}};b.addLocationInformationVersion=function(a,b,h){return 10>h?
(g(a,b),!1):k(a,b)};b.addLocationInformation=k;b.addOldLocationInformation=g},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var k=a(4);e=function(){function a(){}return a.prototype._populateBaseImpressionRequest=function(a,b){a.placement&&k.setLogoSize(b.data.searchContext,a.placement.logo)},a}();b.ImpressionHelper=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});b.isFunction=function(a){return"function"==typeof a&&"number"!=typeof a.nodeType}},function(e,b,a){Object.defineProperty(b,
"__esModule",{value:!0});b.class2Type={}},function(e,b,a){function k(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];var c,d,m,n,p,e=a.length,r=a[0]||{},u=1,v=!1;"boolean"==typeof r&&(v=r,r=a[u]||{},u++);"object"==typeof r||l.isFunction(r)||(r={});for(u===e&&(r=this,u--);u<e;u++)if(null!=(b=a[u]))for(c in b)b.hasOwnProperty(c)&&(d=r[c],m=b[c],r!==m)&&(v&&m&&(g.isPlainObject(m)||(n=Array.isArray(m)))?(n?(n=!1,p=d&&Array.isArray(d)?d:[]):p=d&&g.isPlainObject(d)?d:{},r[c]=k(v,p,m)):void 0!==
m&&(r[c]=m));return r}Object.defineProperty(b,"__esModule",{value:!0});var g=a(28),l=a(19);b.extend=k},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var k,g=a(0),l=a(35),f=a(10);e=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return g.__extends(b,a),b.getInstance=function(){return k||(k=new this),k},b.prototype.prepareItemsToDisplay=function(a){var b=this,c=f.CompareToSettings.getInstance().getSettingsSync();if(!c)return[];var d=[],g=l.StorageHelper.getInstance().getItem("cmp2.check.all"),
c=c.rendering,h=c.storeStateSession,k=c.limited,e=c.usePreCheckItems,x=c.maxCheckedItems,q=0;return a.forEach(function(a){var c=!1;(!k||q<x)&&(c=b._isItemChecked(a,h,e,g))&&q++;c={name:a.name,code:a.code,id:a.id,visible:a.visible,checked:c,prechecked:e&&a.prechecked,termId:a.termId,idInState:a.idInState,rank:a.rank,logo:a.logo,logoLarge:a.logoLarge};"deepLink"in a&&(c.deepLink=a.deepLink);"clickToCall"in a&&(c.clickToCall=a.clickToCall);"svgLogo"in a&&(c.svgLogo=a.svgLogo);"phoneNumber"in a&&(c.phoneNumber=
a.phoneNumber);"trackingUrl"in a&&(c.trackingUrl=a.trackingUrl);d.push(c)}),d},b.prototype.getCompareToItemsFromImpressionState=function(a){var b=[];return a.forEach(function(a){b.push({name:"",logo:"",logoLarge:"",code:a.code,id:a.id,visible:a.visible,checked:a.checked,prechecked:a.prechecked,idInState:!0,termId:a.termId,rank:a.rank})}),b},b.prototype.mapDeepLinkToItems=function(a,b){var c=[];return this.getCompareToItemsFromImpressionState(a).forEach(function(a){a.visible&&a.checked&&b[a.code]&&
b[a.code].deepLink&&(a.deepLink=b[a.code].deepLink,c.push(a))}),c},b}(a(13).CompareToList);b.ItemsList=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var k=a(9),g=a(10);b.isEnabled=function(a,b){return b&&b.enabled&&(!b.verticals||b.verticals[a])||!1};b.excludeRequest=function(a,b){a=a.displayRails;return b&&a&&!1===a[b.displayRail]||!1};b.getMultiProviderWindowExtra=function(a,b,h){h={searchId:void 0!==h?h:a.searchId};var c=g.CompareToSettings.getInstance().getSettingsSync();
if(!c||!(b="rp"===b?c.multiProviderWindowRP:c.multiProviderWindowFD))return h;c=a.placement;return c&&(b.pageOrigin&&(h.pageOrigin=k.getPageOrigin(a)),b.showOn&&(h.showOn=c.showOn),b.displayRail&&(h.displayRail=c.displayRail),b.vertical&&(h.vertical=a.type),b.position&&(h.position=c.displayRail)),h};b.getApiVersion=function(a,b){a=a.type;var f=b.apiVersions;return f&&f[a]?f[a]:b.apiVersion}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});e=function(){function a(){this.events={}}
return a.prototype.on=function(a,b){var f=this.events[a];return f||(this.events[a]=f=[]),f.push(b),this},a.prototype.off=function(a,b){var f=this.events[a];return f?(void 0===b?delete this.events[a]:this.events[a]=f.filter(function(a){if(a!==b)return a}),this):this},a.prototype.subscribe=function(a,b){return this.on(a,b)},a.prototype.unSubscribe=function(a,b){return this.off(a,b)},a.prototype.publish=function(a,b){a=this.events[a];if(!a)return this;for(var f=0,h;h=a[f];f++)h.apply(this,b||[]);return this},
a.prototype.notify=function(a,b){return this.publish(a,b)},a}();b.Observer=e},function(e,b,a){function k(a,b,n,f){var d;if(Array.isArray(b))g.each(b,function(b,d){n||c.test(a)?f(a,d):k(a+"["+("object"==typeof d&&null!=d?b:"")+"]",d,n,f)});else if(n||"object"!==l.toType(b))f(a,b);else for(d in b)b.hasOwnProperty(d)&&k(a+"["+d+"]",b[d],n,f)}Object.defineProperty(b,"__esModule",{value:!0});var g=a(50),l=a(26),f=a(28),h=a(19),c=/\[\]$/;b.param=function(a,b,c){void 0===b&&(b=!1);void 0===c&&(c="\x26");
var d,n=[],m=function(a,b){b=h.isFunction(b)?b():b;n[n.length]=encodeURIComponent(a)+"\x3d"+encodeURIComponent(null==b?"":b)};if(Array.isArray(a)||!f.isPlainObject(a))g.each(a,function(a,b){m(a,b)});else for(d in a)a.hasOwnProperty(d)&&k(d,a[d],b,m);return n.join(c)}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var k=a(20),g=a(27);b.toType=function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?k.class2Type[g.toString.call(a)]||"object":typeof a}},function(e,
b,a){Object.defineProperty(b,"__esModule",{value:!0});e=a(20);b.toString=e.class2Type.toString},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var k=a(29),g=a(53),l=a(30),f=a(27);b.isPlainObject=function(a){var b,d;return!(!a||"[object Object]"!==f.toString.call(a))&&(!(b=Object.getPrototypeOf(a))||"function"==typeof(d=l.hasOwn.call(b,"constructor")&&b.constructor)&&k.functionToString.call(d)===g.objectFunctionString)}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});
e=a(30);b.functionToString=e.hasOwn.toString},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});e=a(20);b.hasOwn=e.class2Type.hasOwnProperty},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});b.addEvent=function(a,b,e){void 0===a._eventListeners&&(a._eventListeners=[]);a.addEventListener(b,e,!1);var f=a._eventListeners;f.push({type:b,fn:e});a._eventListeners=f};b.removeEvent=function(a,b,e){if(void 0!==a._eventListeners){a.removeEventListener(b,e);for(var f,h=a._eventListeners,
c=[],d=h.length,g=0;g<d;g++)f=h[g],f.type!==b&&f.fn!==e&&c.push(h[g]);a._eventListeners=h}}},function(e,b,a){function k(a){a=a.split("/");for(var b=a.length,c=[],n=0;n<b;n++){var f=a[n];0!==f.length&&c.push(f)}return c.join("/").replace(/^(https?:)([\/])*/g,"$1//")}Object.defineProperty(b,"__esModule",{value:!0});var g=a(25);b.updateBasePath=function(a){return b.BASE_PATH=k(a),-1===b.BASE_PATH.indexOf("http")&&(b.BASE_PATH="/"+b.BASE_PATH),b.BASE_PATH};var l=/#.*$/,f=/\?/,h=/([?&])_=[^&]*/;b.formatUrl=
function(a,d,m){void 0===d&&(d="");void 0===m&&(m=!0);a=(a=k(a))?a&&0===a.indexOf("http")?a:b.BASE_PATH.replace(/[\/]$/g,"")+"/"+a:b.BASE_PATH;if(d){var c=m;void 0===a&&(a="");void 0===d&&(d="");void 0===c&&(c=!0);m=a.replace(l,"");a=a.slice(m.length);d&&(d="object"==typeof d?g.param(d):d,m+=(f.test(m)?"\x26":"?")+d);d=(!1===c&&(m=m.replace(h,"$1"),a=(f.test(m)?"\x26":"?")+"_\x3d"+(new Date).getTime()+a),m+a)}else d=a;return d};b.BASE_PATH=""},function(e,b,a){Object.defineProperty(b,"__esModule",
{value:!0});var k=a(21),g=a(1),l={scrollbars:1,location:1,statusbar:1,menubar:0,resizable:1},f=function(){function a(){}return a.getInstance=function(){return this._instance||(this._instance=new this),this._instance},a.prototype.getWindowHandleInformation=function(a){try{a=a||window;var b=a.document,c=a.screen,f=b.documentElement,h=b.getElementsByTagName("body")[0];return{y:"screenY"in a?a.screenY:a.screenTop,x:"screenX"in a?a.screenX:a.screenLeft,width:a.innerWidth||f.clientWidth||h.clientWidth,
height:a.innerHeight||f.clientHeight||h.clientHeight,screenWidth:c.availWidth,screenHeight:c.availHeight}}catch(t){g.getLogger().error("cmp2-workaround: WindowHandleFeatures unable to access window/handle information",t)}try{return{y:0,x:0,width:window.screen.availWidth,height:window.screen.availHeight,screenWidth:window.screen.availWidth,screenHeight:window.screen.availHeight}}catch(t){g.getLogger().error("cmp2-workaround: WindowHandleFeatures unable to access window information",t)}return{y:0,x:0,
width:800,height:600,screenWidth:800,screenHeight:600}},a.prototype.hidden=function(a,b){var c=Math.min(1024,b.height-20),d=Math.min(1280,b.width-20),f=b.y+10,g=b.x+10;return a&&(c=160,d=160,f=b.y+(b.height-110),g=b.x+(b.width-185)),k.extend({},l,{top:f,left:g,height:c,width:d})},a.prototype.tiled=function(a,b,f){b=Math.floor(f.screenWidth/b-10);return k.extend({},l,{left:Math.floor((b+5)*a),top:-999999999,height:Math.abs(-1*f.screenHeight),width:Math.abs(b)})},a}();b.WindowHandleFeatures=f;b.default=
function(){return f.getInstance()}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var k=a(0),g=a(1),l=a(5);e=a(7);var f=l.default();e=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.windowHandleNames=[],b.windowHandles=[],b}return k.__extends(b,a),b.prototype.start=function(a){var b=this,c=this.getItems();this.windowHandleNames=[];this.windowHandles=[];this.publish("preOpen",[c]);var d=this.windowHandleInformation.options,f=1;void 0!==d.delay&&(f=
d.delay);for(var d=0,g=void 0;g=c[d];d++)this._open(g,a);setTimeout(function(){b.publish("postOpen",[b.windowHandles,b.windowHandleNames])},f)},b.prototype._open=function(a,b){var c=this,d=this.getItems(),h=this.getWindowNamePrefix(),m=this.windowHandleInformation.options,e=0;void 0!==m.timer&&(e=m.timer);setTimeout(function(){c.publish("preItemOpen",[a,d]);var n=l.isSystemTargetName(a.name)?a.name:l.getWindowName(h+a.name),e=f.open(a.url,n,a.features);if(m.expectWindowReference)if(e)c.addHandleName(n),
c.addHandle(e),c.publish("handleCreated",[a,d,e]);else{var p=b?"":" in the RP";g.getLogger().warn("cmp2-workaround: unable to open handle in TimeoutWindowHandleExecutor"+p,{workaround:m,name:n,item:a})}c.publish("postItemOpen",[a,d,e])},e)},b.prototype.addHandleName=function(a){this.windowHandleNames.push(a)},b.prototype.addHandle=function(a){this.windowHandles.push(a)},b}(e.default);b.TimeoutWindowHandleExecutor=e;b.default=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var k=
a(8);e=function(){function a(){this._available=!1;try{this.setStorage(window.localStorage)}catch(l){}}return a.getInstance=function(){return this._instance||(this._instance=new this),this._instance},a.prototype.setStorage=function(a){var b;try{a&&(a.setItem("vendor-support-test","success?"),b=a.getItem("vendor-support-test"),a.removeItem("vendor-support-test"),this._storage=a),"success?"===b&&(this._available=!0)}catch(h){}},a.prototype.getItem=function(a){if(this._available&&this._storage){var b=
this._storage.getItem(a);if(b)try{return JSON.parse(b)}catch(h){return k.getLogger().error("cmp2-ui: StorageHelper unable to parse value",{key:a,value:b,error:h}),b}}return null},a.prototype.setItem=function(a,b){if(this._available&&this._storage)try{null!==b&&"object"==typeof b?this._storage.setItem(a,JSON.stringify(b)):this._storage.setItem(a,b)}catch(h){k.getLogger().error("cmp2-ui: StorageHelper unable to set item",{key:a,data:b})}},a.prototype.removeItem=function(a){try{this._available&&this._storage&&
this._storage.removeItem(a)}catch(f){k.getLogger().error("cmp2-ui: StorageHelper unable to remove item",{key:a})}},a.prototype.clear=function(){if(this._available&&this._storage)try{this._storage.clear()}catch(l){k.getLogger().error("cmp2-ui: StorageHelper unable to clear")}},a}();b.StorageHelper=e},function(e,b,a){function k(a,b,c){return{type:a.type,placement:c&&c.placement||a.placement,searchId:a.searchId||c&&c.searchId,url:c&&c.url||a.url,compareTos:m.ItemsList.getInstance().getCompareToItemsFromImpressionState(b||
[]),registerImpression:!0,includeCloseDeepLinks:!1,deepLink:!0,list:!1}}Object.defineProperty(b,"__esModule",{value:!0});var g=a(13),l=a(10),f=a(8),h=a(23),c=a(9),d=a(12),m=a(22);b.onDirectMouseUp=function(a,b){if(!l.CompareToSettings.getInstance().isSettings())return void f.getLogger().error("cmp2-ui: settings are not set to execute direct mouse up");f.getWorkaround().onDirectMouseUp(g.CompareToList.getInstance().getVisibleItem(a),h.getMultiProviderWindowExtra(b,"rp"))};b.onDirectMouseDown=function(a,
b){if(!l.CompareToSettings.getInstance().isSettings())return void f.getLogger().error("cmp2-ui: settings are not set to execute direct mouse down");f.getWorkaround().onDirectMouseDown(g.CompareToList.getInstance().getVisibleItem(a),h.getMultiProviderWindowExtra(b,"rp"))};b.onDirectClick=function(a,b){if(!l.CompareToSettings.getInstance().isSettings())return void f.getLogger().error("cmp2-ui: settings are not set to execute direct click");f.getWorkaround().onDirectClick(g.CompareToList.getInstance().getVisibleItem(a),
h.getMultiProviderWindowExtra(b,"rp"))};b.logImpression=function(a,b,m,e){if(!a.placement)return m([]),void f.getLogger().error("cmp2-ui: placement information is missing in logImpression",a);var n=l.CompareToSettings.getInstance().getSettingsSync();if(!n)return void m([]);a=c.Impression.getInstance().getRequestConfig(a,a.searchId,b,h.getApiVersion(a,n));if(!a)return void m([]);d.Ajax.getInstance().request(a,function(a){if(!a||!a.success)return f.getLogger().error("cmp2-ui: Received an unexpected response in logImpression",
a.errors),void e();m(g.CompareToList.getInstance().updateDisplayItemsDeepLink(b,a.urls))},function(a){f.getLogger().error("cmp2-ui: AJAX error on log impression",a);e()},function(){e()})};b.onResultPageOpen=function(a,b){l.CompareToSettings.getInstance().getSettings(function(n){if(h.isEnabled(a.type,n)&&!h.excludeRequest(n,a.placement)){var m=c.WindowInfo.getInstance().getRetrieveConfig(a,h.getApiVersion(a,n));m&&d.Ajax.getInstance().request(m,function(m){if(!m||!m.success)return void f.getLogger().error("cmp2-ui: errors in Storage",
m.errors);if((m=m.content||[],"object"==typeof m)&&m.constructor===Array&&0<m.length){var e=m[m.length-1],p=f.getWorkaround();if(e){var k=g.CompareToList.getInstance().getCompareToItemsFromImpressionState(e.items||[],[]);(void 0===n.workaround.updateHistory||n.workaround.updateHistory)&&g.CompareToList.getInstance().isCheckedItem(k)&&p.pushHandleHistory(window,e.other.referer||"")}for(var r=m.length,e=0,k=void 0;k=m[e];e++)if(k=function(m,e){var k={type:e.type,placement:e.placement,requestInformation:e.requestInformation},
l=c.Impression.getInstance().getRequestConfig(k,b,e.items,h.getApiVersion(a,n));if(!l)return f.getLogger().error("cmp2-ui: Could not construct Impression Request Config"),{value:void 0};d.Ajax.getInstance().request(l,function(a){if(!a.success)return void f.getLogger().error("cmp2-ui: errors in impression",a.errors);p.setIgnoreWindowErrors(m+1!==r);p.onResultPageOpen(g.CompareToList.getInstance().getCompareToItemsFromImpressionState(e.items||[],a.urls||[]),h.getMultiProviderWindowExtra(k,"fd",b),e.other.windowNamePrefix);
p.setIgnoreWindowErrors(!1)},function(a){f.getLogger().error("cmp2-ui: Error while logging FD impression",a)})}(e,k),"object"==typeof k)return k.value}},function(a){f.getLogger().error("cmp2-ui: AJAX error on Retrieve WindowInfo",a)})}})};b.onResultPage=function(a){var b=l.CompareToSettings.getInstance().getSettingsSync();if(!b)return void f.getLogger().error("cmp2-ui: errors config is not defined can't make request on ResultPage");if(h.isEnabled(a.type,b)&&!h.excludeRequest(b,a.placement)){var n=
c.WindowInfo.getInstance().getRetrieveConfig(a,30);n&&d.Ajax.getInstance().request(n,function(g){if(!g||!g.success)return void f.getLogger().error("cmp2-ui: errors in Storage",g.errors,n);if((g=g.content||[],"object"==typeof g)&&g.constructor===Array&&0<g.length){var e=m.ItemsList.getInstance(),p=g[g.length-1],r=f.getWorkaround();if(p){var l=e.getCompareToItemsFromImpressionState(p.items||[]);(void 0===b.workaround.updateHistory||b.workaround.updateHistory)&&e.isCheckedItem(l)&&r.pushHandleHistory(window,
p.other.referer||"")}var t=g.length;g.forEach(function(b,g){var m=k(a,b.items,b),p=c.List.getInstance().getConfig(m);d.Ajax.getInstance().request(p,function(c){if(!c||!c.success)return void f.getLogger().error("cmp2-ui: ResultPage error",p,c);c=e.mapDeepLinkToItems(b.items||[],c.content||{});r.setIgnoreWindowErrors(g+1!==t);r.onResultPageOpen(c,h.getMultiProviderWindowExtra(m,"fd",a.searchId||b.searchId),b.other.windowNamePrefix);r.setIgnoreWindowErrors(!1)},function(a){f.getLogger().error("cmp2-ui: AJAX error on onResultPage",
a,n,p)})})}},function(a){f.getLogger().error("cmp2-ui: AJAX error on Retrieve WindowInfo V3",a,n)})}};b.registerImpression=function(a,b){l.CompareToSettings.getInstance().getSettings(function(g){if(h.isEnabled(a.type,g)&&!h.excludeRequest(g,a.placement)){g=k(a,b);var n=c.List.getInstance().getConfig(g);d.Ajax.getInstance().request(n,function(a){a&&a.success||f.getLogger().error("cmp2-ui: Error on registerImpression",n,a)},function(a){f.getLogger().error("cmp2-ui: AJAX error on registerImpression",
a,n)})}})}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});e=a(38);window["@r9/cmp2-ui"]||(window["@r9/cmp2-ui"]=e)},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});e=a(0);var k=a(9),g=a(8),l=a(12),f=a(10),h=a(13),c=a(22),d=a(23),m=a(36);b.logImpression=m.logImpression;e.__exportStar(a(8),b);e.__exportStar(a(9),b);e=a(66);b.onItemMouseUp=e.onItemMouseUp;b.onItemMouseDown=e.onItemMouseDown;b.onItemChange=e.onItemChange;b.onFormClick=e.onFormClick;b.onFormButtonMouseDown=
e.onFormButtonMouseDown;b.onFormButtonMouseUp=e.onFormButtonMouseUp;a=a(36);b.onDirectMouseUp=a.onDirectMouseUp;b.onDirectMouseDown=a.onDirectMouseDown;b.onDirectClick=a.onDirectClick;b.onResultPageOpen=a.onResultPageOpen;b.onResultPage=a.onResultPage;b.registerImpression=a.registerImpression;b.setModuleConfig=function(a){a.ajax&&l.Ajax.getInstance().setMethod(a.ajax);a.logger&&g.setLogger(a.logger);a.settings&&f.CompareToSettings.getInstance().setSettings(a.settings)};b.showRPCompareAll=function(a){if(!f.CompareToSettings.getInstance().isSettings())return g.getLogger().error("cmp2-ui: settings are not set to execute showRPCompareAll"),
!1;if(g.getWorkaround().showRPCompareAll()){a=h.CompareToList.getInstance().getVisibleItemCount(a);var b=f.CompareToSettings.getInstance().getSettingsSync();if(b&&a>=b.rendering.minItemsForCompareAll)return!0}return!1};b.getCompareToList=function(a,b,c){if(!a.placement)return b([],[]),void g.getLogger().error("cmp2-ui: placement information is missing",a);f.CompareToSettings.getInstance().getSettings(function(f){if(!d.isEnabled(a.type,f)||d.excludeRequest(f,a.placement))return void b([],[]);var n=
k.List.getInstance().getRequestConfig(a,d.getApiVersion(a,f));if(!n)return void b([],[]);l.Ajax.getInstance().request(n,function(d){if(!d||!d.success)return g.getLogger().error("cmp2-ui: Received an unexpected response",n,d),void c();a.searchId?h.CompareToList.getInstance().apiToDisplayCompareToItem(d.compareTos,function(d){var f=[];if(!d.length)return void b(d,f);d.forEach(function(a){f.push(g.extend({},a))});m.logImpression(a,d,function(a){b(a,f)},c)},c):h.CompareToList.getInstance().apiToDisplayCompareToItem(d.compareTos,
function(a){b(a)},c)},function(b){g.getLogger().error("cmp2-ui: AJAX error on getCompareToList",b,a);c()},c)},c)};b.getCompareTo=function(a,b,m){if(!a.placement)return b([]),void g.getLogger().error("cmp2-ui: placement information is missing",a);if(!a.url)return b([]),void g.getLogger().error("cmp2-ui: missing url",a);var h=f.CompareToSettings.getInstance();if(h.isSettings()){var e=h.getSettingsSync();if(!d.isEnabled(a.type,e)||d.excludeRequest(e,a.placement))return void b([])}var e={type:a.type,
placement:a.placement,searchId:a.searchId,url:a.url,registerImpression:!!a.registerImpression,deepLink:!!a.deepLink,list:!0,convertUrl:!!a.convertUrl,config:!h.isSettings()},n=k.List.getInstance().getConfig(e);l.Ajax.getInstance().request(n,function(f){if(!f||!f.success)return g.getLogger().error("cmp2-ui: Received an unexpected response",n,f,a),void m();if(f.config){h.setSettings(f.config);var e=h.getSettingsSync();if(!d.isEnabled(a.type,e)||d.excludeRequest(e,a.placement))return void b([])}return h.isSettings()?
f.content?void b(c.ItemsList.getInstance().prepareItemsToDisplay(f.content)):void b([]):(g.getLogger().error("cmp2-ui: expected to have settings after getCompareTo request",n,f,a),void b([]))},function(a){g.getLogger().error("cmp2-ui: AJAX error on getCompareTo",a,n);m()},m)}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var k=a(40),g=a(41),l=a(42),f=a(4);e=function(){function a(){}return a.getInstance=function(){return this._instance||(this._instance=new this),this._instance},
a.prototype.getRequestConfig=function(a,b){switch(void 0===b&&(b=2),a.type){case "F":return g.FlightListHelper.getInstance().getListRequest(a,b);case "H":return l.HotelListHelper.getInstance().getListRequest(a,b);case "C":return k.CarListHelper.getInstance().getListRequest(a)}return!1},a.prototype.getConfig=function(a){return{method:"POST",headers:f.getPostHeader(),url:"/s/horizon/compareTo/list",data:a}},a}();b.List=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var k=a(0);e=
a(14);var g=a(4),l=a(15);a=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return k.__extends(b,a),b.getInstance=function(){return this._instance||(this._instance=new this),this._instance},b.prototype.getListRequest=function(a){var b=a.requestInformation;if(!b||l.ignoreRequestInformation(b)||!a.placement)return!1;var c=b.details[0],f=c.startLocation[0],e=b.details[1],b=e.startLocation[0],c={method:"GET",url:"/a/api/compareto/V2/cars/list",params:{showOn:a.placement.showOn,
pickupDate:g.prepareDate(c.startDate),dropoffDate:g.prepareDate(e.startDate),oneWay:!g.isLocationEqual(f,b)}},e=c.params;f.id&&(e.cityCode=f.id);f.cityId&&(e.cityCode=(e.cityCode?e.cityCode+"/":"")+f.cityId);f=f.name;if(f&&(e.location=f),e.oneWay)b.id&&(e.dropoffCityCode=b.id),b.cityId&&(e.dropoffCityCode+="/"+b.cityId),(f=b.name)&&(e.dropoffLocation=f);return this._populateBaseListRequest(a,c),c},b}(e.ListHelper);b.CarListHelper=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});
var k=a(0),g=a(16),l=a(4);e=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return k.__extends(b,a),b.getInstance=function(){return this._instance||(this._instance=new this),this._instance},b.prototype.getListRequest=function(a,b){var c=a.requestInformation;if(!c||g.ignoreRequestInformation(c)||!a.placement)return!1;var d=c.details,f=d[0];l.sortLocations(f.startLocation);l.sortLocations(f.endLocation);c={method:"GET",url:"/a/api/compareto/V2/flights/list",params:{showOn:a.placement.showOn,
departureDate:l.prepareDate(f.startDate),origin:f.startLocation[0].id||"",destination:f.endLocation[0].id||"",cabin:f.other.cabin,student:c.other.student,oneWay:1===d.length}};f=c.params;return(3<=b&&10>b||11<=b)&&(f.travelers=g.getTravelersCount(a)),2===d.length&&(f.returnDate=l.prepareDate(d[1].startDate)),this._populateBaseListRequest(a,c),c},b}(a(14).ListHelper);b.FlightListHelper=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var k=a(0),g=a(17),l=a(4);e=function(a){function b(){return null!==
a&&a.apply(this,arguments)||this}return k.__extends(b,a),b.getInstance=function(){return this._instance||(this._instance=new this),this._instance},b.prototype.getListRequest=function(a,b){var c=a.requestInformation;if(!c||g.ignoreRequestInformation(a,b)||!a.placement)return!1;var d=c.details[0],f={method:"GET",url:"/a/api/compareto/V2/hotels/list",params:{showOn:a.placement.showOn,checkinDate:l.prepareDate(d.startDate),checkoutDate:l.prepareDate(d.endDate)}},e=f.params;if(3<=b&&10>b||11<=b)c=c.other,
e.travelers=c.adults+c.children,e.rooms=c.rooms;d=d.startLocation[0];(b=g.addLocationInformationVersion(e,d,b))&&(b.id&&(e.destinationId=b.id),b.type&&(e.destinationType=b.type));b=d.name;return b&&(e.location=b),this._populateBaseListRequest(a,f),f},b}(a(14).ListHelper);b.HotelListHelper=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var k=a(44),g=a(45),l=a(46);e=function(){function a(){}return a.getInstance=function(){return this._instance||(this._instance=new this),this._instance},
a.prototype.getRequestConfig=function(a,b,d,f){switch(void 0===f&&(f=2),a.type){case "F":return k.FlightImpressionHelper.getInstance().getImpressionRequest(a,b,d);case "H":return g.HotelImpressionHelper.getInstance().getImpressionRequest(a,b,d,f);case "C":return l.CarImpressionHelper.getInstance().getImpressionRequest(a,b,d)}return!1},a}();b.Impression=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var k=a(0);e=a(18);var g=a(4),l=a(16);a=function(a){function b(){return null!==
a&&a.apply(this,arguments)||this}return k.__extends(b,a),b.getInstance=function(){return this._instance||(this._instance=new this),this._instance},b.prototype.getImpressionRequest=function(a,b,f){var c=a.requestInformation;if(!c||l.ignoreRequestInformation(c)||!a.placement)return!1;var d=c.details[0];g.sortLocations(d.startLocation);g.sortLocations(d.endLocation);b={method:"POST",url:"/a/api/compareto/V2/flights/impression",headers:g.getPostHeader(),data:{compareToStates:f,searchContext:{showOn:a.placement.showOn,
departureDate:g.prepareDate(d.startDate),origin:d.startLocation[0].id||"",destination:d.endLocation[0].id||"",cabin:d.other.cabin,student:c.other.student,oneWay:1===c.details.length,numberOfTravelers:l.getTravelersCount(a)},searchId:b,pageOrigin:g.getPageOrigin(a),displayRail:a.placement.displayRail}};return 2===c.details.length&&(b.data.searchContext.returnDate=g.prepareDate(c.details[1].startDate)),this._populateBaseImpressionRequest(a,b),b},b}(e.ImpressionHelper);b.FlightImpressionHelper=a},function(e,
b,a){Object.defineProperty(b,"__esModule",{value:!0});var k=a(0);e=a(18);var g=a(4),l=a(17);a=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return k.__extends(b,a),b.getInstance=function(){return this._instance||(this._instance=new this),this._instance},b.prototype.getImpressionRequest=function(a,b,f,e){var c=a.requestInformation;if(!c||l.ignoreRequestInformation(a,e)||!a.placement)return!1;var d=c.details[0],h=d.startLocation[0];b={method:"POST",url:"/a/api/compareto/V2/hotels/impression",
headers:g.getPostHeader(),data:{compareToStates:f,searchContext:{showOn:a.placement.showOn,checkinDate:g.prepareDate(d.startDate),checkoutDate:g.prepareDate(d.endDate),rooms:c.other.rooms,guests:c.other.adults+c.other.children},searchId:b,pageOrigin:g.getPageOrigin(a),displayRail:a.placement.displayRail}};f=b.data.searchContext;(e=l.addLocationInformationVersion(f,h,e))&&(f.destination=e);h=h.name;return h&&(f.location=h),this._populateBaseImpressionRequest(a,b),b},b}(e.ImpressionHelper);b.HotelImpressionHelper=
a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var k=a(0);e=a(18);var g=a(4),l=a(15);a=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return k.__extends(b,a),b.getInstance=function(){return this._instance||(this._instance=new this),this._instance},b.prototype.getImpressionRequest=function(a,b,f){var c=a.requestInformation;if(!c||l.ignoreRequestInformation(c)||!a.placement)return!1;var d=c.details[0],e=d.startLocation[0],h=c.details[1],c=h.startLocation[0];
b={method:"POST",url:"/a/api/compareto/V2/cars/impression",headers:g.getPostHeader(),data:{compareToStates:f,searchContext:{showOn:a.placement.showOn,pickupDate:g.prepareDate(d.startDate),dropoffDate:g.prepareDate(h.startDate),oneWay:!g.isLocationEqual(e,c)},searchId:b,pageOrigin:g.getPageOrigin(a),displayRail:a.placement.displayRail}};f=b.data.searchContext;(d=d.other.hour)&&(f.pickupHour=d);(d=h.other.hour)&&(f.dropoffHour=d);(d=e.id)&&(f.cityCode=d);e.cityId&&(f.cityCode=(f.cityCode?f.cityCode+
"/":"")+e.cityId);e=e.name;if(e&&(f.location=e),f.oneWay)(e=c.id)&&(f.dropoffCityCode=e),c.cityId&&(f.dropoffCityCode+="/"+c.cityId),(c=c.name)&&(f.dropoffLocation=c);return this._populateBaseImpressionRequest(a,b),b},b}(e.ImpressionHelper);b.CarImpressionHelper=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var k=a(15),g=a(17),l=a(16),f=a(4);e=function(){function a(){}return a.getInstance=function(){return this._instance||(this._instance=new this),this._instance},a.prototype.getStoreConfig=
function(a,b,f,e,g){if(void 0===f&&(f={}),void 0===e&&(e=2),void 0===g&&(g=!0),30===e)return this._getStoreConfig(a,b,f);if(this._ignoreRequest(a,e))return!1;if(g&&a.requestInformation)for(e=a.requestInformation.details,g=0;g<e.length;g++)this._removeLocationNames(e[g]);return this._getStoreConfig(a,b,f)},a.prototype.getRetrieveConfig=function(a,b){return(void 0===b&&(b=2),30===b)?this._getRetrieveConfig(a):!this._ignoreRequest(a,b)&&this._getRetrieveConfig(a)},a.prototype._ignoreRequest=function(a,
b){var c=a.requestInformation;if(!c)return!0;switch(a.type){case "F":return l.ignoreRequestInformation(c);case "H":return g.ignoreRequestInformation(a,b);case "C":return k.ignoreRequestInformation(c)}return!0},a.prototype._removeLocationNames=function(a){for(var b=a.startLocation,c=0;c<b.length;c++)b[c].name&&delete b[c].name;if(a=a.endLocation)for(c=0;c<a.length;c++)a[c].name&&delete a[c].name},a.prototype._getStoreConfig=function(a,b,e){return{method:"POST",url:"/s/horizon/compareTo/WindowInformation/add",
headers:f.getPostHeader(),data:{type:a.type,placement:a.placement,requestInformation:a.requestInformation,convertUrl:!!a.convertUrl,url:a.url?a.url:"",items:b,other:e}}},a.prototype._getRetrieveConfig=function(a){return{method:"POST",url:"/s/horizon/compareTo/WindowInformation/list",headers:f.getPostHeader(),data:a}},a}();b.WindowInfo=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});e=function(){function a(){}return a.getInstance=function(){return this._instance||(this._instance=
new this),this._instance},a.prototype.getRequest=function(){return{method:"GET",url:"/s/horizon/compareTo/config"}},a}();b.CompareToSettings=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var k=a(2),g=a(54),l=a(55),f=a(56),h=a(57),c=a(59),d=a(60),m=a(1),n=a(61),p=a(62),t=a(63),r=a(64),u=a(65),v=function(){function a(){}return a.getInstance=function(){return this._instance||(this._instance=new this),this._instance},a.prototype.setWorkaround=function(a,b){switch(b?a.fallbackName:
a.name){case "AsyncOpen":this.workaround=new g.default(a);break;case "AsyncOpenMobile":this.workaround=new l.default(a);break;case "ChangeWindowNameLast":this.workaround=new f.default(a);break;case "ChangeWindowNameSequence":this.workaround=new h.default(a);break;case "DocumentFocus":this.workaround=new c.default(a);break;case "HandleOpen":this.workaround=new d.default(a);break;case "RegularOpenCloseLast":this.workaround=new n.default(a);break;case "Swapper":this.workaround=new p.default(a);break;
case "SwapperMultipleWindows":this.workaround=new t.default(a);break;case "SwapperMultipleWindowsNoSpinner":this.workaround=new u.default(a);break;case "SwapperNoSpinner":this.workaround=new r.default(a);break;default:if(!b&&a.fallbackName)return m.getLogger().warn("cmp2-workaround: unable to find workaround. Trying to fallback",a),void this.setWorkaround(a,!0);m.getLogger().error("cmp2-workaround: unable to find workaround",a.name);this.workaround=new k.default(a)}},a.prototype.getWorkaround=function(){return this.workaround||
(m.getLogger().error("cmp2-workaround: workaround is not set"),this.workaround=new k.default({name:""})),this.workaround},a}();b.Workaround=v;b.default=function(){return v.getInstance()}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var k=a(51);b.each=function(a,b){if(k.isArrayLike(a))for(var f=a.length,e=0;e<f&&!1!==b.call(a[e],e,a[e]);e++);else for(e in a)if(a.hasOwnProperty(e)&&!1===b.call(a[e],e,a[e]))break;return a}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});
var k=a(19),g=a(26),l=a(52);b.isArrayLike=function(a){var b=!!a&&"length"in a&&a.length,c=g.toType(a);return!k.isFunction(a)&&!l.isWindow(a)&&("array"===c||0===b||"number"==typeof b&&0<b&&b-1 in a)}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});b.isWindow=function(a){return null!=a&&a===a.window}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});e=a(29);b.objectFunctionString=e.functionToString.call(Object)},function(e,b,a){Object.defineProperty(b,"__esModule",
{value:!0});var k=a(0);e=a(2);var g=a(6),l=a(3),f=a(8),h=a(34),c=l.default();a=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return k.__extends(b,a),b.prototype.onDirectClick=function(a,b){a=c.forDirect(a);a=new g.default(this.options,a);(new h.default(a)).start(!1)},b.prototype.onFormClick=function(a,b,d){var e=this;a=c.forSubmit(b);b={url:"",name:"_self",features:{}};delete b.features;a.push(b);a=new g.default(this.options,a);a.postItemOpen=function(a,b,c){a.features||
(c&&!c.closed?c.focus():f.getLogger().warn("cmp2-workaround: AsyncOpen unable to focus",{workaround:e.options}))};a.postOpen=function(a,b){d(a,b)};(new h.default(a)).start(!0)},b}(e.default);b.AsyncOpen=a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var k=a(0);e=a(2);var g=a(6),l=a(3),f=a(8),h=a(34),c=a(5),d=a(11),m=c.default(),n=l.default();a=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return k.__extends(b,a),b.prototype.onDirectClick=
function(a,b){a=n.forDirect(a);a=new g.default(this.options,a);(new h.default(a)).start(!1)},b.prototype.navigateToResults=function(a,b,c){return!0},b.prototype.onFormClick=function(a,b,e){var k=this,l=n.forSubmit(b,4),r=l.shift();r?(b=this.getWindowNamePrefix(),m.updateHandleName(window,c.getWindowName(b+r.name),1),l.push({url:a,name:"k"+d.default.randomString(8),features:{}}),l=new g.default(this.options,l),l.postOpen=function(b,c){var g=m.getActiveWindowHandles(b),h=m.getLastActiveHandle(g);g.length!==
b.length&&f.getLogger().warn("cmp2-workaround: AsyncOpenMobile some windows are closed",{workaround:k.options,activeWindowHandlesLength:g.length,windowHandlesLength:b.length});h&&(m.updateHandleName(h,"k"+d.default.randomString(8),2),h.location.href=a);e(b,c)},l=new h.default(l),l.setWindowNamePrefix(b),l.start(!0)):(f.getLogger().error('cmp2-workaround: AsyncOpenMobile "firstItem" is undefined',{workaround:this.options}),e([],[]))},b}(e.default);b.AsyncOpenMobile=a;b.default=a},function(e,b,a){Object.defineProperty(b,
"__esModule",{value:!0});var k=a(0);e=a(2);var g=a(7),l=a(6),f=a(5);a=a(3);var h=f.default(),c=a.default();a=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return k.__extends(b,a),b.prototype.onFormClick=function(a,b,d){a=c.forSubmit(b);var f=this.getWindowNamePrefix();h.updateHandleName(window,f,1);a=new l.default(this.options,a);a.postOpen=function(a,b){h.open("",f);d(a,b)};(new g.default(a)).start(!0)},b}(e.default);b.ChangeWindowNameLast=a;b.default=a},function(e,b,a){Object.defineProperty(b,
"__esModule",{value:!0});var k=a(0),g=a(58);e=a(2);var l=a(1),f=a(7),h=a(11),c=a(6),d=a(5),m=a(33);a=a(3);var n=d.default(),p=m.default(),t=a.default();a=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return k.__extends(b,a),b.prototype.onDirectClick=function(a,b){var d=this;void 0===b&&(b={});var e=p.getWindowHandleInformation(),g=h.default.UUID(),e=[{url:t.getSpinnerPath(),name:"provider",features:p.hidden(!1,e)}],e=new c.default(this.options,e);e.postOpen=function(){d.onResultPageOpen(a,
b,g)};e=new f.default(e);e.setWindowNamePrefix(g);e.start(!1)},b.prototype.onResultPageOpen=function(a,b,c){void 0===b&&(b={});void 0===c&&(c="");var d=t.forMultiProviderWindow(a,b);if(d){var f=h.default.UUID();n.updateHandleName(window,f,1);c+="provider";var e=n.open(t.getSpinnerPath(),c),g=this.options;if(!g.expectWindowReference)return void l.getLogger().warn("cmp2-workaround: ChangeWindowNameSequence not expecting window reference. Refactor",{workaround:g,windowName:c,items:a,extra:b});if(!e)return void(n.getIgnoreWindowErrors()||
l.getLogger().error("cmp2-workaround: ChangeWindowNameSequence unable to open window",{workaround:g,windowName:c,items:a,extra:b}));n.open("",f);this.createSequence(e,a,d,function(a,b){a=n.getWindowHandle(a);return!!a&&(a.location.href=b,!0)})}},b.prototype.createSequence=function(a,b,c,d){var f=this;if(1===b.length)return void d.apply(f,[a,c,-1,-1]);var e=new g.TimedQueue(this.options.delay);e.setOnError(function(){l.getLogger().error("cmp2-workaround: ChangeWindowNameSequence unable finish sequence",
{workaround:f.options,items:b,index:e.getIndex(),total:e.getTotal()})});for(var k=0,h=void 0;h=b[k];k++)e.add(d,f,[a,h.deepLink]);e.add(d,f,[a,t.getSpinnerPath()]);e.add(function(a){if(a=n.getWindowHandle(a)){try{var c=p.getWindowHandleInformation(window);n.moveAccordingFeatures(a,p.tiled(0,1,c))}catch(A){l.getLogger().error("cmp2-workaround: ChangeWindowNameSequence unable to change position",{workaround:f.options,items:b,index:e.getIndex(),total:e.getTotal()},A)}return!0}return!1},f,[a]);e.add(d,
f,[a,c,-1]);e.run()},b.prototype.onFormClick=function(a,b,d){a=p.getWindowHandleInformation();a=[{url:t.getSpinnerPath(),name:"provider",features:p.hidden(!1,a)}];var e=h.default.UUID();n.updateHandleName(window,e,1);a=new c.default(this.options,a);a.postOpen=function(a,b){n.open("",e);d(a,b)};(new f.default(a)).start(!0)},b}(e.default);b.ChangeWindowNameSequence=a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});e=function(){function a(a){void 0===a&&(a=3E3);this._index=
0;this._defaultDelay=a;this._queue=[]}return a.prototype.add=function(a,b,f,e){void 0===b&&(b=this);void 0===f&&(f=[]);void 0===e&&(e=this._defaultDelay);this._queue.push({fn:a,caller:b,delay:e,args:f})},a.prototype.run=function(a){void 0===a&&(a=0);this._index=a;this.next()},a.prototype.next=function(){var a=this,b=this._index++,f=this._queue[b],b=this._queue[this.getIndex()];if(f){var f=f.fn.apply(f.caller,f.args),e="boolean"!=typeof f||f;!1===f&&this.onError&&this.onError();b&&e&&setTimeout(function(){a.next()},
b.delay)}},a.prototype.setOnError=function(a){this.onError=a},a.prototype.reset=function(){this._index=0},a.prototype.getDefaultDelay=function(){return this._defaultDelay},a.prototype.getIndex=function(){return this._index},a.prototype.getTotal=function(){return this._queue.length},a.prototype.cleanUp=function(){this._index=0;this._queue=[]},a}();b.TimedQueue=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var k=a(0),g=a(31);e=a(2);var l=a(1),f=a(7),h=a(6),c=a(5),d=a(3).default(),
m=c.default();a=function(a){function b(b){var c=a.call(this,b)||this;return c.submitEvent=!1,c.opened={},g.addEvent(window,"unload",function(){c.closeAllOpened()}),c}return k.__extends(b,a),b.prototype.showRPCompareAll=function(){return!1},b.prototype.onItemChange=function(a,b,c){var d=this;c.checked?this._openAndFocus([c],function(a){(a=m.getWindowHandle(a[0]))&&(d.opened[c.code]=a);d.submitEvent=!1}):this.close(c.code,this.opened[c.code]?this.opened[c.code]:null)},b.prototype.onFormClick=function(a,
b,c){this._openAndFocus(b,c)},b.prototype._openAndFocus=function(a,b){var c=this,e=d.forSubmit(a,3),e=new h.default(this.options,e);e.postItemOpen=function(a,b,d){return c._windowFocus(d)};e.postOpen=function(d,e){c.submitEvent=!0;c.closeNotActive(a);b(d,e)};(new f.default(e)).start(!0)},b.prototype.closeAllOpened=function(){if(!this.submitEvent){var a=this.opened,b;for(b in a)a.hasOwnProperty(b)&&this.close(b,a[b])}},b.prototype.closeNotActive=function(a){for(var b=0,c;c=a[b];b++)!c.checked&&this.opened[c.code]&&
this.close(c.code,this.opened[c.code])},b.prototype.close=function(a,b){if(b){b=m.getWindowHandle(b);try{b?(b.close(),delete this.opened[a]):l.getLogger().warn("cmp2-workaround: unable to close handle handle is not exists",{workaround:this.options})}catch(u){l.getLogger().warn("cmp2-workaround: error in closing handle",{workaround:this.options})}}},b.prototype._windowFocus=function(a){var b=this;this.focusInterval&&clearInterval(this.focusInterval);var c=0,d=setInterval(function(){try{var e=m.getWindowHandle(a);
e&&(e.blur(),e.opener.focus());window.self.focus();window.focus();document.focus()}catch(q){l.getLogger().warn("cmp2-workaround: DocumentFocus - windowFocus",{workaround:b.options},q)}10<++c&&d&&clearInterval(d)},300);this.focusInterval=d},b}(e.default);b.DocumentFocus=a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var k=a(0);e=a(2);var g=a(1),l=a(7),f=a(6),h=a(3).default();a=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return k.__extends(b,
a),b.prototype.onFormClick=function(a,b,c){var d=this;a=h.forSubmit(b);a=new f.default(this.options,a);a.postItemOpen=function(a,b,c){c&&!c.closed&&((a=c.open(h.getSpinnerPath()))?a.close():g.getLogger().warn("cmp2-workaround: HandleOpen unable to focus",{workaround:d.options}))};a.postOpen=function(a,b){return c(a,b)};(new l.default(a)).start(!0)},b}(e.default);b.HandleOpen=a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var k=a(0);e=a(2);var g=a(1),l=a(7),f=a(6),
h=a(5);a=a(3);var c=h.default(),d=a.default();a=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return k.__extends(b,a),b.prototype.onFormClick=function(a,b,e){var h=this;a=d.forSubmit(b);a=new f.default(this.options,a);a.postOpen=function(a,b){var f=c.open(d.getSpinnerPath()),k=h.options;k.expectWindowReference?f?f.close():g.getLogger().warn("cmp2-workaround: RegularOpenCloseLast unable to focus",{workaround:k}):g.getLogger().warn("cmp2-workaround: RegularOpenCloseLast not expecting window reference. Refactor",
{workaround:k});e(a,b)};(new l.default(a)).start(!0)},b}(e.default);b.RegularOpenCloseLast=a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var k=a(0);e=a(2);var g=a(1),l=a(7),f=a(6),h=a(5);a=a(3);var c=h.default(),d=a.default();a=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return k.__extends(b,a),b.prototype.onDirectClick=function(a,b){void 0===b&&(b={});a=[{url:d.forMultiProviderWindow(a,b),name:"_blank",features:{}}];a=new f.default(this.options,
a);(new l.default(a)).start(!1)},b.prototype.onResultPageOpen=function(a,b,e){void 0===b&&(b={});void 0===e&&(e="");if(b=d.forMultiProviderWindow(a,b)){var f=c.open(b,e),h=this.options;!h.expectWindowReference||c.getIgnoreWindowErrors()||f||g.getLogger().info("cmp2-workaround: Swapper unable to open window",{workaround:h,items:a,url:b,windowNamePrefix:e})}},b.prototype.navigateToResults=function(a,b,e){return(e=c.getFirstActiveHandle(e))?(e.location.href=a,this.options.method||(window.location.href=
d.getSpinnerPath()),!0):(g.getLogger().error("cmp2-workaround: Swapper unable to navigate to RP",{workaround:this.options,items:b,url:a}),!1)},b.prototype.onFormClick=function(a,b,e){a=d.forBlank();c.updateHandleName(window,this.getWindowNamePrefix(),1);a=new f.default(this.options,a);a.postOpen=function(a,b){return e(a,b)};(new l.default(a)).start(!0)},b}(e.default);b.Swapper=a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var k=a(0);e=a(2);var g=a(1),l=a(7),f=a(11),
h=a(6),c=a(5);a=a(3);var d=c.default(),m=a.default();a=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return k.__extends(b,a),b.prototype.navigateToResults=function(a,b,c){b=d.getActiveWindowHandles(c);var e=d.getLastActiveHandle(b);return e?(b.length!==c.length&&g.getLogger().warn("cmp2-workaround: SwapperMultipleWindows some windows are closed",{workaround:this.options,activeWindowHandlesLength:b.length,windowHandlesLength:c.length}),d.updateHandleName(e,"k"+f.default.randomString(8),
2),e.location.href=a,this.options.method||(window.location.href=m.getSpinnerPath()),!0):(g.getLogger().error("cmp2-workaround: SwapperMultipleWindows unable to found active window",{workaround:this.options}),!1)},b.prototype.onFormClick=function(a,b,e){b=m.forSubmit(b,4);var k=b.shift();if(!k)return g.getLogger().error('cmp2-workaround: SwapperMultipleWindows "firstItem" is undefined',{workaround:this.options}),void e([],[]);a=this.getWindowNamePrefix();d.updateHandleName(window,c.getWindowName(a+
k.name),1);b.push({url:m.getSpinnerPath(),name:"k"+f.default.randomString(8),features:{}});b=new h.default(this.options,b);b.postOpen=function(a,b){e(a,b)};b=new l.default(b);b.setWindowNamePrefix(a);b.start(!0)},b}(e.default);b.SwapperMultipleWindows=a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var k=a(0);e=a(2);var g=a(1),l=a(7),f=a(6),h=a(5);a=a(3);var c=h.default(),d=a.default();a=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return k.__extends(b,
a),b.prototype.onDirectClick=function(a,b){void 0===b&&(b={});a=[{url:d.forMultiProviderWindow(a,b),name:"_blank",features:{}}];a=new f.default(this.options,a);(new l.default(a)).start(!1)},b.prototype.onResultPageOpen=function(a,b,e){void 0===b&&(b={});void 0===e&&(e="");if(b=d.forMultiProviderWindow(a,b)){var f=c.open(b,e),h=this.options;!h.expectWindowReference||c.getIgnoreWindowErrors()||f||g.getLogger().error("cmp2-workaround: SwapperNoSpinner unable to open window",{workaround:h,items:a,url:b,
windowNamePrefix:e})}},b.prototype.navigateToResults=function(a,b,c){return!0},b.prototype.onFormClick=function(a,b,e){a=d.forBlank(a);c.updateHandleName(window,this.getWindowNamePrefix(),1);a=new f.default(this.options,a);a.postOpen=function(a,b){return e(a,b)};(new l.default(a)).start(!0)},b}(e.default);b.SwapperNoSpinner=a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var k=a(0);e=a(2);var g=a(1),l=a(7),f=a(11),h=a(6),c=a(5);a=a(3);var d=c.default(),m=a.default();
a=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return k.__extends(b,a),b.prototype.navigateToResults=function(a,b,c){return!0},b.prototype.onFormClick=function(a,b,e){var k=this,n=m.forSubmit(b,4),p=n.shift();if(!p)return g.getLogger().error('cmp2-workaround: SwapperMultipleWindowsNoSpinner "firstItem" is undefined',{workaround:this.options}),void e([],[]);b=this.getWindowNamePrefix();d.updateHandleName(window,c.getWindowName(b+p.name),1);n.push({url:a,name:"k"+f.default.randomString(8),
features:{}});n=new h.default(this.options,n);n.postOpen=function(b,c){var h=d.getActiveWindowHandles(b),l=d.getLastActiveHandle(h);h.length!==b.length&&g.getLogger().warn("cmp2-workaround: SwapperMultipleWindowsNoSpinner some windows are closed",{workaround:k.options,activeWindowHandlesLength:h.length,windowHandlesLength:b.length});l&&(d.updateHandleName(l,"k"+f.default.randomString(8),2),l.location.href=a);e(b,c)};n=new l.default(n);n.setWindowNamePrefix(b);n.start(!0)},b}(e.default);b.SwapperMultipleWindowsNoSpinner=
a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var k=a(8),g=a(9),l=a(13),f=a(10),h=a(22),c=a(23),d=a(12);b.onItemMouseUp=function(a,b){return k.getWorkaround().onItemMouseUp(a,b)};b.onItemMouseDown=function(a,b){return k.getWorkaround().onItemMouseDown(a,b)};b.onItemChange=function(a,b,c){return 30===f.CompareToSettings.getInstance().getSettingsSync().apiVersion?h.ItemsList.getInstance().updateCheckedItemState(a,c):l.CompareToList.getInstance().updateCheckedItemState(a,
c),k.getWorkaround().onItemChange(a,b,c)};b.onFormClick=function(a,b,e,h){var m=function(){h&&h()};if(!a.placement)return m(),void k.getLogger().error("cmp2-ui: placement information is missing in onFormClick method",a);var n=a.type,p=f.CompareToSettings.getInstance();if(!p.isSettings())return 0<b.length&&k.getLogger().error("cmp2-ui: settings is missing in onFormClick method with items",a,b),void m();p=p.getSettingsSync();if(!c.isEnabled(n,p)||c.excludeRequest(p,a.placement))return void m();a.url=
e;var n=l.CompareToList.getInstance().getImpressionRequestState(b),t={windowNamePrefix:k.getWorkaround().getWindowNamePrefix(),referer:p.uiReferer?window.location.href:""},q=g.WindowInfo.getInstance().getStoreConfig(a,n,t,c.getApiVersion(a,p),void 0===p.removeName||p.removeName);if(!q)return void m();var w=a.urlPrefix?a.urlPrefix:"";if(l.CompareToList.getInstance().isCheckedItem(b))return void k.getWorkaround().onFormClick(w+e,b,function(a){d.Ajax.getInstance().request(q,function(c){if(!c||!c.success)return k.getLogger().error("cmp2-ui: AJAX error on Store WindowInfo",
c.errors),void m();k.getWorkaround().navigateToResults(w+e,b,a)||m()},function(a){k.getLogger().error("cmp2-ui: AJAX error on Store WindowInfo",a);m()},m)});d.Ajax.getInstance().request(q,function(a){a&&a.success||k.getLogger().error("cmp2-ui: AJAX error on Store WindowInfo",a.errors);m()},function(a){k.getLogger().error("cmp2-ui: AJAX error on Store WindowInfo",a);m()},m)};b.onFormButtonMouseDown=function(a){if(l.CompareToList.getInstance().isCheckedItem(a))return f.CompareToSettings.getInstance().isSettings()?
void k.getWorkaround().onFormButtonMouseDown(a):void k.getLogger().error("cmp2-ui: settings are not set to execute form mouse down")};b.onFormButtonMouseUp=function(a){if(l.CompareToList.getInstance().isCheckedItem(a))return f.CompareToSettings.getInstance().isSettings()?void k.getWorkaround().onFormButtonMouseUp(a):void k.getLogger().error("cmp2-ui: settings are not set to execute form mouse up")}}]);(function(d,f){d.createComponentClass("common.compareto.v3.CompareToModuleSettings",{options:{config:null,prefix:null},moduleLoaded:!1,ajaxCall:function(a,b,e){var c=f.extend(!0,{},a.params,a.data);"GET"!==a.method&&(c=JSON.stringify(c));f.ajax({url:a.url,method:a.method,dataType:"json",contentType:"application/json; charset\x3dutf-8",data:c,headers:a.headers,success:function(a){b&&b(a)},error:function(a){e&&e(a)}})},init:function(){var a=this,b=a.options,e=b.config,b=b.prefix,c=a.log;d.question.answer("cmp2.module.loaded",
function(){return a.moduleLoaded});e?a.setConfig(e):f.ajax({method:"GET",url:b+"compareTo/config",success:function(b){b&&b.content?a.setConfig(b.content):(c.error("cmp2-module: unexpected response in config",b),a.setConfig(null))},error:function(b){c.error("cmp2-module: error loading config",b);a.setConfig(null)}})},setConfig:function(a){var b=this;window["@r9/cmp2-ui"].setModuleConfig({ajax:function(a,c,d){b.ajaxCall(a,c,d)},logger:b.log,settings:a});b.moduleLoaded=!0;d.events.publish("cmp2.module.loaded",
!0)},addEventHandlers:function(){}})})(window.R9,window.jQuery||window.jq);(function(d,f){d.createComponentClass("common.compareto.v3.Items",{options:{navigateToResults:!1,placement:{},hiddenClass:"",visibleClass:"",hiddenControls:"",visibleControls:"",itemChecked:"",itemUnChecked:""},lastRequest:null,lastRequestData:null,lastResponse:null,itemsInProgress:!1,cleanupTimer:null,init:function(){this.cmp2ItemsElement=this.getChildElement("checkbox-row");this.cmp2ModuleLoaded=!0===d.question.ask("cmp2.module.loaded")},shouldUpdate:function(a){return-1<this.id().indexOf(a.id)},
addEventHandlers:function(){var a=this;this.subscribe("cmp2.module.loaded",function(c){a.cmp2ModuleLoaded=c;a.lastRequestData&&a.cmp2ModuleLoaded&&(d.events.publish("cmp2.getItems",a.lastRequestData),a.lastRequestData=null)});this.subscribe("cmp2.getItems",function(c){if(a.shouldUpdate(c))if(a.cmp2ModuleLoaded){a.cleanupTimer&&clearTimeout(a.cleanupTimer);var b=a.sanitizeFormData(c);a.lastRequest===f.param(b)?a.itemsInProgress||a.printResponse(a.lastResponse):(a.lastRequest=f.param(b),a.lastResponse=
[],a.itemsInProgress=!0,window["@r9/cmp2-ui"].getCompareTo(b,function(b){a.printResponse(b);a.lastResponse=b;a.itemsInProgress=!1},function(c){a.log.error("v3.Items: unable to load items",c,b);a.lastResponse=[];a.itemsInProgress=!1}))}else a.lastRequestData=c});this.subscribe("cmp2.cleanUp",function(b){a.shouldUpdate(b)&&(a.cleanupTimer=setTimeout(function(){a.printResponse([])},50))});this.subscribe("cmp2.submit",function(b){if(a.shouldUpdate(b)){var c=b.url&&b.url.startsWith("http")?b.url:"/"+b.url,
d=a.sanitizeFormData(b);a.onFormSubmit(b,d,a.items||[],c)}});var b=this.id(),b=b.substr(0,b.lastIndexOf("-"));f("#"+b+" button[type\x3dsubmit]").on("mousedown",function(){window["@r9/cmp2-ui"].onFormButtonMouseDown(a.items||[])});f("#"+b+" button[type\x3dsubmit]").on("mouseup",function(){window["@r9/cmp2-ui"].onFormButtonMouseUp(a.items||[])});this.getChildElement("allLink").on("click",function(b){b.preventDefault();a.toggleCheckedItems(!0)});this.getChildElement("noneLink").on("click",function(b){b.preventDefault();
a.toggleCheckedItems(!1)});this.subscribe("cmp2.uncheckAll",function(){a.toggleCheckedItems(!1)});this.subscribe("cmp2.checkAll",function(){a.toggleCheckedItems(!0)});this.subscribe("cmp2.update.component.options",function(b){if(b||b.navigateToResults)a.options.navigateToResults=b.navigateToResults})},onFormSubmit:function(a,b,c,e){var f=this.options.navigateToResults;window["@r9/cmp2-ui"].onFormClick(b,c||[],e||"",function(){f?e&&e.startsWith("http")?window.location.href=e:window.location.href="/"+
e.replace(/^[/]*/g,""):d.events.publish("searchform.submit",a)})},toggleCheckedItems:function(a){(!a||this.items&&window["@r9/cmp2-ui"].showRPCompareAll(this.items))&&this.cmp2ItemsElement.find(".item").each(function(){var b=f(this);"true"===b.attr("aria-checked")!==a&&b.trigger("click")})},renderItemTemplate:function(a){return d.template.renderElement(this.id("template"),{id:this.id(a.code),code:a.code,name:a.name,checked:a.checked})},printResponse:function(a){d.dom.swapClasses(this.element,this.options.visibleClass,
this.options.hiddenClass);d.events.publish("cmp2.hidden",{id:this.id(),visible:!1});this.cmp2ItemsElement.empty();for(var b=0,c;c=a[b];b++)if(c.visible){var e=this.renderItemTemplate(c);this.cmp2ItemsElement.append(e);this.updateElementState(e,c)}a&&0<a.length&&(this.updateControlsState(a),d.events.publish("cmp2.shown",{id:this.id(),visible:!0}),d.dom.swapClasses(this.element,this.options.hiddenClass,this.options.visibleClass));this.items=a;d.events.publish("cmp2.rendering.finished",{id:this.id(),
items:a})},updateControlsState:function(a){d.dom.swapClassesToggle(this.getChildElement("controls"),this.options.visibleControls,this.options.hiddenControls,window["@r9/cmp2-ui"].showRPCompareAll(a))},updateElementState:function(a,b){var c=this,e=c.options,g=f(a);g.on("click",function(){var a=f.extend(!0,{},b);b.checked=!b.checked;d.dom.swapClassesToggle(g,e.itemChecked,e.itemUnChecked,b.checked);g.attr("aria-checked",b.checked);window["@r9/cmp2-ui"].onItemChange(c.items,a,b)});g.on("mousedown",function(){window["@r9/cmp2-ui"].onItemMouseDown(c.items,
b)}).on("mouseup",function(){window["@r9/cmp2-ui"].onItemMouseUp(c.items,b)})},sanitizeFormData:function(a){var b;switch(a.vertical){case "flights":b="F";break;case "hotels":b="H";break;case "cars":b="C";break;case "packages":b="P";break;case "cruises":b="R";break;case "trains":b="T";break;default:b=a.vertical}return{type:b,placement:this.options.placement,url:a.url,requestInformation:null}}})})(window.R9,window.jQuery||window.jq);(function(l){var m={},n=function(a,c){var b=JSON.stringify(a,Object.keys(a).sort());if(m.hasOwnProperty(b))m[b].callbacks.push(c);else{var d={key:b,callbacks:[c],request:l.ajax({type:"GET",dataType:"json",url:"/s/run/recentsearchhistory/gethistory",data:a,success:function(a){for(;d.callbacks.length;)d.callbacks.pop()(a)},complete:function(){delete m[b]}})};m[b]=d}};R9.extend("Common",{SmartyHistory:function(a){var c=a.historyType;c||(c="flight");var b=R9.Common.SmartyHistory.prototype["_"+c+"Instance"];
if(b)return b.init(),R9.Common.SmartyHistory.prototype["_"+c+"Instance"];this.options=l.extend({},this.options,a);this.init();R9.Common.SmartyHistory.prototype["_"+c+"Instance"]=this}});R9.extend("Common.SmartyHistory",{SmartyFlightHistory:function(a){return R9.Common.SmartyHistory.call(this,l.extend({historyType:"flight"},a))},SmartyHotelHistory:function(a){return R9.Common.SmartyHistory.call(this,l.extend({historyType:"hotel"},a))},SmartyCarHistory:function(a){return R9.Common.SmartyHistory.call(this,
l.extend({historyType:"car"},a))},SmartyClearHistory:function(){this.currentSmartyHistory&&(this.currentSmartyHistory.clearHistory(),this.currentSmarty.hideDropdown(),this.currentSmarty.runSearch(!1));R9.Analytics.api.trackEvent("smartyHistory/click/clearHistory")}});R9.extend("Common.SmartyHistory.prototype",{history:null,received:!1,options:{historyType:"flight",maxSearchHistory:30,searchHistorySubtype:"",showPastDates:R9.config.getBoolean("ui.smarty-history.showPastDates",!1)},init:function(){this.received&&
null!==this.history||setTimeout(this.update.bind(this),1)},update:function(){var a=this;n({searchType:a.options.historyType,maxSearchHistoryNum:a.options.maxSearchHistory,searchHistorySubtype:a.options.searchHistorySubtype},function(c){if(c)for(a.history=c,a.processPastDates(),a.received=!0,c=0;c<a.history.length;c++)a.history[c].idx=c})},clearHistory:function(){this.history=[];var a=this;l.ajax({type:"POST",url:"/s/run/recentsearchhistory/clearhistory",data:{searchType:a.options.historyType},success:function(c){a.history=
[];R9.Analytics.api.trackEvent({category:"Smarty-History",action:"clear-history"})}})},matchWord:function(a,c){var b=a.indexOf(c);0!==b&&(b=a.indexOf(" "+c),-1<b&&(b+=1));return b},processPastDates:function(){var a=[];if(null!==this.history){for(var c=0;c<this.history.length;c++){var b=this.history[c],d=b.startDate||b.checkinDate,e=b.endDate||b.checkoutDate;if(d&&e){var d=new moment(d),e=new moment(e),g=new moment;d.isBefore(g,"day")||e.isBefore(g,"day")?this.options.showPastDates&&(b.isPast=!0,a.push(b)):
a.push(b)}}this.history=a}}});R9.extend("Common.SmartyHistory.SmartyFlightHistory.prototype",!0,R9.Common.SmartyHistory.prototype,{filter:function(a,c,b,d,e){b=b||Infinity;var g=[];if(null===this.history)return[];var h=[];if(c||""===e)h=this.history;else for(var f=0;f<this.history.length;f++){var k=this.history[f];k.departCode===e&&h.push(k)}h=this.filterByRoundTrip(h,d);if(""===a)return h.slice(0,b);for(e=0;e<h.length&&!(f=h[e],k=f.departShortName+" "+f.departAirportName.toUpperCase(),c||(k=f.destShortName+
" "+f.destAirportName.toUpperCase()),-1<this.matchWord(k.toUpperCase(),a.toUpperCase())&&(g.push(f),g.length>=b));e++);return this.filterByRoundTrip(g,d).slice(0,b)},filterByRoundTrip:function(a,c){if(null===a)return[];if(R9.config.getBoolean("ui.flight.smarty-history.separateRTOW",!1)){for(var b=[],d=0;d<a.length;d++){var e=a[d];e.isRoundTrip===c&&b.push(e)}return b}return a}});R9.extend("Common.SmartyHistory.SmartyHotelHistory.prototype",!0,R9.Common.SmartyHistory.prototype,{filter:function(a,c){c=
c||Infinity;var b=[];if(null===this.history)return[];if(""===a)return this.history.slice(0,c);for(var d=0;d<this.history.length;d++){var e=this.history[d],g=e.location.toUpperCase();if(-1<this.matchWord(g,a)&&(b.push(e),b.length>=c))break}return b.slice(0,c)}});R9.extend("Common.SmartyHistory.SmartyCarHistory.prototype",!0,R9.Common.SmartyHistory.prototype,{filter:function(a,c,b,d){b=b||Infinity;var e=[];if(null===this.history)return[];var g=this.filterByOneWay(this.history,d);if(""===a)return g.slice(0,
b);for(var h=0;h<g.length;h++){var f=g[h],k=null===f.airportCode?f.location.toUpperCase():f.location.toUpperCase()+" "+f.airportCode;!c&&f.location2&&(k=null===f.airportCode2?f.location2.toUpperCase():f.location2.toUpperCase()+" "+f.airportCode2);if(-1<this.matchWord(k,a)&&(e.push(f),e.length>=b))break}return this.filterByOneWay(e,d).slice(0,b)},filterByOneWay:function(a,c){if(null===a)return[];for(var b=[],d=0;d<a.length;d++){var e=a[d];e.oneWay===c&&b.push(e)}return b}})})(jq||jQuery);(function(b){R9.extend("Common",{SmartyControlGroup:function(a){this.options=b.extend({},this.options,a);null===this.options.startFormat&&(this.options.startFormat=R9.Widgets.DaterangePicker.prototype.options.startFormat);null===this.options.endFormat&&(this.options.endFormat=R9.Widgets.DaterangePicker.prototype.options.endFormat);this.init()}});R9.extend("Common.SmartyControlGroup.prototype",{options:{form:"",smartyHistory:null,smartyTopDestinations:null,daterangePicker:"",startDate:"",endDate:"",
datePicker:"",startFormat:null,endFormat:null,useLegacyDatePicker:null},type:"flight",getHistory:function(){return this.options.smartyHistory&&this.options.smartyHistory()},getTopDestinations:function(){return this.options.smartyTopDestinations&&this.options.smartyTopDestinations()},getTime:function(a){return null==a?null:a.getTime()},validateDate:function(a){return null==a?null:this.datepicker().utils?this.datepicker().utils.validate(new Date(a)):this.options.datePicker&&this.options.datePicker.validateDate(a)?
new Date(a):null},datepicker:function(){return b(this.options.daterangePicker).data("datepicker")}});R9.extend("Common.SmartyControlGroup",{SmartyFlightControlGroup:function(a){R9.Common.SmartyControlGroup.call(this,a)},SmartyHotelControlGroup:function(a){R9.Common.SmartyControlGroup.call(this,a)},SmartyCarControlGroup:function(a){R9.Common.SmartyControlGroup.call(this,a)}});R9.extend("Common.SmartyControlGroup.SmartyFlightControlGroup.prototype",!0,R9.Common.SmartyControlGroup.prototype,{options:b.extend(R9.Common.SmartyControlGroup.prototype.options,
{form:null,formObject:null,originInput:"",destInput:"",originCode:"",destCode:"",daterangePicker:"",cabin:null,travelers:"",nearbyDeparture:"",nearbyArrival:"",smartyObject:"",maxHistory:5,state:null,isRoundTrip:null}),init:function(){this.type="flight"},setFieldsFromHistoryItem:function(a,c){a.isRoundTrip?(R9.events.publish("flights.search.form.display.change",{value:"roundtrip"}),R9.events.publish("flights.search.form.display.set","roundtrip")):(R9.events.publish("flights.search.form.display.change",
{value:"oneway"}),R9.events.publish("flights.search.form.display.set","oneway"));c&&!R9.config.getBoolean("ui.smarty.previewUpdatesForm.enabled",!1)||null==this.options.formObject||this.options.formObject.updateTravelDateState(this.validateDate(a.startDate),this.validateDate(a.endDate));this.options.useLegacyDatePicker?(this.datepicker().setStartDate(this.validateDate(a.startDate)),this.datepicker().setEndDate(this.validateDate(a.endDate))):(this.startDate().setDate(a.startDate),this.endDate().setDate(a.endDate));
b(this.options.nearbyDeparture).prop("checked",a.departureAllowNearby);b(this.options.nearbyArrival).prop("checked",a.arrivalAllowNearby);this.setTravelersFromHistoryItem(a);c?(b(this.options.originInput).val(a.departAirportName),b(this.options.destInput).val(a.destAirportName),b(this.options.originCode).val(a.departCode),b(this.options.destCode).val(a.destCode)):(c={type:"ap",id:a.departCode,short_str:a.departAirportName},this.options.originInput.getWidget().setItem(c),a={type:"ap",id:a.destCode,
short_str:a.destAirportName},this.options.destInput.getWidget().setItem(a))},saveFieldsToHistoryItem:function(){var a={};a.departAirportName=b(this.options.originInput).val();a.destAirportName=b(this.options.destInput).val();a.departCode=b(this.options.originCode).val();a.destCode=b(this.options.destCode).val();this.options.useLegacyDatePicker?(a.startDate=this.getTime(this.datepicker().getStartDate()),a.endDate=this.getTime(this.datepicker().getEndDate())):(a.startDate=this.startDate().getValue(),
a.endDate=this.endDate().getValue());a.departureAllowNearby=b(this.options.nearbyDeparture).prop("checked");a.arrivalAllowNearby=b(this.options.nearbyArrival).prop("checked");this.options.travelers&&b(".Common-Widgets-Number-NumberBox, .Common-Widgets-Number-StyleJamNumberBox",this.options.travelers.elementNode).each(function(){var c=b(this).getWidget(),e=b(this).attr("id").split("-").pop().toLowerCase();a[e]=c.getValue()});this.options.cabin&&(a.cabin=this.options.cabin.getValue());a.isRoundTrip=
"function"===typeof this.options.isRoundTrip?this.options.isRoundTrip():this.options.isRoundTrip;return a},isRoundTrip:function(){return"function"===typeof this.options.isRoundTrip?this.options.isRoundTrip():"checked"===b("#roundtrip").attr("checked")?!0:0<b(".inlineSearchAgainView").length&&"y"!==b('[name\x3d"oneway"]',".inlineSearchAgainView").val()?!0:!1},setTravelersFromHistoryItem:function(a){if(this.options.cabin){this.options.cabin.setButtonCheckedByValue(a.cabin);var c=this.options.cabin.getCheckedPair();
this.options.state.cabinDisplayType=c.title;this.options.state.cabin=c.value}this.options.travelers&&b(".Common-Widgets-Number-NumberBox, .Common-Widgets-Number-StyleJamNumberBox",this.options.travelers.elementNode).each(function(){var c=b(this).getWidget(),d=b(this).attr("id").split("-").pop().toLowerCase(),d=a[d];void 0!=c&&c.setValue(d)})},datepicker:function(){return this.options.daterangePicker},startDate:function(){return this.options.startDate},endDate:function(){return this.options.endDate},
setSmarty:function(a){this.options.smartyObject=a},getMaxHistory:function(){return this.options.maxHistory},statusMessage:{adults:"{0} adult",seniors:"{0} senior",children:"{0} child",traveler_count:"1#1 traveler|2#{0} travelers"}});R9.extend("Common.SmartyControlGroup.SmartyHotelControlGroup.prototype",!0,R9.Common.SmartyControlGroup.prototype,{options:b.extend(R9.Common.SmartyControlGroup.prototype.options,{form:null,locationInput:"",ctid:"",lmid:"",hid:"",nhid:"",rooms:"",adults:"",children:"",
guests:"",minStars:"",priceRange:"",rating:"",smartyObject:"",maxHistory:5,isPTCEnabled:!1}),init:function(){this.type="hotel"},setSmarty:function(a){this.options.smartyObject=a},validateDate:function(a){return null==a?null:this.options.daterangePicker.utils?this.options.daterangePicker.utils.validate(new Date(a)):this.options.datePicker?this.options.datePicker.validateDate(a):null},getMaxHistory:function(){return this.options.maxHistory},setFieldsFromHistoryItem:function(a,c){this.options.useLegacyDatePicker?
(this.options.daterangePicker.setStartDate(this.validateDate(a.checkinDate)),this.options.daterangePicker.setEndDate(this.validateDate(a.checkoutDate))):(this.options.startDate.setDate(a.checkinDate),this.options.endDate.setDate(a.checkoutDate));this.options.rooms&&this.options.rooms.setValue(a.rooms);this.options.isPTCEnabled?(this.options.adults.setValue(a.adults),this.options.children.setValue(a.children)):this.options.guests.setValue(a.guests);b(this.options.minStars).val(a.minStars);b(this.options.rating).val(Math.floor(a.rating/
10));c?(b(this.options.locationInput).val(a.location),b(this.options.ctid).val(a.ctid),b(this.options.lmid).val(a.lmid),b(this.options.hid).val(a.hid),b(this.options.nhid).val(a.nhid),b(this.options.frid).val(a.frid),b(this.options.rid).val(a.rid),b(this.options.cid).val(a.cid)):(a={id:a.ctid,str:a.location,lmid:a.lmid,hid:a.hid,nhid:a.nhid,frid:a.frid,rid:a.rid,cid:a.cid},this.options.locationInput.getWidget().setItem(a))},saveFieldsToHistoryItem:function(){var a={};a.location=b(this.options.locationInput).val();
a.ctid=b(this.options.ctid).val();a.lmid=b(this.options.lmid).val();a.hid=b(this.options.hid).val();a.nhid=b(this.options.nhid).val();a.frid=b(this.options.frid).val();a.rid=b(this.options.rid).val();a.cid=b(this.options.cid).val();this.options.useLegacyDatePicker?(a.checkinDate=this.getTime(this.options.daterangePicker.getStartDate()),a.checkoutDate=this.getTime(this.options.daterangePicker.getEndDate())):(a.checkinDate=this.options.startDate.getValue(),a.checkoutDate=this.options.endDate.getValue());
this.options.rooms&&(a.rooms=this.options.rooms.getValue());this.options.isPTCEnabled?(a.adults=this.options.adults.getValue(),a.children=this.options.children.getValue()):a.guests=this.options.guests.getValue();a.minStars=b(this.options.minStars).val();a.rating=Math.floor(10*b(this.options.rating).val());return a}});R9.extend("Common.SmartyControlGroup.SmartyCarControlGroup.prototype",!0,R9.Common.SmartyControlGroup.prototype,{options:{form:null,location:"",location2:"",ctid1:"",ctid2:"",datePicker:"",
pickupDate:"",dropoffDate:"",locationSmarty:null,location2Smarty:null},init:function(){this.type="car"},setLocationSmarty:function(a){this.options.locationSmarty=a},setLocation2Smarty:function(a){this.options.location2Smarty=a},getMaxHistory:function(){return this.options.maxHistory},datepicker:function(){return this.options.datePicker},validateDate:function(a){return null==a?null:this.options.datePicker?this.options.datePicker.validateDate(a):null},isOneWay:function(){return"function"===typeof this.options.isOneWay?
this.options.isOneWay():"true"==b(".formType.active").attr("data-oneway")?!0:0<b(".inlineSearchAgainView").length&&"y"===b('[name\x3d"oneway"]',".inlineSearchAgainView").val()?!0:!1},setFieldsFromHistoryItem:function(a,c){this.options.pickupDate.setDate(a.startDate);this.options.dropoffDate.setDate(a.endDate);this.options.pickupDate.setTime(a.pickupHour);this.options.dropoffDate.setTime(a.dropoffHour);c?(a.airportName?b(this.options.location).val(a.airportDisplayName):b(this.options.location).val(a.location),
a.airportName2?b(this.options.location2).val(a.airportDisplayName2):b(this.options.location2).val(a.location2),b(this.options.ctid1).val(a.cityCode),b(this.options.ctid2).val(a.cityCode2)):(this.options.locationSmarty.setItem({id:a.cityCode,str:a.airportDisplayName||a.location}),a={id:a.cityCode2,str:a.airportDisplayName2||a.location2},null!=this.options.location2Smarty&&null!=a&&null!=a.str&&this.options.location2Smarty.setItem(a))},saveFieldsToHistoryItem:function(){var a={};a.location=b(this.options.location).val();
a.location2=b(this.options.location2).val();a.cityCode=b(this.options.ctid1).val();a.cityCode2=b(this.options.ctid2).val();a.startDate=this.options.pickupDate.getValue();a.endDate=this.options.dropoffDate.getValue();a.pickupHour=this.options.pickupDate.getTime();a.dropoffHour=this.options.dropoffDate.getTime();return a}})})(jq||jQuery);(function(a,d){a.createWidgetClass("smarty.AirportSmarty","common.widgets.smarty.FlareSmarty",{constructor:function(e,b){var c={dropdownClass:" smartbox smartbox-air smartbox-v2 R9-Overlay ",extendRequest:{v:"v2"},flareSmartyType:13,forceSelection:!0,minWidth:250,searchOnFocus:!0};this.concatExtraDropdownClasses([c,b],this.extraIconClasses(a.config.getBoolean("ui.smarty.flights.greyIcons",!1)));this.base(e,d.extend(c,b))}})})(window.R9,window.jq||window.jQuery);(function(a,d){a.createWidgetClass("smarty.TrainSmarty","common.widgets.smarty.FlareSmarty",{constructor:function(e,b){var c={forceSelection:!0,dropdownClass:" smartbox smartbox-air R9-Overlay smartbox-v2 ",minWidth:250,searchOnFocus:!0,extendRequest:{v:"v2"}};this.concatExtraDropdownClasses([c,b],this.extraIconClasses(a.config.getBoolean("ui.smarty.trains.greyIcons",!0)));this.base(e,d.extend(c,b))}})})(window.R9,window.jq||window.jQuery);(function(e,d){function h(a,b){if(a)for(var c=0,e=a.childElementCount;c<e;c++)if(a.children){var g=b?a.children[e-c-1]:a.children[c],f=g;if((f&&null!==f.getAttribute("tabindex")&&""!==f.getAttribute("tabindex")&&"-1"!==f.getAttribute("tabindex")||-1<k.indexOf(f.tagName)||"INPUT"===f.tagName&&"hidden"!==f.getAttribute("type"))&&d(f).is(":visible")||(g=h(g,b)))return g}}var k=["SELECT","A","BUTTON","TEXTAREA"];e.createWidgetClass("dialog.Dialog",{content:null,contentBody:null,closeButton:null,modalBackground:null,
focusBoundaries:null,initialFocus:null,lastFocus:null,options:{fullHeight:!1,customWidth:!1,modal:!0,blur:!1,onClose:null,onOpen:null,afterClose:null,afterOpen:null,initialFocusId:null,preventInitialFocus:!1,closeOnModalClick:!0,hasKeyboardControl:!0,openImmediately:!1,preventClose:!1,returnFocus:!0,scrollToTopOnMobile:!0,forceOpen:!1,renderInline:!1,isMobile:!1,isOpenTopZindex:!1,iframeResize:!0,iframeTopGapPercent:.08,preventClosingClickBubble:!1},topLevelComponent:null,returnElement:null,init:function(){this.resizeEventName=
"resize."+this.id();this.content=this.getChildElement("content");this.contentBody=this.getChildElement("body");this.closeButton=this.getChildElement("close");this.modalBackground=this.getChildElement("modal");this.viewport=this.getChildElement("viewport");this.modal=this.getChildElement("modal")},addEventHandlers:function(){var a=this,b=this.closeOnModalClick.bind(this);this.options.preventClose||(this.options.hasKeyboardControl&&(this.registerEvent("keydown",d(document),function(b){a.options.preventClose||
b.which!==e.globals.keyCodes.ESC||a.close(!0)}),this.registerEvent("keypress",this.closeButton,function(b){if(!a.options.preventClose)switch(b.which){case e.globals.keyCodes.RETURN:a.close(!0)}})),this.registerEvent("click",this.closeButton,function(){a.options.preventClose||a.close(!0)}));this.options.closeOnModalClick&&this.registerEvent("click",this.viewport,b);this.registerEvent("click",this.content,function(){a.viewport.off("click",b);setTimeout(function(){if(a.options.closeOnModalClick)a.viewport.on("click",
b)},50)});this.subscribe("dialogs.close",function(){a.isOpen()&&a.close()});this.options.preventClosingClickBubble&&this.registerEvent("click",this.element,function(a){a.stopPropagation()})},inlineComponentsReady:function(){var a=this;this.options.modal||this.modalBackground.hide();this.topLevelComponent=this.contentBody.children("div").eq("0");this.options.renderInline&&d("body").append(this.element);this.options.openImmediately?(this.element.addClass("animate"),e.dom.schedule(this.open.bind(this))):
setTimeout(function(){a.element.addClass("animate")},100);this.getChildElement("focusStartBoundary").focus(this.resetFocus.bind(this,!1));this.getChildElement("focusEndBoundary").focus(this.resetFocus.bind(this,!0))},closeOnModalClick:function(a){a=d(a.target).closest(".content");this.content[0]===a[0]||this.options.preventClose||this.close(!0)},calculateDimensions:function(){if(this.topLevelComponent&&this.topLevelComponent.length){var a=this.topLevelComponent[0].getBoundingClientRect(),b=this.content[0].getBoundingClientRect(),
c="number"===typeof this.topLevelComponent.outerWidth()?Math.ceil(a.width):null,a="number"===typeof this.topLevelComponent.outerHeight()?Math.ceil(a.height):null;this.options.customWidth||c===Math.ceil(b.width)||this.content.width(c);this.options.fullHeight||a===Math.ceil(b.height)||this.content.height(a)}},resetFocus:function(a){(a=a?this.closeButton:this.lastFocus?this.lastFocus:this.findFirstFocusableElement(!0))&&"function"===typeof a.focus&&a.focus();return!1},handleKeyPress:function(a){switch(a.which){case e.globals.keyCodes.ESC:this.close(!0)}},
setContentDimensions:function(a,b,c){void 0!==a&&this.content.width(a);void 0!==b&&this.content.height(b);c&&this.content.css({maxWidth:c})},setViewPortOverflow:function(a,b){this.viewport&&this.viewport.length&&(a&&this.viewport.css({overflowX:a}),b&&this.viewport.css({overflowX:b}))},setContent:function(a){this.contentBody.html(a);this.topLevelComponent=this.contentBody.children("div").eq("0")},close:function(a){if(this.isOpen()&&!this.options.forceOpen){var b,c=d("body");this.isTouchDevice()&&
(b=c.css("top").replace("-","").replace("px",""),c.css({overflow:"",position:"",width:""}));this.options.iframeResize&&window.parentIFrame&&"function"===typeof window.parentIFrame.getPageInfo&&window.parentIFrame.getPageInfo(!1);c.scrollTop(b);this.element.removeClass("visible");this.element.attr("aria-hidden",!0);if("function"===typeof this.options.onClose)this.options.onClose(this.element,a);e.events.publish("dialog.close",{id:this.id()});this.options.blur&&e.events.publish("pageContainer.contentBlur",
!1);c.removeClass("hideOverflow modal-open");this.returnElement&&this.returnElement.length&&(this.returnElement.focus(),this.returnElement=null);d(window).off(this.resizeEventName);"function"===typeof this.options.afterClose&&this.options.afterClose()}},open:function(a){if(!this.isOpen()){this.topLevelComponent&&0!==this.topLevelComponent.length||(this.topLevelComponent=this.contentBody.children("div").eq("0"));this.options.preventClose&&this.closeButton.hide();this.options.returnFocus&&(this.returnElement=
d(document.activeElement));if(this.options.isOpenTopZindex){var b=0;this.element.siblings("[role\x3ddialog]").each(function(){var a=parseInt(d(this).css("z-index"));a&&a>b&&(b=a)});0<b&&this.element.css("z-index",b+1)}e.events.publish(["common.dropdown.closeAll","common.widgets.tooltip.closeAll"]);this.element.addClass("visible");this.element.attr("aria-hidden",!1);null===this.initialFocus&&this.setFocusTargets();this.options.preventInitialFocus||this.focusInitialElement();this.options.iframeResize&&
window.parentIFrame&&"function"===typeof window.parentIFrame.getPageInfo&&window.parentIFrame.getPageInfo(this.positionOnIframe.bind(this));if("function"===typeof this.options.onOpen)this.options.onOpen(this.element);"function"===typeof a&&a(this.element);this.modalBackground.length&&d("body").addClass("hideOverflow modal-open");this.options.blur&&e.events.publish("pageContainer.contentBlur",!0);null!==this.topLevelComponent&&setTimeout(this.calculateDimensions.bind(this),1);this.isTouchDevice()&&
this.options.scrollToTopOnMobile&&d("body").css({overflow:"hidden",position:"fixed",width:"100%"});d(window).off(this.resizeEventName).on(this.resizeEventName,this.calculateDimensions.bind(this));"function"===typeof this.options.afterOpen&&this.options.afterOpen()}},positionOnIframe:function(a){if(a&&this.viewport){var b=a.clientHeight*this.options.iframeTopGapPercent,c=a.scrollTop;a=a.offsetTop;this.content.addClass("no-margin");c<a?this.viewport.css("top",0):c-a<b?this.viewport.css("top",2*(c-a)+
"px"):c-a+b+this.content.height()>=this.modal.height()?this.viewport.css("top",this.modal.height()-this.content.height()+"px"):this.viewport.css("top",c-a+Math.round(b)+"px")}},focusInitialElement:function(){var a=this;setTimeout(function(){var b=a.initialFocus&&a.initialFocus.get(0);b&&"function"===typeof b.focus&&b.focus()},501)},setFocusTargets:function(){this.focusBoundaries=this.getChildElement("focusStartBoundary").add(this.getChildElement("focusEndBoundary"));this.initialFocus=this.findFirstFocusableElement(!1);
this.lastFocus=this.findFirstFocusableElement(!0)},findFirstFocusableElement:function(a){if(this.options.initialFocusId&&!a)return d("#"+this.options.initialFocusId);a=h(this.contentBody[0],a);a||(a=this.closeButton);return d(a)},isOpen:function(){return this.element.hasClass("visible")},isTouchDevice:function(){return"ontouchstart"in window||navigator&&navigator.maxTouchPoints},destroy:function(){this.base();this.element.remove()}})})(R9,jQuery);(function(c,f){function g(a){return null===a||"undefined"===typeof a}function k(a){return g(a)||"string"===typeof a&&""===a.trim()}var q=c.config.getBoolean("ui.horizon.flights.airportPicker.autoFocusOrigin",!1);c.createComponentClass("common.airportpicker.StyleJamAirportPicker",{states:null,cacodeInputField:null,sbhintInputField:null,nearbyAirportsTable:null,customAirportMapDiv:null,radiusDropdown:null,submitButtonInput:null,dialog:null,locationSmarty:null,currentCallback:null,firstCall:null,events:{open:"flights.airportpicker.open",
submit:"flights.airportpicker.submit"},init:function(){this.base.apply(this,arguments);this.options.events&&(this.events=f.extend(!0,{},this.events,this.options.events));this._setupLocale();this.prefetchDomElements();this.bindSmarty();this.bindRadius();this.bindDialog();this.$loader=this.dialog.element.find(".js-loader");this.$noResults=this.dialog.element.find(".js-no-results");this.$tableWrapper=this.dialog.element.find(".js-table-wrapper");this.$tableDistanceCol=this.dialog.element.find(".js-distance-column");
this.$map=this.dialog.element.find(".js-map")},_setupLocale:function(){g(c.globals.locale)&&(c.globals.locale={lc_cc:"US",lc:"en"})},loadCustomAirports:function(){var a=this,b=function(a){var b=a.firstCall&&a.options.defaultRadiusOverride?a.options.defaultRadiusOverride:a.radiusDropdown.getSelectedElement().value,b={cacode:a.cacodeInputField.val(),calocation:a.locationInputVal(),sbhint:a.sbhintInputField.val(),radius:b,maxAirports:a.options.maxAirportsSearch,sort:a.options.airportSort};k(b.calocation)&&
(b.calocation="",b.cacode="");"train"===a.options.searchType&&(b.trainsOnly="true");return b}(this);this.firstCall&&(this.firstCall=!1);2===arguments.length&&(b.startcode=arguments[0],b.startlocation=arguments[1]);this.showLoading();jq.ajax({type:"GET",url:this.options.ajaxUrl,data:b,dataType:"json",cache:!1,success:function(b){a.updateDom(b);a.hideLoading()},error:function(a,b,c){alert(b)},done:function(){a.hideLoading()}})},addEventHandlers:function(a){this.base.apply(this,arguments);var b=this;
this.getChildElement("form").submit(function(a){a.preventDefault();return b.eventTriggers().submit()});this.subscribe(this.events.open,f.proxy(this.eventListeners().open,this))},eventListeners:function(){var a=this;return{open:function(b){g(b)||b.id!==a.id()||a.dialog.isOpen()||(a.firstCall=!0,a.updateDom(),a.sbhintInputField.val(b.hint),a.loadCustomAirports(b.code,b.location),a.currentCallback=b.callback,a.dialog.open())}}},eventTriggers:function(){function a(){var a=b.getCheckedAirports().map(function(){return f(this).val()}).get().join(", "),
d=b.sbhintInputField.val(),c=b.cacodeInputField.val();b.radiusDropdown.getValue();k(d)||(c=d);d=3<a.length?"C-"+c+"-"+b.radiusDropdown.getValue():a;return{id:b.id(),code:d,location:a}}var b=this;return{submit:function(){try{var l=b.getAirportCheckCount();if(0>=l)throw b.options.msg.noAirportSelected;if(l>b.options.maxAirportsSelect)throw b.options.msg.tooManyAirportsSelected;var d=a();c.events.publish(b.events.submit,d);"function"===typeof b.currentCallback&&b.currentCallback(d);b.dialog.close()}catch(m){alert(m)}}}},
bindDialog:function(){var a=this,b=c.Common.Utils.throttle(200,function(){var b=900;window.innerWidth<b&&(b=window.innerWidth-40);a.findChildElement(".dialogContentContainer").width(b);a.dialog.calculateDimensions()});this.dialog=this.getChildElement("dialog").dialog({onOpen:function(){f(window).bind("resize",b)},onClose:function(){f(window).unbind("resize",b)},preventInitialFocus:a.options.onlyView||!q,initialFocus:a.id("calocation")}).getWidget()},bindSmarty:function(){var a=this,b={dataSource:a.options.smartyUrl,
flareSmartyType:a.options.flareSmartyType,v:"v2",extraDropdownClasses:a.options.smartyDropdownClass,clearItem:function(){},setItem:function(b,d,c){setTimeout(function(){b.elementNode.value=d.str;a.cacodeInputField.val(d.id);var c=!1,h="",e="";switch(d.type){case "ap":case "apnc":case "city":case "rail":c=d.id.split("/");1<c.length&&(d.id=c[1],e=d.id);c=!0;break;case "freereg":h="F:%s".format(d.frid);break;case "reg":h="R:%s".format(d.rid);break;case "ctry":h="Y:%s".format(d.cid)}a.cacodeInputField.val(e);
a.sbhintInputField.val(h);a.updateRadiusVisibility(c);a.loadCustomAirports()},1)}};this.locationSmarty="train"===this.options.searchType?this.getChildElement("calocation").trainSmarty(b).getWidget():this.getChildElement("calocation").flightSmarty(b).getWidget()},bindRadius:function(){var a=this;this.radiusDropdown=this.getChildElement("radius").styleJamDropdown({change:function(){a.loadCustomAirports()}}).getWidget()},prefetchDomElements:function(){this.cacodeInputField=this.getChildElement("cacode");
this.sbhintInputField=this.getChildElement("sbhint");this.nearbyAirportsTable=this.getChildElement("nearbyAirportsTable");this.customAirportMapDiv=this.getChildElement("customAirportMapDiv");this.submitButtonInput=this.getChildElement("submit")},updateDom:function(a){var b="",c="",d="",f=!1,n=[],h,e;g(a)||(b=a.calocation,c=a.cacode,d=a.sbhint,e=a.radius,g(a.nearbyAirports)||(f=a.nearbyAirports.hasDistance,n=a.nearbyAirports.nearbyAirportsList),g(a.customAirportMap)||(h=a.customAirportMap));this.updateRadius(e);
this.updateSmartyInputs(b,c,d);this.updateTable(f,n);this.updateMap(h)},updateRadius:function(a){k(a)&&(a=this.radiusDropdown.element.find("option[selected]").val());this.radiusDropdown.setValue(a)},updateRadiusVisibility:function(a){if(1>arguments.length){var b=self.sbhintInputField.val();a=!k(b)}this.findChildElement(".gridCellRadius")},updateSmartyInputs:function(a,b,c){this.locationInputVal(a);this.cacodeInputField.val(b);this.sbhintInputField.val(c)},updateTable:function(a,b){function g(a){a=
f(a).attr("id").match(/^(row|pin)(.*)$/);return 3===a.length?a[2]:""}function d(a,b){a=c.template.renderElement("airportItemRow",{airportName:b.airportName,airportDistance:b.localizedDistance,rank:b.rank,hasDistance:a,airportCode:b.airportCode,markerText:b.markerText,hideCheckbox:e.options.onlyView});b="cb"+b.airportCode;b=f(a).find("#"+b);var d=b.parent().is(".StyleJamCheckbox")?"styleJamCheckbox":"checkbox";b=b[d]({change:m.bind(e),focus:n.bind(e),blur:h.bind(e)}).getWidget();(function(a,b){a.click(function(a){b.element.parent().find(a.target)||
b.element.trigger("click")})})(a,b);return a}function m(){0>=e.getAirportCheckCount()||4<e.getAirportCheckCount()?(e.submitButtonInput.prop("disabled",!0),e.submitButtonInput.attr("aria-disabled",!0)):(e.submitButtonInput.prop("disabled",!1),e.submitButtonInput.attr("aria-disabled",!1))}function n(a){c.dom.swapClasses(f("#row"+a.value),"",this.getState("rowFocused"))}function h(a){c.dom.swapClasses(f("#row"+a.value),this.getState("rowFocused"),"")}var e=this,k=this.nearbyAirportsTable.find("tbody");
k.empty();this.findChildElement(".customAirportsForm");if(0<b.length){this.showTable();this.hideNoResults();for(var p=0;p<b.length;p++)k.append(d(a,b[p]))}else this.hideTable(),this.showNoResults();a?this.showTableDistanceCol():this.hideTableDistanceCol();m();this.registerEvent("mouseleave",this.nearbyAirportsTable.find(".js-table-row"),function(){c.dom.swapClasses(f("#row"+g(this)),e.getState("rowFocused"),"")})},updateMap:function(a){function b(a){d.customAirportMapDiv.find(".js-map-pin").remove();
g(a)||jq.each(a,function(a,b){a=c.template.renderElement("airportPin",{id:b.itemId,xCoord:b.xCoord+-12+"px",yCoord:b.yCoord+-25+"px",hoverText:b.hoverText,label:b.pinLabel});d.customAirportMapDiv.append(a)})}function l(){function a(a){a=f(a).attr("id").match(/^(row|pin)(.*)$/);return 3===a.length?a[2]:""}d.nearbyAirportsTable.find(".js-table-row").off("mouseenter mouseleave","syncPinHover").on("mouseenter mouseleave","syncPinHover",function(){var b=a(this);f("#pin"+b).toggleClass("airportPicker__map__airportPin--active")});
d.customAirportMapDiv.find(".js-map-pin").off("mouseenter mouseleave","syncPinHover").on("mouseenter mouseleave","syncPinHover",function(){var b=a(this);f("#row"+b).toggleClass("airportPicker__table__row--active")})}var d=this;g(a)||k(a.mapUrl)?(this.hideMap(),this.showNoResults(),b([])):(this.showMap(a.mapUrl),this.hideNoResults(),b(a.pinMarkers),l())},getCheckedAirports:function(){return this.findChildElement("input[type\x3d'checkbox']:checked")},getAirportCheckCount:function(){return this.getCheckedAirports().length},
showMap:function(a){this.customAirportMapDiv.css("background-image","url("+a+")");c.dom.swapClasses(this.$map,this.getState("mapHidden"),this.getState("mapShowing"))},hideMap:function(){this.customAirportMapDiv.css("background-image","");c.dom.swapClasses(this.$map,this.getState("mapShowing"),this.getState("mapHidden"))},showTable:function(){c.dom.swapClasses(this.$tableWrapper,this.getState("tableWrapperHidden"),this.getState("tableWrapperShowing"))},hideTable:function(){c.dom.swapClasses(this.$tableWrapper,
this.getState("tableWrapperShowing"),this.getState("tableWrapperHidden"))},showTableDistanceCol:function(){c.dom.swapClasses(this.$tableDistanceCol,this.getState("tableDistanceColHidden"),this.getState("tableDistanceColShowing"))},hideTableDistanceCol:function(){c.dom.swapClasses(this.$tableDistanceCol,this.getState("tableDistanceColShowing"),this.getState("tableDistanceColHidden"))},showLoading:function(){c.dom.swapClasses(this.$loader,this.getState("loaderHidden"),this.getState("loaderShowing"));
this.hideTable();this.hideMap();this.hideNoResults()},hideLoading:function(){c.dom.swapClasses(this.$loader,this.getState("loaderShowing"),this.getState("loaderHidden"))},showNoResults:function(){c.dom.swapClasses(this.$noResults,this.getState("noResultsHidden"),this.getState("noResultsShowing"))},hideNoResults:function(){c.dom.swapClasses(this.$noResults,this.getState("noResultsShowing"),this.getState("noResultsHidden"))},findChildElement:function(a){return this.dialog.element.find(a)},locationInputVal:function(){1===
arguments.length&&(this.locationSmarty.elementNode.value=arguments[0]);return this.locationSmarty.elementNode.value},getState:function(a){null===this.states&&(this.states=c.question.ask("StyleJamAirportPicker.states"));if(this.states)return this.states[a]}})})(R9,jQuery);(function(d,f){function e(a){return null===a||"undefined"===typeof a||"string"===typeof a&&""===a.trim()}d.createComponentClass("flights.search.AnywhereSearchDialog",{formData:null,options:{autoAnywhere:!1},init:function(){this.dialog=this.getChildElement("dialog").dialog({}).getWidget();this.searchButton=this.getChildElement("search");this.exploreButton=this.getChildElement("explore")},addEventHandlers:function(){var a=this;this.subscribe("flights.search.AnywhereSearchDialog.open",function(c){a.formData=
c;a.options.autoAnywhere?a.openExplorePage():a.dialog.open()});this.subscribe("flights.search.AnywhereSearchDialog.close",function(){a.dialog.close()});this.searchButton.on("click",function(){d.events.publish("flights.search.AnywhereSearchDialog.search.click");a.dialog.close()});this.exploreButton.on("click",function(){d.events.publish("flights.search.AnywhereSearchDialog.explore.click");a.openExplorePage()})},openExplorePage:function(){var a=this.formData;if(null!==a){var c=["explore"];if(a.isMulticity){for(var b=
0;b<a.nrLegs&&(e(a["origincode"+b])||!e(a["destinationcode"+b]));b++);b<a.nrLegs&&c.push(a["origincode"+b])}else a.origincode&&c.push(a.origincode);window.open("/"+c.join("/"));this.dialog.close()}}})})(R9,jQuery);(function(f,q){function p(a){a=(a||"").split(",");for(var b=[],c=/^[A-Z0-9]{3}$/i,d=0;d<a.length;d++){var e=a[d].trim().toUpperCase();if(c.test(e))b.push(e);else return""}return b.join(",")}var r=/[0-9]+[fr]{1,2}/;f.publish("flights.search.FlightSearchFormUrls",{generateRtowFlightsUrl:function(a,b,c,d){var e=this._createSegmentsArray(b);if(null!=a)if(e.push(this._generateLeg(a,b,c)),"anywhere"!==b&&"continents"!==b)e.push(this._generateCabinClass(a.cabinClass)),e.push(this._generateTravelers(a.adults,
a.seniors,a.youth,a.child,a.seatInfants,a.lapInfants,a.students)),e.push(this._generateBaggageCount(a.baggageCount));else if(f.config.getBoolean("ui.explore-dropdown-on-ffd.enabled",!0)||f.config.getBoolean("ui.explore.ffd.use.exact.dates",!1))return this.generateExploreUrl(a,e);return this.appendFilterStateParam(this._createUrlFromSegments(e,a&&a.relativeUrl,a&&a.hostUrl),d)},appendFilterStateParam:function(a,b){if(!b||q.isEmptyObject(b)||!f.config.getBoolean("ui.flights.searchUrlFS.enabled",!0))return a;
var c=[];Object.keys(b).each(function(a){a&&"string"===typeof b[a]&&""!==b[a]&&c.push(a+"\x3d"+b[a])});if(c.length){var d=-1<a.indexOf("\x26")?"\x26":"?";return a+d+"fs\x3d"+c.join(";")}return a},generateExploreUrl:function(a,b){a.anywhereRange&&"none"!==a.anywhereRange&&b.push(a.anywhereRange);b=this._createUrlFromSegments(b,a.relativeUrl);var c=[];a.anywhereDuration&&"none"!==a.anywhereDuration&&c.push("tripduration\x3d"+a.anywhereDuration);a.exploreLengthOfStay&&(-1!==a.exploreLengthOfStay.indexOf("-")?
c.push("tripdurationrange\x3d"+a.exploreLengthOfStay.replace("-",",")):c.push("tripdurationrange\x3d"+a.exploreLengthOfStay+","+a.exploreLengthOfStay));a.anywhereOccasion&&"none"!==a.anywhereOccasion&&c.push("occ\x3d"+a.anywhereOccasion);c.length&&(b+="?"+c.join("\x26"));return b},generateMultiCityFlightsUrl:function(a,b,c){var d=this._createSegmentsArray(),e=[];if(null!=a){for(var f=0;f<b;f++)d.push(this._generateLeg(a.legData[f],"openflex",!0)),"legCabinClass"in a.legData[f]&&0<a.legData[f].legCabinClass.length&&
e.push(a.legData[f].legCabinClass);0===e.length&&e.push(a.cabinClass);d.push(this._generateCabinClasses(e));d.push(this._generateTravelers(a.adults,a.seniors,a.youth,a.child,a.seatInfants,a.lapInfants,a.students))}return this.appendFilterStateParam(this._createUrlFromSegments(d,a&&a.relativeUrl,a&&a.hostUrl),c)},_createSegmentsArray:function(a){switch(a){case "anywhere":case "continents":return["explore"];default:return[f.config.getString("ui.flights.searchUrlPath","flights").replace("/","")]}},_createUrlFromSegments:function(a,
b,c){a=a.join("/").replace(/[/]{2,}/g,"/").replace(/\/$/g,"");if(!b&&((b=f.config.getString("ui.flights.searchSwitchHostUrl",""))&&(c=b),c))if(f.config.getString("ui.flights.searchSwitchHostUrl.trackAffiliate",!0)){c=c.replace(/^(.+?)\/*?$/,"$1");b=f.globals.isSeo&&"undefined"!==typeof seoR9&&seoR9.placement?seoR9.placement:f.globals.placement;var d=f.globals.isSeo&&"undefined"!==typeof seoR9&&seoR9.affiliate?seoR9.affiliate:f.globals.affiliate;a=c+"/in?url\x3d"+encodeURIComponent((a.startsWith("/")?
"":"/")+a)+"\x26a\x3d"+encodeURIComponent(d||"")+"\x26p\x3d"+encodeURIComponent(b||"")}else a=c+(a.startsWith("/")?"":"/")+a;return a},_generateLeg:function(a,b,c){var d=[],e="anywhere"===b||"continents"===b;e?d.push(this._getAirportCode(a.originId,a.origin_location)):(a.regionSearch&&d.push("region"),d.push(this._generateOriginAndDestination(a.originId,a.originLocation,a.destinationId,a.destinationLocation,a.includeNearbyOrigin,a.includeNearbyDestination)));if(e)a.departDate&&a.returnDate&&d.push([this._generateDate(a.departDate),
this._generateDate(a.returnDate)].join());else if("weekend"!==b&&"openflex"!==b)b="plusminusthree"===b,d.push(this._generateDate(a.departDate,a.plusMinusThreeDepart,b)),!0!==c&&d.push(this._generateDate(a.returnDate,a.plusMinusThreeReturn,b));else if("openflex"===b)!0!==c?(c=this._safeURLDate(a.openflexDepartDate||a.departDate),d.push(c),c&&(c=new Date(c),c.setDate(c.getDate()+30),a=a.openflexLengthOfStay||"",d.push(this._generateOpenFlexDate(this._safeURLDate(c),a.toString())))):(c=this._generateDate(a.departDate,
a.plusMinusThreeDepart,"plusminusthree"===a.plusMinusThreeDepart),"a"!==a.departTime&&(c+=this._getTimeOption(a.departTime||"")),d.push(c));else{if(!0===c)throw Error("Illegal state: can't use flex category 'weekend' on oneway trips");d.push(this._generateWeekend(a.weekendDepartDate,a.weekendDepart,a.weekendReturn))}return d.join("/")},_generateCabinClass:function(a){return"p"===a?"/premium":"b"===a?"/business":"f"===a?"/first":""},_generateBaggageCount:function(a){return a&&0<a?"/bags-"+a:""},_generateCabinClasses:function(a){var b=
[];if("undefined"===typeof a||0===a.length)return"";var c;for(c=0;c<a.length;c++)-1===b.indexOf(a[c])&&b.push(a[c]);if(1===b.length)return"p"===b[0]?"/premium":"b"===b[0]?"/business":"f"===b[0]?"/first":"";b="/";for(c=0;c<a.length;c++)0<c&&(b+=","),"e"===a[c]?b+="economy":"p"===a[c]?b+="premium":"b"===a[c]?b+="business":"f"===a[c]&&(b+="first");return b},_generateOpenFlexDate:function(a,b){return a+"-flexible-calendar-"+b.replace("-","to").replace(/ /g,"")},_getTimeOption:function(a){return"a"===
a?"":"r"===a?"-early-morning":"m"===a?"-morning":"n"===a?"-afternoon":"e"===a?"-evening":"l"===a?"-night":"-"+a+"h"},_generateDate:function(a,b,c){c="";null!=a&&(c=a,null!=b&&(c+=this._getFlexOption(b)));return c},_safeURLDate:function(a){if(!a)return"";if("string"===typeof a||a&&"object"===typeof a&&a.hasOwnProperty("_isAMomentObject"))a=new Date(a);return a&&"function"===typeof a.toISOString&&a.getTime()?a.toISOString().split("T",1)[0]:""},_generateTravelers:function(a,b,c,d,e,l,g){function h(a){a=
parseInt(a,10);isNaN(a)&&(a=0);return a}function m(a,b){for(var c="",d=0;d<a;d++)c+="-"+b;return c}var k=[];a=h(a);b=h(b);d=h(d);c=h(c);e=h(e);l=h(l);var n=-1;"undefined"!==typeof g&&(n=h(g));g=d+c+e+l;1<a||0<b||0<g?k.push(a+"adults"):1===a&&0<n&&k.push(a+"adults");0<b&&k.push(b+"seniors");0<n&&k.push(n+"students");0<g&&(g="children",a="17",f.config&&(a=f.config.getString("ui.ptc.youth.age","17")),g+=m(e,"1S"),g+=m(l,"1L"),g+=m(d,"11"),g+=m(c,a),k.push(g));return k.join("/")},_generateWeekend:function(a,
b,c){var d="weekend";b=this._generateWeekendDays(b,c);a=a?a:"";"WEEKEND"!==a?(d+="/"+a.replace(/\//g,"-"),""!==b&&(d+="-"+b)):""!==b&&(d+="/"+b);return d},_generateWeekendDays:function(a,b){var c="";null==a||"FRIDAY_ANYTIME"===a&&"SUNDAY_ANYTIME"===b||(c=this._generateWeekendDay(a)+"-"+this._generateWeekendDay(b));return c},_generateWeekendDay:function(a){return"THURSDAY_ANYTIME"===a?"Thu":"THURSDAY_AM"===a?"Thu-AM":"THURSDAY_PM"===a?"Thu-PM":"FRIDAY_ANYTIME"===a?"Fri":"FRIDAY_AM"===a?"Fri-AM":"FRIDAY_PM"===
a?"Fri-PM":"SATURDAY_ANYTIME"===a?"Sat":"SATURDAY_AM"===a?"Sat-AM":"SUNDAY_ANYTIME"===a?"Sun":"SUNDAY_AM"===a?"Sun-AM":"SUNDAY_PM"===a?"Sun-PM":"MONDAY_ANYTIME"===a?"Mon":"MONDAY_AM"===a?"Mon-AM":"MONDAY_PM"===a?"Mon-PM":""},_generateOriginAndDestination:function(a,b,c,d,e,f){a=this._getAirportCode(a,b,e);c=this._getAirportCode(c,d,f);return a+"-"+c},_getAirportCode:function(a,b,c){if(null==a)return"";if(r.exec(a)||-1!==a.indexOf("cy")||-1!==a.indexOf("cg"))return a;var d=p(b)||p(a);if(d)return!0===
c&&(d+=",nearby"),d;a=a.split("/")[0];if(""==a||0==a.indexOf("C-"))a=b.replace(/ /g,""),-1!=a.indexOf("(")&&(b=a.match(/\(([A-Z]{3})\)/g),null!=b&&(a=b[0]));!0===c&&(a+=",nearby");return a},_getFlexOption:function(a){return"plusminusthree"===a?"-flexible":"plusminustwo"===a?"-flexible-2days":"plusminusone"===a?"-flexible-1day":"plusone"===a?"-flexible-1day-after":"minusone"===a?"-flexible-1day-before":""}})})(R9,jQuery);(function(d,h,g,l){var m=function(a){switch(a){case "m":return"0400,1200";case "n":return"1200,1800";case "e":return"1700,2400"}return null},k=function(a){switch(a){case "0400,1200":return"m";case "1200,1800":return"n";case "1700,2400":return"e"}return null};d.publish("flights.search.RTOWFormController",l.extend({parent:null,originField:null,destinationField:null,daterangePicker:null,advancedDaterangePicker:null,openflexDaterangePicker:null,openflexCalcReturnDate:null,openflexLengthOfStay:null,searchForm:null,
searchFormWrapper:null,flexCategoryRadio:null,departDate:null,returnDate:null,datePicker:null,flexDatePicker:null,openFlexDatePicker:null,flexSignUp:null,flexSignIn:null,oneway:!1,initialized:!1,flexCat:"exact",state:{start_date:null,end_date:null,plusMinusThreeDepart:null,plusMinusThreeReturn:null,weekendDepartDate:null,weekendDepart:null,weekendReturn:null,nearby_origin:!1,nearby_destination:!1,origin:null,originCode:null,destination:null,destinationCode:null},utils:null,constructor:function(a,
b){this.state=h.extend(!0,{},this.state);this.parent=a;this.utils=b;this.initFields()},initFields:function(){this.originField=new d.flights.search.FlightAirportField(this.parent.getChildElement("origin"),{airportMultiSelectEnabled:this.parent.options.airportMultiSelect,initialAirportMultiSelections:this.parent.options.originAirportMultiSelections});this.destinationField=new d.flights.search.FlightAirportField(this.parent.getChildElement("destination"),{airportMultiSelectEnabled:this.parent.options.airportMultiSelect,
initialAirportMultiSelections:this.parent.options.destinationAirportMultiSelections});this.daterangePicker=this.parent.getChildElement("travelDates");this.advancedDaterangePicker=this.parent.getChildElement("flexTravelDates");this.openflexDaterangePicker=this.parent.getChildElement("flexDepartDate");this.openflexCalcReturnDate=this.parent.getChildElement("flexCalcReturnDate");this.openflexLengthOfStay=this.parent.getChildElement("flexLengthOfStay");this.searchForm=this.parent.getChildElement("RTOWsearchform");
this.searchFormWrapper=this.parent.element.find(".js-searchForm");this.flexCategoryRadio=this.parent.getChildElement("flexCat");this.departDate=this.parent.getChildElement("depart").getWidget();this.returnDate=this.parent.getChildElement("return").getWidget();this.datePicker=this.parent.getChildElement("datePicker").getWidget();this.flexDatePicker=this.parent.getChildElement("flexDatePicker").getWidget();this.openFlexDatePicker=this.parent.getChildElement("openFlexDatePicker").getWidget();this.flexSignUp=
this.parent.getChildElement("signup");this.flexSignIn=this.parent.getChildElement("login");this.departCol=this.parent.getChildElement("depart-col");this.returnCol=this.parent.getChildElement("return-col");this.datesCol=this.parent.getChildElement("dates-col");this.originCol=this.parent.getChildElement("origin-col");this.destCol=this.parent.getChildElement("dest-col");this.advancedSection=this.parent.getChildElement("advancedSection");this.advancedOpenButton=this.parent.getChildElement("advancedFilterToggleOn");
this.advancedCloseButton=this.parent.getChildElement("advancedFilterToggleOff");this.timesFilterWrapper=this.parent.getChildElement("timesFilterWrapper")},_extendRadionButton:function(a){a.setValue=function(a){this.element.find("input").each(function(){var b=h(this);b.val()===a?b.prop("checked",!0):b.prop("checked",!1)});d.Widgets.RadiobuttonSet.refresh(this.element)};a.setEnabled=function(a,c){this.element.find("input").each(function(){var b=h(this);b.val()===a&&b.prop("disabled",!c)});d.Widgets.RadiobuttonSet.refresh(this.element)}},
setOneWay:function(a){this.oneway=a;this.parent.options.useLegacyDatePicker?(this.daterangePicker.getWidget().setSingleDateMode(a),"undefined"!==typeof this.advancedDaterangePicker.getWidget()&&this.advancedDaterangePicker.getWidget().setSingleDateMode(a)):(this.datePicker.setDateMode(a?"single":"range",!0),"undefined"!==typeof this.flexDatePicker&&this.flexDatePicker.setDateMode(a?"single":"range",!0));var b=this.getFlexCategory(),c=this.flexCategoryRadio.getWidget();"undefined"!==typeof c&&(!0!==
a||"weekend"!==b&&"openflex"!==b||(c.setButtonCheckedByValue("plusminusthree"),this.setFlexCategory("plusminusthree")),c.setButtonEnabledByValue("weekend",!a),c.setButtonEnabledByValue("openflex",!a));this.searchForm.removeClass("oneway roundtrip");this.searchForm.addClass(a?"oneway":"roundtrip");this.parent.loadCompareToItems();this.setGridState(a?"--oneway":"");this.parent.options.advancedFiltersEnabled&&(this.updateTakeoffFilterVisibility(1,this.oneway,!0),this.parent.swapClassesToggle(this.timesFilterWrapper,
"AdvancedSection__Right--oneway","AdvancedSection__Right--roundtrip",this.oneway))},setGridState:function(a){var b=""===a?"--oneway":"";this.departCol.length&&this.returnCol.length&&(this.parent.swapClasses(this.departCol,"col-depart-date"+b,"col-depart-date"+a),this.parent.swapClasses(this.returnCol,"col-return-date"+b,"col-return-date"+a));this.datesCol.length&&this.parent.swapClasses(this.datesCol,"col-date-range"+b,"col-date-range"+a);this.parent.swapClasses(this.originCol,"col-origin"+b,"col-origin"+
a);this.parent.swapClasses(this.destCol,"col-destination"+b,"col-destination"+a)},getFlexCategory:function(){if("anywhere"===this.state.destinationCode)return"anywhere";if(this.parent.options.useFlexDatePicker&&this.datePicker&&this.datePicker.getFlexCategory)return this.datePicker.getFlexCategory();var a=this.parent.getChildElement("plusMinus3Days");return this.searchFormWrapper.hasClass("advanced")?this.flexCat:a.length&&a.is(":visible")&&a.is(":checked")?"plusminusthree":"exact"},setFlexCategory:function(a){this.flexCat=
a;h(".flexCatBlock",this.parent.element).removeClass("exact weekend plusminusthree openflex").addClass(a);this.parent.vsLog("flexdates/dayofweek/"+a);this.parent.gaLog("select-flextype",a)},bindFlexDisplayCat:function(){var a=this;"undefined"!==typeof this.flexCategoryRadio.styleJamRadioButtonSet&&this.flexCategoryRadio.styleJamRadioButtonSet({change:function(b,c){a.setFlexCategory(b.value)}})},bindNearbyCheckboxes:function(){var a=this;this.utils.bindCheckbox(this.parent.getChildElement("nearbyOriginCheckRtow"),
function(b){a.triggerChangeNearbyOrigin(b)});this.utils.bindCheckbox(this.parent.getChildElement("nearbyDestinationCheckRtow"),function(b){a.triggerChangeNearbyDestination(b)})},validate:function(){var a=[],a=a.concat(this.parent.getLocationValidationMessages(0,this.getOriginAirportCode(),this.getDestinationAirportCode())),b=this.getFlexCategory();"anywhere"!==b&&(a="weekend"===b||"openflex"===b||this.oneway?a.concat(this.parent.getDateValidationMessages(0,!0,this.state.start_date)):a.concat(this.parent.getDateValidationMessages(0,
!1,this.state.start_date,this.state.end_date)));return a=a.concat(this.parent.getTravelerValidationMessages())},isSameDayRoundtrip:function(){var a=g(this.state.start_date),b=g(this.state.end_date);return!this.oneway&&a.isValid()&&b.isValid()?a.isSame(b,"day"):!1},originCodeVal:function(){1===arguments.length&&this.originField.code(arguments[0]);return this.originField.code()},getOriginAirportCode:function(){return this.utils.getMultipleAirportCodes(this.state.origin)||this.utils.getAirportCode(this.state.originCode)},
originLocationVal:function(){1===arguments.length&&this.originField.val()!==arguments[0]&&this.originField.val(arguments[0]);return this.originField.val()},destinationCodeVal:function(){1===arguments.length&&this.destinationField.code(arguments[0]);return this.destinationField.code()},getDestinationAirportCode:function(){return this.utils.getMultipleAirportCodes(this.state.destination)||this.utils.getAirportCode(this.state.destinationCode)},destinationLocationVal:function(){1===arguments.length&&
this.destinationField.val()!==arguments[0]&&this.destinationField.val(arguments[0]);return this.destinationField.val()},serialize:function(){var a={},b=g(this.state.start_date),c=g(this.state.end_date);a.isMulticity=!1;var e=this.getFlexCategory(),f={};if(this.parent.options.useFlexDatePicker)switch(f=this.datePicker.getFlexDatesData("anywhere"===e),f.flex_category){case "exact":case "plusminusthree":b.isValid()&&(f.depart_date=b.format(d.globals.apiDateFormat));!this.oneway&&c.isValid()&&(f.return_date=
c.format(d.globals.apiDateFormat));break;case "weekend":b.isValid()&&(g(b).startOf("month").isSameOrBefore(g())?f.weekend_depart_date="WEEKEND":f.weekend_depart_date=b.format("YYYY-MM-DD"));break;case "openflex":b.isValid()&&(f.openflex_depart_date=b.toDate())}else f.flex_category=e,"exact"===e||"plusminusthree"===e?(b.isValid()&&(f.depart_date=b.format(d.globals.apiDateFormat)),!this.oneway&&c.isValid()&&(f.return_date=c.format(d.globals.apiDateFormat)),"plusminusthree"===e&&(f.depart_date_flex=
this.state.plusMinusThreeDepart,this.oneway||(f.return_date_flex=this.state.plusMinusThreeReturn))):"weekend"===e?(f.weekend_depart_date=this.state.weekendDepartDate,f.weekend_depart=this.state.weekendDepart,f.weekend_return=this.state.weekendReturn):"openflex"===e&&(f.openflex_depart_date=this.state.openflexDepartDate,f.openflex_length_of_stay=this.state.openflexLengthOfStay);h.extend(a,f);"anywhere"===e&&(this.parent.getChildElement("anymonth").length?(f=this.parent.getChildElement("anymonth").getWidget().getValue())?
(a.depart_date_canon=f.split(",")[0],a.return_date_canon=f.split(",")[1],a.depart_date=g(a.depart_date_canon,"YYYYMMDD").format(d.globals.apiDateFormat),a.return_date=g(a.return_date_canon,"YYYYMMDD").format(d.globals.apiDateFormat)):(this.state.start_date&&(a.depart_date=this.state.start_date.format(d.globals.apiDateFormat)),this.state.end_date&&(a.return_date=this.state.end_date.format(d.globals.apiDateFormat))):d.config.getBoolean("ui.explore-dropdown-on-ffd.enabled",!1)&&(a.anywhereRange=d.question.ask("ExploreFlexDatesDropdown.range"),
a.anywhereDuration=d.question.ask("ExploreFlexDatesDropdown.duration"),a.anywhereOccasion=d.question.ask("ExploreFlexDatesDropdown.occasion")),d.config.getBoolean("ui.explore.ffd.use.exact.dates",!1)&&null===a.explore_length_of_stay&&(a.depart_date_anywhere=g(this.state.start_date).format("YYYY-MM-DD"),a.return_date_anywhere=g(this.state.end_date).format("YYYY-MM-DD")));a.oneway=this.oneway;a.origin=a.origincode=this.getOriginAirportCode();a.origin_location=this.state.origin;a.origin_code=this.state.originCode;
a.nearby_origin=this.state.nearby_origin;a.originMultiAirports=this.originField.getAirportMultiSelections();"anywhere"!==e&&(a.destination=a.destinationcode=this.getDestinationAirportCode(),a.destination_location=this.state.destination,a.destination_code=this.state.destinationCode,a.nearby_destination=this.state.nearby_destination,a.destinationMultiAirports=this.destinationField.getAirportMultiSelections(),null!==this.utils.REGION_RX.exec(a.destination)?a.freeRegionId=parseInt(a.destination.replace(/[A-z]+/,
"")):null!==/[0-9]+[r]{1,2}/.exec(a.destination)?a.regionId=parseInt(a.destination.replace(/[A-z]+/,"")):a.countrySearch=this.utils.isCountryOrCountryGroup(a.destination),b.isValid()&&(a.depart_date_canon=g(this.state.start_date).format("YYYY-MM-DD")),!this.oneway&&c.isValid()&&(a.return_date_canon=g(this.state.end_date).format("YYYY-MM-DD")));this.parent.serializeTravelers(a);return a},initState:function(a){a=a||{};this.triggerChangeOrigin();this.triggerChangeDestination();this.triggerChangeDateRange();
this.triggerChangeNearbyOrigin(a.nearby_origin,this.parent.options.isNearbyInSmarty);this.triggerChangeNearbyDestination(a.nearby_destination,this.parent.options.isNearbyInSmarty);this.triggerChangeLengthOfStay(a.openflex_length_of_stay);this.parent.options.useFlexDatePicker&&"anywhere"!==a.flex_category&&this.datePicker.loadFlexData(a);this.parent.options.flexDatesSignUpPromoEnabled&&"exact"!==this.parent.options.flex_category&&(d.Analytics.api.trackEvent({category:"flexDatesSignUpPromo",action:"open",
label:this.parent.options.flex_category}),this.flexCategoryRadio.getWidget().focusRadio())},onCmp2GoodToLoad:function(a){return d.config.getBoolean("ui.flights.form.cmp2.allPass",!1)||!a||!a.hasOwnProperty("originLocation")&&!a.hasOwnProperty("destinationLocation")?!0:!!(a.originLocation&&a.originCode||a.destinationLocation&&a.destinationCode)},onChangeOrigin:function(a){this.allowAirportMultiSelect(a.originCodeType)?this.originField.addAirportMultiSelection(a.originCode,a.originLocation,a.originLocationDescription,
"selection"):(this.originLocationVal(a.originLocation),this.originCodeVal(a.originCode));0===a.originCode.length&&a.originLocation.match(/^[A-z]{3}$/)&&this.originCodeVal(a.originLocation);this.state.origin=this.originLocationVal()||"";this.state.originCode=this.originCodeVal()||"";a.refreshNearby&&this.parent.setNearbyWrapperVisibility(this.state.origin,".rtow .originBlock .nearbyWrapper")},triggerChangeOrigin:function(a){a=a||{};var b=h.extend({},this.parent.eventDataTemplate),c=this;b.originLocation=
this.utils.valOrDefault(a.location,function(){return c.originLocationVal()});b.originLocationDescription=a.locationDescription;b.originCode=this.utils.valOrDefault(a.code,function(){return c.originCodeVal()});b.originCodeType=a.codeType;b.refreshNearby=!(""===a.location&&""===a.code);b.item=a.smartyItem;b.odSwitch=a.odSwitch;b.isDestinationFocusSkipped=a.isDestinationFocusSkipped;d.events.publish(this.parent.events.rtowOrigin,b);b=h.extend({},b);b.legIndex=0;d.events.publish(this.parent.events.multiOrigin,
b);a.location&&(this.parent.vsLog("location/origin"),this.parent.gaLog("select-origin"))},onChangeDestination:function(a){this.allowAirportMultiSelect(a.destinationCodeType)?(a.resetState&&this.destinationField.resetAirportMultiSelect(),this.destinationField.addAirportMultiSelection(a.destinationCode,a.destinationLocation,a.destinationLocationDescription,"selection")):(this.destinationLocationVal(a.destinationLocation),this.destinationCodeVal(a.destinationCode));0===a.destinationCode.length&&a.destinationLocation.match(/^[A-z]{3}$/)&&
this.destinationCodeVal(a.destinationLocation);this.state.destination=this.destinationLocationVal()||"";this.state.destinationCode=this.destinationCodeVal()||"";a.refreshNearby&&this.parent.setNearbyWrapperVisibility(this.state.destination,".rtow .destinationBlock .nearbyWrapper");a.pulse&&this.pulseInputModal(this.destinationField)},triggerChangeDestination:function(a){a=a||{};var b=h.extend({},this.parent.eventDataTemplate),c=this;b.destinationLocation=this.utils.valOrDefault(a.location,function(){return c.destinationLocationVal()});
b.destinationLocationDescription=a.locationDescription;b.destinationCode=this.utils.valOrDefault(a.code,function(){return c.destinationCodeVal()});b.destinationCodeType=a.codeType;b.refreshNearby=!(""===a.location&&""===a.code);b.item=a.smartyItem;b.odSwitch=a.odSwitch;d.events.publish(this.parent.events.rtowDestination,b);b=h.extend({},b);b.legIndex=0;d.events.publish(this.parent.events.multiDestination,b);a.location&&(this.parent.vsLog("location/destination"),this.parent.gaLog("select-destination"))},
allowAirportMultiSelect:function(a){var b=this.parent.options.airportMultiSelect;a=a&&0===a.indexOf("ap");return b&&a},onChangeDateRange:function(a){if(this.parent.options.useLegacyDatePicker){var b=this.daterangePicker.getWidget();b.setStartDate(a.startDate);b.setEndDate(a.endDate);0<this.advancedDaterangePicker.length&&(b=this.advancedDaterangePicker.getWidget(),b.setStartDate(a.startDate),b.setEndDate(a.endDate));0<this.openflexDaterangePicker.length&&(b=this.openflexDaterangePicker.getWidget(),
b.setStartDate(a.startDate),b=b.getStartDate())&&(b=g(b).add(1,"month").subtract(1,"day"),b=b.format("ddd M/D"),b=replaceArgs(this.parent.options.msg.openflexToDateWithLengthIntro,b),this.openflexCalcReturnDate.text(b))}else b=this.returnDate.getDate(),"undefined"!==typeof a.startDate&&this.departDate.setDate(a.startDate),"undefined"!==typeof a.endDate?null!==a.endDate&&g(a.startDate).isSameOrBefore(g(a.endDate))?this.returnDate.setDate(a.endDate):this.returnDate.setDate(null):null!==b&&b.isSameOrBefore(g(a.startDate))&&
this.returnDate.setDate(null),this.parent.options.flexMonthEnabled&&(b=g(b).add(1,"month").subtract(1,"day"),b=b.format("ddd M/D"),b=replaceArgs(this.parent.options.msg.openflexToDateWithLengthIntro,b),this.openflexCalcReturnDate.text(b));this.state.openflexDepartDate=a.startDate;this.state.start_date=a.startDate;this.state.end_date=a.endDate;this.parent.vsLog("dropoffdate");this.parent.gaLog("select-date","depart:"+g(this.state.start_date).format("MMM Do YY")+", return:"+g(this.state.end_date).format("MMM Do YY"))},
triggerChangeDateRange:function(a,b){var c=this,e=g(a);null!==a&&void 0!==a&&e.isValid()&&(a=e);e=g(b);null!==b&&void 0!==b&&e.isValid()&&(b=e);e=h.extend({},this.parent.eventDataTemplate);if(this.parent.options.useLegacyDatePicker){var f=this.daterangePicker.getWidget();e.startDate=this.utils.valOrDefault(a,function(){return f.getStartDate()});e.endDate=this.utils.valOrDefault(b,function(){return f.getEndDate()})}else e.startDate=this.utils.valOrDefault(a,function(){return c.departDate.getDate()}),
e.endDate=this.utils.valOrDefault(b,function(){return c.returnDate.getDate()});d.events.publish(this.parent.events.rtowDateRange,e)},onChangeNearbyOrigin:function(a){this.utils.setCheckboxValue(this.parent.getChildElement("nearbyOriginCheckRtow"),a.includeNearbyOrigin);this.state.nearby_origin=a.includeNearbyOrigin},triggerChangeNearbyOrigin:function(a,b){var c=h.extend({},this.parent.eventDataTemplate),e=this;c.includeNearbyOrigin=this.utils.valOrDefault(a,function(){var a=e.parent.getChildElement("nearbyOriginCheckRtow");
return 1>a.length?!1:a[0].checked});d.events.publish(this.parent.events.rtowNearbyOrigin,c);b&&this.originField.inputEl.getWidget().setIsNearbyChecked(c.includeNearbyOrigin);this.parent.vsLog("location/addnearby/"+(c.includeNearbyOrigin?"on":"off"));this.parent.gaLog("add-nearby",c.includeNearbyOrigin?"on-"+this.originLocationVal():"off-"+this.originLocationVal())},onChangeNearbyDestination:function(a){this.utils.setCheckboxValue(this.parent.getChildElement("nearbyDestinationCheckRtow"),a.includeNearbyDestination);
this.state.nearby_destination=a.includeNearbyDestination},triggerChangeNearbyDestination:function(a,b){var c=h.extend({},this.parent.eventDataTemplate),e=this;c.includeNearbyDestination=this.utils.valOrDefault(a,function(){var a=e.parent.getChildElement("nearbyDestinationCheckRtow");return 1>a.length?!1:a[0].checked});d.events.publish(this.parent.events.rtowNearbyDestination,c);b&&this.destinationField.inputEl.getWidget().setIsNearbyChecked(c.includeNearbyDestination);this.parent.vsLog("location/addnearby/"+
(c.includeNearbyOrigin?"on":"off"));this.parent.gaLog("add-nearby",c.includeNearbyDestination?"on-"+this.destinationLocationVal():"off-"+this.destinationLocationVal())},onChangeLengthOfStay:function(a){var b=this.parent.getChildElement("flexLengthOfStay");b.val()!==a.lengthOfStay&&b.val(a.lengthOfStay);this.state.openflexLengthOfStay=a.lengthOfStay},triggerChangeLengthOfStay:function(a){var b=h.extend({},this.parent.eventDataTemplate);b.lengthOfStay=a||"6-8";d.events.publish(this.parent.events.rtowLengthOfStay,
b)},onOriginDepartureSwitch:function(a){a=this.destinationField.val();var b=this.destinationField.code();if(d.config.getBoolean("ui.horizon.flights.smarty.od.switch.validate.enabled",!0)){var c=this.destinationField.code();/^\d+[r|fr|cy]+$|^any$|^[A-Z]{2}cg$/.test(c)&&(b=a="")}var c=this.originField.val(),e=this.originField.code();if(this.parent.options.airportMultiSelect){var f=this.originField.getAirportMultiSelections(),g=this.destinationField.getAirportMultiSelections();this.originField.resetAirportMultiSelect();
this.destinationField.resetAirportMultiSelect();f.length?this.destinationField.addAirportMultiSelections(f):(this.destinationField.val(c),this.destinationField.code(e));g.length?this.originField.addAirportMultiSelections(g):(this.originField.val(a),this.originField.code(b))}else this.originField.val(a),this.destinationField.val(c),this.originField.code(b),this.destinationField.code(e);this.triggerChangeDestination({odSwitch:!0});this.triggerChangeOrigin({odSwitch:!0});this.triggerChangeDestination({odSwitch:!0});
this.triggerChangeOrigin({odSwitch:!0});a=this.parent.getChildElement("nearbyOriginCheckRtow");b=this.parent.getChildElement("nearbyDestinationCheckRtow");a.is(":checked")!==b.is(":checked")&&(a.click(),b.click());this.parent.loadCompareToItems()},buildSearchURL:function(a,b){var c={originId:a.origin,destinationId:a.destination,originLocation:a.origin_location,destinationLocation:a.destination_location,includeNearbyOrigin:a.nearby_origin,includeNearbyDestination:a.nearby_destination,cabinClass:a.cabin,
baggageCount:a.baggageCount,departDate:a.depart_date_canon,returnDate:a.return_date_canon,plusMinusThreeDepart:a.depart_date_flex,plusMinusThreeReturn:a.return_date_flex,adults:a.adults,seniors:a.seniors,youth:a.youth,child:a.child,seatInfants:a.seatInfant,lapInfants:a.lapInfant,weekendDepartDate:a.weekend_depart_date,weekendDepart:a.weekend_depart,weekendReturn:a.weekend_return,openflexDepartDate:a.openflex_depart_date,openflexLengthOfStay:a.openflex_length_of_stay};d.config.getBoolean("ui.explore-dropdown-on-ffd.enabled",
!1)&&(c.anywhereDuration=a.anywhereDuration,c.anywhereOccasion=a.anywhereOccasion,c.anywhereRange=a.anywhereRange);d.config.getBoolean("ui.explore.ffd.use.exact.dates",!1)&&"anywhere"===a.flex_category&&(null!==a.explore_length_of_stay?c.exploreLengthOfStay=a.explore_length_of_stay:"undefined"===typeof c.returnDate&&"undefined"===typeof c.departDate&&(c.returnDate=g(a.return_date_anywhere).format("YYYYMMDD"),c.departDate=g(a.depart_date_anywhere).format("YYYYMMDD")));this.parent.options.showStudents&&
(c.students=a.students);this.utils.isEmpty(a.airlineFilter)||(c.airlineFilter=a.airlineFilter);c.regionSearch=this.parent.options.regionSearchEnabled&&a.destination&&(this.utils.REGION_RX.exec(a.destination)||this.utils.isCountryOrCountryGroup(a.destination));return d.flights.search.FlightSearchFormUrls.generateRtowFlightsUrl(c,this.getFlexCategory(),this.oneway,b)},bindAdvanced:function(){var a=this.parent,b=this;a.registerEvent("click",this.advancedOpenButton,function(){b.toggleAdvancedSection(!0);
a.gaLog("advancedFilter","open")});a.registerEvent("click",this.advancedCloseButton,function(){b.toggleAdvancedSection(!1);a.gaLog("advancedFilter","close")});var c=a.getChildElement("nonstopFilter");c.length&&(this.nonstopFilter=c.styleJamCheckbox({change:this.handleStopFilterChanged.bind(this)}).getWidget());c=a.getChildElement("basiceconFilter");c.length&&(this.basiceconFilter=c.styleJamCheckbox({change:this.handleCabinFilterChanged.bind(this)}).getWidget());d.events.when("inlineComponents.initialized",
function(){var b=a.getChildElement("timesFilterDepart"),c=a.getChildElement("timesFilterReturn");b.getWidget()&&(this.timesFilterDepart=b.getWidget(),this.timesFilterDepart.setOption("change",this.handleTakeoffFilterChanged.bind(this,0)));c.getWidget()&&(this.timesFilterReturn=c.getWidget(),this.timesFilterReturn.setOption("change",this.handleTakeoffFilterChanged.bind(this,1)))}.bind(this))},loadAdvancedFilterState:function(a){var b=a.cabin,c=a.takeoff,e=!1;"0"===a.stops&&this.nonstopFilter&&(this.nonstopFilter.setChecked(!0),
e=!0);b&&this.basiceconFilter&&"-"===b[0]&&-1<b.indexOf("bfbe")&&(this.basiceconFilter.setChecked(!0),e=!0);c&&(a=c.split("|"),this.timesFilterDepart&&a[0]&&(b=k(a[0]))&&(this.timesFilterDepart.setValue(b,!1),e=!0),this.timesFilterReturn&&1<a.length&&a[1]&&(b=k(a[1]))&&(this.timesFilterReturn.setValue(b,!1),e=!0));e&&this.toggleAdvancedSection(!0)},handleStopFilterChanged:function(){this.nonstopFilter.getValue()?this.parent.searchFormFilterState.stops="0":delete this.parent.searchFormFilterState.stops;
this.parent.gaLog("advancedFilter","click/nonstop")},handleCabinFilterChanged:function(){this.basiceconFilter.getValue()?this.parent.searchFormFilterState.cabin="-bfbe":delete this.parent.searchFormFilterState.cabin;this.parent.gaLog("advancedFilter","click/basicecon")},handleTakeoffFilterChanged:function(a){this.updateTakeoffFilterState(a);this.parent.gaLog("advancedFilter","click/"+(0===a?"departTime":"returnTime"))},updateTakeoffFilterVisibility:function(a,b){var c=0===a?this.timesFilterDepart:
this.timesFilterReturn;c&&(this.parent.swapClassesToggle(c.element.parent(),"AdvancedSection__FilterSelect--hidden","AdvancedSection__FilterSelect--visible",b),this.updateTakeoffFilterState(a,b))},updateTakeoffFilterState:function(a,b){if(this.parent.searchFormFilterState){var c=0===a?this.timesFilterDepart:this.timesFilterReturn;if(c){var e=this.parent.searchFormFilterState.takeoff||"",d="";b||(d=m(c.getValue()));b=e.split("|");b=[b[0],1<b.length?b[1]:""];b[a]=d;a=b.join("|");1<a.length?this.parent.searchFormFilterState.takeoff=
a:delete this.parent.searchFormFilterState.takeoff}}},toggleAdvancedSection:function(a){this.parent.swapClassesToggle(this.advancedOpenButton,"AdvancedFilterToggle--visible","AdvancedFilterToggle--hidden",!a);this.parent.swapClassesToggle(this.advancedCloseButton,"AdvancedFilterToggle--visible","AdvancedFilterToggle--hidden",a);this.parent.swapClassesToggle(this.advancedSection,"AdvancedSection--visible","AdvancedSection--hidden",a)},bindFlexDatePicker:function(){this.parent.subscribe("DatePicker.update",
{updateGroup:"RTOWDates"},this.onFlexDatePickerUpdate.bind(this))},onFlexDatePickerUpdate:function(a){if(a.flex){switch(a.flex){case "plusminusthree":case "exact":this.searchFormWrapper.removeClass("show-flex-display");break;case "weekend":case "openflex":this.searchFormWrapper.addClass("show-flex-display")}this.parent.options.advancedFiltersEnabled&&(this.timesFilterDepart&&this.updateTakeoffFilterState(0,"weekend"===a.flex),this.timesFilterReturn&&this.updateTakeoffFilterState(0,"openflex"===a.flex||
"weekend"===a.flex))}},bindMultiAirportSelect:function(){var a=this;this.originField.setOptions({onChangeAirportMultiSelection:function(b){a.state.origin=b;a.state.originCode=b},onDisableNearbyToggle:function(){a.state.nearby_origin=!1}});this.destinationField.setOptions({onChangeAirportMultiSelection:function(b){a.state.destination=b;a.state.destinationCode=b},onDisableNearbyToggle:function(){a.state.nearby_destination=!1}})},bindAll:function(){this.bindFlexDisplayCat();this.parent.options.advancedFiltersEnabled&&
this.bindAdvanced();this.parent.options.useFlexDatePicker&&this.bindFlexDatePicker();this.bindNearbyCheckboxes();this.parent.bindFlightSmartyFields({field:this.originField,isOrigin:!0,changeCallback:h.proxy(this.triggerChangeOrigin,this)});this.parent.bindFlightSmartyFields({field:this.destinationField,enableTopDestinations:!0,topDestinationOptions:{originField:this.originField},changeCallback:h.proxy(this.triggerChangeDestination,this)});this.parent.options.airportMultiSelect&&this.bindMultiAirportSelect();
if(this.parent.options.useLegacyDatePicker){var a=this.daterangePicker.add(this.advancedDaterangePicker).add(this.openflexDaterangePicker);this.parent.bindDaterangePicker(a,h.proxy(this.triggerChangeDateRange,this))}else this.parent.bindDaterangePicker(this.datePicker,h.proxy(this.triggerChangeDateRange,this)),this.flexDatePicker&&this.parent.bindDaterangePicker(this.flexDatePicker,h.proxy(this.triggerChangeDateRange,this)),this.parent.options.flexMonthEnabled&&this.openFlexDatePicker&&this.parent.bindDaterangePicker(this.openFlexDatePicker,
h.proxy(this.triggerChangeDateRange,this));this.parent.subscribe(this.parent.events.rtowOrigin,this.parent.proxyEventCallback(this.onChangeOrigin,this,null,this.onCmp2GoodToLoad));this.parent.subscribe(this.parent.events.rtowDestination,this.parent.proxyEventCallback(this.onChangeDestination,this,null,this.onCmp2GoodToLoad));this.parent.subscribe(this.parent.events.rtowDateRange,this.parent.proxyEventCallback(this.onChangeDateRange,this,null,this.onCmp2GoodToLoad));this.parent.subscribe(this.parent.events.rtowNearbyOrigin,
this.parent.proxyEventCallback(this.onChangeNearbyOrigin,this));this.parent.subscribe(this.parent.events.rtowNearbyDestination,this.parent.proxyEventCallback(this.onChangeNearbyDestination,this));this.parent.subscribe(this.parent.events.rtowLengthOfStay,this.parent.proxyEventCallback(this.onChangeLengthOfStay,this));this.parent.subscribe("flights.search.swapLocations",{id:this.parent.id("originDepartureSwitch")},this.onOriginDepartureSwitch.bind(this))},setup:function(){this.bindAll();this.initialized=
!0},teardown:function(){this.destinationField=this.originField=null},activate:function(){this.initialized||this.setup();!0===this.oneway&&this.setOneWay(!0);this.searchForm.attr("aria-hidden","false");this.parent.swapClasses(this.searchForm,"SearchForm--hidden","SearchForm--visible")},pulseInputModal:function(a){(a=a&&a.inputEl&&a.inputEl.data?a.inputEl.data("inputModal"):null)&&a.pulseDisplay()}}))})(window.R9,window.jQuery,window.moment,window.base2.Base);(function(g,k,l,m){g.publish("flights.search.MulticityFormController",m.extend({parent:null,searchForm:null,addMoreLegsLink:null,clearAllLink:null,initialized:!1,indexLastVisibleLeg:!1,maxLegs:0,legState:{origin:"",destination:"",originCode:"",destinationCode:"",depart_date:null,depart_time:"a",cabin_type:"e",nearby_origin:!1,nearby_destination:!1},defaultLegState:null,backFromRP:!1,legStates:[],accessors:null,utils:null,constructor:function(a,b){this.parent=a;this.utils=b;this.initFields()},initFields:function(){this.searchForm=
this.parent.getChildElement("js-multiSearchform");this.addMoreLegsLink=this.parent.getChildElement("js-addMoreLegs");this.clearAllLink=this.parent.getChildElement("js-clearLegs");this.indexLastVisibleLeg=this.parent.options.backFromRP?this.parent.options.multicityOptions.length-1:this.parent.options.defaultLegsVisible-1;this.maxLegs=this.parent.options.maxLegs;this.defaultLegState=this.parent.options.multicityOptions;this.backFromRP=this.parent.options.backFromRP;this.accessors={}},removeLeg:function(a){for(;a<
(this.backFromRP?this.defaultLegState.length-1:this.maxLegs-1);a++)a<this.indexLastVisibleLeg?this.copyLeg(a+1,a):(this._legAccessor(a).visible(!1),this.setLegWidgetValues(a,this.legState));this.setLegWidgetValues(a,this.legState);this._legAccessor(a).visible(!1);--this.indexLastVisibleLeg;this.addMoreLegsLink.show();this.parent.vsLog("multicity/removeleg");this.parent.gaLog("clear-multicity")},addLeg:function(){this.indexLastVisibleLeg<this.maxLegs-1&&(this.indexLastVisibleLeg+=1,this.setLegWidgetValues(this.indexLastVisibleLeg,
this.legState),this._legAccessor(this.indexLastVisibleLeg).visible(!0));this.indexLastVisibleLeg>=this.maxLegs-1&&this.addMoreLegsLink.hide();this.parent.vsLog("multicity/addanotherflight");this.parent.gaLog("select-add-another-flight")},updateLegState:function(a){var b=this._legAccessor(a);a=this.legStates[a];a.origin=b.origin();a.originCode=b.originCode();a.destination=b.destination();a.destinationCode=b.destinationCode();a.depart_date=b.departDate();a.depart_time=b.departTime();a.cabin_type=b.cabinType();
a.nearby_origin=b.nearbyOrigin();a.nearby_destination=b.nearbyDestination()},setLegWidgetValues:function(a,b){var c=this._legAccessor(a);c.origin(b.origin);c.destination(b.destination);c.originCode(b.originCode);c.destinationCode(b.destinationCode);c.departDate(b.depart_date);c.departTime(b.depart_time);c.cabinType(b.cabin_type);c.nearbyOrigin(b.nearby_origin);c.nearbyDestination(b.nearby_destination);this.updateLegState(a)},copyLeg:function(a,b){a=this._legAccessor(a);var c=this._legAccessor(b);
c.origin(a.origin());c.destination(a.destination());c.originCode(a.originCode());c.destinationCode(a.destinationCode());c.departDate(a.departDate());c.departTime(a.departTime());c.cabinType(a.cabinType());c.nearbyOrigin(a.nearbyOrigin());c.nearbyDestination(a.nearbyDestination());this.updateLegState(b)},validate:function(){for(var a=[],b=0;b<=this.indexLastVisibleLeg;b++){var c=this._legAccessor(b);if(!1===this.isLegEmpty(c)||0===b)this.updateLegState(b),c=this.validateLeg(b),!0!==c&&(a=a.concat(c))}return a=
a.concat(this.parent.getTravelerValidationMessages())},validateLeg:function(a){var b=this.legStates[a];a+=1;var c=[],d=this.utils.getMultipleAirportCodes(b.origin)||this.utils.getAirportCode(b.originCode),f=this.utils.getMultipleAirportCodes(b.destination)||this.utils.getAirportCode(b.destinationCode),c=c.concat(this.parent.getLocationValidationMessages(a,d,f));return c=c.concat(this.parent.getDateValidationMessages(a,!0,b.depart_date,null))},serialize:function(){var a={};this.parent.serializeTravelers(a);
a.isMulticity=!0;for(var b=0,c=g.config.getBoolean("ui.flights.userhistory.usefulllocationcode",!0),d=g.config.getBoolean("ui.flights.mc.useMultiApCode",!0),f,h=0;h<=this.indexLastVisibleLeg;h++){var e=this._legAccessor(h);!1===this.isLegEmpty(e)&&(this.updateLegState(h),e=this.legStates[h],c?(a["origin"+b]=a["origincode"+b]=e.originCode,a["destination"+b]=a["destinationcode"+b]=e.destinationCode):(a["origin"+b]=a["origincode"+b]=this.utils.getAirportCode(e.originCode),a["destination"+b]=a["destinationcode"+
b]=this.utils.getAirportCode(e.destinationCode)),a["originLocation"+b]=e.origin,a["destinationLocation"+b]=e.destination,d&&((f=this.utils.getMultipleAirportCodes(e.origin))&&(a["origin"+b]=a["origincode"+b]=f),(f=this.utils.getMultipleAirportCodes(e.destination))&&(a["destination"+b]=a["destinationcode"+b]=f)),a["nearby_origin"+b]=e.nearby_origin,a["nearby_destination"+b]=e.nearby_destination,f=e.depart_date,a["depart_date"+b]=l(f).format(g.globals.apiDateFormat),a["depart_date_canon"+b]=l(f).format("YYYY-MM-DD"),
a["depart_time"+b]=e.depart_time,a["cabin_type"+b]=e.cabin_type,b+=1)}a.origin_location=a.originLocation0;a.origincode=a.origincode0;a.destination_location=a.destinationLocation0;a.destinationcode=a.destinationcode0;a.depart_date=a.depart_date0;a.nearby_origin=a.nearby_origin0;a.nearby_destination=a.nearby_destination0;a.nrLegs=b;return a},isLegEmpty:function(a){return this.utils.isEmpty(a.originCode())&&this.utils.isEmpty(a.destinationCode())&&this.utils.isEmpty(a.departDate())},buildSearchURL:function(a,
b){var c={cabinClass:a.cabin,adults:a.adults,seniors:a.seniors,youth:a.youth,child:a.child,seatInfants:a.seatInfant,lapInfants:a.lapInfant,legData:[]};this.parent.options.showStudents&&(c.students=a.students);for(var d=0;d<a.nrLegs;d++){var f={};f.originId=a["origin"+d];f.destinationId=a["destination"+d];f.originLocation=a["originLocation"+d];f.destinationLocation=a["destinationLocation"+d];f.includeNearbyOrigin=a["nearby_origin"+d];f.includeNearbyDestination=a["nearby_destination"+d];f.departDate=
a["depart_date_canon"+d];f.departTime=a["depart_time"+d];f.legCabinClass=a["cabin_type"+d];c.legData[d]=f}this.utils.isEmpty(a.airlineFilter)||(c.airlineFilter=a.airlineFilter);return g.flights.search.FlightSearchFormUrls.generateMultiCityFlightsUrl(c,a.nrLegs,b)},_legAccessor:function(a){this.accessors[a]||(this.accessors[a]=this._makeLegAccessor(a));return this.accessors[a]},_makeLegAccessor:function(a){function b(b){return d.getChildElement(b+a)}function c(a,b){if(!a||!a.length)return!1;void 0!==
b&&f.utils.setCheckboxValue(a,b);return a[0].checked}var d=this.parent,f=this,h=new g.flights.search.FlightAirportField(d.getChildElement("origin"+a)),e=new g.flights.search.FlightAirportField(d.getChildElement("destination"+a));return{originField:h,destinationField:e,origin:function(a){return this.originField.val(a)},destination:function(a){return this.destinationField.val(a)},originCode:function(a){return this.originField.code(a)},destinationCode:function(a){return this.destinationField.code(a)},
departDate:function(a){if(d.options.useLegacyDatePicker){var c=b("depart_date").getWidget();void 0!==a&&c.setStartDate(a);return c.getStartDate()}c=b("departDate").getWidget();void 0!==a&&c.setDate(a);return c.getDate()},departTime:function(a){var c=b("depart_time").getWidget();if(!c)return"";void 0!==a&&c.setValue(a);return c.getValue()},cabinType:function(a){var c=b("cabin_type").getWidget();if(!c)return"";void 0!==a&&c.setValue(a);return c.getValue()},nearbyOrigin:function(a){return c(b("nearbyOriginCheck"),
a)},nearbyDestination:function(a){return c(b("nearbyDestinationCheck"),a)},visible:function(a){var c=b("js-multiCityLeg");!1!==a?(c.removeClass("js-hiddenLeg"),c.find("input").first().focus(),d.swapClasses(c,"SearchForm--hidden","col-leg")):(c.addClass("js-hiddenLeg"),d.swapClasses(c,"col-leg","SearchForm--hidden"));return!c.hasClass("js-hiddenLeg")}}},setupLeg:function(a,b){function c(a,b){var c=l(a._legAccessor(b).departDate());if(null!=c)for(b+=1;b<h.options.maxLegs;b++){var d=a._legAccessor(b),
e=l(d.departDate());null!=e&&e.isBefore(c)&&d.departDate(null)}}function d(b){var c,d;for(d=a-1;0<=d;d--)if(c=e._legAccessor(d).departDate(),null!=c){h.options.useLegacyDatePicker?b.minDate=c:b.setMinDate(c);break}}var f=this._legAccessor(a),h=this.parent,e=this;if(h.options.useLegacyDatePicker){var g=h.getChildElement("depart_date"+a);h.bindDaterangePicker(g,null,{getFormData:function(){var b=e.serialize();return{vertical:"flights",origin:b["origincode"+a],destination:b["destinationcode"+a],isOneWay:b.oneway}},
useDaysFormat:!0,singleDateMode:!0,singlePickerWithSingleField:!0,minDateFunc:d,change:function(){e.triggerChangeDepartDate(this.getStartDate(),a);c(e,a)},skipForceSetDefaultStartOnFocusBlur:!0});g.getWidget().singleDateMode=!0;if(0===a||null!=b.departDate)b.depart_date=null!=b.departDate?l(b.departDate):g.getWidget().getStartDate()}else if(g=h.getChildElement("departDate%s".format(a)).getWidget(),h.bindDaterangePicker(g,null,{getFormData:function(){var b=e.serialize();return{vertical:"flights",origin:b["origincode"+
a],destination:b["destinationcode"+a],isOneWay:b.oneway}},minDateFunc:d,change:function(b){e.triggerChangeDepartDate(b.date,a);c(e,a)}}),0===a||null!=b.departDate)b.depart_date=null!=b.departDate?l(b.departDate):g.date;g=h.getChildElement("depart_time"+a);this.utils.bindDropdown(g,function(b){e.triggerChangeDepartTime(b.value,a);h.vsLog("multicity/choosetime/"+b.value);h.gaLog("select-multicitytime")});this.utils.bindCheckbox(h.getChildElement("nearbyOriginCheck"+a),function(b){e.triggerChangeNearbyOrigin(b,
a);h.vsLog("location/addnearby/"+(b?"on":"off"));h.gaLog("add-nearby",b?"on-"+f.origin():"off-"+f.origin())});this.utils.bindCheckbox(h.getChildElement("nearbyDestinationCheck"+a),function(b){e.triggerChangeNearbyDestination(b,a);h.vsLog("location/addnearby/"+(b?"on":"off"));h.gaLog("add-nearby",b?"on-"+f.destination():"off-"+f.destination())});g=h.getChildElement("cabin_type"+a);this.utils.bindDropdown(g,function(b){e.triggerChangeLegCabinType(b.value,a);h.vsLog("multicity/chooselegcabintype/"+b.value);
h.gaLog("select-multicitytlegcabintype")});["removeLegTop","removeLegBottom"].forEach(function(b){h.getChildElement(b+a).click(function(){e.triggerRemoveLeg(a)})},this);h.getChildElement("js-removeLeg"+a).click(function(){e.triggerRemoveLeg(a)});h.getChildElement("js-removeLegMobile"+a).click(function(){e.triggerRemoveLeg(a)});h.getChildElement("js-removeLegTablet"+a).click(function(){e.triggerRemoveLeg(a)});var g=function(a,b){return function(c){b.triggerChangeOrigin({location:c.location,code:c.code,
leg:a})}}(a,e),m=function(a,b){return function(c){b.triggerChangeDestination({location:c.location,code:c.code,leg:a})}}(a,e),n=function(a,b){return function(c){b.triggerChangeNearbyOrigin(c,a)}}(a,e),p=function(a,b){return function(c){b.triggerChangeNearbyDestination(c,a)}}(a,e);h.bindFlightSmartyFields({field:f.originField,isOrigin:!0,changeCallback:g,nearbyFormCallback:n,beforeStartCallback:function(a){var b=null;a=a.inputEl.prop("id").match(/^.*?-(?:destination|origin)(\d+)/);2===a.length&&(a=
parseInt(a[1]),0<a&&(b=e._legAccessor(a-1)));return function(a,c){a.elementNode.value||c&&(8===c.keyCode||46===c.keyCode)||!b||(c=f.originField.codeEl,a.elementNode.value=b.destination(),c.val(b.destinationCode()),a.elementNode.focus(),k(this).select())}},noHistory:!0,isMulticity:!0});h.bindFlightSmartyFields({field:f.destinationField,isOrigin:!1,changeCallback:m,nearbyFormCallback:p,noHistory:!0,isMulticity:!0});e.setLegWidgetValues(a,b)},setup:function(){var a=this,b=this.parent;if(0===this.legStates.length)for(var c=
0;c<this.maxLegs;c++)this.legStates.push(k.extend({},this.backFromRP&&c<this.defaultLegState.length?this.defaultLegState[c]:this.legState)),this.setupLeg(c,this.legStates[c]);this.searchForm.closest(".viewport").find(".content");this.addMoreLegsLink.click(function(b){a.triggerAddLeg();b.preventDefault?b.preventDefault():b.returnValue=!1});this.clearAllLink.keypress(function(b){b.preventDefault();switch(b.which){case g.globals.keyCodes.SPACE:case g.globals.keyCodes.RETURN:a.clearAllLink.click()}});
this.clearAllLink.click(function(b){for(var c=0;c<=a.indexLastVisibleLeg;c++){var d=a.legStates[c];d.origin="";d.originCode="";d.destination="";d.destinationCode="";d.depart_date="";d.depart_time="";d.cabin_type="";d.nearby_origin="";d.nearby_destination="";a.setLegWidgetValues(c,d)}b.preventDefault()});b.subscribe(b.events.multiOrigin,this.multiProxyEventCallback(this.onChangeOrigin,this));b.subscribe(b.events.multiDestination,this.multiProxyEventCallback(this.onChangeDestination,this));b.subscribe(b.events.multiDepartDate,
this.multiProxyEventCallback(this.onChangeDepartDate,this));b.subscribe(b.events.multiDepartTime,this.multiProxyEventCallback(this.onChangeDepartTime,this));b.subscribe(b.events.multiNearbyOrigin,this.multiProxyEventCallback(this.onChangeNearbyOrigin,this));b.subscribe(b.events.multiNearbyDestination,this.multiProxyEventCallback(this.onChangeNearbyDestination,this));b.subscribe(b.events.multiLegCabinType,this.multiProxyEventCallback(this.onChangeLegCabinType,this));b.subscribe(b.events.multiRemoveLeg,
this.multiProxyEventCallback(this.onRemoveLeg,this));b.subscribe(b.events.multiAddLeg,this.multiProxyEventCallback(this.onAddLeg,this));this.initialized=!0},multiProxyEventCallback:function(a,b){var c=this.parent;return c.proxyEventCallback(a,b,function(a){return c.id()===a.id||!0===c.options.sync&&(0===a.legIndex||c.options.mixedCabinsUI&&1===a.legIndex)},function(){return!1})},activate:function(){var a=this.parent;this.initialized||this.setup();for(var b=0;b<this.indexLastVisibleLeg;b++)if("any"===
this._legAccessor(b).destinationCode()){var c=this.legStates[b];c.destination="";c.destinationCode="";this.setLegWidgetValues(b,c)}this.searchForm.attr("aria-hidden","false");a.swapClasses(this.searchForm,"SearchForm--hidden","SearchForm--visible")},initState:function(){for(var a=0;a<(this.backFromRP?this.defaultLegState.length:this.maxLegs);a++)this.triggerChangeOrigin({location:void 0,code:void 0,leg:a}),this.triggerChangeDestination({location:void 0,code:void 0,leg:a}),this.triggerChangeDepartDate(void 0,
a),this.triggerChangeDepartTime(void 0,a),this.triggerChangeNearbyOrigin(void 0,a),this.triggerChangeNearbyDestination(void 0,a)},onChangeOrigin:function(a){var b=this._legAccessor(a.legIndex);b.origin(a.originLocation);b.originCode(a.originCode);0===a.originCode.length&&a.originLocation.match(/^[A-z]{3}$/)&&b.originCode(a.originLocation);a=this.legStates[a.legIndex];a.origin=b.origin();a.originCode=b.originCode()},triggerChangeOrigin:function(a){a=a||{};var b=k.extend({},this.parent.eventDataTemplate),
c=this._legAccessor(a.leg);b.originLocation=this.utils.valOrDefault(a.location,function(){return c.origin()});b.originCode=this.utils.valOrDefault(a.code,function(){return c.originCode()});b.legIndex=a.leg;b.refreshNearby=!(""===a.location&&""===a.code);b.isDestinationFocusSkipped=a.isDestinationFocusSkipped;g.events.publish(this.parent.events.multiOrigin,b);0===a.leg&&g.events.publish(this.parent.events.rtowOrigin,b);a.location&&(this.parent.vsLog("location/origin"),this.parent.gaLog("select-origin"))},
onChangeDestination:function(a){var b=this._legAccessor(a.legIndex);b.destination(a.destinationLocation);b.destinationCode(a.destinationCode);0===a.destinationCode.length&&a.destinationLocation.match(/^[A-z]{3}$/)&&b.destinationCode(a.destinationLocation);a=this.legStates[a.legIndex];a.destination=b.destination();a.destinationCode=b.destinationCode()},triggerChangeDestination:function(a){a=a||{};var b=k.extend({},this.parent.eventDataTemplate),c=this._legAccessor(a.leg);b.destinationLocation=this.utils.valOrDefault(a.location,
function(){return c.destination()});b.destinationCode=this.utils.valOrDefault(a.code,function(){return c.destinationCode()});b.legIndex=a.leg;b.refreshNearby=!(""===a.location&&""===a.code);g.events.publish(this.parent.events.multiDestination,b);0===a.leg&&g.events.publish(this.parent.events.rtowDestination,b);a.location&&(this.parent.vsLog("location/destination"),this.parent.gaLog("select-destination"))},onChangeDepartDate:function(a){var b=this._legAccessor(a.legIndex);b.departDate(a.departDate);
this.legStates[a.legIndex].depart_date=b.departDate()},triggerChangeDepartDate:function(a,b){var c=k.extend({},this.parent.eventDataTemplate),d=this._legAccessor(b);c.departDate=this.utils.valOrDefault(a,function(){return d.departDate()});c.legIndex=b;g.events.publish(this.parent.events.multiDepartDate,c)},onChangeDepartTime:function(a){var b=this._legAccessor(a.legIndex);b.departTime(a.departTime);this.legStates[a.legIndex].depart_time=b.departTime()},triggerChangeDepartTime:function(a,b){var c=
k.extend({},this.parent.eventDataTemplate),d=this._legAccessor(b);c.departTime=this.utils.valOrDefault(a,function(){return d.departTime()});c.legIndex=b;g.events.publish(this.parent.events.multiDepartTime,c)},onChangeLegCabinType:function(a){var b=this._legAccessor(a.legIndex);b.cabinType(a.cabinType);this.legStates[a.legIndex].cabin_type=b.cabinType()},triggerChangeLegCabinType:function(a,b){var c=k.extend({},this.parent.eventDataTemplate),d=this._legAccessor(b);c.cabinType=this.utils.valOrDefault(a,
function(){return d.cabinType()});c.legIndex=b;g.events.publish(this.parent.events.multiLegCabinType,c)},updateNonMcSearchFormCabinClasses:function(a){var b=this,c={};this.legStates.forEach(function(a,d){d=b._legAccessor(d);!b.isLegEmpty(d)&&a.cabin_type&&(c[a.cabin_type]=(c[a.cabin_type]||0)+1)});var d=Object.keys(c);if(0<d.length){var d=d.sort(function(a,b){return c[a]-c[b]}),f=d[d.length-1];1<d.length&&c[d[0]]===c[d[1]]&&(f=this.legStates[0].cabin_type);g.events.publish(this.parent.events.cabinType,
{cabinType:f,id:a.id},1<d.length&&c[d[0]]===c[d[1]])}},updateAllLegsToCabinType:function(a){var b=this;this.legStates.forEach(function(c,d){a.legIndex=d;b.onChangeLegCabinType(a)})},onChangeNearbyOrigin:function(a){var b=this._legAccessor(a.legIndex);b.nearbyOrigin(a.includeNearbyOrigin);this.legStates[a.legIndex].nearby_origin=b.nearbyOrigin()},triggerChangeNearbyOrigin:function(a,b,c){var d=k.extend({},this.parent.eventDataTemplate),f=this._legAccessor(b);d.includeNearbyOrigin=this.utils.valOrDefault(a,
function(){return f.nearbyOrigin()});d.legIndex=b;g.events.publish(this.parent.events.multiNearbyOrigin,d);c&&this._legAccessor(b).originField.getSmarty().setIsNearbyChecked(d.includeNearbyOrigin)},onChangeNearbyDestination:function(a){var b=this._legAccessor(a.legIndex);b.nearbyDestination(a.includeNearbyDestination);this.legStates[a.legIndex].nearby_destination=b.nearbyDestination()},triggerChangeNearbyDestination:function(a,b,c){var d=k.extend({},this.parent.eventDataTemplate),f=this._legAccessor(b);
d.includeNearbyDestination=this.utils.valOrDefault(a,function(){return f.nearbyDestination()});d.legIndex=b;g.events.publish(this.parent.events.multiNearbyDestination,d);c&&this._legAccessor(b).destinationField.getSmarty().setIsNearbyChecked(d.includeNearbyDestination)},onRemoveLeg:function(a){this.removeLeg(a.legIndex);this.parent.recalculateDialogDimensions()},triggerRemoveLeg:function(a){var b=k.extend({},this.parent.eventDataTemplate);b.legIndex=a;g.events.publish(this.parent.events.multiRemoveLeg,
b)},onAddLeg:function(a){this.addLeg();this.parent.recalculateDialogDimensions()},triggerAddLeg:function(){var a=k.extend({},this.parent.eventDataTemplate);g.events.publish(this.parent.events.multiAddLeg,a)},teardown:function(){this.accessors=null}}))})(window.R9,window.jQuery,window.moment,window.base2.Base);(function(c,d){var f=c.config.getBoolean("ui.horizon.searchForm.includePageTypeCookie",!0);c.createComponentClass("base.search.SearchForm",{vertical:null,searchForm:null,submitButton:null,errorContainer:null,searchFormFilterState:null,animationInterval:null,timers:{selectAll:null},options:{loadCmp2WhenVisible:!1,suppressCmp2s:!1,cleanUpInputFieldOnFocus:!1,useCmp2Submit:!0,navigateToResults:!1,pageOrigin:"",useHistory:!0,inlineErrorEnabled:!1,sync:!0,forceSearchFormSubmit:!1,loggingPrefix:"",isSeo:!1,
isCmp2Tooltip:!1,autofocusViaJs:!1,multiSearcherEnabled:!1,useSelectWidget:!1,useDialogQuestions:!1,displayDateFormat:"MMM D",enableSmartyRemoteHide:!1,hasSubscriptionPanel:!1,formChangedClass:"formChangedState",singlePulseAnimation:!1,showTopDestinations:!1,continents:[],smartyInnerScrollEnabled:!1,smartyUIUpdateEnabled:!1,searchFormFilterState:null,useStyleJamInlineSearchButton:!1,useMultipleSubmitIds:!1},didUpdateHistory:!1,localHistory:null,isSubmitted:!1,consentGranted:!1,init:function(a){this.searchForm=
this.element.find(".searchform");this.submitButton=this.options.useMultipleSubmitIds?this.getChildElements("submit,submit-multi"):this.getChildElement("submit");this.errorContainer=this.getChildElement("error");this.searchFormFilterState=this.options.searchFormFilterState},addEventHandlers:function(){var a=this;this.bindLocalHistory();this.bindSelectTextOnFocus();this.loadFromStorage();this.options.useStyleJamInlineSearchButton&&this.registerEvent("click",this.submitButton,function(){a.searchForm.submit();
return!0});this.searchForm.on("submit",function(b){b.preventDefault();a.trackSubmitEvent();return a.onSubmit(b)});c.events.subscribe("search.form.clear",d.proxy(this.onClear,this));c.events.subscribe("common.compareto.focusout",{id:this.id()+"-compareTo"},function(){a.submitButton.focus()})},enableSearchButton:function(){this.submitButton.prop("disabled",!1).attr("aria-disabled",!1);this.isSubmitted=!1},disableSearchButton:function(){this.submitButton.prop("disabled",!0).attr("aria-disabled",!0);
this.isSubmitted=!0},inlineComponentsReady:function(){c.events.publish("searchform.initialized",this);this.loadCompareToItems();if(this.options.autofocusViaJs){var a=this;setTimeout(function(){a.autofocus()},10)}},loadCompareToItems:function(){var a=this;if(!c.config.getBoolean("ui.cmp2.searchform.defer",!0)||!this.deferCmp2Id&&this.deferCmp2Init)if(this.isEnoughInformationForCompareToRequest()){var b=this.serialize()||{};b.relativeUrl=!0;var e=this.buildSearchURL(b);b.id=this.id()+"-compareTo";b.url=
e;b.vertical=this.vertical;c.events.publish("cmp2.getItems",b);c.events.publish("search.form.clear",this.id())}else c.events.publish("cmp2.cleanUp",{id:this.id()+"-compareTo"});else this.deferCmp2Init=1,this.deferCmp2Id&&clearTimeout(this.deferCmp2Id),this.deferCmp2Id=setTimeout(function(){clearTimeout(a.deferCmp2Id);a.deferCmp2Id=null;a.loadCompareToItems()},100)},shouldUpdate:function(a){a=a||{};return this.options.sync||this.id()===a.id},updateLogging:function(a){a.loggingPrefix&&a.loggingPrefix!==
this.options.loggingPrefix&&(this.options.loggingPrefix=a.loggingPrefix)},getCompareToFormData:function(){return{}},isEnoughInformationForCompareToRequest:function(){return!1},serialize:function(){return{tab:this.vertical,pageOrigin:this.options.pageOrigin,src:"",searchingAgain:"",c2s:"",po:"",personality:"",provider:"-1",searchFormFilterState:this.getSearchFormFilterState(),pageType:f?this.getPageType():null}},load:function(a){},buildSearchURL:function(a){},onClear:function(){this.clearErrors()},
clearErrors:function(){this.errorContainer.html("")},validate:function(){return!1},isValid:function(){var a=this.validate();return!a||!a.length},showError:function(a){if(this.options.inlineErrorEnabled)if(0<this.errorContainer.length)this.errorContainer.html(a),c.events.publish("search.submit.error",this.errorContainer);else throw"Missing container with id: "+this.id("error");else c.events.publish("error.alert",{messages:a})},onSubmit:function(a){if(this.isSubmitted)return!1;this.clearErrors();this.disableSearchButton();
if((a=this.validate())&&a.length)return this.enableSearchButton(),this.showError(a),!1;this.saveToStorage(!0);c.storage.set("search_submit_pageId",c.globals.analytics.pageId);a=this.serialize()||{};a.vertical=this.vertical;a.url=this._generate(a);a.id=this.id();this.triggerConsentGranted();this.publishSubmitEvent(a);return!1},triggerConsentGranted:function(){c.config.getBoolean("ui.gtm.useConsent",!1)&&c.config.getBoolean("ui.consent.submit.publish",!0)&&!this.consentGranted&&(this.consentGranted=
!0,c.events.publish("consent.granted"))},notValidSubscription:function(){return!0===this.options.hasSubscriptionPanel?c.question.ask("email.subscription.validate."+this.id("subscription-panel")):!1},submitSubscription:function(){return!0===this.options.hasSubscriptionPanel?c.question.ask("email.subscription.submit."+this.id("subscription-panel")):!0},publishSubmitEvent:function(a){var b;b=this.options.multiSearcherEnabled?"multilocale.search.submit":this.options.useCmp2Submit&&!this.options.forceSearchFormSubmit?
"cmp2.submit":"searchform.submit";a.navigateToResults=this.options.navigateToResults;c.events.publish(b,a)},bindSelectTextOnFocus:function(){var a=this;this.searchForm.find("input.selectTextOnFocus").on("focus.selectAll",function(){a.selectInput(this)});var b=this.searchForm.find("input[autofocus]");b.length&&a.selectInput(b.get(0))},selectInput:function(a){if(!d(a).data("disabledSelect")){var b=this;clearTimeout(this.timers.selectAll);this.timers.selectAll=window.setTimeout(function(){a.select();
b.options.cleanUpInputFieldOnFocus&&(a.value="")},50)}},bindLocalHistory:function(){var a=this;this.didUpdateHistory=!1;this.localHistory=new c.common.utils.history.UserHistory({tab:a.vertical,persistLocalStorage:!0,onSave:function(){a.didUpdateHistory||a.saveToStorage(!1)}})},trackSubmitEvent:function(){c.Analytics.api.trackEvent("%s/searchform/submit".format(this.options.loggingPrefix))},getCookieData:function(){var a=this.serialize(),b={page_origin:a.pageOrigin,src:a.src,searchingagain:a.searchingAgain,
c2s:a.c2s,po:a.po,personality:a.personality,provider:a.provider};f&&(b.pageType=a.pageType);return b},getPageType:function(){var a;a=c.question.ask("SearchPage.view");a||(a=(a=c.globals.analytics&&c.globals.analytics.pageId)?"results"===a?"RP":"FD":data.pageOrigin.contains(".FD")?"FD":"RP");return a},getSearchFormFilterState:function(){return d.extend({},this.searchFormFilterState)},_generate:function(a){a=this.buildSearchURL(a);this.setCookies(a);return a},setCookies:function(a){var b=this.getCookieData();
b.id=this.id();c.events.publish("update.cookies",b);document.cookie=this._generateCookie(a,this.vertical,b)},_generateCookie:function(a,b,c){if(""!==a){b="/"+b+"/";var e=encodeURIComponent(a.substring(a.indexOf(b)+b.length));0>a.indexOf(b)&&(e=encodeURIComponent(a.substring(a.indexOf("/",1)+1)));a="hiddenParams"+e;b=new Date;e=b.getTime();b.setTime(e+3E4);c=encodeURIComponent(decodeURIComponent(d.param(c)));return a+"\x3d"+c+"; expires\x3d"+b.toGMTString()+"; path\x3d/"}},getStorageProps:function(){return null},
getStorageExceptions:function(){return null},loadFromStorage:function(){this.loadingHistory=!0;this.options.useHistory&&this.localHistory.wasLastUsedPage&&this.loadFromHistory(this.localHistory.getRecentHistory());this.loadingHistory=!1},loadFromHistory:function(a){this.load(d.extend({},{id:this.id()},a))},saveToStorage:function(a){this.didUpdateHistory=!0;if(a){a=this.serialize()||{};var b=this.getStorageProps()||{},c=this.getStorageExceptions()||[],g={};b||(b=d.map(a,function(a,b){return b}));c&&
d.map(c,function(a){a=d.inArray(a,b);0<=a&&b.splice(a,1)});for(c=0;c<b.length;c++)if(a.hasOwnProperty(b[c])){var h=b[c],f=a[h];this.localHistory.set(h,f);g[h]=f}d.isEmptyObject(g)||this.localHistory.pushSearchHistory(g)}},autofocus:function(){return null},isNull:function(a){return null===a},isUndefined:function(a){return"undefined"===typeof a},isEmpty:function(a){return this.isNull(a)||this.isUndefined(a)||"string"===typeof a&&""===a.trim()},destroy:function(){null!==this.animationInterval&&clearInterval(this.animationInterval);
this.base()},setFormChangedState:function(a){if(this.options.useStyleJamInlineSearchButton)return this.setStyleJamButtonActivation(a,this.id("submit"));c.events.publish("button.formChangedState",{changed:a});this.element.toggleClass(this.options.formChangedClass,a);this.options.singlePulseAnimation&&this.submitButton.toggleClass("pulse",a)},setStyleJamButtonActivation:function(a,b){c.events.publish(a?"button.activate":"button.deactivate",{id:b});this.options.singlePulseAnimation&&c.events.publish(a?
"button.pulse":"button.pulse.reset",{id:b})},checkAndSetDropdownSmartyInnerScrollOpts:function(a){this.options.smartyInnerScrollEnabled&&(a.boundToScreen=!0)},checkAndSetSmartyUIUpdateOpts:function(a){this.options.smartyUIUpdateEnabled&&(a.extendRequest={f:"j"},a.dropdownClass+=" ui-update-v1",a.smartyUIUpdateEnabled=!0)}})})(window.R9,window.jq||window.jQuery);(function(c,d,m){function t(a,b){a=r(a,b);b(a.getSelectedElement(),!0)}function r(a,b){var c;d(a).is(".Common-Widgets-Dropdown-StyleJamDropdown")?c=a.styleJamDropdown({change:function(){b(a.getWidget().getSelectedElement())}}).getWidget():d(a).is(".Common-Widgets-Select-StyleJamSelect")?(c=d(a).getWidget())&&c.setOption("change",function(){b(a.getWidget().getSelectedItem())}):c=a.dropdown({change:function(){b(a.getWidget().getSelectedElement())}}).getWidget();return c}function u(a,b){"boolean"===
typeof b&&a&&a[0]&&a[0].checked!==b&&a.click()}function v(a,b,c){if(a.length){var e=a.parent().is(".StyleJamCheckbox")?"styleJamCheckbox":"checkbox";a[e]({change:function(){b.call(c,this.checked)}})}}function n(a,b){return null===a||"undefined"===typeof a?"function"===typeof b?b():b:a}function p(a){return a&&(-1!==a.indexOf("cy")||-1!==a.indexOf("cg"))}function w(a){return null!=a?q.exec(a)||p(a)?a:a.split("/")[0]:""}function x(a){a=(a||"").split(",");for(var b=[],c=/^[A-Z0-9]{3}$/i,e=0;e<a.length;e++){var k=
a[e].trim().toUpperCase();if(c.test(k))b.push(k);else return""}return b.join(",")}var q=/[0-9]+[fr]{1,2}/;c.createComponentClass("flights.search.StyleJamFlightSearchForm","base.search.SearchForm",{vertical:"flights",loggingPrefix:"Search-Form",formQuestion:"flights.fd.searchform",display:null,inline:!1,inlineViewOnly:!1,controllers:{},activeFormController:null,lapInfantWarning:null,travelerTypes:null,options:{cmp2LimitDisplay:!1,slideCMP2:!1,flareSmartyType:1,smartyUrl:"/mv/marvel",autoOpenNextField:!1,
showSmartyHistory:!1,isNearbyInSmarty:!1,allAirportsLocalizedText:"",airlineFilter:void 0,showAnywhere:!1,anywhereIfEmpty:!1,toggleLinks:!0,toggleSwap:!1,toggleField:!1,useMultiCityInFD:!1,multicityEnabled:!0,useLegacyDatePicker:!0,showAnywherePopupEnabled:!1,isFdForm:!1,regionSearch:!1,regionSearchEnabled:!1,autoNearbyEnabled:!1,mixedCabinsUI:!1,ajaxOrigin:!1,travelersAboveForm:!1,stageAreaEnabled:!1,stageDepartDefault:"",stageDepartOneWay:"",stageReturnDefault:"",stageReturnOneWay:"",dialog:!1,
focusIndicationClass:"",showFocusIndication:!1,regionDisplayAirportPicker:!1,useSwindle:!1,ignoreSticky:!1,isBusinessMode:!1,airportMultiSelect:!1,delayHistoryLoad:!1,newSearchHeaderDesign:!1,originAirportMultiSelections:[],destinationAirportMultiSelections:[]},isRegionSearchSupported:!1,state:{travelers:0,cabin:"e",adults:0,seniors:0,child:0,youth:0,seatInfant:0,lapInfant:0,students:0},eventDataTemplate:{id:null},events:{rtowOrigin:"flights.search.rtow.form.origin",rtowDestination:"flights.search.rtow.form.destination",
rtowDateRange:"flights.search.rtow.form.dateRange",rtowNearbyOrigin:"flights.search.rtow.form.nearbyOrigin",rtowNearbyDestination:"flights.search.rtow.form.nearbyDestination",rtowLengthOfStay:"flights.search.rtow.form.lengthOfStay",multiOrigin:"flights.search.multi.form.origin",multiDestination:"flights.search.multi.form.destination",multiDepartDate:"flights.search.multi.form.departDate",multiDepartTime:"flights.search.multi.form.departTime",multiNearbyOrigin:"flights.search.multi.form.nearbyOrigin",
multiNearbyDestination:"flights.search.multi.form.nearbyDestination",multiLegCabinType:"flights.search.multi.form.legCabinType",multiAddLeg:"flights.search.multi.form.addLeg",multiRemoveLeg:"flights.search.multi.form.removeLeg",cabinType:"flights.search.rtow.form.cabinType",travelerCount:"flights.search.rtow.form.travelerCount",displayCat:"flights.search.rtow.form.displayCat",searchError:"search.submit.error",stickyFormState:"flights.search.form.sticky.toggle"},travelerDialogClass:"Flights-Frontdoor-TravelersDialog-Content",
stateInitialized:!1,defaultSeparateIconAndTextButtonClass:"SeparateIconAndTextButton",stickySeparateIconAndTextButtonClass:"SeparateIconAndTextButton--sticky",init:function(a){this.base.apply(this,arguments);this.options.slideCMP2&&(this.originCountry=this.options.originCountryCode);this.options.showAnywhere=this.options.showAnywhere&&!d(".Sem-Common-Layout-SEMStandardBody").length;this.errorContainer.length||(this.errorContainer=d("."+this.id("error"),this.element));this.state=d.extend({},this.state);
this.eventDataTemplate=d.extend({},this.eventDataTemplate);this.eventDataTemplate.id=this.id();this.display=this.options.display;!this.options.advancedFiltersEnabled&&!this.options.showBaggageDropdown||this.searchFormFilterState||(this.searchFormFilterState={});this.bindShowAirportMapLinks();this.bindDisplayCat();this.controllers=this.createSubControllers();this.bindOpenNextFieldEvents();this.initActiveFormController();this.setupChildControllers();this.isRegionSearchSupported=-1<c.config.getString("ui.flights.smarty.regionEnabled",
"32,51,58,72,77").split(",").indexOf(""+this.options.flareSmartyType);this.lapInfantWarning=this.getChildElement("infantInLapWarning");this.studentCheckbox=this.getChildElement("student");this.studentCheckbox.length&&this.studentCheckbox.styleJamCheckbox()},inlineComponentsReady:function(){this.base.apply(this,arguments);this.initState();this.loadCompareToItems();this.options.ajaxOrigin&&this.checkOriginForUpdate();c&&c.globals&&c.globals.isSeo&&this.checkForValidDates();this.loadSlideCMP2()},addEventHandlers:function(){this.base.apply(this,
arguments);this.subscribe(["flights.frontdoor.form.all","cmp2.form.fill"],this.proxyEventCallback(this.onChangeTriggerData,this));this.subscribe(this.events.cabinType,this.proxyEventCallback(this.onChangeCabinType,this));this.subscribe(this.events.travelerCount,this.proxyEventCallback(this.onChangeTravelers,this));this.subscribe(this.events.displayCat,this.proxyEventCallback(this.onChangeDisplayCat,this));this.subscribe(this.events.searchError,this.proxyEventCallback(this.onSearchError,this));var a=
0;this.subscribe("flights.search.travelers.init."+this.id(),function(b){a++;!this.options.travelersAboveForm&&2!==a&&this.options.multicityEnabled||this.setupTravelersAndCabin()}.bind(this));var b=this;this.subscribe("DropdownDialog.open",function(a){var c=d(".FlightSearchDialogWidget");!c.length||a.id!==b.id("multi-travelers")&&a.id!==b.id("travelers")||c.find(".viewport").animate({scrollTop:d("#"+a.id).offset().top-c.find(".content").offset().top+.12*c.find(".viewport").height()},500)});this.subscribe("intentmedia.submit.handler",
d.proxy(this.onHookSubmitForIntentMedia,this));this.options.dialog||this.answer(this.formQuestion,function(){return b.serialize()});this.subscribe("flights.search.AnywhereSearchDialog.search.click",function(){b.vsLog("/nodestination/click/search")});this.subscribe("flights.search.AnywhereSearchDialog.explore.click",function(){b.vsLog("/nodestination/click/anywhere")});this.subscribe("omni.vertical.changed",function(a){"flights"===a&&b.focusFirstElement()});this.studentCheckbox.getWidget()&&this.studentCheckbox.getWidget().setOption("click",
function(){var a=this.getValue();b.vsLog("/student/"+(a?"checked":"unchecked"));window.setMetaCookie("isStudent",a?"true":"false")});if(this.options.slideCMP2){var f=this;this.subscribe([this.events.cabinType,this.events.travelerCount,this.events.displayCat,this.events.searchError,this.events.rtowOrigin,this.events.rtowDestination,this.events.rtowDateRange,this.events.rtowNearbyOrigin,this.events.rtowNearbyDestination,this.events.rtowLengthOfStay,"flights.frontdoor.form.all","cmp2.form.fill"],function(){f.enableSearchButton()})}d(".js-addMoreLegs",
this.element).on({mouseenter:function(){c.dom.swapClasses(d("button",this),c.stylejam.common.widgets.button.StyleJamButton.plusButtonInactive,c.stylejam.common.widgets.button.StyleJamButton.plusButtonActive)},mouseleave:function(){c.dom.swapClasses(d("button",this),c.stylejam.common.widgets.button.StyleJamButton.plusButtonActive,c.stylejam.common.widgets.button.StyleJamButton.plusButtonInactive)}});this.getChildElement("js-removeLeg").on("click",function(a){var c=d(".js-multiCityLeg",b.element).not(".js-hiddenLeg").last().index();
0!==c&&(b.controllers.multi.triggerRemoveLeg(c),a=d(a.currentTarget),1===c?b.swapClasses(a,"SearchForm--visible","SearchForm--hidden"):b.swapClasses(a,"SearchForm--hidden","SearchForm--visible"))});this.subscribe("flights.search.multi.form.removeLeg",function(a){b.adjustFormClass.call(b)});this.subscribe("flights.search.multi.form.addLeg",function(a){b.swapClasses(b.getChildElement("js-removeLeg"),"SearchForm--hidden","SearchForm--visible");b.adjustFormClass.call(b)});this.subscribe(this.events.stickyFormState,
function(a){if(["rising","rising-mono-grey-without-large"].includes(b.options.presentation)){var f=b.getChildElement("origin-col"),e=b.getChildElement("dest-col"),h=b.getChildElement("dates-col");a?(c.dom.swapClasses(b.getChildElement("fields"),c.stylejam.flights.search.StyleJamFlightSearchForm.defaultFieldGrid,c.stylejam.flights.search.StyleJamFlightSearchForm.stickyFieldGrid),"roundtrip"===b.display||"multicity"===b.display?(d(f).removeClass(c.stylejam.flights.search.StyleJamFlightSearchForm.stickyOneWayOriginCol),
c.dom.swapClasses(f,c.stylejam.flights.search.StyleJamFlightSearchForm.defaultOriginCol,c.stylejam.flights.search.StyleJamFlightSearchForm.stickyOriginCol),d(e).removeClass(c.stylejam.flights.search.StyleJamFlightSearchForm.stickyOneWayDestCol),c.dom.swapClasses(e,c.stylejam.flights.search.StyleJamFlightSearchForm.defaultDestCol,c.stylejam.flights.search.StyleJamFlightSearchForm.stickyDestCol),d(h).removeClass(c.stylejam.flights.search.StyleJamFlightSearchForm.stickyOneWayDatesCol),c.dom.swapClasses(h,
c.stylejam.flights.search.StyleJamFlightSearchForm.defaultDatesCol,c.stylejam.flights.search.StyleJamFlightSearchForm.stickyDatesCol)):"oneway"===b.display&&(d(f).removeClass(c.stylejam.flights.search.StyleJamFlightSearchForm.stickyOriginCol),c.dom.swapClasses(f,c.stylejam.flights.search.StyleJamFlightSearchForm.defaultOneWayOriginCol,c.stylejam.flights.search.StyleJamFlightSearchForm.stickyOneWayOriginCol),d(e).removeClass(c.stylejam.flights.search.StyleJamFlightSearchForm.stickyDestCol),c.dom.swapClasses(e,
c.stylejam.flights.search.StyleJamFlightSearchForm.defaultOneWayDestCol,c.stylejam.flights.search.StyleJamFlightSearchForm.stickyOneWayDestCol),d(h).removeClass(c.stylejam.flights.search.StyleJamFlightSearchForm.stickyDatesCol),c.dom.swapClasses(h,c.stylejam.flights.search.StyleJamFlightSearchForm.defaultOneWayDatesCol,c.stylejam.flights.search.StyleJamFlightSearchForm.stickyOneWayDatesCol)),c.dom.swapClasses(b.submitButton,c.stylejam.common.widgets.button.StyleJamButton.defaultSubmitBtn,c.stylejam.common.widgets.button.StyleJamButton.stickySubmitBtn),
c.dom.swapClasses(b.getChildElement("col-button-wrapper"),c.stylejam.flights.search.StyleJamFlightSearchForm.defaultButtonCol,c.stylejam.flights.search.StyleJamFlightSearchForm.stickyButtonCol),c.dom.swapClasses(b.getChildElement("col-switch"),c.stylejam.flights.search.StyleJamFlightSearchForm.defaultSwitchCol,c.stylejam.flights.search.StyleJamFlightSearchForm.stickySwitchCol),b.options.newSearchHeaderDesign&&c.dom.swapClasses(b.submitButton,b.defaultSeparateIconAndTextButtonClass,b.stickySeparateIconAndTextButtonClass),
b.getChildElement("compareToWrapper").hide(),c.events.publish("DatePicker.layout.compressed.toggle",!0)):(c.dom.swapClasses(b.getChildElement("fields"),c.stylejam.flights.search.StyleJamFlightSearchForm.stickyFieldGrid,c.stylejam.flights.search.StyleJamFlightSearchForm.defaultFieldGrid),"roundtrip"===b.display||"multicity"===b.display?(d(f).removeClass(c.stylejam.flights.search.StyleJamFlightSearchForm.stickyOneWayOriginCol),c.dom.swapClasses(f,c.stylejam.flights.search.StyleJamFlightSearchForm.stickyOriginCol,
c.stylejam.flights.search.StyleJamFlightSearchForm.defaultOriginCol),d(e).removeClass(c.stylejam.flights.search.StyleJamFlightSearchForm.stickyOneWayDestCol),c.dom.swapClasses(e,c.stylejam.flights.search.StyleJamFlightSearchForm.stickyDestCol,c.stylejam.flights.search.StyleJamFlightSearchForm.defaultDestCol),d(h).removeClass(c.stylejam.flights.search.StyleJamFlightSearchForm.stickyOneWayDatesCol),c.dom.swapClasses(h,c.stylejam.flights.search.StyleJamFlightSearchForm.stickyDatesCol,c.stylejam.flights.search.StyleJamFlightSearchForm.defaultDatesCol)):
"oneway"===b.display&&(d(f).removeClass(c.stylejam.flights.search.StyleJamFlightSearchForm.defaultOneWayOriginCol),c.dom.swapClasses(f,c.stylejam.flights.search.StyleJamFlightSearchForm.stickyOneWayOriginCol,c.stylejam.flights.search.StyleJamFlightSearchForm.defaultOneWayOriginCol),d(e).removeClass(c.stylejam.flights.search.StyleJamFlightSearchForm.defaultOneWayDestCol),c.dom.swapClasses(e,c.stylejam.flights.search.StyleJamFlightSearchForm.stickyOneWayDestCol,c.stylejam.flights.search.StyleJamFlightSearchForm.defaultOneWayDestCol),
d(h).removeClass(c.stylejam.flights.search.StyleJamFlightSearchForm.defaultOneWayDatesCol),c.dom.swapClasses(h,c.stylejam.flights.search.StyleJamFlightSearchForm.stickyOneWayDatesCol,c.stylejam.flights.search.StyleJamFlightSearchForm.defaultOneWayDatesCol)),c.dom.swapClasses(b.getChildElement("form-grid"),c.stylejam.flights.search.StyleJamFlightSearchForm.stickyFormGrid,c.stylejam.flights.search.StyleJamFlightSearchForm.defaultFormGrid),c.dom.swapClasses(b.submitButton,c.stylejam.common.widgets.button.StyleJamButton.stickySubmitBtn,
c.stylejam.common.widgets.button.StyleJamButton.defaultSubmitBtn),c.dom.swapClasses(b.getChildElement("col-button-wrapper"),c.stylejam.flights.search.StyleJamFlightSearchForm.stickyButtonCol,c.stylejam.flights.search.StyleJamFlightSearchForm.defaultButtonCol),c.dom.swapClasses(b.getChildElement("col-switch"),c.stylejam.flights.search.StyleJamFlightSearchForm.stickySwitchCol,c.stylejam.flights.search.StyleJamFlightSearchForm.defaultSwitchCol),b.options.newSearchHeaderDesign&&c.dom.swapClasses(b.submitButton,
b.stickySeparateIconAndTextButtonClass,b.defaultSeparateIconAndTextButtonClass),b.getChildElement("compareToWrapper").show(),c.events.publish("DatePicker.layout.compressed.toggle",!1))}});this.options.showFocusIndication&&this.subscribe("body.accessibilityMode.enabled",function(a){a?(c.dom.swapClasses(d(".js-addMoreLegs"),"",b.options.focusIndicationClass),c.dom.swapClasses(d(".js-clearLegs"),"",b.options.focusIndicationClass)):(c.dom.swapClasses(d(".js-addMoreLegs"),b.options.focusIndicationClass,
""),c.dom.swapClasses(d(".js-clearLegs"),b.options.focusIndicationClass,""))});this.options.useSwindle&&this.answer("flights.search.isSwindleEligibleQuery",this.canSwindleQuery.bind(this));c.config.getBoolean("ui.horizon.flights.frontdoor.inspirationPromotion",!1)&&!b.options.isBusinessMode&&this.subscribe("inspirationPromotion.destination.changed",function(a){b.updateFormFromInspirationData(a)});this.options.showBaggageDropdown&&this.subscribe("flights.search.baggageCounts.changed",this.updateBaggageCounts.bind(this))},
loadFromHistory:function(a){this.options.delayHistoryLoad?d(document).ready(this.base.bind(this,a)):this.base(a)},load:function(a){if(a){var b=this.controllers.rtow,f=this.controllers.multi;a.nearby_origin&&b.triggerChangeNearbyOrigin(a.nearby_origin,this.options.isNearbyInSmarty);a.nearby_destination&&b.triggerChangeNearbyDestination(a.nearby_destination,this.options.isNearbyInSmarty);a.hasOwnProperty("oneway")&&a.oneway&&(this.display="oneway");if(a.hasOwnProperty("isMulticity")&&a.isMulticity&&
this.options.toggleLinks){this.display=this.options.useMultiCityInFD?"rtow":"multicity";var e=a.nrLegs||f.indexLastVisibleLeg+1,k=0;if(f.maxLegs)for(var g=0;g<f.maxLegs&&a["origincode"+g]&&a["destinationcode"+g];g++)k++,f._legAccessor(g).visible(!0);k>e&&(e=k,f.indexLastVisibleLeg=k-1);k===f.maxLegs&&this.element.find(".js-addMoreLegs").hide();k=this.options.isNearbyInSmarty;for(g=0;g<e;g++){var h="depart_time"+g;a[h]&&f.triggerChangeDepartTime(a[h],g);h="nearby_origin"+g;a[h]&&f.triggerChangeNearbyOrigin(a[h],
g,k);h="nearby_destination"+g;a[h]&&f.triggerChangeNearbyDestination(a[h],g,k);var h="originLocation"+g,l="origincode"+g;a[h]&&a[l]?f.triggerChangeOrigin({location:a[h],code:a[l],leg:g}):0===g&&a.originLocation&&a.origincode&&f.triggerChangeOrigin({location:a.originLocation,code:a.origincode,leg:g});h="destinationLocation"+g;l="destinationcode"+g;a[h]&&a[l]?f.triggerChangeDestination({location:a[h],code:a[l],leg:g}):0===g&&a.destinationLocation&&a.destinationcode&&f.triggerChangeDestination({location:a.destinationLocation,
code:a.destinationcode,leg:g});h="depart_date_canon"+g;a[h]&&f.triggerChangeDepartDate(a[h],g);h="cabin_type"+g;a[h]&&f.triggerChangeLegCabinType(a[h],g)}}a.hasOwnProperty("depart_date_canon")&&a.depart_date_canon&&a.hasOwnProperty("return_date_canon")&&a.return_date_canon&&b.triggerChangeDateRange(a.depart_date_canon,a.return_date_canon);a.hasOwnProperty("searchFormFilterState")&&(this.searchFormFilterState=d.extend({},this.searchFormFilterState,a.searchFormFilterState),c.events.publish("searchform.loadForm.searchFormFilterState",
{searchFormFilterState:a.searchFormFilterState}),this.options.advancedFiltersEnabled&&this.controllers.rtow.loadAdvancedFilterState(this.searchFormFilterState))}},updateFormFromInspirationData:function(a){a&&(a=d.extend({},a,{id:this.element[0].id,pulse:!0,destinationCodeType:"ap",resetState:!0}),c.events.publish(this.events.rtowDestination,a))},updateCabinType:function(a){a.hasOwnProperty("cabin")&&a.cabin&&(c.events.publish("flights.search.cabinType.set",{namespace:this.id(),value:a.cabin}),this.options.travelersAboveForm||
c.events.publish("flights.search.travelers.refresh",{namespace:this.id()}))},bindOpenNextFieldEvents:function(){var a=this,b=!1;if(this.options.autoOpenNextField){var f=null,e=null,k=null,g=function(){var a=0;return function(){var b=Date.now(),c=b-a;a=b;return 250<c}}(),h=function(){!g()||b||a.options.phoenixRising&&c.utils.presentation.isMobile()&&c.globals.isSeo||(a.controllers.rtow.destinationModal?a.controllers.rtow.destinationModal.focus():a.controllers.rtow.destinationField.inputEl.focus());
b=!1},l=function(){g()&&(a.options.useLegacyDatePicker?a.controllers.rtow.daterangePicker.getWidget().startDisplay.trigger("mousedown"):a.controllers.rtow.departDate.focus())};this.subscribe(this.events.rtowOrigin,function(b){b.id!==a.element[0].id||b.odSwitch||(null==f?f=!!b.originCode:(f=!!b.originCode)&&!b.isDestinationFocusSkipped&&(k=setTimeout(h,10)))});this.options.ajaxOrigin&&this.subscribe(this.events.rtowOrigin,function(a){!this.options.dialog&&a.isDestinationFocusSkipped&&c.events.publish("flights.search.small.sticky.update")}.bind(this));
this.subscribe(this.events.rtowDestination,function(b){b.id===a.element[0].id&&(null!==k&&(clearTimeout(k),k=null),null==e?e=!!b.destinationCode:(e=!!b.destinationCode,b=a.options.useLegacyDatePicker?a.controllers.rtow.daterangePicker.getWidget().startInput.val()&&a.controllers.rtow.daterangePicker.getWidget().endInput.val():a.controllers.rtow.departDate.getValue()&&a.controllers.rtow.returnDate.getValue(),e&&!b&&l()))});this.controllers.rtow.originField.inputEl.on("keyup",function(a){13===a.which&&
f&&h()}).on("keydown",function(a){a.which===c.globals.keyCodes.TAB&&(b=!0)}).on("mousedown touchstart",function(){d(this).focus()});this.controllers.rtow.destinationField.inputEl.on("keyup",function(a){13===a.which&&e&&l()})}},vsLog:function(a){if(this.stateInitialized&&this.searchForm.is(":visible")&&0<=this.searchForm.offset().top&&"complete"===document.readyState){var b="simpleform";this.searchForm.filter(".active").hasClass("multicity")?b="multicity":this.element.find(".js-searchForm").hasClass("advanced")&&
(b="advancedform");c.Analytics.api.trackEvent(["flights/form",b,a].join("/"))}},gaLog:function(a,b){this.stateInitialized&&this.searchForm.is(":visible")&&0<=this.searchForm.offset().top&&"complete"===document.readyState&&c.Analytics.api.trackEvent({category:"Search-Form",action:a,label:b})},initState:function(){this.options.showStudents||delete this.state.students;if(!0!==this.options.sync){this.triggerChangeDisplayCat(void 0,!0);var a;this.localHistory&&this.localHistory.getRecentHistory&&(a=this.localHistory.getRecentHistory());
Object.values(this.controllers).forEach(function(b){b.initState(a)})}this.stateInitialized=!0},setupChildControllers:function(){this.controllers.rtow.setup();this.options.toggleLinks&&this.options.multicityEnabled&&this.controllers.multi.setup()},onSubmit:function(a){var b=this;if(!this.isSubmitted){var f=!1===this.validate(),e=this.serialize(),d=!1;this.options.airportMultiSelect&&(e.originMultiAirports.length||e.destinationMultiAirports.length)&&c.Analytics.api.trackEvent({category:"airportMultiSelect",
action:"submit",label:e.originMultiAirports.length,value:e.destinationMultiAirports.length});if(this.loadSlideCMP2())return!1;f&&this.submitIntentMedia();this.gaLog("click-search","origin:%s;dest:%s;depart:%s;return:%s;travelers:%s;triptype:%s;cabin:%s;departflex:%s;returnflex:%s".format(e.origin,e.destination,e.depart_date_canon,e.return_date_canon,e.travelers,this.display,e.cabin,e.depart_date_flex,e.return_date_flex));if(f&&this.options.useSwindle&&this.submitSwindle())return!1;if(this.options.showAnywhere&&
"anywhere"!==e.flex_category)if(e.isMulticity)for(var g=0;g<e.nrLegs&&(this.isEmpty(e["origincode"+g])||!this.isEmpty(e["destinationcode"+g]));g++);else d=!this.isEmpty(e.origincode)&&this.isEmpty(e.destinationcode)&&"function"===typeof this.showAnywhereSearchPopup&&this.options.showAnywherePopupEnabled;this.triggerConsentGranted();d?(this.vsLog("/nodestinationerror/show"),this.showAnywhereSearchPopup(e)):this.options.regionSearchEnabled&&(e.freeRegionId||e.countrySearch)&&!this.options.regionSearch&&
f?window.location="/"+this._generate(e):this.base(a)}setTimeout(function(){b.recalculateDialogDimensions()},10);return!1},canSwindleQuery:function(a){var b="multicity"===this.display,c=this.activeFormController,c=c&&c.isSameDayRoundtrip?c.isSameDayRoundtrip():!1,e=a||this.serialize()||{};a=!!e.freeRegionId;e=-1!==["explore","anywhere"].indexOf(e.flex_category);return!b&&!c&&!a&&!e},submitSwindle:function(){var a=this.serialize()||{};return this.canSwindleQuery(a)?c.question.ask("hotels.swindle.handleSwindle",
{url:this.buildSearchURL(a)}):!1},showAnywhereSearchPopup:function(a){c.events.publish("flights.search.AnywhereSearchDialog.open",a)},publishSubmitEvent:function(a){this.options.regionSearch?window.location.href="/"+a.url:"anywhere"===a.flex_category?(window.open(a.url),this.enableSearchButton()):this.base(a)},getCMP2AirportLocation:function(a,b){if(a){a=a.substr(0,3);if(""===a||0===a.indexOf("C-"))a=b.replace(/ /g,""),-1!==a.indexOf("(")?(b=a.match(/\(([A-Z]{3})\)/g),null!=b&&(a=b[0])):a=a.substr(0,
3);return a}return""},getCompareToFormData:function(){var a=this.serialize(),b={vertical:this.vertical};a.origin=a.origin_location;a.origincode=a.origin_code;a.destination=a.destination_location;a.destinationcode=a.destination_code;return d.extend(b,a)},isEnoughInformationForCompareToRequest:function(){if(this.options.loadCmp2WhenVisible&&!this.element.is(":visible"))return!1;var a=["plusminusthree","exact","exact-graph"];if(this.activeFormController===this.controllers.rtow&&-1===d.inArray(this.activeFormController.getFlexCategory(),
a))return!1;a=!0;this.options.cmp2LimitDisplay&&(a="oneway"===this.display||"roundtrip"===this.display);if(this.options.regionSearchEnabled&&a&&this.activeFormController){var b=this.serialize();if(b.destination&&(q.exec(b.destination)||p(b.destination)))return!1}return a&&!this.options.suppressCmp2s&&!this.isNull(this.activeFormController)&&!1===this.validate()},autofocus:function(){this.controllers.rtow.originField.inputEl.focus()},switchToFullView:function(){this.inlineViewOnly=this.inline=!1},
switchToInlineView:function(a){this.inline=!0;this.inlineViewOnly=a||!1;a&&this.updateInlineViewOnly()},getSearchFormFilterState:function(){var a=this.base();this.options.advancedFiltersEnabled&&"multicity"===this.display&&["stops","cabin","takeoff"].forEach(function(b){delete a[b]});return a},buildSearchURL:function(a){return this.activeFormController.buildSearchURL(a,this.getSearchFormFilterState())},serialize:function(){var a=this.base();a.provider="";var b=this.getActiveFormData();return d.extend(a,
b)},getActiveFormData:function(){return d.extend({airlineFilter:this.options.airlineFilter},this.activeFormController.serialize())},getCookieData:function(){var a=this.base(),b={},c=this;this.element.find("[type\x3d'hidden']").filter(function(){var a=d(this).attr("name");return c.isEmpty(a)?!1:!/^(?:airportcode|origincode|destinationcode)\d?$/i.test(a)}).each(function(){var a=d(this),f=a.attr("name"),g=a.val();c.isEmpty(g)||(b[f]=a.val())});this.options.airlineFilter&&!b.airlineFilter&&(b.airlineFilter=
this.options.airlineFilter);return d.extend(a,b)},getStorageProps:function(){for(var a="depart_date depart_date_canon return_date return_date_canon origincode destinationcode travelers cabin flex_category isMulticity oneway nearby_origin nearby_destination depart_date_flex return_date_flex weekend_depart_date weekend_depart weekend_return openflex_depart_date openflex_length_of_stay".split(" "),b=this.activeFormController&&this.activeFormController.maxLegs?this.activeFormController.maxLegs:3,c=0;c<
b;c++)a.push("origincode"+c),a.push("originLocation"+c),a.push("destinationcode"+c),a.push("destinationLocation"+c),a.push("depart_date"+c),a.push("depart_date_canon"+c),a.push("depart_time"+c),a.push("cabin_type"+c),a.push("nearby_origin"+c),a.push("nearby_destination"+c);(this.options.showBaggageDropdown||this.options.advancedFiltersEnabled)&&a.push("searchFormFilterState");return a},removeActiveClass:function(a){a=a?d(a).find(".js-rtow,.js-mcmc"):d(".js-rtow,.js-mcmc");a.attr("aria-hidden","true");
"undefined"!==typeof c.stylejam&&this.swapClasses(a,"SearchForm--visible","SearchForm--hidden")},bindDisplayCat:function(){var a=this;this.options.toggleLinks?this.subscribe("flights.search.form.display.change",function(b){b.namespace&&b.namespace!==a.eventDataTemplate.id&&!a.options.sync||a.triggerChangeDisplayCat(b.value)}):this.options.multicityEnabled&&(a.multiCityDialog=this.getChildElement("multiCityDialog").getWidget(),a.multiCityDialog&&(d.extend(a.multiCityDialog.options,{onClose:function(){a.autofocus();
a.triggerChangeDisplayCat("roundtrip",!0)}}),this.subscribe(["flights.search.multicity.legAdded","flights.search.multicity.legRemoved"],function(){setTimeout(a.multiCityDialog.calculateDimensions.bind(a.multiCityDialog),1)}),this.subscribe("searchform.submit",function(){a.multiCityDialog.close()})))},initActiveFormController:function(){switch(this.display){case "roundtrip":case "rtow":case "oneway":this.activeFormController=this.controllers.rtow;break;case "multi":case "multicity":this.activeFormController=
this.controllers.multi}},onChangeDisplayCat:function(a){switch(a.displayCat){case "roundtrip":case "rtow":a=this.activeFormController==this.controllers.multi;this.activeFormController=this.controllers.rtow;this.options.mixedCabinsUI&&a&&this.copyMultiDataForMixedCabinsUI();this.display="roundtrip";break;case "oneway":this.activeFormController=this.controllers.rtow;this.display="oneway";break;case "explore":this.activeFormController=this.controllers.rtow;this.display="explore";break;case "multi":case "multicity":a=
this.activeFormController==this.controllers.rtow;this.activeFormController=this.controllers.multi;this.options.mixedCabinsUI&&a&&this.copyRTDataForMixedCabinsUI();this.display="multicity";break;default:return}this.options.toggleLinks&&this.removeActiveClass(this.element);this.options.travelersAboveForm&&(a="multicity"===this.display,this.getChildElement("cabinType").parent().toggleClass(this.getStlBlock("Header__grid__col--hidden"),a),this.options.showBaggageDropdown&&this.getChildElement("baggage").toggleClass(this.getStlBlock("Header__grid__col--spacing"),
a));("multicity"!==this.display||this.options.toggleLinks)&&this.activeFormController.activate();"oneway"!==this.display&&"roundtrip"!==this.display||this.activeFormController.setOneWay("oneway"===this.display);this.updateLapInfantWarning();this.loadCompareToItems();this.recalculateDialogDimensions()},copyRTDataForMixedCabinsUI:function(){var a=this.controllers.rtow.state;if(null!=a.end_date){var b=d.extend({},this.eventDataTemplate);b.legIndex=1;b.originCode=a.destinationCode;b.originLocation=a.destination;
c.events.publish(this.events.multiOrigin,b);b=d.extend({},this.eventDataTemplate);b.legIndex=1;b.destinationCode=a.originCode;b.destinationLocation=a.origin;c.events.publish(this.events.multiDestination,b);b=d.extend({},this.eventDataTemplate);b.legIndex=1;b.departDate=a.end_date;c.events.publish(this.events.multiDepartDate,b);b=d.extend({},this.eventDataTemplate);b.cabinType=this.state.cabin;this.controllers.multi.updateAllLegsToCabinType(b)}},copyMultiDataForMixedCabinsUI:function(){var a=d.extend({},
this.eventDataTemplate);this.controllers.multi.updateNonMcSearchFormCabinClasses(a)},triggerChangeDisplayCat:function(a,b){var f=d.extend({},this.eventDataTemplate);f.displayCat=n(a,this.display);c.events.publish(this.events.displayCat,f);b&&c.events.publish("flights.search.form.display.set",f.displayCat);this.vsLog("/triptype/"+a);this.gaLog("select-trip-type",a)},updateInlineViewOnly:function(){var a=this.activeFormController.serialize(),a={depart_date:m(a.depart_date).format("MMM DD"),return_date:m(a.return_date).format("MMM DD"),
origincode:a.origincode,destinationcode:a.destinationcode,cabin:a.cabin||"Economy",travelers:a.travelers},b;for(b in a)a.hasOwnProperty(b)&&d(".displayView[data-disp-%s]".format(b),this.element).html(a[b])},adjustAnywhereSearchCategory:function(a){a?this.controllers.rtow.searchFormWrapper.addClass("anywhere-search"):this.controllers.rtow.searchFormWrapper.removeClass("anywhere-search")},updateBaggageCounts:function(a){this.searchFormFilterState[a.type]=""+a.value},bindFlightSmartyFields:function(a){var b=
this,f=function(b){var c=b.inputEl;return function(b){setTimeout(function(){if(!c.val()||0===c.val().length){var f=b.options.messages.anywhereInptText;c.closest(".js-searchForm").addClass("anywhere-search");a.changeCallback({location:f,code:"anywhere"})}},1)}},e=function(){return function(f){if(f)if(a.nearbyFormCallback)a.nearbyFormCallback(f.enabled);else{var e=d.extend({},b.eventDataTemplate);a.isOrigin?(e.includeNearbyOrigin=f.enabled,c.events.publish(b.events.rtowNearbyOrigin,e)):(e.includeNearbyDestination=
f.enabled,c.events.publish(b.events.rtowNearbyDestination,e))}}},k=b.options.flareSmartyType,g=a.field.inputEl,h={flareSmartyType:k,dataSource:b.options.smartyUrl,smartyControlGroup:function(){if(!(b.options.showSmartyHistory&&!a.noHistory||b.options.showTopDestinations&&a.enableTopDestinations))return null;var f=b.getChildElement("origin-airport"),e=b.getChildElement("destination-airport"),d=b.getChildElement("origin-code"),g=b.getChildElement("destination-code"),h=b.getChildElement("nearbyOriginCheckRtow"),
k=b.getChildElement("nearbyDestinationCheckRtow"),l=b.state,m,n,p,q;b.options.useLegacyDatePicker?m=b.getChildElement("travelDates").daterangePicker().getWidget():(p=b.activeFormController.departDate,q=b.activeFormController.returnDate,n=b.activeFormController.datePicker);f={form:b.searchForm,formObject:b,originInput:f,destInput:e,originCode:d,destCode:g,daterangePicker:m,startDate:p,endDate:q,datePicker:n,useLegacyDatePicker:b.options.useLegacyDatePicker,nearbyDeparture:h,nearbyArrival:k,isRoundTrip:function(){return"roundtrip"===
b.display},maxHistory:b.options.maxHistoryItems,state:l};if(b.options.showSmartyHistory&&!a.noHistory){var r=new c.Common.SmartyHistory.SmartyFlightHistory;f.smartyHistory=function(){return r}}if(b.options.showTopDestinations&&a.enableTopDestinations){var t=new c.Common.SmartyTopDestinations.SmartyFlightTopDestinations(a.topDestinationOptions||{});f.smartyTopDestinations=function(){return t}}return new c.Common.SmartyControlGroup.SmartyFlightControlGroup(f)}(),setItem:function(f){return function(e,
d){d&&setTimeout(function(){var g,h,k;g=b.options.regionDisplayAirportPicker?!1:!(a.isOrigin||a.isMulticity)&&b.isRegionSearchSupported;if("ap"===d.type||"apnc"===d.type||"rail"===d.type)g=d.short_str||d.str,k=d.str,h=d.id;else if("isl"===d.type)g=d.str,h="";else if(g&&"reg"===d.type)g=d.short_str||d.str,h=d.rid+"r";else if(g&&"freereg"===d.type)g=d.short_str||d.str,h=d.frid+"fr";else if(g&&b.options.regionSearchEnabled&&"ctry"===d.type)g=d.short_str||d.str,h=d.cid+"cy";else if(g&&b.options.regionSearchEnabled&&
"ctgroup"===d.type)g=d.short_str||d.str,h=d.cgid+"cg";else if(e.options.showAnywhere&&"anywhere"===d.short_str)c.events.publish("forceDismiss.DatePicker"),g=e.options.messages.anywhereInptText,h="anywhere",f.closest(".js-searchForm").removeClass("advanced").addClass("anywhere-search"),b.vsLog("/smarty/anywhere");else{h=g="";var l=d.id;if(b.isRegionSearchSupported)switch(d.type){case "freereg":l="F:%s".format(d.frid);break;case "reg":l="R:%s".format(d.rid);break;case "ctry":l="Y:%s".format(d.cid)}b.openAirportPicker("",
"",l,!a.isOrigin,function(b){a.changeCallback({location:b.location,code:b.code})})}e.options.showAnywhere&&"anywhere"!==d.short_str&&f.closest(".js-searchForm").removeClass("anywhere-search");a.isOrigin&&(b.originCountry=d.cc||"");a.changeCallback({location:g,locationDescription:k,code:h,codeType:d.type})},100)}}(g),clearItem:function(b){return function(c){setTimeout(function(){c.options.showAnywhere&&b.closest(".js-searchForm").removeClass("anywhere-search");a.changeCallback({location:void 0,code:""})},
1)}}(g),messages:b.options.msg,showAnywhere:b.options.showAnywhere&&!a.isOrigin&&!a.isMulticity,showBackgroundAutocomplete:c.config.getBoolean("ui.common.smarty.background.autocomplete.enabled",!1),animateSmarty:!1,useNearby:b.options.isNearbyInSmarty};if(this.options.phoenixRising){var l=a.field.inputEl.data("inputModal");l&&(h.appendTo=l.getSmartyWrapper(),h.fixedDropdown=!0)}"function"===typeof a.beforeStartCallback&&d.extend(h,{beforeStart:a.beforeStartCallback(a.field)});h.useNearby&&(h.nearbyCallback=
e());b.options.showAnywhere&&b.options.anywhereIfEmpty&&!a.isOrigin&&(h.afterDone=f(a.field));if(32===k||51===k||55===k||58===k)h.dropdownClass="smartbox smartbox-air smartbox-v2 smartbox-air-regions";c.config.getBoolean("ui.smarty.flights.greyIcons",!1)&&(h.dropdownClass=h.dropdownClass+" "+c.config.getString("ui.smarty.iconClasses","greyIcons"));b.checkAndSetSmartyUIUpdateOpts(h);h.allAirportsLocalizedText=this.options.allAirportsLocalizedText;g.flightSmarty(h)},setupTravelersAndCabin:function(){var a=
this;this.subscribe("flights.search.cabinType.change",{namespace:this.id()},function(b){"m"===b.value?(a.triggerChangeCabinType("e"),c.events.publish("flights.search.travelers.close",{namespace:a.id()}),a.triggerChangeDisplayCat("multicity",!0),a.vsLog("/passengers/cabin/m"),a.gaLog("select-cabin","m")):a.triggerChangeCabinType(b.value)});this.subscribe("flights.search.travelers.change",{namespace:this.id()},function(b){a.triggerChangeTravelers(b.data)});this.travelersDataQuestion="flights.search.travelers."+
this.id(this.options.travelersAboveForm?"above":"rtow");var b;this.localHistory&&this.localHistory.getRecentHistory&&(b=this.localHistory.getRecentHistory())&&(c.events.publish("flights.search.travelers.set",d.extend({namespace:this.id()},b)),!this.options.ignoreSticky&&b.cabin&&(this.options.travelersAboveForm?c.events.when("flights.search.cabinType.init."+this.id(),this.triggerChangeCabinType.bind(this,b.cabin)):this.triggerChangeCabinType(b.cabin)));(b=c.question.ask(this.travelersDataQuestion))&&
this.triggerChangeTravelers(b)},onChangeTravelers:function(a){c.events.publish("flights.search.travelers.set",d.extend({namespace:this.id()},a));d.extend(this.state,a);this.updateLapInfantWarning()},triggerChangeTravelers:function(a){var b=d.extend({},this.eventDataTemplate);a||(a=c.question.ask(this.travelersDataQuestion));d.extend(b,a);c.events.publish(this.events.travelerCount,b);b.hasOwnProperty("travelerType")&&(this.vsLog("passengers/"+b.travelerType),this.gaLog("select-passengers",b.travelerType))},
getCabin:function(){return c.question.ask("flights.search.cabinType."+this.id()+".get")},onChangeCabinType:function(a){this.updateCabinType({cabin:a.cabinType});if(a=this.getCabin())this.state.cabin=a.value,this.state.cabinDisplayType=a.display},triggerChangeCabinType:function(a){var b=this,f=d.extend({},this.eventDataTemplate);f.cabinType=n(a,function(){return b.getCabin().value});c.events.publish(this.events.cabinType,f);this.vsLog("/passengers/cabin/"+a);this.gaLog("select-cabin",a)},bindDaterangePicker:function(a,
b,c){var e=this,f=function(a){var b=e.serialize();return{vertical:"flights",origin:b.origincode,destination:b.destinationcode,isOneWay:b.oneway,departDate:a?void 0:b.depart_date_canon}};this.options.useLegacyDatePicker?(c=c||{getFormData:f,useDaysFormat:!0,minRangeDays:0,change:function(){b(this.getStartDate(),this.getEndDate())},alwaysShowEndDatepicker:this.options.autoOpenNextField,nextFieldSelector:"#"+this.controllers.rtow.searchForm.find(".searchButton").attr("id")},a.daterangePicker(c).getWidget()):
(c=c||{change:b,dismiss:this.dismissingDatepicker.bind(this),getFormData:f},d.extend(a.options,c))},dismissingDatepicker:function(a){var b=this;a&&a.returnEvent&&c.dom.schedule(function(){b.submitButton&&b.submitButton.focus()})},checkForValidDates:function(){var a=this.getChildElement("depart"),b=this.getChildElement("return");if(a&&a.getWidget()&&b&&b.getWidget()&&(a=a.getWidget(),b=b.getWidget(),a=a.getDate(),b=b.getDate(),a&&m(Date.now()).isAfter(a,"day")||!a||!b)){b=1;a=8;c&&c.config&&(b=c.config.getInt("ui.horizon.flights.flightroutes.departureDate.offset",
b),a=c.config.getInt("ui.horizon.flights.flightroutes.returnDate.offset",a));var f=d.extend({},this.eventDataTemplate);f.startDate=m().startOf("day").add(b,"d");f.endDate=m().startOf("day").add(a,"d");c.events.publish(this.events.rtowDateRange,f)}},bindShowAirportMapLinks:function(){function a(a){a.preventDefault?a.preventDefault():a.returnValue=!1;d(!1,function(a){e.controllers.rtow.triggerChangeOrigin(a.location,a.code);e.controllers.multi.triggerChangeOrigin(a.location,a.code,0)})}function b(a){a.preventDefault?
a.preventDefault():a.returnValue=!1;d(!0,function(a){e.controllers.rtow.triggerChangeDestination({location:a.location,code:a.code});e.controllers.multi.triggerChangeDestination({location:a.location,code:a.code,leg:0})})}function d(a,b){var c=a?e.destinationField:originField;e.openAirportPicker(c.val(),c.code(),"",a,b)}var e=this;this.getChildElement("showAirportMapOriginRtow").click(a.bind(this));this.getChildElement("showAirportMapOriginRtow").keydown(function(b){b.which===c.globals.keyCodes.RETURN&&
a(b)});this.getChildElement("showAirportMapDestinationRtow").click(b.bind(this));this.getChildElement("showAirportMapDestinationRtow").keydown(function(a){a.which===c.globals.keyCodes.RETURN&&b(a)})},onChangeTriggerData:function(a){if(!this.isEmpty(a.origincode)&&!this.isEmpty(a.originname)){var b={location:a.originname,code:a.origincode,isDestinationFocusSkipped:a.isDestinationFocusSkipped};this.controllers.rtow.triggerChangeOrigin(b);this.controllers.multi.triggerChangeOrigin(d.extend({},b,{leg:0}))}this.isEmpty(a.destinationcode)||
this.isEmpty(a.destinationname)||(this.controllers.rtow.triggerChangeDestination({location:a.destinationname,code:a.destinationcode}),this.controllers.multi.triggerChangeDestination({location:a.destinationname,code:a.destinationcode,leg:0}));this.isEmpty(a.departDate)||this.isEmpty(a.returnDate)||this.controllers.rtow.triggerChangeDateRange(a.departDate,a.returnDate);this.isEmpty(a.filter)||(this.options.airlineFilter=a.filter);this.updateLogging(a);this.loadCompareToItems()},updateTravelDateState:function(a,
b){this.isEmpty(a)||this.isEmpty(b)||this.controllers.rtow.triggerChangeDateRange(a,b)},openAirportPicker:function(a,b,d,e,k){e=this.id(e?"airportPickerDestination":"airportPickerOrigin");c.events.publish("flights.airportpicker.open",{id:e,location:a,code:b,hint:d,callback:k})},updateLapInfantWarning:function(){this.element.removeClass("hasInfantInLapWarning hasTopInfantInLapWarning");c.config.getBoolean("ui.horizon.flights.search.showInfantWarningInForm",!0)&&(0<this.state.lapInfant&&(this.element.addClass("hasInfantInLapWarning"),
this.activeFormController===this.controllers.rtow&&this.element.addClass("hasTopInfantInLapWarning")),this.swapClassesToggle(this.lapInfantWarning,"MultiForm__lap-warning__inner--hide","MultiForm__lap-warning__inner--show",0===this.state.lapInfant))},onSearchError:function(){this.recalculateDialogDimensions()},serializeTravelers:function(a){a.travelers=this.state.travelers;a.adults=this.state.adults;a.seniors=this.state.seniors;a.youth=this.state.youth;a.child=this.state.child;a.seatInfant=this.state.seatInfant;
a.lapInfant=this.state.lapInfant;a.cabin=this.state.cabin;a.cabinDisplayType=this.state.cabinDisplayType},loadSlideCMP2:function(){if(this.options.slideCMP2&&this.activeFormController===this.controllers.rtow&&"US"===this.originCountry){this.disableSearchButton();var a=this.getCompareToFormData(),b=this,d=this.buildSearchURL(this.serialize()||{}),a={id:this.id("slidecmp2"),url:d,pageOrigin:a.pageOrigin};c.ajax.execute("common/compareto/slide/SlideCompareToFlights",{customUpdate:function(a){b.getChildElement("slidecmp2").replaceWith(a.innerHTML);
return!0},data:a});return!0}return!1},loadCompareToItems:function(){this.options.slideCMP2&&"US"===this.originCountry?c.events.publish("cmp2.cleanUp",{id:this.id()+"-compareTo"}):this.base()},validate:function(){var a=!1,b=this.activeFormController.validate();0===b.length&&(a=!0,b=this.getStandAloneErrorMessage());if(0===b.length)return!1;if(a)return b[0];for(a=0;a<b.length;a++)b[a]=c.utils.escapeHTML(b[a]);return"\x3cul\x3e\x3cli\x3e"+b.join("\x3c/li\x3e\x3cli\x3e")+"\x3c/li\x3e\x3c/ul\x3e"},getStandAloneErrorMessage:function(){var a=
this.state.adults+this.state.seniors;this.options.showStudents&&(a+=this.state.students);return 0===a?[this.options.errMsg.noUnaccompaniedMinors+""]:[]},getTravelerValidationMessages:function(){return this.state.travelers>this.options.maxTravelers?[c.Common.Utils.String.formatString(this.options.errMsg.tooManyPassengersSelected+"",this.options.maxTravelers)]:1>this.state.travelers?[this.options.errMsg.noPassengersSelected+""]:[]},getDateValidationMessages:function(a,b,d,e){var f=[],g=!this.isEmpty(d),
h=!this.isEmpty(e);g||f.push(c.Common.Utils.String.formatChoice(this.options.errMsg.missingLeaveDateChoice,a,a));b||(h?(a=m(d),0>m(e).diff(a,"days")&&f.push(this.options.errMsg.departDateAfterReturnDate)):f.push(this.options.errMsg.missingReturnDate));return f},getLocationValidationMessages:function(a,b,d){var e=[];this.isEmpty(b)&&e.push(c.Common.Utils.String.formatChoice(this.options.errMsg.missingFromAirportChoice,a,a)+"");this.isEmpty(d)?e.push(c.Common.Utils.String.formatChoice(this.options.errMsg.missingToAirportChoice,
a,a)+""):b===d&&e.push(c.Common.Utils.String.formatChoice(this.options.errMsg.uniqueAirportsChoice,a,a)+"");return e},isInternalEvent:function(a){return this.id()===a.id},isConsumeUpdateEvent:function(a){return this.isInternalEvent(a)||!0===this.options.sync},proxyEventCallback:function(a,b,c,d){var e=this;return function(f){("function"===typeof c?c.call(b,f):e.isConsumeUpdateEvent(f))&&a.apply(b,arguments);("function"===typeof d?d.call(b,f):e.isInternalEvent(f))&&e.loadCompareToItems()}},recalculateDialogDimensions:function(){c.events.publish("flights.search.dialog.recalculatedimensions",
{id:this.id()})},onHookSubmitForIntentMedia:function(a){a&&"function"===typeof a.callOnSubmit&&(this.intentMediaCallOnSubmit=a.callOnSubmit)},submitIntentMedia:function(){"function"===typeof this.intentMediaCallOnSubmit&&this.intentMediaCallOnSubmit.call(null,this.serialize())},checkOriginForUpdate:function(){var a=this;d.ajax({url:"/s/run/analytic/airport",method:"GET",success:function(b){if(b.success){var c=b.ipAirport?b.ipAirport:"";a.onChangeTriggerData({origincode:c,originname:b.ipAirportDisplayName?
b.ipAirportDisplayName:c,isDestinationFocusSkipped:a.options.phoenixRising})}}})},focusFirstElement:function(){this.options.toggleLinks?c.events.publish("flights.search.form.display.focus"):this.getChildElement("origin").get(0).focus()},createSubControllers:function(){var a={bindAndInitDropdown:t,bindDropdown:r,bindCheckbox:v,setCheckboxValue:u,isEmpty:this.isEmpty.bind(this),valOrDefault:n,isCountryOrCountryGroup:p,getAirportCode:w,getMultipleAirportCodes:x,REGION_RX:q},b={rtow:new c.flights.search.RTOWFormController(this,
a)};this.options.multicityEnabled&&(b.multi=new c.flights.search.MulticityFormController(this,a));return b},setNearbyWrapperVisibility:function(a,b){a=this.isEmpty(a)?"hidden":"visible";b=this.element.find(b);b.css("visibility",a);b.removeClass("visible hidden").addClass(a)},adjustFormClass:function(){this.controllers.multi.searchForm&&(0===d(".js-multiCityLeg.js-hiddenLeg",this.element).length===!0?this.controllers.multi.searchForm.addClass("fullyExpand"):this.controllers.multi.searchForm.removeClass("fullyExpand"))},
destroy:function(){this.base();this.controllers.rtow.teardown();this.controllers.multi&&this.controllers.multi.teardown()}})})(window.R9,window.jQuery,window.moment);(function(d,e,f){d.publish("common.utils.history.UserHistory",f.extend({constructor:function(a){this.options=e.extend({},this.options,a);this.init()},pageTab:"other",wasLastUsedPage:!1,searchHistoryLimit:3,options:{defaultCookiExpire:10,defaultSearchExpire:100,persistLocalStorage:!0,onSave:e.noop},_storageTemplate:{sticky:{origin:"",destination:"",guests:"",depart_date:"",return_date:"",travelersObject:""},lastUsedTab:"",canary:3},_storageKey:"BKHISTORY2",hasSearchHistory:!1,searchHistoryMoreRecent:!1,
_loadStorageInstance:function(){var a=this._storageTemplate.canary,b=d.storage.get(this._storageKey);d.common.utils.history.UserHistory.storageSync=b&&b.canary&&b.canary===a?b:e.extend(!0,{},this._storageTemplate)},getStorage:function(){d.common.utils.history.UserHistory.storageSync||(d.common.utils.history.UserHistory.storageSync=e.extend(!0,{},this._storageTemplate));return d.common.utils.history.UserHistory.storageSync},initStorageInstance:function(){var a=this.getStorage();a[this.pageTab]||(a[this.pageTab]=
{searches:[],last_updated:null},d.storage.set(this._storageKey,a))},_createExpirationTimestamp:function(a){return moment().add(a||0,"hours").toDate()},init:function(){this.dirty=!1;this.pageTab=this.options.tab||this.pageTab;this._loadStorageInstance();this.initStorageInstance();this.getStorage().lastUsedTab===this.pageTab&&(this.wasLastUsedPage=!0);this.evictExpiredSearches();var a=this.getStorage()[this.pageTab];a&&a.searches&&0<a.searches.length&&(this.hasSearchHistory=!0,a.last_updated&&a.searches[0]&&
1>moment(a.last_updated).diff(a.searches[0].createdAt)&&(this.searchHistoryMoreRecent=!0));var b=this;e(window).bind("beforeunload",function(){try{b.save()}catch(c){}})},save:function(){if(this.dirty)try{this.options.onSave.call(this),this.dirty&&this.options.persistLocalStorage&&(this.dirty=!1,this.getStorage().lastUsedTab=this.pageTab,this.getStorage().common=this.common,d.storage.set(this._storageKey,this.getStorage()))}catch(a){return!1}return!0},get:function(a){if(this.getStorage()[this.pageTab])return this.getStorage()[this.pageTab][a]},
set:function(a,b){var c=this.getStorage()[this.pageTab];c&&c[a]!==b&&(this.dirty=!0,c.last_updated=this._createExpirationTimestamp(),c[a]=b);clearTimeout(this._saveTimeout);this._saveTimeout=setTimeout(e.proxy(this,"save"),100)},reduceTravelersObjectToTotal:function(){var a=0;if(this.getStorage().sticky){var b=this.getStorage().sticky.travelersObject;b&&(a+=parseInt(b.adults),a+=parseInt(b.youth),a+=parseInt(b.children),a+=parseInt(b.infants),a+=parseInt(b.lapinfants),a+=parseInt(b.seniors))}return a},
getRecentHistory:function(){var a=this.getStorage()[this.pageTab],b=this.hasSearchHistory&&this.searchHistoryMoreRecent&&a&&a.searches?a.searches[0]:null;if(!b&&a&&(!a.last_updated||moment().diff(a.last_updated,"hours")<this.options.defaultSearchExpire)){var b={},c;for(c in a)a.hasOwnProperty(c)&&(b[c]=this.get(c));delete b.last_updated;delete b.searches}return b},evictExpiredSearches:function(){var a=this.getStorage(),b=a[this.pageTab]?a[this.pageTab].searches:null,c=this;b&&0!==b.length&&(b.length>
this.searchHistoryLimit&&a[this.pageTab].searches&&(b=b.slice(0,this.searchHistoryLimit)),a[this.pageTab].searches=b.filter(function(a){return!c._shouldExpire(a.expiresBy)}))},pushSearchHistory:function(a){var b=this.getStorage();b[this.pageTab]&&b[this.pageTab].searches&&(a.expiresBy=this._createExpirationTimestamp(this.options.defaultSearchExpire),a.createdAt=this._createExpirationTimestamp(),b[this.pageTab].searches.splice(0,0,a),this.dirty=!0);this.save()},_shouldExpire:function(a){return 0<moment().diff(moment(a))},
purge:function(){d.storage.remove(this._storageKey);d.common.utils.history.UserHistory.storageSync=null;this.initStorageInstance();this.options.persistLocalStorage=!1}}))})(R9,jQuery,base2.Base);(function(c,h,g){c.publish("common.kn.Mixin",g.extend({loadGPT:function(){if(!c.common.kn.Mixin.loadedGPT&&c.config&&c.config.getBoolean("ui.gpt.loadOnce",!0)||!window.googletag){c.common.kn.Mixin.loadedGPT=1;window.googletag||(window.googletag={cmd:[]});var a=document.createElement("script");a.async=!0;a.type="text/javascript";a.src="//www.googletagservices.com/tag/js/gpt.js";var f=document.getElementsByTagName("script")[0];f.parentNode.insertBefore(a,f)}window.googletag.cmd=window.googletag.cmd||
[]},loadAdsense:function(){window._googCsa||function(a,f,d,b,e,c){a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)};a[b].t=1*new Date;e=f.createElement(d);c=f.getElementsByTagName(d)[0];e.async=1;e.src="//www.google.com/adsense/search/async-ads.js";c.parentNode.insertBefore(e,c)}(window,document,"script","_googCsa")},findAdDataForType:function(a,c,d){if(!(d&&a&&c&&d[a]))return null;var b,e;for(e in d[a])if(d[a].hasOwnProperty(e)){b=d[a][e];if("string"===typeof b)try{b=JSON.parse(b)}catch(k){b=
null}if(b&&b.pageLocation&&b.pageLocation===c)return b}return null}}))})(R9,jQuery,window.base2.Base);(function(a,c){a.createComponentClass("common.kn.Display",{options:{},addEventHandlers:function(){var b=this;this.subscribe("displayads.register",{type:b.options.type},function(a){b.registerDisplay()});b.options.destroyable&&this.subscribe("displayads.destroy",function(){a.events.publish("displayad.sra.destroy",b.getSlotParams())})},inlineComponentsReady:function(){this.options.lazyLoad||this.registerDisplay()},registerDisplay:function(){a.events.publish("displayad.sra.register",c.extend(this.getSlotParams(),
this.options))},destroy:function(){a.events.publish("displayad.sra.destroy",this.getSlotParams());this.base()},getSlotParams:function(){return{adDivId:this.id()}}})})(R9,jQuery);(function(f,e){f.createComponentClass("common.kn.DisplaySra",{options:{slots:null,slotKeyDelim:"",slotsLoadedTimerMS:400,deferGPTLoad:!1,deferUserInteractMS:3E3,eventsEnable:null,eventsDisable:null,lazyLoad:!1,lazyFetch:-999,lazyRender:-999,renderIfNotEmpty:!1,checkRegisteredSlotMatch:!0},enabled:1,delayedGptApiCt:0,hasSlots:0,pendingSlotInfo:null,registeredSlots:null,definedSlots:null,allSlotsRegistered:null,allSlotsRegisteredTimerID:null,allSlotsLoaded:null,boundSlotRenderedListener:null,boundWindowSmartAdResize:null,
pageTargetingLast:null,dfpHideData:null,adBlocked:null,init:function(){this.pendingSlotInfo=[];this.registeredSlots={};this.definedSlots={};this.hasSlots=e.isArray(this.options.slots)&&this.options.slots.length},addEventHandlers:function(){this.hasSlots&&(this.subscribe("displayad.sra.register",this.onSraSlotRegisterEvent.bind(this)),this.subscribe("displayad.sra.unregisterAll",this.unregisterAllSlots.bind(this)),this.subscribe("displayad.sra.destroy",this.onSraSlotDestroyEvent.bind(this)),this.subscribe("displayad.sra.slots.broadcast",
this.onSraSlotsBroadcast.bind(this)),this.subscribe("resultspage.adinfo.empty",this.publishAllAdsRequests.bind(this)),this.subscribe("resultspage.ads.update",this.onResultsPageAdsUpdate.bind(this)),this.subscribe("resultspage.ads.options",this.onResultsPageAdsPoll.bind(this)),this.subscribe("adblock.detected",this.onAdBlockDetected.bind(this)),this.options.eventsEnable&&this.options.eventsEnable.pop&&this.options.eventsEnable.length&&(this.enabled=0,this.subscribe(this.options.eventsEnable,this.onSraEnable.bind(this))),
this.options.eventsDisable&&this.options.eventsDisable.pop&&this.options.eventsDisable.length&&this.subscribe(this.options.eventsDisable,this.onSraDisable.bind(this)))},inlineComponentsReady:function(){if(this.hasSlots){f.events.publish("displayad.sra.slots.broadcast",{owner:this,slots:[].concat(this.options.slots)});var a=this,b=f.question.ask("adblock.detected");if(b&&b.adblock)this.onAdBlockDetected();else this.options.deferGPTLoad?f.events.when("ajaxComponent.highPriority.initialized",function(){a.loadGPT()}):
this.loadGPT()}},destroy:function(){e(window).off(this.getWindowMessageEventName());this.boundWindowSmartAdResize&&this.boundWindowSmartAdResize===window.resizeIframeToContents&&(window.resizeIframeToContents=null);this.boundWindowSmartAdResize=null;this.base();this.cleanupSlots()},loadGPT:function(){this.loadedGPT||(this.loadedGPT=1,(new f.common.kn.Mixin).loadGPT())},onSraSlotDestroyEvent:function(a){if(a&&a.adDivId){var b=this;this.pendingSlotInfo=this.pendingSlotInfo.filter(function(b){return b&&
b.adDivId!==a.adDivId});Object.keys(this.registeredSlots).forEach(function(c){c&&b.registeredSlots[c]&&b.registeredSlots[c].adDivId===a.adDivId&&delete b.registeredSlots[c]});this.destroyDefinedSlot(a.adDivId)}},destroyDefinedSlot:function(a){if(window.googletag){var b=this;googletag.cmd.push(function(){b.definedSlots&&b.definedSlots[a]&&(googletag.destroySlots([b.definedSlots[a]]),delete b.definedSlots[a])})}},onSraSlotsBroadcast:function(a){a&&this!==a.owner&&e.isArray(a.slots)&&(this.options.slots=
this.options.slots.filter(function(b){return 0>a.slots.indexOf(b)}),1>this.options.slots.length&&(this.hasSlots=0,this.cleanupSlots(),this.registeredSlots={},this.pendingSlotInfo=[],this.enabled=this.allSlotsRegistered=0))},onSraEnable:function(){this.enabled||(this.enabled=1,this.checkLoadSlots())},onSraDisable:function(){this.enabled&&(this.enabled=0,this.cleanupSlots())},handleMissingOrigin:function(a){this.loggedMissingParams||(this.loggedMissingParams=1,a&&this.logError("Ad params without origin"))},
onSraSlotRegisterEvent:function(a){a&&a.adDivId?a.adBlockOptions?(this.augmentPageOptions(a),a.adBlockOptions.origin?this.updateSlotDataAndLoad(a):this.handleMissingOrigin(a.gptAdID)):a.isAvoidResults?this.logError("No ad targeting for non-results ad"):(this.pendingSlotInfo.push(a),this.publishOneAdsRequest(a)):this.logError("Missing adOptions ID")},publishAllAdsRequests:function(){var a=[];this.pendingSlotInfo&&this.pendingSlotInfo.length&&(a=this.pendingSlotInfo.filter(function(a){return a&&!a.isAvoidResults}));
a=a.concat(Object.values(this.registeredSlots).map(function(a){return a&&!a.isAvoidResults?a:null}));a.forEach(this.publishOneAdsRequest.bind(this))},publishOneAdsRequest:function(a){a&&!a.isAvoidResults&&f.events.publish("ads.request",{adType:"displayAd",pageLocation:a.pageLocation,now:!a.gptAdID,events:["searchform.submit","resultsHeader.changed","filters.changed","paginator.change"],minRefreshRate:this.options.minRefreshRate})},onResultsPageAdsUpdate:function(a){if(this.enabled){var b=this,c=new f.common.kn.Mixin,
d=function(a,c){Object.keys({gptAdID:null,gptTargetID:null,gptAdWidth:null,gptAdHeight:null,gptAdSizes:null,gptPageURL:null,adBlockOptions:null,pageOptions:null}).forEach(function(b){c.hasOwnProperty(b)&&"undefined"!==typeof c[b]&&(a[b]=c[b])});b.augmentPageOptions(a);return a};this.pendingSlotInfo&&this.pendingSlotInfo.length&&this.pendingSlotInfo.forEach(function(g){if(g){var e=c.findAdDataForType("displayAd",g.pageLocation,a);e&&e.adBlockOptions&&e.adBlockOptions.origin&&b.hasSlots&&0<=b.options.slots.indexOf(b.makeSlotKey(e))&&
b.updateSlotDataAndLoad(d(g,e))}});this.pendingSlotInfo.length&&(this.pendingSlotInfo=this.pendingSlotInfo.filter(function(a){return!Object.values(b.registeredSlots).some(function(b){return!b||a.adDivId===b.adDivId})}));this.pendingSlotInfo.length&&e.isEmptyObject(this.registeredSlots)&&this.pendingSlotInfo.some(function(a){return a&&!a.isAvoidResults})&&this.hasSlots?this.publishAllAdsRequests():Object.values(this.registeredSlots).forEach(function(g){var e=c.findAdDataForType("displayAd",g.pageLocation,
a);e&&b.updateSlotDataAndLoad(d(g,e))})}},makeSlotKey:function(a){var b=this.getAdSizes(a);return b[0][0]+"x"+b[0][1]+this.options.slotKeyDelim+a.pageLocation+this.options.slotKeyDelim+a.adBlockOptions.origin},updateSlotDataAndLoad:function(a){var b=this;if(a&&a.adBlockOptions&&a.adDivId&&(a=e.extend({slotKey:this.makeSlotKey(a),adSize:this.getAdSizes(a),adDivId:a.adDivId,smartAd:null},a),a.slotKey&&this.hasSlots&&!(0>this.options.slots.indexOf(a.slotKey)))){var c=this.registeredSlots[a.slotKey];
c&&c.adDivId!==a.adDivId&&this.definedSlots&&this.definedSlots[c.adDivId]&&this.destroyDefinedSlot(c.adDivId);this.registeredSlots[a.slotKey]=e.extend({},a);!this.allSlotsRegistered&&0<this.options.slotsLoadedTimerMS&&(clearTimeout(this.allSlotsRegisteredTimerID),this.allSlotsRegisteredTimerID=setTimeout(function(){var a=f.question.ask("adblock.detected");a&&a.adblock||b.setAllSlotsRegistered()},this.options.slotsLoadedTimerMS));this.checkLoadSlots()}},onSlotRenderedEvent:function(a){this.enabled&&
(f.events.publish("displayad.loaded",{slotElementId:a.slot.getSlotElementId()}),!0===this.options.renderIfNotEmpty&&!1===a.isEmpty&&e("#"+a.slot.getSlotElementId()).show())},checkLoadSlots:function(){if(this.enabled&&this.hasSlots){if(this.options.checkRegisteredSlotMatch)for(var a,b=0;b<this.options.slots.length;b++){if((a=this.options.slots[b])&&!this.registeredSlots[a])return}else if(!this.registeredSlots||e.isEmptyObject(this.registeredSlots))return;this.setAllSlotsRegistered()}},unregisterAllSlots:function(){this.registeredSlots=
{};this.pendingSlotInfo=[];this.allSlotsRegistered=0;clearTimeout(this.allSlotsRegisteredTimerID)},setAllSlotsRegistered:function(){this.allSlotsRegistered=1;clearTimeout(this.allSlotsRegisteredTimerID);this.loadAllSlots()},loadAllSlots:function(a){this.enabled&&(this.adBlocked?this.replaceAllAdBlockedSlots():window.googletag&&googletag.apiReady?a?(this.setupAllSlots(),this.allSlotsLoaded=1):this.deferUserInteractID?this.handleDelayedSlotLoad():this.handleDelayedSlotLoad(null,1):this.handleDelayedSlotLoad(1))},
handleDelayedSlotLoad:function(a,b){var c=this;this.delayedSlotLoadID&&clearTimeout(this.delayedSlotLoadID);this.delayedSlotLoadID=setTimeout(function(){if(a&&(c.delayedGptApiCt+=1,100<=c.delayedGptApiCt)){var d=f.question.ask("adblock.detected");100!==c.delayedGptApiCt||d&&d.adblock||f.Analytics.api.trackEvent({category:"sra",action:"error",label:"gptapi"});return}c.loadAllSlots(b)},200)},onResultsPageAdsPoll:function(){if(this.options.deferUserInteractMS&&!e.isEmptyObject(this.definedSlots)){var a=
this;this.deferUserInteractID&&clearTimeout(this.deferUserInteractID);this.deferUserInteractID=setTimeout(function(){a.deferUserInteractID=null},this.options.deferUserInteractMS)}},setupAllSlots:function(){var a=this,b;Object.values(this.registeredSlots).forEach(function(c){!c||a.pageTargetingLast&&a.sameObjectProperties(a.pageTargetingLast,c.pageOptions,["tile"])||(a.pageTargetingLast=e.extend({},c.pageOptions),b=c)});this.pageTargetingLast?"function"!==typeof googletag.pubads?this.logError("Bad googletag pubads"):
(this.setWindowEvents(),googletag.cmd.push(function(){b&&a.setupPageTargeting(b);a.boundSlotRenderedListener||(a.boundSlotRenderedListener=a.onSlotRenderedEvent.bind(a),googletag.pubads().addEventListener("slotRenderEnded",a.boundSlotRenderedListener));Object.values(a.registeredSlots).forEach(function(b){b&&a.setupSlot(b);a.allSlotsLoaded&&e("#"+b.adDivId).show()});a.allSlotsLoaded?googletag.pubads().refresh():(googletag.enableServices(),Object.keys(a.definedSlots).forEach(function(a){a&&googletag.display(a)}))})):
this.errPageOptions||(this.errPageOptions=1,this.logError("Missing slot data page options"))},augmentPageOptions:function(a){a&&a.pageOptions&&("undefined"===typeof a.pageOptions.xp&&(a.pageOptions.xp=f.globals.experiment),a.isAvoidResults&&"undefined"===typeof a.pageOptions.host&&(a.pageOptions.host="http://"+window.location.hostname))},setupPageTargeting:function(a){googletag.pubads().clearTargeting();googletag.pubads().enableSingleRequest();this.options.gptIframeTitle&&googletag.setAdIframeTitle(this.options.gptIframeTitle);
this.options.isForceSafeFrame&&googletag.pubads().setForceSafeFrame(!0);if(this.options.lazyLoad){var b={};!isNaN(this.options.lazyFetch)&&-1<=this.options.lazyFetch&&(b.fetchMarginPercent=this.options.lazyFetch);!isNaN(this.options.lazyRender)&&-1<=this.options.lazyRender&&(b.renderMarginPercent=this.options.lazyRender);googletag.pubads().enableLazyLoad(b)}a.gptPageURL&&googletag.pubads().set("page_url",a.gptPageURL);googletag.pubads().collapseEmptyDivs();Object.keys(a.pageOptions).forEach(function(b){b&&
googletag.pubads().setTargeting(b,a.pageOptions[b])})},setupSlot:function(a){if(a&&a.adDivId&&a.adBlockOptions){var b=this.definedSlots[a.adDivId],c;b||(c=1,b=googletag.defineSlot(a.gptTargetID,a.adSize,a.adDivId));b?(b.clearTargeting(),Object.keys(a.adBlockOptions).forEach(function(c){c&&b.setTargeting(c,a.adBlockOptions[c])}),c&&(b.addService(googletag.pubads()),this.definedSlots[a.adDivId]=b)):this.errSlotDefine||(this.errSlotDefine=1,this.logError("defineSlot failed"))}else this.errSlotOptions||
(this.errSlotOptions=1,this.logError("Missing slot ID or data ad options"))},cleanupSlots:function(){this.boundSlotRenderedListener=this.pageTargetingLast=null;if(window.googletag&&googletag.cmd){var a=this;googletag.cmd.push(function(){var b=[];Object.keys(a.definedSlots).forEach(function(c){b.push(a.definedSlots[c]);delete a.definedSlots[c]});b.length&&googletag.destroySlots(b);a.definedSlots={};a.allSlotsLoaded=0})}},onAdBlockDetected:function(){this.adBlocked||(this.adBlocked=1,this.replaceAllAdBlockedSlots())},
replaceAllAdBlockedSlots:function(){if(this.enabled){var a=this;Object.values(this.registeredSlots).forEach(function(b){a.replaceAdBlockedContent(b)})}},replaceAdBlockedContent:function(a){var b,c=" width\x3d'%s' height\x3d'%s' ",d=a&&a.adDivId?e("#"+a.adDivId):null;a&&a.adBlockedURL&&a.gptAdID&&d?(b=this.getAdSizes(a),c=e.isArray(b)?b[0]&&e.isArray(b[0])?c.format(b[0][0],b[0][1]):c.format(b[0],b[1]):c.format(a.gptAdWidth,a.gptAdHeight),d.html("\x3ciframe class\x3d'had-frame' frameborder\x3d'0' "+
c+" scrolling\x3d'no' src\x3d'"+a.adBlockedURL+"'\x3e\x3c/iframe\x3e")):d&&d.hide()},setWindowEvents:function(){var a=this,b=this.getWindowMessageEventName(),c;this.dfpHideData={};Object.values(this.registeredSlots).forEach(function(b){b&&b.adBlockOptions&&b.adBlockOptions.pos&&b.adBlockOptions.origin&&(c=b.adBlockOptions.origin.match(/\w+\.\w*\.(\w+)\./))&&1<c.length&&c[1]&&(a.dfpHideData[c[1]+"."+b.adBlockOptions.pos+".NoAd"]=e.extend({},b))});e(window).off(b).on(b,this.onWindowMessage.bind(this))},
getWindowMessageEventName:function(){return"message.displayad-"+this.id()},onWindowMessage:function(a){var b,c,d;this.enabled&&a&&a.originalEvent&&((c=this.options.smartAdWinMessageHosts||"")&&(c=c.replace(/(http(s)?:)?\/\//g,window.location.protocol+"//")),c+=","+window.location.protocol+"//"+window.location.host,this.dfpHideData&&a.originalEvent.data&&this.dfpHideData[a.originalEvent.data]?(c=this.dfpHideData[a.originalEvent.data])&&c.adDivId&&(e("#"+c.adDivId).hide(),f.config.getBoolean("ui.horizon.ads.trackCollapse",
!0)&&f.Analytics.api.trackEvent({category:"sra",action:"adcollapse",label:c.pageLocation})):a.originalEvent.origin&&0<=c.indexOf(a.originalEvent.origin)&&this.options.smartAdWinMessageID&&a.originalEvent.data[this.options.smartAdWinMessageID]&&((d=a.originalEvent.data[this.options.smartAdWinMessageID].pos)?(b=this,Object.values(this.registeredSlots).forEach(function(c){c.adBlockOptions&&d===c.adBlockOptions.pos&&b.kickoffSmartAd(a.originalEvent.data[b.options.smartAdWinMessageID],c)})):this.logError("No pos for smartad data: "+
d)))},kickoffSmartAd:function(a,b){if(f.config.getBoolean("ui.horizon.ads.loadSmartAd",!0)&&a&&b&&b.adDivId&&(a.searchid||(a.searchid=this.options&&this.options.pageOptions?this.options.pageOptions.searchid:null),a.provider_code&&a.searchid)){var c=this.getSmartAdURL(a);if(c){this.boundWindowSmartAdResize||(this.boundWindowSmartAdResize=this.onSmartAdGlobalResize.bind(this),window.resizeIframeToContents=this.boundWindowSmartAdResize);window.R9.Ads=window.R9.Ads||{};window.R9.Ads.SmartAd=window.R9.Ads.SmartAd||
{slots:{R0:{},R1:{},M0:{}},adjustBannerContainerSize:e.noop()};var d="",g=b.adBlockOptions&&b.adBlockOptions.origin;"string"===typeof a.sz&&(d=(d=a.sz.split("x"))&&2===d.length&&parseInt(d[0])&&parseInt(d[1])?" width\x3d'"+d[0]+"' height\x3d'"+d[1]+"' ":"");b.smartAd=e.extend({rank:b.gptAdID?b.gptAdID.substr(b.gptAdID.length-1,1):null,origin:g&&1<g.length?g.substr(g.length-2,2):null,reloaded:0,sized:0},a);this.subscriptions&&this.subscriptions["search.poll.response"]||this.subscribe("search.poll.response",
this.onSmartAdSearchPoll.bind(this));e("#"+b.adDivId).html("\x3ciframe class\x3d'smartad-frame' frameborder\x3d'0' "+d+" scrolling\x3d'no' src\x3d'"+c+"'\x3e\x3c/iframe\x3e")}else f.Analytics.api.trackEvent({category:"smartad",action:"urlfail",label:b.pageLocation})}},onSmartAdSearchPoll:function(a){if(a&&a.completed){this.unsubscribe("search.poll.response");var b=this;Object.values(this.registeredSlots).forEach(function(a){a&&a.smartAd&&!a.smartAd.reloaded&&(a.smartAd.reloaded=1,a.smartAd.sized=
0,setTimeout(function(){a.smartAd&&e("#"+a.adDivId).find(".smartad-frame").attr("src",b.getSmartAdURL(a.smartAd,"false")+"\x26reload\x3d1")},100))})}},onSmartAdGlobalResize:function(){var a=this;Object.values(this.registeredSlots).forEach(function(b){a.resizeSmartAd(b)})},resizeSmartAd:function(a){if(a&&a.adDivId&&a.smartAd&&!a.smartAd.sized){var b=e("#"+a.adDivId),c=b.find("iframe.smartad-frame").first(),d,g,f;if(c.length){try{d=c.contents().find("body")}catch(h){return}a.smartAd.sized=1;a=c.outerWidth();
g=c.outerHeight();f=d.outerWidth();d=d.outerHeight();2>f||2>d?b.hide():(a!==f&&c.attr("width",f),g!==d&&c.attr("height",d),b.outerWidth()!==f&&(b.width("auto"),b.css("max-width","none")),b.outerHeight()!==d&&(b.height("auto"),b.css("max-height","none")))}}},getSmartAdURL:function(a,b){if(!a)return null;"true"!==b&&"false"!==b&&(b="true");var c=a.rank||0,d=a.origin||"R0",g=a.provider_code?encodeURIComponent(a.provider_code):"",e=a.click_tracking?encodeURIComponent(a.click_tracking):"",f=a.sz?encodeURIComponent(a.sz):
"";return"/h/ads/smartad?provider_code\x3d"+g+"\x26searchid\x3d"+a.searchid+"\x26clicktracking\x3d"+e+"\x26sz\x3d"+f+"\x26rank\x3d"+c+"\x26logimpr\x3d"+b+"\x26strm\x3d\x26pageorigin_location\x3d"+d+"\x26isstreaming\x3d"},getAdSizes:function(a){var b;a.gptAdSizes&&(b=this.validateAdSizes(a.gptAdSizes));return b||this.validateAdSizes([parseInt(a.gptAdWidth),parseInt(a.gptAdHeight)])},validateAdSizes:function(a){var b=function(a){return!isNaN(a)&&0<a&&9999>a&&a===parseInt(a,10)},c=function(a){return a&&
a.pop&&2===a.length&&b(a[0])&&b(a[1])};if(!a||!a.pop)return null;if(c(a))return a;for(var d=0;d<a.length;d++)if(!c(a[d]))return null;return a},sameObjectProperties:function(a,b,c){if(!a||!b)return!1;var d;c=c||[];for(d in a)if(a.hasOwnProperty(d)&&!b.hasOwnProperty(d))return!1;for(d in b)if(b.hasOwnProperty(d)){if(!a.hasOwnProperty(d))return!1;if(!(0<=c.indexOf(d))&&a[d]!==b[d]){var e=a[d];if(e=e!==e)e=b[d],e=e!==e;if(!e)return!1}}return!0},logError:function(a){f.config.getBoolean("ui.ads.sra.log",
!0)&&this.log.error(a)}})})(window.R9,window.jQuery);(function(b,c){b.createComponentClass("common.frontdoor.FrontDoorAdDisplay",{columns:{left:null,middle:null,right:null},init:function(){this.columns.left=this.getChildElement("left");this.columns.middle=this.getChildElement("middle");this.columns.right=this.getChildElement("right")},addEventHandlers:function(){this.subscribe("fd.ad.display.left",this.adLoadedCallback.bind(this,"left"));this.subscribe("fd.ad.display.middle",this.adLoadedCallback.bind(this,"middle"));this.subscribe("fd.ad.display.right",
this.adLoadedCallback.bind(this,"right"))},adLoadedCallback:function(a,b){(a=this.columns[a])&&a.length&&(b.isEmpty?a.addClass("col-hidden"):a.removeClass("col-hidden"))}})})(R9,jQuery);(function(a){var c=a.config.getBoolean("ui.horizon.personalization.ajaxLoader.combine",!1);a.createComponentClass("common.personalization.AjaxLoader",{options:{action:"",params:{}},inlineComponentsReady:function(){var b=this;a.ajax.execute(this.options.action,{appendTo:this.element,replaceContainer:!0,combinable:c,data:this.options.params}).then(function(a){a.id||b.element.remove()}).fail(function(){b.element.remove()})}})})(R9);(function(b){R9.extend("Widgets",{TextInput:function(a,c){this.elementNode=a;this.element=b(this.elementNode);this.validateElement()&&(this.options=b.extend({},this.options,c),this.init())}});R9.extend("Widgets.TextInput",{isTextInput:function(a){return a&&a.nodeName&&"input"==a.nodeName.toLowerCase()&&"text"==a.type.toLowerCase()},isWidgetControlled:function(a){return"undefined"==typeof document.createElement("input").placeholder}});R9.extend("Widgets.TextInput.prototype",{widgetName:"textinput",
widgetBaseClass:"r9-textinput",widgetPlaceholderClass:"r9-textinput-placeholder-active",elementNode:null,element:null,options:{click:null,change:null},init:function(){this.bindInputEvent("focus",this.handleElementFocusEvent);this.bindInputEvent("smartyfocus",this.handleElementFocusEvent);this.bindInputEvent("blur",this.handleElementBlurEvent);this.bindFormSubmission();this.element.data(this.widgetName,this);this.element.is(":focus")||this.handleElementBlurEvent(this.elementNode)},validateElement:function(){return R9.Widgets.TextInput.isTextInput(this.elementNode)&&
R9.Widgets.TextInput.isWidgetControlled(this.elementNode)&&void 0===this.element.data(this.widgetName)},bindInputEvent:function(a,b){var c=this;a+="."+this.widgetName;this.element.unbind(a).bind(a,function(a){b.call(c,this,a)})},bindFormSubmission:function(){var a=this,b="submit."+a.widgetName+a.element.attr("id"),d="form-pre-submit."+a.widgetName+a.element.attr("id");this.element.parents("form").off(b).on(b,function(b){a.element.val()==a.element.attr("placeholder")&&a.clearPlaceholderText(a.element)});
this.element.parents("form").off(d).on(d,function(b){a.element.val()==a.element.attr("placeholder")&&a.clearPlaceholderText(a.element)})},handleElementFocusEvent:function(a,c){a.disabled||(b(a).val()==b(a).attr("placeholder")&&this.clearPlaceholderText(b(a)),this.options.focus&&this.options.focus.apply(this,arguments))},handleElementBlurEvent:function(a,c){a.disabled||(0==b.trim(b(a).val()).length&&this.setPlaceholderText(a),this.options.blur&&this.options.blur.apply(this,arguments))},clearPlaceholderText:function(a){a.removeClass(this.widgetPlaceholderClass).val("")},
setPlaceholderText:function(a){b(a).addClass(this.widgetPlaceholderClass).val(b(a).attr("placeholder"))}})})(jq||jQuery);
(function(b){R9.createWidgetClass("text.TextInput",b.extend({},R9.Widgets.TextInput.prototype,{widgetPlaceholderClass:"vs-placeholder",inputElement:null,options:{needsPlaceholderSupport:!1,selectOnFocus:!1},init:function(){this.inputElement=this.inputElement||this.element;this.elementNode=this.inputElement.get(0)},addEventHandlers:function(){var a=this;this.options.needsPlaceholderSupport&&(this.element.is(":focus")||this.handleElementBlurEvent(this.elementNode),this.bindInputEvent("focus",this.handleElementFocusEvent),
this.bindInputEvent("smartyfocus",this.handleElementFocusEvent),this.bindInputEvent("blur",this.handleElementBlurEvent));if(this.options.selectOnFocus)a.inputElement.on("focus",function(){a.inputElement.on("mouseup.a keyup.a",function(b){a.elementNode.setSelectionRange(0,9999);a.inputElement.off("mouseup.a keyup.a").select()})})},getValue:function(){return b(this.inputElement).val()}}))})(jq||jQuery);(function(a){a.createComponentClass("common.frontdoor.EmailSubscriptionPanelV2","common.frontdoor.EmailSubscriptionPanel",{options:{mainPanelHidden:"",successPanelVisible:""},onSubmitSuccess:function(){this.setSubscriptionStatusCookie();this.mainPanel.attr("class",this.options.mainPanelHidden).attr("aria-visible",!0);this.successPanel.attr("class",this.options.successPanelVisible).attr("aria-visible",!1);this.logEvent("success");a.events.publish("common.frontdoor.email-subscription.success",{id:this.id(),
email:this.emailAddress})}})})(R9);(function(b){b.createComponentClass("common.frontdoor.EmailSubscriptionPanel",{options:{source:"email-capture",hasSubscriptionCookieKey:"hasEmailSubscription",subscriptionEndpointUrl:"/a/api/subscription/byemail",toggableDisplay:!1},formElement:null,inputElement:null,mainPanel:null,successPanel:null,emailTooltip:null,closeTooltipTimer:null,emailAddress:"",toggleElement:null,mainContentWrap:null,allowBtnSubmit:!1,init:function(){this.formElement=this.getChildElement("signupForm");this.inputElement=
this.getChildElement("input");this.mainPanel=this.getChildElement("mainPanel");this.successPanel=this.getChildElement("successPanel");!0===this.options.toggableDisplay?(this.toggleElement=this.getChildElement("toggleBox"),this.mainContentWrap=this.getChildElement("mainContent"),this.handleContentToggle.call(this)):this.logEvent("show")},addEventHandlers:function(){this.isToggable()?(this.toggleElement.on("change",this.handleContentToggle.bind(this)),b.question.answer("email.subscription.validate."+
this.id(),this.handleToggleValidation.bind(this)),b.question.answer("email.subscription.submit."+this.id(),this.handleToggledSubmit.bind(this)),!0===this.options.allowBtnSubmit&&this.formElement.submit(this.handleSubmit.bind(this))):this.formElement.submit(this.handleSubmit.bind(this));this.inputElement.keydown(this.handleKeyDown.bind(this));this.inputElement.on("click touchend",this.logEvent.bind(this,"click"))},isToggable:function(){return!0===this.options.toggableDisplay},istoggableAndActive:function(){return this.isToggable()&&
!0===this.toggleElement.is(":checked")},handleToggledSubmit:function(){return this.istoggableAndActive()?this.onValidationSuccess():!0},handleToggleValidation:function(){return this.istoggableAndActive()?this.validateEmail(!1):{}},handleContentToggle:function(){this.mainContentWrap&&(!0===this.toggleElement.is(":checked")?(this.element.addClass("toggled"),this.mainContentWrap.show(),this.logEvent("show")):(this.element.removeClass("toggled"),this.mainContentWrap.hide(),this.logEvent("hide")))},handleSubmit:function(a){a.preventDefault();
this.validateEmail.call(this)},validateEmail:function(a){if(this.inputElement.val()){if(a=b.validation.customValidate(this.inputElement,/^.+@.+\..+$/,this.onValidationSuccess.bind(this,a),this.onInvalidEmail.bind(this)),this.isToggable()&&!a)return this.formatErrorMsg()}else this.onInvalidEmail.call(this)},handleKeyDown:function(a){"13"===a.which&&this.formElement.submit()},onInvalidEmail:function(){this.showErrorTooltip();this.logEvent("validationError")},onValidationSuccess:function(a){if(!1===
a)return!0;this.emailAddress=this.inputElement.val();a="?email\x3d"+encodeURIComponent(this.emailAddress)+"\x26source\x3d"+encodeURIComponent(this.options.source);var c=JSON.stringify(["all"]);this.disableInput();$.ajax({method:"POST",url:this.options.subscriptionEndpointUrl+a,contentType:"application/json",data:c,headers:{"X-CSRF":b.globals.formtoken}}).done(this.onSubmitSuccess.bind(this)).fail(this.onSubmitFailure.bind(this)).always(this.enableInput.bind(this));return!0},onSubmitSuccess:function(){this.setSubscriptionStatusCookie();
this.isToggable()&&!0!==this.options.allowBtnSubmit||(this.mainPanel.addClass("hidden-fade").attr("aria-visible",!0),this.successPanel.removeClass("hidden-fade").attr("aria-visible",!1));this.logEvent("success");b.events.publish("common.frontdoor.email-subscription.success",{id:this.id(),email:this.emailAddress})},onSubmitFailure:function(){this.showErrorTooltip();this.logEvent("submitError");b.events.publish("common.frontdoor.email-subscription.error",{id:this.id()})},setSubscriptionStatusCookie:function(){window.setMetaCookie(this.options.hasSubscriptionCookieKey,
!0)},showErrorTooltip:function(a){if(!this.isToggable()||this.options.allowBtnSubmit){var b=this.formatErrorMsg();this.emailTooltip?this.emailTooltip.setContent(b):(window.clearTimeout(this.closeTooltipTimer),this.inputElement.toolTip({extraClass:this.getExtraTooltipClass(),content:b,showImmediately:!0,activation:"focus",position:a||"top",closeOnBodyClick:!0}),this.emailTooltip=this.inputElement.data("toolTip"));this.emailTooltip.open();this.closeTooltipTimer=setTimeout(function(){this.emailTooltip.removeWidget()}.bind(this),
5E3)}},getExtraTooltipClass:function(){return"emailSubscriptionPanelTooltip"},formatErrorMsg:function(){return this.formElement.attr("data-invalid-message")},enableInput:function(){this.isToggable()||(this.formElement.removeClass("disabled").off("submit").submit(this.handleSubmit.bind(this)),this.inputElement.removeAttr("disabled"),this.getChildElement("submit").removeAttr("disabled"))},disableInput:function(){this.isToggable()||(this.formElement.addClass("disabled").off("submit"),this.inputElement.attr("disabled",
!0),this.getChildElement("submit").attr("disabled",!0))},logEvent:function(a){b.Analytics.api.trackEvent("EmailSubscriptionPanel/"+a)}})})(R9);(function(b,d){b.createComponentClass("framework.JavaScriptComponent",{options:{vertical:null,global:!1},addEventHandlers:function(){var a=this;this.subscribe("resultspage.JavaScriptComponent.cleanup",function(c){a.options.vertical===c||a.options.global?a.options.vertical=c:a.options.singleton?b.ComponentManager.removeSingleton(a._namespace):a.destroy()})}})})(R9,jQuery);(function(b){b.publish("common.personalization.FlightPriceAlertsUtils",{showEmailAlertError:function(a){b.events.publish("common.personalization.FlightPriceAlertsUtils.alertsaved.error",{error:a})},emailAlertSaveSuccess:function(a){b.events.publish("common.personalization.FlightPriceAlertsUtils.alertsaved.success",{alertid:a})},showDuplicateEmailAlertError:function(a,c){b.events.publish("common.personalization.FlightPriceAlertsUtils.alertsaved.error",{errorid:a,error:c})}});b.createComponentClass("common.personalization.FlightPriceAlertsController",
"framework.JavaScriptComponent",{alertFormData:{alertsrc:"toolbox",ac:null,alertid:"",action:null,hsrc:null,code:null,dest:null,desthint:null,destlist:null,depart_date:null,return_date:null,numtrav:1,travadl:1,travsen:0,travyth:0,travchd:0,travsinf:0,travlinf:0,cabin:"e",Enonstop:!1,depairports:null,retairports:null,airlines:"ALL",max:null,dtakeoffmin:"NONE",dtakeoffmax:"NONE",atakeoffmin:"NONE",atakeoffmax:null,dlandingmin:null,dlandingmax:null,alandingmin:null,alandingmax:"NONE",removeHistory:null,
createFromButton:!0,oneway:"n",dt:"e","1s":"Y","2s":"Y",fdsrc:"y"},options:{anonUser:!0},trackingId:"",init:function(){},addEventHandlers:function(){var a=this;this.subscribe("common.personalization.FlightPriceAlertController.createAlert",this.createEmailAlertFromParams.bind(this));this.subscribe("common.personalization.FlightPriceAlertController.deleteAlert",this.deletePriceAlert.bind(this));this.subscribe("common.personalization.FlightPriceAlertsUtils.alertsaved.success",function(b){a.handlePriceAlertSaved(b.alertid)});
this.subscribe("common.personalization.FlightPriceAlertsUtils.alertsaved.error",function(b){a.handlePriceAlertSaveFailed(b.error)})},createEmailAlertFromParams:function(a){0<a.trackingId.length&&0===this.trackingId.length&&(this.trackingId=a.trackingId,this.addParams(a.data),this.saveEmailPriceAlert())},serialize:function(){var a=this;return Object.keys(a.alertFormData).map(function(b){var c=a.alertFormData[b];return null===c||void 0===c||""===c?"":encodeURIComponent(b)+"\x3d"+encodeURIComponent(c)}).join("\x26")},
addParams:function(a){this.alertFormData=Object.assign(this.alertFormData,a)},saveEmailPriceAlert:function(){b.Analytics.api.trackEvent({category:"Price-Alert",action:"create",value:"new"});this.alertFormData.action="save";$.ajax({type:"POST",headers:{"X-CSRF":b.globals.formtoken},url:"/k/alertajax",data:this.serialize(),dataType:"script",error:function(a,c){b.events.publish("error.alert",{messages:c})}})},deletePriceAlert:function(a){this.options.anonUser?this.showAlertAuth():0<a.trackingId.length&&
0===this.trackingId.length&&(this.trackingId=a.trackingId,this.deleteEmailPriceAlert(a.alertid));b.Analytics.api.trackEvent({category:"Price-Alert",action:"delete",value:a.alertid})},deleteEmailPriceAlert:function(a){var c=this;$.ajax({type:"POST",url:"/h/hermes/prefs/ajax/alert/v1",headers:{"X-CSRF":b.globals.formtoken},data:{action:"delete",alertid:a},error:function(a,d){b.events.publish("error.alert",{messages:d});b.events.publish("common.personalization.FlightPriceAlertController.alertDeletionFailed."+
c.trackingId);c.trackingId=""},success:function(){c.trackingId=""}})},handlePriceAlertSaved:function(a){b.Analytics.api.trackEvent("pricealert/exactdate/create");this.alertFormData.alertid=a;b.events.publish("common.personalization.FlightPriceAlertController.alertSuccessfullySaved."+this.trackingId,a);this.trackingId=""},handlePriceAlertSaveFailed:function(a){b.events.publish("error.alert",{messages:a});b.events.publish("common.personalization.FlightPriceAlertController.alertSaveFailed."+this.trackingId);
this.trackingId=""},showAlertAuth:function(){var a={promo:"priceAlert",promoType:"alerts",aftershow:this.renderSearchDataForLogin.bind(this),success:function(){b.authentication.cached_dialog.close()}};b.authentication.showLogin(a)}})})(R9);(function(c,d){c.createComponentClass("seo.common.destinationtiles.ajax.SEODestinationLink",{title:null,toggle:null,content:null,options:{logClickEvents:!0,columnGroup:"",showSeoOverlay:!0,msg:{EXPAND_TEXT:"",COLLAPSE_TEXT:""}},Keys:{RETURN:13,SPACE:32},expanded:!1,init:function(c){this.title=this.getChildElement("title");this.toggle=this.getChildElement("toggle");this.content=this.getChildElement("content")},addEventHandlers:function(b){var a=this;this.options.logClickEvents&&this.initLoggingEvents();
this.options.showSeoOverlay&&(this.toggle.click(function(){a.toggleExpansion(!a.expanded);a.expanded&&c.events.publish("destinationlink.expanded",{columnGroup:a.options.columnGroup,id:a.id()})}).keydown(function(b){if(b.which===a.Keys.SPACE||b.which===a.Keys.RETURN)b.preventDefault(),a.toggleExpansion(!a.expanded),a.expanded&&c.events.publish("destinationlink.expanded",{columnGroup:a.options.columnGroup,id:a.id()})}),this.subscribe("destinationlink.expanded",{columnGroup:this.options.columnGroup},
function(b){a.id()!==b.id&&a.expanded&&(a.toggleExpansion(!1),a.options.logClickEvents&&c.Analytics.api.trackEvent({category:"seolinks",subPageId:"destinationTile",action:"toggle"}))}))},toggleExpansion:function(b){b!==this.expanded&&(this.expanded=b,c.dom.swapChildrenClasses(this.element,c.stylejam.seo.common.destinationtiles.ajax.SEODestinationLink,this.expanded?"collapsed":"expanded",this.expanded?"expanded":"collapsed"),this.content.attr("aria-expanded",this.expanded),this.toggle.attr("aria-label",
this.expanded?this.options.msg.COLLAPSE_TEXT:this.options.msg.EXPAND_TEXT))},initLoggingEvents:function(){this.element.on("click",".js-city-link",function(b){c.Analytics.api.trackEvent({category:"seocitylink",subPageId:"destinationTile",action:"click",label:d(b.currentTarget).data("type")})});if(this.options.showSeoOverlay)this.element.on("click",".js-link",function(b){c.Analytics.api.trackEvent({category:"seocitylink",subPageId:"destinationTile",action:"click",label:d(b.currentTarget).data("type")})})}})})(R9,
jQuery);(function(a,b){a.createComponentClass("seo.common.destinationtiles.ajax.SEODestinationLinks",{init:function(){},addEventHandlers:function(){this.element.on("click",".js-city-link, .js-link",function(c){a.Analytics.api.trackEvent({category:"seocitylink",subPageId:"destinationTile",action:"click",label:b(c.currentTarget).data("type")})});this.subscribe("destinationlink.expanded",function(){a.Analytics.api.trackEvent({category:"seolinks",subPageId:"destinationTile",action:"toggle"})})}})})(R9,jQuery);(function(d){d.createComponentClass("common.frontdoor.punto.PuntoDialog",{options:{redirectLink:"/in?cc\x3duy\x26lc\x3des",metaCookieKey:"PUNTO_DIALOG_REDIRECT_LANGUAGE",hideDays:30},trackClose:!0,init:function(){this.englishBtn=this.getChildElement("englishBtn");this.spanishBtn=this.getChildElement("spanishBtn");this.puntoDialogEl=this.getChildElement("puntoDialog");this.dialog=this.puntoDialogEl.dialog({openImmediately:!0,onClose:$.proxy(this.onDialogClose,this),onOpen:d.Analytics.api.trackEvent({category:"PuntoDialog",
action:"open"})}).getWidget()},addEventHandlers:function(){this.englishBtn.on("click",$.proxy(this.onBtnPress,this,"select-english",!1));this.spanishBtn.on("click",$.proxy(this.onBtnPress,this,"select-spanish",!0))},onDialogClose:function(){var a=this,b=function(){d.Analytics.api.trackEvent({category:"PuntoDialog",action:"close"});a.element.remove();a.destroy()};!0===this.trackClose?setMetaCookie(this.options.metaCookieKey,this.createMetaCookieVal(!1),b):b()},onBtnPress:function(a,b){var c=this;setMetaCookie(c.options.metaCookieKey,
c.createMetaCookieVal(b),function(){d.Analytics.api.trackEvent({category:"PuntoDialog",action:a});c.options.redirectLink&&b?setMetaCookie("ip.filter",!0,function(){window.location=window.location.origin+c.options.redirectLink}):c.dialog.close();c.trackClose=!1})},createMetaCookieVal:function(a){return(a?"es":"us")+"_"+this.getCookieDateStamp(this.options.hideDays)},getCookieDateStamp:function(a){var b=new Date;b.setDate(b.getDate()+a);a=this.padCookieDateStr(b.getDate());var c=this.padCookieDateStr(b.getMonth()+
1);return b.getFullYear()+c+a},padCookieDateStr:function(a){return 10>a?"0"+a:""+a}})})(R9);(function(c,d){c.createComponentClass("common.frontdoor.FrontDoorContent",{init:function(){this.element.find("img").unveil(500,function(){d(this).on("load",function(){this.style.opacity=1})}).trigger("unveil")},addEventHandlers:function(d){var a=this;c.events.subscribe("frontdoor.vertical.changed",function(b){b.vertical===a.vertical?a.show():a.hide()});c.events.subscribe(["frontdoor.view.changed","fdcontent.view.setview"],function(b){"inline"===b.view||"hidden"===b.view?a.hide():a.show()})},show:function(){this.element.removeClass("hidden")},
hide:function(){this.element.addClass("hidden")}})})(R9,jQuery);(function(c,d){function h(){var a=d.Deferred(),b=d("iframe[src^\x3d'https://smartlock.google.com/iframe/request']");return b.length&&0<b.height()?a.resolve(b):b.length?a.reject("Google Yolo widget found an iframe but with zero height "):a.reject("Google Yolo widget is unable to locate the iframe")}function f(a){var b=d.Deferred();window.setTimeout(b.resolve,a);return b}function g(a,b,c){var e=d.Deferred();a().then(e.resolve).catch(function(d){return 0>=c-1?e.reject(d):f(b).then(g.bind(null,a,b,c-
1)).then(e.resolve).catch(e.reject)});return e}c.createComponentClass("common.authentication.GoogleYolo",{options:{googleClientId:"",resizeWidgetOnLoad:!1,iframeLookupAttempts:10,widgetHeightAdjustment:-60,maxWidgetHeight:null,handleReload:!1},hasLoadError:!1,cancelShow:!1,init:function(){var a=this,b=c.storage.get("google-yolo-hide"),d=new Date;d.setDate(d.getDate()-7);if(!isNaN(b)&&parseInt(b)>d.getTime())return!0;jq.getScript("//smartlock.google.com/client",function(){setTimeout(function(){window.googleyolo?
a.cancelShow||(c.Analytics.api.trackEvent("googleyolo/impression"),window.googleyolo.hint({supportedAuthMethods:["https://accounts.google.com"],supportedIdTokenProviders:[{uri:"https://accounts.google.com",clientId:a.options.googleClientId}]}).then(function(a){c.Analytics.api.trackEvent("googleyolo/login");c.authentication.external.googleYolo.login(a)},function(b){switch(b.type){case "userCanceled":c.storage.set("google-yolo-hide",(new Date).getTime());c.Analytics.api.trackEvent("googleyolo/user-cancel");
break;case "noCredentialsAvailable":c.Analytics.api.trackEvent("googleyolo/no-credentials");a.hasLoadError=!0;break;default:c.Analytics.api.trackEvent("googleyolo/error/"+b.type),a.hasLoadError=!0}}),f(500).then(g.bind(null,h,500,a.options.iframeLookupAttempts)).then(a.manipulateIframe.bind(a)).catch(a.logIframeError.bind(a))):!c.globals.adBlock&&c.config.getBoolean("ui.social.debug",!1)&&a.log.warn("Google YOLO login failed to load")},3E3)})},addEventHandlers:function(){var a=this;this.subscribe("signin.open",
function(){a.cancelShow=!0});this.options.handleReload&&this.subscribe("googleauth.login.success",function(){setTimeout(function(){window.location.reload(!0)},300)})},manipulateIframe:function(a){this.options.resizeWidgetOnLoad&&a.height(a.height()+this.options.widgetHeightAdjustment);var b=this.options.maxWidgetHeight;b&&a.height()>b&&a.height(b);a.prop("tabindex",-1)},logIframeError:function(a){this.hasLoadError||this.log.error(a)}})})(R9,jQuery);(function(a,c){a.createComponentClass("base.frontdoor.FrontDoor",{options:{vertical:null},init:function(a){},addEventHandlers:function(c){var d=this;a.events.subscribe("frontdoor.view.changed",function(b){d.element.toggleClass("InlineView","inline"===b.view);a.events.publish("frontdoor.setview",b.view)})}})})(R9,jq||jQuery);(function(a,b){a.createComponentClass("flights.frontdoor.FlightFrontDoor","base.frontdoor.FrontDoor",{})})(R9,jQuery);(function(a,c){a.createComponentClass("common.kn.BlockerDetector",{wasBlocked:null,options:{selfAdsUrl:null,remoteAdsImgUrl:null},init:function(){var b=this;a.question.answer("adblock.detected",function(){return{adblock:b.wasBlocked}});a.events.when("ajaxComponent.highPriority.initialized",function(){b.options.selfAdsUrl&&c.ajax(b.options.selfAdsUrl,{complete:function(a,c){"error"===c&&b.blocked()}});if(b.options.remoteAdsImgUrl){var a=new Image;a.onerror=function(){b.blocked()};a.style="height:0;width:0;display:block";
a.src=b.options.remoteAdsImgUrl;a.alt="";document.body.appendChild(a)}})},blocked:function(){this.wasBlocked||(this.wasBlocked=1,a.Analytics.api.trackEvent("shields-up/detected"),a.events.publish("adblock.detected"),a.globals.adBlock=1)}})})(R9,jQuery);(function(a){a.createComponentClass("common.layout.StyleJamSiteWideMessage",$.extend({},a.Common.RedirectMessage.prototype,{redirectMessage:void 0,options:{redirectFromTo:void 0,redirectFromToAlt:void 0,upgradeBrowserEnabled:!1},upgradeId:void 0,init:function(){this.upgradeId=this.id("upgrade");this.containerId=this.id();this.redirectFromTo=this.options.redirectFromTo;this.redirectFromToAlt=this.options.redirectFromToAlt;this.updateRedirectUrl();this.bindRedirectAdt()},addEventHandlers:function(){this.subscribe("frontdoor.view.changed",
this.updateRedirectUrl.bind(this));null!==document.getElementById(this.upgradeId)&&a.ajax.execute("common/upgrade/UpgradeBrowser",{appendTo:this.upgradeId});this.registerEvent("click",this.element.find(".js-close"),function(){$(this).closest(".js-msgContainer").slideUp("slow");var a=$(this).attr("data-mc");setMetaCookie(a,!0)})}}))})(R9);(function(b){b.createComponentClass("common.layout.features.chatbot.ChatBotBanner",{init:function(){},inlineComponentsReady:function(){var a=this;setTimeout(function(){a.element.addClass("visible")},1E3)},addEventHandlers:function(){this.registerEvent("click",this.getChildElement("close"),this.hide.bind(this));b.config.getBoolean("ui.horizon.chatbot.banner.hideOnRP",!0)&&this.subscribe("resultspage.view.setvisible",this.hide.bind(this,!0))},hide:function(a){this.element.hide();"boolean"===typeof a&&
a||window.setMetaCookie("disableChatbotBanner","true")}})})(R9);function ConsentHandler(d){this.consentExpires=d&&0<=d.consentExpires?d.consentExpires:15552E6;this.declinedExpires=6048E5;this.CONSENT_NAME="DATA_CONSENT"}ConsentHandler.prototype.setConsentToCookie=function(d,c){c="undefined"===typeof c?!0:c;var a=new Date;a.setTime(a.getTime()+this.consentExpires);document.cookie=this.CONSENT_NAME+"\x3d"+c+";path\x3d/;expires\x3d"+a;d&&d({dataConsent:c})};
ConsentHandler.prototype.setDeclinedConsentCookie=function(d){var c=new Date;c.setTime(c.getTime()+this.declinedExpires);document.cookie=this.CONSENT_NAME+"\x3dfalse;path\x3d/;expires\x3d"+c;d&&d({dataConsent:!1})};ConsentHandler.prototype.getConsentFromCookie=function(){if(document.cookie){var d=this.CONSENT_NAME+"\x3dtrue";return document.cookie.split(";").some(function(c){return c&&c.trim&&c.trim()===d})}return!1};
ConsentHandler.prototype.getConsentCookieValue=function(){var d=this;if(document.cookie){var c=document.cookie.split(";").filter(function(a){return a&&a.trim&&0===a.trim().indexOf(d.CONSENT_NAME)});if(c.length)return"true"===c[0].trim().split("\x3d")[1]?!0:!1}return null};
(function(d,c){d.createComponentClass("common.tags.DataLayer",{consented:!1,ready:!1,consentHandler:null,consentEvents:null,gtmSourceSetup:!1,gtm:null,queue:null,options:{useConsentSetup:!1,consentExpires:0,noConsentDefersLoad:!1},init:function(a){this.queue=[];this.options.useConsentSetup?(this.consentHandler=new ConsentHandler({consentExpires:this.options.consentExpires}),this.consented=this.consentHandler.getConsentFromCookie()):this.consented=!0;this.consentEvents=d.config.getString("ui.horizon.cookie.consent.events",
"").split(",");this.gtm=c(a)[0];c(this.gtm).on("load",c.proxy(this.onLoadIFrame,this))},inlineComponentsReady:function(){!this.consented&&this.options.noConsentDefersLoad||this.loadGtm();d.question.ask("tags.dataLayer.hasCustomHandler")||this.updateDataLayer(this.getMainLayerParams())},addEventHandlers:function(){var a=this;this.options.useConsentSetup&&(this.subscribe(this.consentEvents,this.consentSuccess.bind(this)),this.subscribe("gdpr.cookie.declined",this.declinedConsent.bind(this)));d.events.subscribe("frontdoor.view.changed",
function(){if(a.ready)try{var b=that.gtm.contentWindow;b.history&&b.history.replaceState&&b.history.replaceState("",document.title,location.href);b.document.title=document.title}catch(e){}});this.subscribe("tags.dataLayer.push",function(b){b=b||{};b.attachMainParams&&(b=c.extend(a.getMainLayerParams(),b));b.hasOwnProperty("dataConsent")||(b.dataConsent=a.consented);delete b.attachMainParams;a.updateDataLayer(b)});d.question.answer("horizon.cookie.consent.value",function(){return a.consentHandler.getConsentCookieValue()})},
onLoadIFrame:function(){setTimeout(this.processQueue.bind(this),1)},processQueue:function(){this.ready=!0;for(var a=0,b;b=this.queue[a];a++)this.updateDataLayer(b)},cleanUndefinedVars:function(a){c.each(a,function(b,c){""!==c&&null!==c||delete a[b]})},updateDataLayer:function(a){a&&!a.hasOwnProperty("dataConsent")&&(a.dataConsent=this.consented);if(this.ready)try{this.log.console("updating data layer",a);var b=this.gtm.contentWindow;b.unifiedDataLayer||(b.unifiedDataLayer=[]);this.cleanUndefinedVars(a);
b.unifiedDataLayer.push(a)}catch(e){}else this.queue.push(a)},consentSuccess:function(){var a=this;!this.consented&&this.consentHandler&&this.consentHandler.setConsentToCookie(function(b){a.consented=!0;a.updateDataLayer(b);a.loadGtm()})},declinedConsent:function(){var a=this;this.consentHandler&&this.consentHandler.setDeclinedConsentCookie(function(b){a.consented=!1;a.updateDataLayer(b);a.loadGtm()},!1)},loadGtm:function(){this.gtmSourceSetup||(this.gtmSourceSetup=!0,this.gtm.src="/ugtm"+location.pathname+
location.search+location.hash)},getMainLayerParams:function(){var a=d.globals.analytics||{},b=c.extend({},this.options,{vertical:a.vertical||"unknown",screenId:a.screenId||a.pageId||"unknown",subScreenId:a.subScreenId||a.subPageId,eventName:this.options.eventName||"screenView",dataConsent:this.consented,placement:d.globals.placement||"",presentation:this.options.apPresentation});["apPresentation","useConsentSetup","consentExpires","noConsentDefersLoad"].forEach(function(a){delete b[a]});return b}})})(R9,
jQuery);(function(b,d){b.createComponentClass("common.tracking.IFrameGoogleTagManager",{options:{clickTripz:!1,updateDelay:100,useConsentSetup:!1,consentExpires:0,noConsentDefersLoad:!1},searchId:null,queue:null,ready:!1,consented:!1,CONSENT_NAME:"DATA_CONSENT",gtmSourceSetup:!1,init:function(a){this.gdprEvents=b.config.getString("ui.horizon.cookie.consent.iframegtm.events","").split(",");this.queue=[];this.consented=!this.options.useConsentSetup||this.getConsentFromCookie();this.setUpInitialData();this.gtm=
d(a)[0];d(this.gtm).on("load",d.proxy(this.onLoadIFrame,this));!this.consented&&this.options.noConsentDefersLoad||this.setupGtmSource()},setupGtmSource:function(){this.gtmSourceSetup||(this.gtmSourceSetup=!0,this.gtm.src="/gtm"+location.pathname+location.search+location.hash)},getConsentFromCookie:function(){if(document.cookie){var a=this.CONSENT_NAME+"\x3dtrue";return document.cookie.split(";").some(function(c){return c&&c.trim&&c.trim()===a})}return!1},consentSuccess:function(){if(!this.consented){this.consented=
!0;if(this.options.useConsentSetup){var a=new Date,c=0<=this.options.consentExpires?this.options.consentExpires:15552E6;a.setTime(a.getTime()+c);document.cookie=this.CONSENT_NAME+"\x3dtrue;path\x3d/;expires\x3d"+a}this.updateDataLayer({dataConsent:!0});this.setupGtmSource()}},onLoadIFrame:function(){setTimeout(this.processQueue.bind(this),1)},setUpInitialData:function(){var a=b.globals.analytics||[],c=a.pixelContext||{};this.updateDataLayer({vertical:a.vertical||b.globals.vertical,locale:b.globals.locale.loc,
affiliate:b.globals.affiliate,affiliateskin:b.globals.brand,placement:b.globals.placement||"",geoIpCc:b.globals.geoIpCc,experiment:b.globals.experiment,pageId:a.pageId,subPageId:a.subPageId,presentation:a.presentation||b.globals.presentation,clickTripz:this.options.clickTripz,pixelContext:c,dataConsent:this.consented,event:"pageView"});this.searchId=c.searchId},processQueue:function(){this.ready=!0;for(var a=0,c;c=this.queue[a];a++)this.updateDataLayer(c)},updateDataLayer:function(a){a&&!a.hasOwnProperty("dataConsent")&&
(a.dataConsent=this.consented);if(this.ready)try{this.log.console("updating data layer",a);var c=this.gtm.contentWindow;c.dataLayer||(c.dataLayer=[]);c.dataLayer.push(a)}catch(e){}else this.queue.push(a)},addEventHandlers:function(){var a=this;b.events.subscribe("frontdoor.view.changed",function(){if(a.ready)try{var c=a.gtm.contentWindow;c.history&&c.history.replaceState&&c.history.replaceState("",document.title,location.href);c.document.title=document.title}catch(f){}});var c=this.options.updateDelay;
b.events.subscribe("search.poll.response",function(b){b.pixelContext&&a.searchId!==b.pixelContext.searchId&&(setTimeout(a.updateDataLayer.bind(a,{event:"pageView",vertical:b.vertical,pageId:"results",pixelContext:b.pixelContext}),c),a.searchId=b.pixelContext.searchId);b.completed&&setTimeout(a.updateDataLayer.bind(a,{event:"resultsLoaded"}),c)});this.options.useConsentSetup&&b.events.subscribe(this.gdprEvents,this.consentSuccess.bind(this));b.events.subscribe(["login.success","fbauth.login.success",
"googleauth.login.success"],function(){a.updateDataLayer({event:"login"})});b.events.subscribe("signup.success",function(){a.updateDataLayer({event:"signup"})});b.events.subscribe("gtm.update",function(b){a.updateDataLayer(b)})}})})(R9,jq||jQuery);(function(a,e){a.createComponentClass("common.privacy.StyleJamHeaderCookiesMessage",{options:{gdprEnabled:!1},init:function(){var b="common/privacy/AjaxStyleJamHeaderCookiesMessage",c={type:"GET",replace:!0,combinable:a.config.getBoolean("ui.horizon.common.header.cookieMessage.combinable",!1),cacheable:a.config.getBoolean("ui.horizon.common.header.cookieMessage.cacheable",!1)};if(this.options.gdprEnabled){var d=window["@r9/gdpr"];d&&d.canShowConsentDialog()&&(b=a.config.getString("ui.horizon.common.gdpr.cookie.consent.dialog.url",
"common/gdpr/CookieConsent"),c={type:"GET",appendTo:e("body")})}a.ajax.execute(b,c)}})})(window.R9,window.jQuery);(function(b,a){b.createComponentClass("common.currency.StyleJamCurrencyMessage",{options:{displayLater:!1,displayImmediately:!1,cookieName:"hideCurrencyMessage"},isVisible:!1,closeBtn:void 0,init:function(b){this.closeBtn=a("#"+this.id("close"));this.options.displayImmediately?this.showMessage():this.options.displayLater&&(this.subscribe("resultspage.view.setvisible",a.proxy(this.showMessage,this)),this.subscribe("header.view.set",{view:"results"},a.proxy(this.showMessage,this)),this.subscribe("pageContainers.changed",
{state:"results"},a.proxy(this.showMessage,this)),this.subscribe("resultspage.routed",a.proxy(this.showMessage,this)))},addEventHandlers:function(){this.closeBtn.bind("click",a.proxy(this.close,this))},showMessage:function(){this.isVisible||(this.element.slideDown("slow"),window.setMetaCookie(this.options.cookieName,!0),this.isVisible=!0)},close:function(){this.element.slideUp("slow")}})})(window.R9,window.jQuery);(function(b,f){b.createComponentClass("common.layout.StyleJamNavLink",{loggingPrefix:"StyleJamNavLink",openedSwindleTab:!1,infoMarker:null,options:{url:null,active:!1,verticalName:null,preventNavigation:!1,pageStates:{default:{base:null,defaultState:null,activeState:null,infoMarker:null,viewTransition:null},results:{base:null,defaultState:null,activeState:null,infoMarker:null,viewTransition:null}},showFocusIndication:!1,focusedElement:""},view:null,init:function(){this.infoMarker=this.getChildElement("info-marker")},
addEventHandlers:function(){var a=this;a.element.on("click",function(d){var c=a.getStates();a.options.preventNavigation?(a.options.active||(b.events.publish("NavLink.clicked",{vertical:a.options.verticalName,url:a.options.url,active:a.options.active}),b.dom.swapClasses(a.element,c.defaultState,c.activeState),a.options.active=!0),d.preventDefault()):b.Analytics.api.trackEvent({category:a.loggingPrefix,action:"click",label:a.options.verticalName})});a.options.preventNavigation&&this.subscribe("NavLink.clicked",
this.onActiveNavChanged.bind(this));if(!b.config.getBoolean("ui.no.popup.enabled",!1)||"notloggedin"===b.globals.analytics.loginState){if(b.config.getBoolean("ui.search.swindle.enabled",!0)&&b.config.getBoolean("ui.search.swindle."+a.options.verticalName+".enabled",!0)&&(!b.config.getBoolean("ui.suppress.swindle",!1)||b.config.getBoolean("ui.suppress.swindle",!1)&&!b.storage.get("suppress_swindle")))a.element.on("click",function(d){var c=b.storage.get("lastSwindleClick"),e=b.config.getInt("ui.search.swindle.expiration",
864E5);if(("/"===document.location.pathname||"/hotels"===document.location.pathname)&&!a.options.active&&(!c||c+e<Date.now()))return b.storage.set("lastSwindleClick",Date.now()),b.events.publish("swindleTab.activated"),window.open(a.options.url,"_blank"),d.preventDefault(),!1});this.subscribe(["header.view.set","pageContainers.changed","sem.explore.form.change-state"],function(d){if(d.view||d.newstate){d=d.view||d.newstate;a.view="rp"===d?"results":d;var c=a.getStates();c&&(a.element.removeClass(),
a.infoMarker.removeClass(),a.element.addClass(c.viewTransition),window.setTimeout(function(){a.options.active?a.element.addClass(c.activeState):a.element.addClass(c.defaultState);a.infoMarker.length&&a.infoMarker.addClass(c.infoMarker);b.dom.schedule(function(){a.element.addClass(c.base);a.element.removeClass(c.viewTransition)})},0))}});this.subscribe("omni.vertical.changed",function(d){var c=a.getStates();a.options.verticalName!==d?(b.dom.swapClasses(a.element,c.activeState,c.defaultState),a.options.active=
!1):(b.dom.swapClasses(a.element,c.defaultState,c.activeState),a.options.active=!0)});this.options.showFocusIndication&&this.subscribe("body.accessibilityMode.enabled",function(d){d?b.dom.swapClasses(a.element,"",a.options.focusedElement):b.dom.swapClasses(a.element,a.options.focusedElement,"")})}},onActiveNavChanged:function(a){a.vertical!==this.options.verticalName&&this.options.active&&(a=this.getStates(),b.dom.swapClasses(this.element,a.activeState,a.defaultState),this.options.active=!1)},getStates:function(){return"results"===
this.view?this.options.pageStates.results:this.options.pageStates.default}})})(R9,jQuery);(function(a,c){a.createComponentClass("common.layout.StyleJamMoreNavMenuContent",{options:{isLogoutFullUrl:!1,flightTrackerV3Enabled:!1,parentId:void 0,preventNavigation:!1,contentLinksCacheable:!1,contentLinksCombinable:!1},loggingPrefix:"MoreNavMenuContent",init:function(){this.getChildElement("more-magazine").attr("target","_blank")},addEventHandlers:function(){var b=this;b.getChildElement("more-login").click(function(){a.authentication.showLogin()});b.getChildElement("more-logout").click(function(){a.Social.WebCredentials.requireUserMediation();
document.location="/k/ident/signout?redir\x3d"+encodeURIComponent(b.options.isLogoutFullUrl?window.location.href:window.location.pathname)});c(b.element).find("a").on("click",function(){a.Analytics.api.trackEvent({category:b.loggingPrefix,action:"click",label:c(this).attr("class")});if(b.options.preventNavigation)return c(this).hasClass("js-navselected")||(b.element.find("a.js-navselected").removeClass("js-navselected"),a.events.publish("NavLink.clicked",{vertical:c(this).attr("data-vertical"),url:c(this).attr("href"),
active:!0}),b.element.addClass("js-navselected"),a.dom.swapClasses(b.element,b.options.unselectedNavLinkClzs,b.options.selectedNavLinkClzs)),!1});b.options.flightTrackerV3Enabled&&b.getChildElement("more-flighttracker").click(function(e){e.preventDefault();var d="#"+b.options.parentId+"-navMoreMenu";e=c(d);d=c(d+"_content");0!==e.length&&0!==d.length&&(e.removeClass("open"),d.removeClass("open"));a.events.publish("menu.flightracker.click")})},inlineComponentsReady:function(){this.loadMissingLinksByAjax()},
loadMissingLinksByAjax:function(){var b={},e=[],d=[];c(".moreMenuItem").not("[href]").each(function(){var a=c(this),f=c(this).attr("data-vertical"),g=c(this).attr("data-morelink");f&&(b[f]=a,e.push(f));g&&(b[g]=a,d.push(g))});a.ajax.execute("common/layout/StyleJamMoreNavMenuContentLink",{data:{verticals:JSON.stringify(e),moreLinks:JSON.stringify(d)},cacheable:this.options.contentLinksCacheable,combinable:this.options.contentLinksCombinable,success:function(a){a.content&&(a=JSON.parse(a.content),c.each(a,
function(a,c){b[a].attr("href",c)}))}})}})})(R9,jQuery);(function(c,d){c.createComponentClass("common.layout.StyleJamMoreNavLink",{navMoreMenuDialog:null,options:{pageStates:{default:{base:null,defaultState:null,activeState:null},results:{base:null,defaultState:null,activeState:null}},showFocusIndication:!1,focusedElement:""},init:function(){this.getChildElement("navMoreMenu");this.navMoreMenuDialog=this.getChildElement("navMoreMenu").styleJamDropdownDialog().getWidget()},addEventHandlers:function(){var b=this;this.subscribe("DropdownDialog.open",{id:this.id("navMoreMenu")},
function(){c.events.publish("navMoreMenu.open")});this.subscribe("DropdownDialog.close",{id:this.id("navMoreMenu")},function(){b.element.focus();c.events.publish("navMoreMenu.close")});this.subscribe(["header.view.set","pageContainers.changed","sem.explore.form.change-state"],function(a){if(a.view||a.newstate)if(a=a.view||a.newstate,a=b.getStates("rp"===a?"results":a))b.element.removeClass(),b.element.addClass(a)});this.options.showFocusIndication&&this.subscribe("body.accessibilityMode.enabled",
function(a){a?c.dom.swapClasses(b.element,"",b.options.focusedElement):c.dom.swapClasses(b.element,b.options.focusedElement,"")})},getStates:function(b){return"results"===b?this.options.pageStates.results:this.options.pageStates.default}})})(R9,jQuery);(function(b,d){b.createComponentClass("common.layout.StyleJamNavigation",{options:{isAjaxableMoreNavLinkEnabled:!1,activeVertical:"",overflowVertical:"",showFocusIndication:!1},init:function(){this.options.isAjaxableMoreNavLinkEnabled&&this.loadValues()},loadValues:function(){var a=this.getData(this.options);b.ajax.execute("common/layout/StyleJamMoreNavLink",{data:d.extend({},a,{active:"more"===a.activeVertical,isTab:!0,currentVertical:a.activeVertical,underline:a.underlineLinks,hideBreakpoint:a.hideMoreBreakpoint,
styleJamPresentation:a.moreNavLinkPresentation,styleJamPresentationRP:a.moreNavLinkPresentationRP,activeStyleJamPresentation:a.activeMoreNavLinkPresentation,showFocusIndication:a.showFocusIndication,moreNavMenuOptions:JSON.stringify(a.moreNavMenuOptions),overrideLinks:JSON.stringify(a.overrideLinks),seo:b.globals.isSeo}),appendTo:this.element.find(".col.js-vertical-more"),replace:!0})},getData:function(a){var b={},c;for(c in a)a.hasOwnProperty(c)&&null!==a[c]&&(b[c]=a[c]);return b}})})(R9,$);(function(c,l){c.createWidgetClass("checkbox.Toggle",{widgetName:"checkbox",icon:null,input:null,label:null,onText:null,offText:null,clicking:!1,options:{keydown:l.noop,click:null,change:null,focus:null,blur:null},jQueryConstructorName:"toggleInput",isValidElement:function(){return"input"===this.input.get(0).nodeName&&"checkbox"===this.input.get(0).type},init:function(){this.input=this.getChildElement("input");this.label=this.getChildElement("label");this.icon=this.getChildElement("icon");this.onText=
this.getChildElement("text-on");this.offText=this.getChildElement("text-off")},addEventHandlers:function(){this.registerEvent("click.checkbox",this.input,this._handleElementClickEvent.bind(this));this.registerEvent("change.checkbox",this.input,this._handleElementChangeEvent.bind(this));this.registerEvent("keydown.checkbox",this.input,this._handleKeydownEvent.bind(this));this.registerEvent("focus.checkbox",this.input,this._handleElementFocusEvent.bind(this));this.registerEvent("blur.checkbox",this.input,
this._handleElementBlurEvent.bind(this))},_handleElementClickEvent:function(){this.options.click&&this.options.click.apply(this,arguments)},_handleElementChangeEvent:function(a){var b=this.input.prop("checked");this.styleChecked(b);this.input.attr("aria-checked",b);this.onText.length&&this.offText.length&&this.label.attr("aria-label",b?this.onText.html():this.offText.html());this.options.change&&this.options.change.apply(this,[b,a])},_handleKeydownEvent:function(a){if(a.which===c.globals.keyCodes.RETURN||
a.which===c.globals.keyCodes.SPACE)return this.input.prop("checked",!this.input.prop("checked")),this.input.change(),!1},_handleElementFocusEvent:function(a,b,c){a.disabled||(this.styleFocus(!0),this.options.focus&&this.options.focus.apply(this,arguments))},_handleElementBlurEvent:function(a,b,c){a.disabled||(this.styleFocus(!1),this.options.blur&&this.options.blur.apply(this,arguments))},setEnabled:function(a){a?this.input.removeAttr("disabled"):this.input.attr("disabled","disabled");this.input.attr("aria-disabled",
!a);this.input.attr("tabindex",a?0:-1);this.styleEnabled(a)},getValue:function(){return this.input.prop("checked")},setChecked:function(a){this.input.prop("checked",a)},setLabel:function(a){this.label.text(a)},styleChecked:function(a){var b=a?"on":"off";a=a?"off":"on";c.dom.swapClasses(this.icon,this.getStlBlock("Toggle__icon--"+a),this.getStlBlock("Toggle__icon--"+b));c.dom.swapClasses(this.icon.children("svg"),this.getStlBlock("Toggle__icon__svg--"+a),this.getStlBlock("Toggle__icon__svg--"+b));
c.dom.swapClasses(this.label,this.getStlBlock("Toggle__label--"+a),this.getStlBlock("Toggle__label--"+b));c.dom.swapClasses(this.onText,this.getStlBlock("Toggle__label__text--"+a),this.getStlBlock("Toggle__label__text--"+b));c.dom.swapClasses(this.offText,this.getStlBlock("Toggle__label__text--"+b),this.getStlBlock("Toggle__label__text--"+a));this.styleFocus(this.isInputFocused())},styleEnabled:function(a){var b=a?"enabled":"disabled";a=a?"disabled":"enabled";c.dom.swapClasses(this.element,this.getStlBlock("Toggle--"+
a),this.getStlBlock("Toggle--"+b));c.dom.swapClasses(this.input,this.getStlBlock("Toggle__input--"+a),this.getStlBlock("Toggle__input--"+b));c.dom.swapClasses(this.label,this.getStlBlock("Toggle__label--"+a),this.getStlBlock("Toggle__label--"+b))},styleFocus:function(a){var b=this.input.prop("checked"),e=b?"on":"off",g=this.getStlBlock("Toggle__icon--focused-on"),d=this.getStlBlock("Toggle__icon--focused-off"),f=this.getStlBlock("Toggle__icon--"+e),h=this.getStlBlock("Toggle__label--focused-on"),
k=this.getStlBlock("Toggle__label--focused-off"),e=this.getStlBlock("Toggle__label--"+e);a?(a=b?g:d,d=(b?d:g)+" "+f,f=b?h:k,b=(b?k:h)+" "+e):(a=f,d=g+" "+d,f=e,b=h+" "+k);g&&c.dom.swapClasses(this.icon,d,a);h&&c.dom.swapClasses(this.label,b,f)},isInputFocused:function(){return document.activeElement===this.input.get(0)}})})(R9,jQuery);(function(c,d){c.createComponentClass("common.authentication.StyleJamLoginForm",{url:"/k/run/auth/login",loggingPrefix:"account-login",usernameEl:null,passwordEl:null,submitEl:null,stickyWidget:null,trackCategory:"LoginForm",options:{onSubmit:null,newDialog:!1,promoType:"",improvedMessaging:!1,inline:!1,msg:{missingPassword:"",passwordTooShort:"",submitButton:"",submitButtonProcessing:""},useForgotDialog:!1,inputValidationEnabled:!1,reloadOnSuccess:!0,eventId:null},init:function(){this.usernameEl=
this.getChildElement("username");this.passwordEl=this.getChildElement("password");this.forgotEl=this.getChildElement("forgot");this.submitEl=this.getChildElement("submit");this.form=this.getChildElement("form")},addEventHandlers:function(){var a=this;this.form.submit(this.doLogin.bind(this));this.subscribe("authentication.viewChange",this.onViewChange.bind(this));this.options.inline||this.subscribe("authentication.showLogin",function(b){b&&a.hasEventIdMismatch(b.id)||b&&"login"===b.type&&a.focusEmptyInput()});
this.forgotEl.click(function(){c.Analytics.api.trackEvent({category:a.trackCategory,action:"click",value:"forgot-link"});c.events.publish("authentication.viewChange",{type:"forgot",id:a.options.eventId})});this.options.newDialog&&(this.getChildElement("cancel").click(function(){c.events.publish("authentication.setView",{type:"default",id:a.options.eventId})}),this.element.find(".footerGrid .signup").click(function(){c.events.publish("authentication.setView",{type:"signup",id:a.options.eventId})}));
this.answer(this.namespaceQuestionName("authentication.login.username"),function(){return a.usernameEl.val()})},inlineComponentsReady:function(){var a=this,b=this.getChildElement("remember");b.length&&(this.stickyWidget=b.getWidget(),this.stickyWidget.options.change=function(b){c.Analytics.api.trackEvent({category:a.trackCategory,action:"remember",value:b?"yes":"no"})})},namespaceQuestionName:function(a){var b=this.options.eventId;return b?a+"."+b:a},doLogin:function(){var a={};a.username=this.usernameEl.val();
a.passwd=this.passwordEl.val();if(8>a.passwd.length)return c.events.publish("login.error",{formToken:null,message:0===a.passwd.length?this.options.msg.missingPassword:this.options.msg.passwordTooShort,status:-1,uid:null,userInfo:null,element:this.passwordEl,id:this.options.eventId}),!1;this.stickyWidget&&(a.sticky=this.stickyWidget.getValue());this.toggleSubmittingState(!0);"function"===typeof this.options.onSubmit?this.options.onSubmit.call(this,a):d.ajax({method:"POST",url:this.url,headers:{"X-CSRF":c.globals.formtoken},
data:a}).done(this.success.bind(this)).fail(this.fail.bind(this));return!1},success:function(a){0<=a.status?(c.storage.set("R9ScrollY",window.document.documentElement.scrollTop||window.document.body.scrollTop),c.authentication.formToken=a.formToken,c.authentication.userInfo=a.userInfo,c.events.publish("login.success",{username:this.usernameEl.val(),id:this.options.eventId}),c.Analytics.api.trackEvent({category:this.loggingPrefix,action:"success"}),this.options.reloadOnSuccess||this.toggleSubmittingState(!1)):
(this.toggleSubmittingState(!1),a.id=this.options.eventId,this.options.improvedMessaging&&(a.element="p"===a.errorField?this.passwordEl:"u"===a.errorField?this.usernameEl:null),c.events.publish("login.error",a))},fail:function(){c.events.publish("login.fail",{id:this.options.eventId});this.toggleSubmittingState(!1)},toggleSubmittingState:function(a){var b=this.options.msg;a?this.submitEl.focus().text(b.submitButtonProcessing).prop("disabled",!0):this.submitEl.text(b.submitButton).prop("disabled",
!1)},focusEmptyInput:function(a){var b=this;a=a||0;window.setTimeout(function(){b.usernameEl.is(":visible")?b.usernameEl.val()?b.passwordEl.focus():b.usernameEl.focus():10>a&&(a+=1,b.focusEmptyInput(a))},50)},hasEventIdMismatch:function(a){return this.options.eventId&&a&&this.options.eventId!==a},onViewChange:function(a){this.hasEventIdMismatch(a.id)||("login"===a.type?(this.swapClasses(this.element,"Wrapper--hidden","Wrapper--visible"),this.element.attr("aria-hidden",!1).fadeIn("slow"),this.focusEmptyInput(),
c.Analytics.api.trackEvent({category:this.trackCategory,action:"visible"}),a.username?this.usernameEl.val(a.username):this.usernameEl.val()||(a=c.question.ask(this.namespaceQuestionName("authentication.register.username")))&&this.usernameEl.val(a)):"signup"===a.type&&(this.element.attr("aria-hidden",!0).css("display",""),this.swapClasses(this.element,"Wrapper--visible","Wrapper--hidden")))}})})(R9,jq||jQuery);(function(b,d){b.createComponentClass("common.authentication.StyleJamSignupForm",{url:"/k/run/auth/register",loggingPrefix:"account-login",usernameEl:null,passwordEl:null,airportEl:null,airportCodeEl:null,hasAirport:!1,submitEl:null,optInWidget:null,form:null,legalCheckWidget:null,trackCategory:"SignupForm",options:{improvedMessaging:!1,inline:!1,promo:null,promoType:null,redirectUrl:null,inputValidationEnabled:!1,legalAuthRequired:!1,reloadOnSuccess:!0,eventId:null,confirmed:"",confcode:"",msg:{passwordTooShort:"",
submitButton:"",submitButtonProcessing:""}},init:function(){this.usernameEl=this.getChildElement("username");this.passwordEl=this.getChildElement("password");this.airportEl=this.getChildElement("airport");this.airportCodeEl=this.element.find("input[name\x3dairportcode]");this.hasAirport=this.airportEl.length&&this.airportCodeEl.length;this.submitEl=this.getChildElement("submit");this.form=this.getChildElement("form")},bindAirportSmarty:function(){var a=this.airportCodeEl;this.airportEl.flightSmarty({setItem:function(c,
b){b&&setTimeout(function(){"ap"===b.type||"rail"===b.type?(c.elementNode.value=b.short_str||b.str,a.val(b.id)):"isl"===b.type&&(c.elementNode.value=b.str,a.val(""))},1)}})},addEventHandlers:function(){var a=this;this.hasAirport&&this.bindAirportSmarty();this.form.submit(this.doSignup.bind(this));this.options.inline||(this.subscribe("authentication.viewChange",this.onViewChange.bind(this)),this.subscribe("authentication.showLogin",function(b){b&&a.hasEventIdMismatch(b.id)||b&&"signup"===b.type&&a.focusEmptyInput()}));
this.answer(this.namespaceQuestionName("authentication.register.username"),function(){return a.usernameEl.val()})},inlineComponentsReady:function(){var a=this;this.optInWidget=this.getChildElement("email").getWidget();this.optInWidget.options.change=function(c){b.Analytics.api.trackEvent({category:a.trackCategory,action:"click",value:c?"opt-in":"opt-out"})};var c=this.getChildElement("legalcheck");c.length&&(this.legalCheckWidget=c.getWidget(),this.legalCheckWidget.options.change=function(c){b.Analytics.api.trackEvent({category:a.trackCategory,
action:"consent",value:c?"yes":"no"})})},namespaceQuestionName:function(a){var b=this.options.eventId;return b?a+"."+b:a},doSignup:function(){var a=d.extend({},this.options);a.username=this.usernameEl.val();a.passwd=this.passwordEl.val();if(this.options.improvedMessaging&&8>this.passwordEl.val().length)return b.events.publish("signup.error",{formToken:null,message:this.options.msg.passwordTooShort,status:-1,uid:null,userInfo:null,element:this.passwordEl,id:this.options.eventId}),!1;this.hasAirport&&
(a.airport=this.airportEl.val(),a.airportcode=this.airportCodeEl.val());a.username=this.usernameEl.val();a.optin=this.optInWidget.getValue();a.promo=this.options.promo;a.optin?b.Analytics.api.trackEvent({category:this.loggingPrefix,action:"email-opt-in",label:this.options.promoType}):b.Analytics.api.trackEvent({category:this.loggingPrefix,action:"email-opt-out",label:this.options.promoType});a.consent="";a.passwd=this.passwordEl.val();a.sub="";a.userInfo="";this.options.legalAuthRequired&&this.legalCheckWidget&&
(a.consent=this.legalCheckWidget.getValue());this.toggleSubmittingState(!0);d.ajax({method:"POST",url:this.url,headers:{"X-CSRF":b.globals.formtoken},data:a}).done(this.success.bind(this)).fail(this.fail.bind(this));return!1},success:function(a){0<=a.status?(b.authentication.formToken=a.formToken,b.authentication.userInfo=a.userInfo,b.events.publish("signup.success"),b.Analytics.api.trackEvent({category:this.loggingPrefix,action:"success"}),this.options.reloadOnSuccess||this.toggleSubmittingState(!1)):
(this.toggleSubmittingState(!1),"p"===a.errorField&&"login"===a.errorAction?(b.events.publish("authentication.viewChange",{type:"login",id:this.options.eventId}),b.events.publish("login.error",d.extend({},a,{id:this.options.eventId}))):this.options.improvedMessaging?b.events.publish("signup.error",{code:a.status,message:a.message,element:"p"===a.errorField?this.passwordEl:"u"===a.errorField?this.usernameEl:null,id:this.options.eventId}):b.events.publish("signup.error",{code:a.status,message:a.message,
id:this.options.eventId}))},fail:function(){b.events.publish("signup.fail",{id:this.options.eventId});this.toggleSubmittingState(!1)},toggleSubmittingState:function(a){var b=this.options.msg;a?this.submitEl.focus().text(b.submitButtonProcessing).prop("disabled",!0):this.submitEl.text(b.submitButton).prop("disabled",!1)},focusEmptyInput:function(a){var b=this;a=a||0;window.setTimeout(function(){b.usernameEl.is(":visible")?""===b.usernameEl.val()?b.usernameEl.focus():b.passwordEl.focus():10>a&&(a+=
1,b.focusEmptyInput(a))},50)},hasEventIdMismatch:function(a){return this.options.eventId&&a&&this.options.eventId!==a},onViewChange:function(a){this.hasEventIdMismatch(a.id)||("signup"===a.type?(this.swapClasses(this.element,"Wrapper--hidden","Wrapper--visible"),this.element.attr("aria-hidden",!1).fadeIn("slow"),this.focusEmptyInput(),b.Analytics.api.trackEvent({category:this.trackCategory,action:"visible"}),a.username?this.usernameEl.val(a.username):this.usernameEl.val()||(a=b.question.ask(this.namespaceQuestionName("authentication.login.username")))&&
this.usernameEl.val(a)):"login"===a.type&&(this.swapClasses(this.element,"Wrapper--visible","Wrapper--hidden"),this.element.attr("aria-hidden",!0).css("display","")))}})})(R9,jQuery);(function(c,d){c.createComponentClass("common.authentication.StyleJamForgotPasswordForm",{url:"/k/run/auth/forgot",formContainer:null,successContainer:null,emailInput:null,forgotForm:null,options:{eventId:null,msg:{submitButton:"",submitButtonProcessing:""}},init:function(){this.formContainer=this.getChildElement("formContainer");this.successContainer=this.getChildElement("successContainer");this.emailInput=this.getChildElement("email");this.submit=this.getChildElement("submit");this.cancelButton=
this.getChildElement("cancel");this.forgotForm=this.getChildElement("form");this.successLink=this.getChildElement("success-link")},addEventHandlers:function(){var a=this;this.subscribe("authentication.viewChange",this.handleViewChange.bind(this));this.forgotForm.submit(this.handleFormSubmit.bind(this));d(this.cancelButton).click(function(){c.events.publish("authentication.viewChange",{id:a.options.eventId,type:"login",username:a.emailInput.val()})});this.registerEvent("click",this.successLink,function(){c.events.publish("authentication.forgot.success")})},
hasEventIdMismatch:function(a){return this.options.eventId&&a&&this.options.eventId!==a},namespaceQuestionName:function(a){var b=this.options.eventId;return b?a+"."+b:a},handleViewChange:function(a){var b=this;this.hasEventIdMismatch(a.id)||("forgot"===a.type&&(this.showForm(),this.element.fadeIn("slow"),window.setTimeout(function(){b.emailInput.focus()},1)),a.username&&this.emailInput.val(a.username))},handleFormSubmit:function(a){var b=this.emailInput.val();a.preventDefault();this.disableInput();
d.ajax({method:"POST",url:this.url,headers:{"X-CSRF":c.globals.formtoken},data:{username:b}}).always(this.handleResponse.bind(this))},showForm:function(){this.swapClasses(this.successContainer,"Form__Success--visible","Form__Success--hidden");this.successContainer.attr("aria-hidden","true");this.swapClasses(this.formContainer,"Form--hidden","Form--visible");this.formContainer.attr("aria-hidden","false");if(!this.emailInput.val()){var a=c.question.ask(this.namespaceQuestionName("authentication.login.username"));
a&&this.emailInput.val(a)}},handleResponse:function(){this.showSuccessMessage();this.enableInput()},showSuccessMessage:function(){this.swapClasses(this.successContainer,"Form__Success--hidden","Form__Success--visible");this.successContainer.attr("aria-hidden","false");this.swapClasses(this.formContainer,"Form--visible","Form--hidden");this.formContainer.attr("aria-hidden","true");this.successLink.focus()},enableInput:function(){this.emailInput.focus();this.submit.text(this.options.msg.submitButton).removeClass("Button-Disabled").prop("disabled",
!1).attr("aria-busy",!1)},disableInput:function(){this.submit.text(this.options.msg.submitButtonProcessing).addClass("Button-Disabled").prop("disabled",!0).attr("aria-busy",!0)}})})(R9,$);(function(b,c){var d=b.config.getBoolean("ui.common.authentication.allowRedirect",!1);b.createComponentClass("common.authentication.OneStepSignin",{options:{usingCustomCallback:!1,socialApiErrorMessage:"",redirectUrl:null,inputValidationEnabled:!1,dropdown:!1,errorToolTip:!1,showFacebookLogin:!0,showGoogleLogin:!0,strictNamespaceCheck:!1,msg:{loginHeaderWelcome:"",loginHeaderDesc:"",registerHeaderWelcome:"",registerHeaderDesc:""}},headerWelcome:null,headerDesc:null,trackCategory:"OneStepSignin",dialog:null,
loginContainer:null,signupContainer:null,errorContainer:null,forgotDialogEl:null,forgotDialog:null,forgotSuccess:!1,linkToLogin:null,linkToRegister:null,googleConnectButton:null,fbConnectButton:null,init:function(){this.loginContainer=this.getChildElement("loginContainer");this.signupContainer=this.getChildElement("signupContainer");this.forgotDialogEl=this.getChildElement("forgotDialog");this.fbConnectButton=this.getChildElement("facebookLogin");this.googleConnectButton=this.getChildElement("googleLogin");
this.linkToLogin=this.getChildElement("linkToLogin");this.linkToRegister=this.getChildElement("linkToRegister");this.errorContainer=this.getChildElement("error");this.headerWelcome=this.getChildElement("headerWelcome");this.headerDesc=this.getChildElement("headerDesc");this.disclaimer=this.getChildElement("disclaimer")},addEventHandlers:function(){var a=this;a.getChildElement("linkToRegister").click(function(){b.Analytics.api.trackEvent({category:a.trackCategory,action:"click",value:"register-link"});
b.events.publish("authentication.viewChange",{type:"signup",id:a.id()})});a.getChildElement("linkToLogin").click(function(){b.Analytics.api.trackEvent({category:a.trackCategory,action:"click",value:"login-link"});b.events.publish("authentication.viewChange",{type:"login",id:a.id()})});a.subscribe("authentication.viewChange",a.changeView.bind(this));a.subscribe("authentication.showLogin",a.onOpen.bind(this));a.subscribe(["social.error","login.error","signup.error"],a.showError.bind(this));this.subscribe(["login.success",
"signup.success","fbauth.login.success","googleauth.login.success"],this.handleAuthSuccess.bind(this));this.subscribe("authentication.forgot.success",function(){a.forgotSuccess=!0;a.forgotDialog.close()})},inlineComponentsReady:function(){var a=this;this.options.showFacebookLogin&&b.Social.FB.ensureAPILoaded().then(this.setupFacebookLogin.bind(this)).catch(this.handleMissingFacebookLogin.bind(this));this.options.showGoogleLogin&&b.Social.Google.ensureAPILoaded().then(this.setupGoogleLogin.bind(this)).catch(this.handleMissingGoogleLogin.bind(this));
var c={preventClosingClickBubble:!0};this.options.dropdown&&(c.onClose=function(){a.forgotSuccess?a.forgotSuccess=!1:b.events.publish("header.navMenu.dropdown.open",{source:"forgot"})});this.forgotDialog=this.forgotDialogEl.dialog(c).getWidget()},setupFacebookLogin:function(){var a=this;this.fbConnectButton.click(function(){b.Analytics.api.trackEvent({category:a.trackCategory,action:"click",value:"facebook"});b.authentication.external.facebook.login(null,null,null,null,{id:a.id()})});window.FB.XFBML.parse()},
handleMissingFacebookLogin:function(){this.googleConnectButton.length&&this.googleConnectButton.find(".googleOuterLarge").removeClass("googleOuterLarge");this.handleMissingSocialAPI(this.fbConnectButton,"r9.facebook.api.loaded",function(){this.setupFacebookLogin()})},setupGoogleLogin:function(){var a=this;this.googleConnectButton.click(function(){b.Analytics.api.trackEvent({category:a.trackCategory,action:"click",value:"google"});b.authentication.external.google.login(null,null,null,{id:a.id()})})},
handleMissingGoogleLogin:function(){this.handleMissingSocialAPI(this.googleConnectButton,"r9.google.api.loaded",this.setupGoogleLogin.bind(this))},handleMissingSocialAPI:function(a,b,c){var d=this,e=a.children(".js-social-button-content");this.swapClasses(e,"SocialButton__Content--active","SocialButton__Content--disabled");a.attr({"aria-disabled":!0,"aria-label":this.options.socialApiErrorMessage});this.options.socialApiErrorMessage&&a.toolTip({content:this.options.socialApiErrorMessage,position:"top",
extraClass:"modal-layer",showImmediately:!1,readContentOnOpen:!0});this.subscribe(b,function(){d.swapClasses(e,"SocialButton__Content--disabled","SocialButton__Content--active");a.attr("aria-disabled",!1).removeAttr("aria-label");a.data("toolTip")&&a.data("toolTip").removeWidget();"function"===typeof c&&c()})},onOpen:function(a){b.events.publish("authentication.viewChange",c.extend({},a,{id:this.id()}))},changeView:function(a){!this.hasEventIdMismatch(a.id)&&a.type&&("login"===a.type?(this.swapClasses(this.linkToRegister,
"SwitchLink--hidden","SwitchLink--visible"),this.swapClasses(this.linkToLogin,"SwitchLink--visible","SwitchLink--hidden"),this.swapClasses(this.disclaimer,"Privacy--visible","Privacy--hidden"),this.updateHeaderText(a.type),this.forgotDialog.close()):"signup"===a.type?(this.swapClasses(this.linkToRegister,"SwitchLink--visible","SwitchLink--hidden"),this.swapClasses(this.linkToLogin,"SwitchLink--hidden","SwitchLink--visible"),this.swapClasses(this.disclaimer,"Privacy--hidden","Privacy--visible"),this.updateHeaderText(a.type),
this.forgotDialog.close()):"forgot"===a.type&&this.forgotDialog.open(),this.hideError())},updateHeaderText:function(a){"login"===a?(this.headerWelcome.text(this.options.msg.loginHeaderWelcome),this.headerDesc.text(this.options.msg.loginHeaderDesc)):(this.headerWelcome.text(this.options.msg.registerHeaderWelcome),this.headerDesc.text(this.options.msg.registerHeaderDesc))},showError:function(a){this.hasEventIdMismatch(a.id)||(this.options.errorToolTip?(c(".username, .pass, .auth-tooltip-hook").each(function(){c(this).data("toolTip")&&
c(this).data("toolTip").removeWidget()}),(a.element||this.element.find(".auth-tooltip-hook:visible")).toolTip({content:a.message,baseClass:"loginDlgError",extraClass:"modal-layer",position:"top",showImmediately:!0,activation:"click",readContentOnOpen:!0})):(this.errorContainer.html(a.message),this.swapClasses(this.errorContainer,"ErrorMessage--hidden","ErrorMessage--visible")))},hideError:function(){!this.options.errorToolTip&&this.errorContainer.length&&(this.errorContainer.html(""),this.swapClasses(this.errorContainer,
"ErrorMessage--visible","ErrorMessage--hidden"))},handleAuthSuccess:function(a){a&&(this.options.strictNamespaceCheck&&this.id()!==a.id||this.hasEventIdMismatch(a.id))||(b.authentication.needsRefresh=!0,this.hideError(),d&&this.options.redirectUrl?(b.storage.remove("R9ScrollY"),window.location=this.options.redirectUrl):this.options.usingCustomCallback?b.events.publish("authentication.success",{id:this.id()}):setTimeout(function(){window.location.reload(!0)},300))},hasEventIdMismatch:function(a){return a&&
this.id()!==a}})})(R9,jQuery);(function(b,e){b.createComponentClass("common.layout.AccountDropdown",{dropdown:null,isOpen:!1,options:{enableNotificationUpdates:!1,signoutRoot:"/k/ident/signout",confirmRoot:"/k/ident/resend",isLoggedInUser:!1},init:function(){this.dropdown=this.getChildElement("dropdown").getWidget()},addEventHandlers:function(){this.subscribe("header.navMenu.dropdown.open",this.open.bind(this));this.subscribe("header.navMenu.dropdown.close",this.close.bind(this));this.subscribe("DropdownDialog.close",{id:this.id("dropdown")},
this.close.bind(this));this.subscribe("header.navMenu.dropdown.toggle",this.toggle.bind(this));this.getChildElement("more-logout").click(this.logout.bind(this));this.getChildElement("more-confirmation").click(this.confirmAccount.bind(this));this.options.enableNotificationUpdates&&this.subscribe(["trips.add","trips.remove","trips.move.event.finished"],this.updateNotificationCount.bind(this))},logout:function(){b.Social.WebCredentials.requireUserMediation();window.location=this.options.signoutRoot+
"?redir\x3d"+encodeURIComponent(window.location.pathname);b.Analytics.api.trackEvent({action:"logout",label:"click"})},confirmAccount:function(){window.location=this.options.confirmRoot+"?redir\x3d"+encodeURIComponent(window.location.pathname)},setTripsCount:function(a){isNaN(a)||this.getChildElement("trips-counter").text(a)},updateNotificationCount:function(){var a=this;b.action.execute("common/authentication/UserStateAction").done(function(b){a.setTripsCount(b.tripsCount)})},tryWebCredentialLogin:function(){var a=
e.Deferred();b.Social.WebCredentials.trySignIn(a.reject);return a},open:function(a){var c=this,d=function(){c.dropdown.open();c.isOpen=!0};b.events.publish("signin.open");a=a&&"forgot"===a.source;this.isLoggedInUser||a?d():this.tryWebCredentialLogin().catch(d)},close:function(){this.dropdown.close();this.isOpen=!1},toggle:function(){this.isOpen?this.close():this.open()}})})(R9,jQuery);(function(a,k){var h=[a.globals.keyCodes.RETURN,a.globals.keyCodes.SPACE];a.createComponentClass("common.layout.NavMenuAuth",{view:"",accountLabel:null,options:{resultsPagePresentation:null,showFocusIndication:!1,view:"",isOpenAccountOnClick:!1,currentPresentation:null},init:function(){this.view=this.options.view?this.options.view.toLowerCase():""},addEventHandlers:function(){var c=this;this.subscribe("header.auth.reload",this.reloadComponent.bind(this));this.options.presentation!==this.options.resultsPagePresentation&&
this.subscribe(["header.view.set","sem.explore.form.change-state"],function(b){b=b.view||b.newstate;-1!==["rp","results"].indexOf(b)?c.updateViewStyles(c.options.resultsPagePresentation):b&&c.updateViewStyles("")});this.options.showFocusIndication&&this.subscribe("body.accessibilityMode.enabled",function(b){var g=c.getChildElement("account-button"),d=c.getChildElement("account-link"),f=c.getChildElement("trips-button"),e=c.options.focusedElement;b?(a.dom.swapClasses(g,"",e),a.dom.swapClasses(d,"",
e),a.dom.swapClasses(f,"",e)):(a.dom.swapClasses(g,e,""),a.dom.swapClasses(d,e,""),a.dom.swapClasses(f,e,""))});var d=!1;this.getChildElement("account-button").on("click",function(b){b.stopPropagation();d||(d=!0,setTimeout(function(){d=!1},100),a.events.publish("header.navMenu.dropdown.toggle"),a.Analytics.api.trackEvent({action:"my-account",label:"click"}),a.events.publish("common.dropdown.closeAll",{avoidElementId:c.id("dropdown")}))});this.subscribe("DropdownDialog.close",{id:this.id("accountDropdown-dropdown")},
function(){c.getChildElement("account-button").focus()});this.registerEvent("keydown",this.getChildElement("account-link"),this.handleKeyPress.bind(this));if(this.options.isOpenAccountOnClick){var f;this.registerEvent("mouseenter click",this.getChildElement("account-link"),function(b){b.stopPropagation();clearTimeout(f);a.events.publish("header.navMenu.dropdown.toggleon");return!1});this.registerEvent("mouseleave",this.getChildElement("account-link"),function(b){b.stopPropagation();f=setTimeout(function(){a.events.publish("header.navMenu.dropdown.toggleoff")},
a.config.getInt("ui.common.account.header.v2.timeout",150))});this.subscribe(["account.picture.changed","account.action.change-nickname"],function(){a.action.execute("account/v2/action/navdetails").then(function(b){var d=a.template.render("personalizedAccountPic",{url:b.url,accountLetter:b.accountLetter,defaultPic:!b.url&&!b.accountLetter});b=a.template.render("personalizedAccountLabel",{accountLabel:b.accountLabel});c.getChildElement("account-pic").html(d);c.getChildElement("account-name").html(b)}).fail(function(b){})})}},
reloadComponent:function(){var c=this;a.ajax.execute("common/layout/NavMenuAuth",{method:"GET",data:{pageType:this.options.view,resultsPagePresentation:this.options.resultsPagePresentation,isOpenAccountOnClick:this.options.isOpenAccountOnClick,showFocusIndication:this.options.showFocusIndication,currentPresentation:this.options.currentPresentation},allowRobots:!1,highPriority:!0,appendTo:this.element,replaceContainer:!0,customUpdate:function(){a.ComponentManager.remove(c.element,!1);return!1}})},
updateViewStyles:function(a){this.swapPresentationBlocks(a,"AccountButton AccountLink AccountLabel AccountName AccountBadge TripsButton ProfileIconLetter".split(" "))},handleKeyPress:function(c){-1!==h.indexOf(c.keyCode)&&a.events.publish("header.navMenu.dropdown.toggleon",{focusSelectorOnKeyClose:"#"+this.id("account-link")})}})})(R9,jQuery);(function(c,f){c.createComponentClass("common.layout.StyleJamHeader",{options:{focusHeaderMenuOnLoad:!1,navigationVisible:!0,statesClasses:{"default":{main:"",headerWrapper:"",headerContainer:"",caretBorder:""},hidden:{main:"",headerWrapper:"",headerContainer:"",caretBorder:""},results:{main:"",headerWrapper:"",headerContainer:"",caretBorder:""},navWrapper:{hidden:"",visible:""},activeState:""},swapInvertedLogoOnRp:!1,useCaret:!1,isHeaderSticky:!1,fullWidthMap:!1},headerContainer:null,inlineComponentsReady:function(){var b=
this;if(this.options.focusHeaderMenuOnLoad&&!this.isHashNavigation()&&!c.globals.isSeo){var a=this.element.find(".StyleJamNavLink")[0];a&&a.focus()}this.answer("header.height",function(){return b.element.outerHeight()});this.options.isHeaderSticky&&c.events.publish("pinnableBar.pinnedChange");this.headerContainer=this.getChildElement("headerContainer")},isHashNavigation:function(){return!!window.location.hash},addEventHandlers:function(){var b=this;b.element.find("#myAccount").click(function(a){a.stopPropagation();
c.events.publish("header.account.clicked",{})});c.events.subscribe(["header.view.set","pageContainers.changed","sem.explore.form.change-state"],function(a){if(a.view||a.newstate)a=a.view||a.newstate,b.changeView("rp"===a?"results":a)});this.options.useCaret&&c.events.subscribe("header.hideCaretBorder",function(){b.getChildElement("caretBorder").hide()});this.subscribe("hotels.results.dualViewMap.open",this.setDualViewMapOpen.bind(this,!0));this.subscribe("hotels.results.dualViewMap.closed",this.setDualViewMapOpen.bind(this,
!1))},setDualViewMapOpen:function(b){this.element.toggleClass("map-open",b);this.element.toggleClass("map-closed",!b);this.options.fullWidthMap&&this.swapClassesToggle(this.headerContainer,"Header--fullWidth","Header--normalWidth",b)},changeView:function(b){var a=this.options.statesClasses[b],e=this.options.statesClasses.activeState,d=this.options.statesClasses[e]||this.options.statesClasses.default;a||(a=this.options.statesClasses.default);a&&b!==e&&(c.dom.swapClasses(this.element,d.main,a.main),
c.dom.swapClasses(this.getChildElement("headerWrapper"),d.headerWrapper,a.headerWrapper),c.dom.swapClasses(this.getChildElement("headerContainer"),d.headerContainer,a.headerContainer),d.caretBorder&&a.caretBorder&&c.dom.swapClasses(this.getChildElement("caretBorder"),d.caretBorder,a.caretBorder),this.options.statesClasses.activeState=b,"results"!==b||this.options.navigationVisible||(this.options.navigationVisible=!0,this.getChildElement("verticals").attr("aria-hidden","false")));this.options.swapInvertedLogoOnRp&&
"results"===b&&(this.toggleLogoVisibility(this.element.find(".js-logo")),this.toggleLogoVisibility(this.element.find(".js-logo-inverted")))},toggleLogoVisibility:function(b){var a=!b.hasClass(this.getStlBlock("Header__phoenixLogo--hidden"));this.swapClassesToggle(b,"Header__phoenixLogo--hidden","Header__phoenixLogo--visible",a)}})})(R9,jQuery);(function(a){a.createComponentClass("common.layout.StyleJamFooter",{options:{isSeo:!1,loadContent:!1,needSeoFooter:!1,showYoloEmailSubscriptionPopUp:!1,userEmail:void 0},fdFooter:null,rpFooter:null,init:function(){this.fdFooter=jq("#footer-fd",this.element);this.rpFooter=jq("#footer-rp",this.element);this.options.loadContent&&a.ajax.execute("common/layout/AjaxFooterLinks",{type:"GET",data:{id:this.id(),isSeo:this.options.isSeo,forceSeoLinks:this.options.forceSeoLinks},cacheable:this.options.ajaxLinksCacheable,
combinable:this.options.ajaxLinksCombinable,replace:!0}).then(function(){a.events.publish("common.layout.StyleJamFooter.AjaxFooterLinks.loaded")});this.options.showYoloEmailSubscriptionPopUp&&(a.ajax.execute("common/authentication/GoogleYoloEmailSubscription",{data:{email:this.options.userEmail},appendTo:$("body")}),window.deleteMetaCookie("showYoloEmailSubscriptionPopUp"))},addEventHandlers:function(){var b=this;a.question.answer("footer.offset",function(){return b.element.position()});a.events.subscribe("footer.show",
function(){b.element.show()});a.events.subscribe("footer.hide",function(){b.element.hide()});a.events.publish("footer.init");a.events.subscribe("resultspage.view.setvisible",this.updateVisibility.bind(this));a.events.subscribe("footer.update.rp.disclaimer",this.updateText.bind(this))},updateVisibility:function(){this.options.needSeoFooter&&this.fdFooter&&this.rpFooter&&(this.fdFooter.addClass("hidden"),this.rpFooter.removeClass("hidden"))},updateText:function(a){this.options.needSeoFooter&&this.rpFooter&&
this.rpFooter.html(a.message)}})})(R9);(function(a,d){a.createComponentClass("common.authentication.PromotedSignup","framework.JavaScriptComponent",{options:{showForcedSignup:!1,isMultiLocaleMandatorySignup:!1},init:function(){},inlineComponentsReady:function(){var c=this.options.isMultiLocaleMandatorySignup;this.options.showForcedSignup&&setTimeout(function(){if(c)a.authentication.showSignup({promo:"multilocale",preventClose:!0,type:"login"});else{var b=window.location.href;-1===b.lastIndexOf("/maps/hotelnew")&&-1===b.lastIndexOf("/reset/")&&
-1===b.lastIndexOf("/mobile")&&setMetaCookie("forced-signup-shown","true",function(){a.config.getBoolean("ui.forcedsignup.enabled",!1)&&a.authentication.showSignup({promo:"promotedsignupv2"})})}},10)}})})(R9,jq||jQuery);(function(a,b){a.createComponentClass("common.utils.admin.Tools",{options:{showExperimentSwitchTool:!1,showFeaturesSwitchTool:!1,showCookieControlTool:!1,showFindTemplateTool:!1,seoIndexDisabled:!1,currentExperiments:null,icon:null},legacyAdminToolsInstance:null,constructor:function(a,d,e){this._id=a;this.options=b.extend({},this.options,b.extend(d||{},e||{}));this.init()},init:function(){this.legacyAdminToolsInstance=a.Admin.AdminTools.getInstance({classNameMainContainer:"Common-Utils-Admin-Tools layer-sticky r9-admin-main"},
!0);this.options.showExperimentSwitchTool&&this.legacyAdminToolsInstance.addTool(new a.Admin.Tools.ExperimentTool({currentExperiments:this.options.currentExperiments}));this.options.showFeaturesSwitchTool&&this.legacyAdminToolsInstance.addTool(new a.Admin.Tools.FeatureTool);this.options.showCookieControlTool&&this.legacyAdminToolsInstance.addTool(new a.Admin.Tools.CookieTool);this.options.showFindTemplateTool&&this.legacyAdminToolsInstance.addTool(new a.Admin.Tools.FindTemplateTool);var c=this.getChildElement("chev").detach();
if(c){var d=this;c.click(function(a){a.stopPropagation();a.stopImmediatePropagation();d.legacyAdminToolsInstance.getMenuContainer().toggleClass("collapsed")});this.legacyAdminToolsInstance.getMenuContainer().children().eq(0).prepend(c)}this.options.seoIndexDisabled&&(0<b("link[rel\x3d'canonical'][href$\x3d'/seonox']").length&&b("body").addClass("seonox"),b("a[href$\x3d'/seonox']").addClass("seonox"))}})})(window.R9,window.jQuery);(function(b,c){b.createComponentClass("common.errors.ErrorDialog",{dialog:null,dialogEl:null,title:null,messages:null,init:function(){this.dialogEl=this.getChildElement("dialog");this.dialog=this.dialogEl.dialog({}).getWidget();this.title=this.getChildElement("title");this.messages=this.getChildElement("messages")},addEventHandlers:function(){var a=this;this.subscribe("error.alert",this.show.bind(this));b.events.when("error.alert",this.show.bind(this));this.subscribe("error.dismiss",this.hide.bind(this));
this.getChildElement("close").on("click keydown",function(c){c.keyCode!==b.globals.keyCodes.TAB&&a.dialog.close()})},show:function(a){var b=this;a.title?(this.title.html(a.title),this.dialogEl.addClass("hasTitle")):(this.title.html(""),this.dialogEl.removeClass("hasTitle"));this.messages.html("");a.messages&&(c.isArray(a.messages)||(a.messages=[a.messages]),c.each(a.messages,function(a,d){a=c("\x3cli\x3e").html(d);b.messages.append(a)}));this.dialog.open()},hide:function(){this.dialog.close()}})})(R9,
jQuery);(function(a,b){a.createComponentClass("common.layout.StandardBody",{stateClasses:{results:"ResultsPageBody"},init:function(){},addEventHandlers:function(){}})})(R9,jQuery);(function(e,f){f.openTooltipInstances={};var b=!1;R9.extend("Widgets",{Tooltip:function(a,d){this.element=e(a);this.element.data(this.widgetName,this);this.setOptions(d,!0)}});R9.extend("Widgets.Tooltip",{validateElement:function(a){return void 0===e(a).data(this.prototype.widgetName)},getInstance:function(a,d){return this.validateElement(a)?new R9.Widgets.Tooltip(a,d):(a=e(a).data(this.prototype.widgetName),d?a.setOptions(d):a)},removeWidget:function(a){this.validateElement(a)||this.getInstance(a).removeWidget()},
setDebug:function(a){b=a},isDebug:function(){return b}});R9.extend("Widgets.Tooltip.prototype",{element:null,widgetNamespace:"r9-tooltip",widgetBaseClass:"r9-tooltip",widgetName:"tooltip",positionTarget:"data-tooltip-position-target",isOpen:!1,options:{delay:200,fadeIn:200,fadeOut:200,edgeOffset:3,baseClass:null,content:null,positionTarget:null,position:"top",activation:"hover",showImmediately:!1,subNameSpace:"",onOpen:null,fixedPositioning:null,onClose:null,positionUpdate:!1,appendTo:"body",offsetLeft:0,
offsetAgainstEdge:!0,keepOpenOnContentHover:!1,keepOpenOnPositionTargetHover:!1,readContentOnOpen:!1,keepOpenOnRelatedTargetHover:!0,closeDelay:0,fallbackPosition:null,forceDesiredPosition:!1},_timer:null,_closeTimer:null,_originalTitle:null,_positionUpdater:null,init:function(){this._removeAllWidgetBindings();openTooltipInstances.hasOwnProperty(this.options.subNameSpace)||(openTooltipInstances[this.options.subNameSpace]=null);var a=this,d=a._getContainerElement(),c=a._getArrowElement();switch(this.options.activation){case "click":this.element.on("click."+
this.widgetName,function(c){null===openTooltipInstances[a.options.subNameSpace]&&(a.isOpen=!1);a.isOpen?a.close(c):setTimeout(a.open.bind(a,c),0)});this.options.keepOpenOnContentHover||this.bindContainerHoverEvents();this.options.showImmediately&&this.element.trigger("click."+this.widgetName);break;case "focus":this.element.on("focus."+this.widgetName,function(c){a.open(c)});this.element.on("blur."+this.widgetName,function(c){a.close(c)});this.options.showImmediately&&this.element.trigger("focus."+
this.widgetName);break;default:this.element.on("mouseenter."+this.widgetName,function(c){clearTimeout(a._closeTimer);a.open(c)}),(this.options.keepOpenOnPositionTargetHover?this._getPositionTarget():this.element).on("mouseleave."+this.widgetName,function(b){a.options.keepOpenOnRelatedTargetHover&&(e(b.relatedTarget).closest(d).length||e(b.relatedTarget).closest(c).length)||(a.options.closeDelay?a._closeTimer=setTimeout(function(){a.close(b)},a.options.closeDelay):a.close(b))}),this.options.showImmediately&&
this.element.trigger("mouseenter."+this.widgetName),this.options.keepOpenOnContentHover&&this.bindContainerHoverEvents()}return this},bindContainerHoverEvents:function(){var a=this;this._getContainerElement().on("mouseenter."+this.widgetName,function(){a.isOpen&&clearTimeout(a._closeTimer)}).on("mouseleave."+this.widgetName,function(d){a.isOpen&&!e(d.relatedTarget).closest(a._getArrowElement()).length&&(a._closeTimer=setTimeout(function(){a.close(d)},a.options.closeDelay))})},setOptions:function(a,
d){a&&(this.options=e.extend({},this.options,a));(a||d)&&this.init();return this},open:function(a){var d=this.getContent(a);if(!d||this.isOpen)return this;openTooltipInstances[this.options.subNameSpace]&&openTooltipInstances[this.options.subNameSpace]!==this&&openTooltipInstances[this.options.subNameSpace].close();var c=this._getWrapperElement(),b=this._getContainerElement(),g=this._getArrowElement();this.renderContent(d,b);this._resetElements(c,b,g);d=this._getPositionMap(c,g);this._updateArrowElement(d,
g);this._updateWrapperElement(d,c);this._updateContainerElement(d,b);if(this.options.fixedPositioning){var h=this;Object.keys(this.options.fixedPositioning).forEach(function(a){c.css(a,h.options.fixedPositioning[a])});c.css("position","fixed")}this._timer&&clearTimeout(this._timer);this._closeTimer&&clearTimeout(this._closeTimer);this.isOpen=!0;openTooltipInstances[this.options.subNameSpace]=this;if(this.options.delay){var k=this;this._timer=setTimeout(function(){k._open(c,a)},this.options.delay)}else this._open(c,
a);this._positionUpdater&&clearInterval(this._positionUpdater);e(f).on("resize",e.proxy(this._updatePosition,this));return this},renderContent:function(a,d){d.html(a)},close:function(){if(!R9.Widgets.Tooltip.isDebug()){this._timer&&clearTimeout(this._timer);this._closeTimer&&clearTimeout(this._closeTimer);this._positionUpdater&&clearInterval(this._positionUpdater);e(f).off("resize",this._updatePosition);var a=this._getWrapperElement();a.stop(!0,!0);this.isOpen=!1;openTooltipInstances[this.options.subNameSpace]=
null;var d=this;this.options.fadeOut?a.fadeOut(this.options.fadeOut,function(){d._close()}):(a.hide(),this._close());return this}},getContent:function(a){var d=this.element.attr("title");d&&(this._originalTitle=d,this.element.attr("title",""));return this.options.content?"function"==typeof this.options.content?this.options.content.call(this,a):this.options.content:this._originalTitle?this._originalTitle:null!=this.element.data("title")?this.element.data("title"):this.element.text()},removeWidget:function(){this._removeAllWidgetBindings();
this.element.removeData(this.widgetName);this.close();return this},_updatePosition:function(){var a=this._getWrapperElement(),d=this._getContainerElement(),c=this._getArrowElement(),b=this._getPositioning(a,c);this._updateArrowElement(b,c);a.css({top:b.newWrapperTop+"px",left:b.newWrapperLeft+"px"});this._updateContainerElement(b,d)},_getWrapperElement:function(){var a=e("#"+this._getIdValue("-wrapper"));a.length||(a=this._createDOMElement("-wrapper"),this.options.readContentOnOpen?a.attr("role",
"alert"):a.attr("role","tooltip"),e(this.options.appendTo).append(a));return a},_getContainerElement:function(){var a=e("#"+this._getIdValue("-container"));a.length||(a=this._createDOMElement("-container"),this._getWrapperElement().append(a));return a},_getArrowElement:function(){var a=e("#"+this._getIdValue("-arrow"));a.length||(a=this._createDOMElement("-arrow"),this._getWrapperElement().append(a));return a},_createDOMElement:function(a){var d=e("\x3cdiv\x3e\x3c/div\x3e").attr("id",this._getIdValue(a));
this._setStyleClasses(d,a);return d},_removeAllWidgetBindings:function(){this.element.off("click."+this.widgetName).off("focus."+this.widgetName).off("blur."+this.widgetName).off("mouseenter."+this.widgetName).off("mouseleave."+this.widgetName);return this},_getPositionTarget:function(){var a=this.options.positionTarget||this.element.attr(this.positionTarget);return a&&(a=this.options.positionTarget?e("#"+this.options.positionTarget):e(a,this.element),0<a.length)?a:this.element},_getOffsetInformation:function(a,
d,c){var b=this._getPositionTarget();this.options.fixedPositioning&&this._getContainerElement();var g=b.outerWidth(),h=b.outerHeight();a="width"===a?c.outerWidth():c.outerHeight();return{arrowSize:Math.round(a/2),elementWidth:g,elementHeight:h,wrapperWidth:d.outerWidth(),wrapperHeight:d.outerHeight(),offset:{top:Math.floor(b.offset().top-e(this.options.appendTo).offset().top),left:Math.floor(b.offset().left-e(this.options.appendTo).offset().left)}}},_getPositionMap:function(a,d){a.attr("style","").css({top:"-1000px",
left:"-5000px",display:"block"});return this._getPositioning(a,d)},_getPositioning:function(a,d,c){switch(c||this.options.position){case "bottom":return this._getBottomPositioning(a,d);case "left":return this._getLeftPositioning(a,d);case "right":return this._getRightPositioning(a,d);default:return this._getTopPositioning(a,d)}},_getCommonPositioningMap:function(){return{newArrowTop:0,newArrowLeft:0,newWrapperTop:0,newWrapperLeft:0,wrapperClass:""}},getLeftRightOffsetAgainstEdge:function(a,d,c){if(this.options.offsetAgainstEdge){var b=
e(this.options.appendTo).offset(),g=b?b.left+e(this.options.appendTo).width():e(this.options.appendTo).width(),h,k=null!=b&&a<b.left,f=!isNaN(g)&&a+c.wrapperWidth>g;k?h=Math.floor(b.left+this.options.edgeOffset):f&&(h=Math.floor(g-c.wrapperWidth-this.options.edgeOffset));if(k||f)d+=a-h,a=h}return{wrapperLeft:a,arrowLeft:d}},_getTopPositioning:function(a,d){var c=this._getOffsetInformation("height",a,d),b=c.elementWidth/2,g="-top",h=c.wrapperHeight,f=c.offset.top-this.options.edgeOffset-c.arrowSize-
c.wrapperHeight;if(!this.options.forceDesiredPosition&&0>=f){if(this.options.fallbackPosition&&"top"!==this.options.fallbackPosition)return this._getPositioning(a,d,this.options.fallbackPosition);g="-bottom";f=c.offset.top+c.elementHeight+this.options.edgeOffset+c.arrowSize;h=-1*c.arrowSize}a=this.getLeftRightOffsetAgainstEdge(c.offset.left+b-c.wrapperWidth/2+this.options.offsetLeft,c.wrapperWidth/2-c.arrowSize,c);return e.extend(this._getCommonPositioningMap(),{newArrowTop:Math.round(h),newArrowLeft:Math.round(a.arrowLeft),
newWrapperTop:Math.round(f),newWrapperLeft:Math.round(a.wrapperLeft),wrapperClass:g})},_getBottomPositioning:function(a,d){var c=this._getOffsetInformation("height",a,d),b=c.elementWidth/2,g="-bottom",h=-1*c.arrowSize,k=c.offset.top+c.elementHeight+this.options.edgeOffset+c.arrowSize;if(!this.options.forceDesiredPosition&&k+c.wrapperHeight>=jq(f).scrollTop()+e(f).height()){if(this.options.fallbackPosition&&"bottom"!==this.options.fallbackPosition)return this._getPositioning(a,d,this.options.fallbackPosition);
g="-top";k=c.offset.top-this.options.edgeOffset-c.arrowSize-c.wrapperHeight;h=c.wrapperHeight}a=this.getLeftRightOffsetAgainstEdge(c.offset.left+b-c.wrapperWidth/2+this.options.offsetLeft,c.wrapperWidth/2-c.arrowSize,c);return e.extend(this._getCommonPositioningMap(),{newArrowTop:Math.round(h),newArrowLeft:Math.round(a.arrowLeft),newWrapperTop:Math.round(k),newWrapperLeft:Math.round(a.wrapperLeft),wrapperClass:g})},_getLeftPositioning:function(a,b){var c=this._getOffsetInformation("width",a,b),d=
c.elementHeight/2,g=c.wrapperHeight/2,f="-left",k=c.wrapperWidth,l=c.offset.left-this.options.edgeOffset-c.arrowSize-c.wrapperWidth;if(!this.options.forceDesiredPosition&&0>=l){if(this.options.fallbackPosition&&"left"!==this.options.fallbackPosition)return this._getPositioning(a,b,this.options.fallbackPosition);f="-right";l=c.offset.left+c.elementWidth+this.options.edgeOffset+c.arrowSize;k=-1*c.arrowSize}return e.extend(this._getCommonPositioningMap(),{newArrowTop:Math.round(g-c.arrowSize),newArrowLeft:Math.round(k),
newWrapperTop:Math.round(c.offset.top+d-g),newWrapperLeft:Math.round(l),wrapperClass:f})},_getRightPositioning:function(a,b){var c=this._getOffsetInformation("border-right-width",a,b),d=c.elementHeight/2,g=c.wrapperHeight/2,h="-right",k=-1*c.arrowSize,l=c.offset.left+c.elementWidth+this.options.edgeOffset+c.arrowSize;if(!this.options.forceDesiredPosition&&l+c.wrapperWidth>=e(f).width()){if(this.options.fallbackPosition&&"right"!==this.options.fallbackPosition)return this._getPositioning(a,b,this.options.fallbackPosition);
a=c.offset.left-this.options.edgeOffset-c.arrowSize-c.wrapperWidth;0<=a&&(h="-left",l=a,k=c.wrapperWidth)}return e.extend(this._getCommonPositioningMap(),{newArrowTop:Math.round(g-c.arrowSize),newArrowLeft:Math.round(k),newWrapperTop:Math.round(c.offset.top+d-g),newWrapperLeft:Math.round(l),wrapperClass:h})},_setStyleClasses:function(a,b,c){a.attr("class","");this._addStyleClasses(a,b,c);return this},_addStyleClasses:function(a,b,c){b&&(a.addClass(this.widgetBaseClass+b),c&&a.addClass(this.widgetBaseClass+
b+c),this.options.baseClass&&(a.addClass(this.options.baseClass+b),c&&a.addClass(this.options.baseClass+b+c)));return this},_updateWrapperElement:function(a,b){this._addStyleClasses(b,"-wrapper",a.wrapperClass);b.attr("style","");"number"===typeof a.newWrapperTop&&b.css("top",a.newWrapperTop+"px");"number"===typeof a.newWrapperLeft&&b.css("left",a.newWrapperLeft+"px");return this},_updateArrowElement:function(a,b){this._addStyleClasses(b,"-arrow",a.wrapperClass);b.css({top:a.newArrowTop+"px",left:a.newArrowLeft+
"px"});return this},_updateContainerElement:function(a,b){this._addStyleClasses(b,"-container",a.wrapperClass);this.options.updateContainerOnResize&&b.css({top:a.newArrowTop+5+"px",left:a.newArrowLeft-b.width()+"px"});return this},_getIdValue:function(a){return this.widgetNamespace+this.options.subNameSpace+a},_open:function(a,b){var c=this;a.stop(!0,!0);var d=function(a){this.options.onOpen&&this.options.onOpen.call(this,a);this.options.positionUpdate&&(this._positionUpdater=setInterval(e.proxy(this._updatePosition,
this),1E3/60))};this.options.fadeIn?a.fadeIn(this.options.fadeIn,function(){d.call(c,b)}):(a.show(),d.call(c,b));return this},_close:function(){this._originalTitle&&(this.element.attr("title",this._originalTitle),this._originalTitle=null);this.options.onClose&&this.options.onClose.call(this,null);return this},_resetElements:function(a,b,c){this._setStyleClasses(a,"-wrapper");this._setStyleClasses(b,"-container");this._setStyleClasses(c,"-arrow");return this}})})(jq||jQuery,window);
(function(e,f){e.createWidgetClass("tip.ToolTip",f.extend({},e.Widgets.Tooltip.prototype,{contentContainer:null,boundEvents:null,orientationOffset:null,trackEventId:null,options:f.extend({},e.Widgets.Tooltip.prototype.options,{showImmediately:!1,baseClass:"coolTip",extraClass:null,delay:200,position:"top",fallbackPosition:null,forceDesiredPosition:null,orientation:"middle",orientationOffset:null,onDestroy:null,activation:"hover",subNameSpace:"",alwaysRendered:!1,color:"black",size:"l",closeOnBodyClick:!0,
content:"",isComponent:!1,target:null,positionTarget:null,updateContainerOnResize:!1,track:null}),init:function(){this.base();this.options.alwaysRendered&&(this.contentContainer=this.getChildElement("rendered-content"),this.setContent(this.contentContainer.children().eq(0)));e.Widgets.Tooltip.prototype.init.call(this);this.boundEvents={};this.orientationOffset=this._getOrientationOffset()},addEventHandlers:function(){this.subscribe("common.widgets.tooltip.clearCloseTimers",this._clearCloseTimers.bind(this));
var b=this;this.subscribe("common.widgets.tooltip.closeAll",function(){b.isOpen&&b.close()})},destroy:function(){if("function"===typeof this.options.onDestroy)this.options.onDestroy();this.options.fadeOut=!1;var b=this._getContainerElement();Object.keys(this.boundEvents).forEach(function(a){b.off(a,this.boundEvents[a])}.bind(this));this.isOpen&&this.close();this._removeAllWidgetBindings();this.element.removeData(this.widgetName);this.base()},bindComponent:function(){this.element.data("toolTip",this);
this.element.data("widget")||this.element.data("widget",this)},bindEventHandler:function(b,a,d){b=b.replace(/\s|$/g,"."+this.id()+" ");this._getContainerElement().on(b,a,d);this.boundEvents[b]=a},setContent:function(b){this.options.content=b},renderContent:function(b,a){"string"===typeof b?e.Widgets.Tooltip.prototype.renderContent.call(this,b,a):"object"===typeof b?f.contains(a,b)||(a.html(""),a.append(b)):this.log.errorInternal('Bad parameter passed to renderContent(): "content" param must be a String or a jQuery object')},
getOptionalTarget:function(b,a){return"string"===typeof b&&b.length?"#"===b[0]?f(b):f("#"+b):null!==b&&"object"===typeof b?f(b):a},_getOrientationOffset:function(){return null!==this.options.orientationOffset?this.options.orientationOffset:this.options.extraClass&&-1!==this.options.extraClass.indexOf("no-arrow")?0:{start:-15,middle:0,end:15}[this.options.orientation]},_getPositioning:function(b,a,d,c){d=d||this.options.position;var m=e.Widgets.Tooltip.prototype._getPositioning.call(this,b,a,d),g=
{top:0,left:0};if("middle"!==this.options.orientation){var h=this.options.orientation,k,l;c&&(h="start"===h?"end":"start");"left"===d||"right"===d?(l="top",k="outerHeight"):(l="left",k="outerWidth");var n=this.getOptionalTarget(this.options.positionTarget,this.element),q=n[k](),p=this._getWrapperElement()[k]();if(!c&&!this.options.forceDesiredPosition)if(c=n.offset()[l],n="scroll"+l.charAt(0).toUpperCase()+l.slice(1),"start"===h){if(c+p>f(window)[n]()+f(window)[k]())return this._getPositioning(b,
a,d,!0)}else if("end"===h&&c+q-p<f(window)[n]())return this._getPositioning(b,a,d,!0);b=q/2;p/=2;"start"===h?g[l]=Math.ceil(p-b+this.orientationOffset):"end"===h&&(g[l]=Math.ceil(b-p+this.orientationOffset))}m.newArrowTop-=g.top;m.newArrowLeft-=g.left;m.newWrapperTop+=g.top;m.newWrapperLeft+=g.left;return m},clearTrackEvent:function(){this.trackEventId&&(clearTimeout(this.trackEventId),this.trackEventId=null)},startTrackEvent:function(b){this.clearTrackEvent();if(b&&b.wait&&b.label){var a=parseInt(b.wait);
isNaN(a)||1>a||(this.trackEventId=setTimeout(this.triggerTrackEvent.bind(this,b),a))}},triggerTrackEvent:function(b){if(this.element&&this.element.hasClass("tooltip-open")&&b&&b.label){var a={category:b.category||"ToolTip",action:b.action||"open",label:b.label};b.hasOwnProperty("value")&&(a.value=b.value);e.Analytics.api.trackEvent(a)}},_open:function(b){var a=this,d="click."+this.id();e.Widgets.Tooltip.prototype._open.call(this,b);e.events.publish("common.widgets.tooltip.clearCloseTimers",this.options.subNameSpace);
this.element.addClass("tooltip-open");var c=function(c){b[0].contains(c.target)||"click"===a.options.activation&&a.element[0].contains(c.target)||(f(document).off(d),a.close())};this.options.closeOnBodyClick&&setTimeout(function(){f(document).off(d).on(d,c)},1);this.options.track&&this.startTrackEvent(f.extend({wait:2E3},this.options.track))},_close:function(b){var a=this.getContent();this.options.alwaysRendered&&"object"===typeof a&&this.contentContainer.append(a);e.Widgets.Tooltip.prototype._close.call(this,
b);this.element.removeClass("tooltip-open");this.options.closeOnBodyClick&&e.dom.schedule(function(){f(document).off("click."+this.id())}.bind(this));this.options.track&&this.clearTrackEvent()},closeAfter:function(b){this._closeTimer=window.setTimeout(this.close.bind(this),b)},_clearCloseTimers:function(b){b===this.options.subNameSpace&&clearTimeout(this._closeTimer)},_addStyleClasses:function(b,a,d){a&&(b.addClass(this.widgetBaseClass+a),d&&b.addClass(this.widgetBaseClass+a+d),this.options.baseClass&&
(b.addClass(this.options.baseClass+a),d&&b.addClass(this.options.baseClass+a+d)),this.options.color&&b.addClass("Color-"+this.options.color));this.options.extraClass&&b.addClass(this.options.extraClass);this.options.size&&b.addClass("size-"+this.options.size);e.Common.Utils.Browsers.isIE()?b.addClass("ie"):e.Common.Utils.Browsers.isChrome()&&(b.addClass("chrome"),a=e.Common.Utils.Browsers.getChromeVersion(),65!==a&&66!==a||b.addClass("chrome65"));return this},_getOffsetInformation:function(b,a,d){var c=
this.getOptionalTarget(this.options.positionTarget,this.element),e=c.outerWidth(),g=c.outerHeight(),c={top:Math.floor(c.offset().top-f(this.options.appendTo).offset().top),left:Math.floor(c.offset().left-f(this.options.appendTo).offset().left)};b="width"===b?d.outerWidth():d.outerHeight();return{arrowSize:Math.round(b/2),elementWidth:e,elementHeight:g,wrapperWidth:a.outerWidth(),wrapperHeight:a.outerHeight(),offset:c}}}))})(R9,jQuery);(function(g,d){g.createWidgetClass("tip.StyleJamTooltip",{presentations:{wrapper:"Tooltip__Wrapper Tooltip__Wrapper--fixed Tooltip__Wrapper--hidden",visible:"Tooltip__Wrapper--visible",hidden:"Tooltip__Wrapper--hidden",content:"Tooltip__Content",pointer:"Tooltip__Pointer",above:"Tooltip__Pointer Tooltip__Pointer--down",right:"Tooltip__Pointer Tooltip__Pointer--left",below:"Tooltip__Pointer Tooltip__Pointer--up",left:"Tooltip__Pointer Tooltip__Pointer--right"},$targetElem:null,$triggerElem:null,$tooltipElem:null,
$tooltipPointerElem:null,state:null,options:{targetElem:null,triggerElem:null,triggerEvent:"hover",position:"above",positionOffsetX:50,positionOffsetY:50,showDelay:0,hideDelay:1E3,content:null,preRendered:!1},init:function(){this.base();this.state={afID:null,scrolling:!1,scrollTicker:null,visible:!1,showTimeout:0,hideTimeout:0,widthSet:!1};this.$targetElem=d("#"+this.options.targetElem);this.$triggerElem=null!==this.options.triggerElem?d("#"+this.options.triggerElem):this.$targetElem;this.$targetElem.length&&
this.$triggerElem.length?(this.options.preRendered?(this.$tooltipElem=d("#"+this.id()),this.$tooltipPointerElem=this.getChildElement("pointer")):(this.$tooltipElem=d(this.createTooltipElement()),this.$tooltipPointerElem=this.$tooltipElem.children("#"+this.id("pointer"))),this.options.preRendered&&this.$tooltipElem.appendTo(d("body"))):console.warn("StyleJamTooltip: Couldn't locate target element with id: %s",this.options.targetElem)},addEventHandlers:function(){var a=this;switch(this.options.triggerEvent){case "hover":this.$triggerElem.on("mouseenter",
function(){a.show()}).on("mouseleave",function(){a.hide()});this.$tooltipElem.on("mouseenter",function(){a.show()}).on("mouseleave",function(){a.hide()});break;case "click":this.options.hideDelay=0;this.$triggerElem.on("click",function(){a.show()});d(document).on("click",function(b){if(a.state.visible){var c=a.$targetElem[0],e=a.$tooltipElem[0],c=b.target===c||a.isDescendant(c,b.target);b=b.target===e||a.isDescendant(e,b.target);c||b||a.hide()}});break;case "focus":this.$triggerElem.on("focus",function(){a.show()}).on("blur",
function(){a.hide()})}this.setupOnScroll();this.subscribe("common.widgets.tooltip.closeAll",this.hide.bind(this))},createTooltipElement:function(){var a=document.createElement("div");a.setAttribute("id",this.id());a.setAttribute("class",this.getStlBlocks(this.presentations.wrapper));var b=document.createElement("div");b.setAttribute("class",this.getStlBlock(this.presentations.content));b.innerHTML=this.options.content;var c=document.createElement("div");c.setAttribute("id",this.id("pointer"));c.setAttribute("class",
this.getStlBlock(this.presentations.pointer));a.appendChild(b);a.appendChild(c);return a},setupOnScroll:function(){var a=this;this.registerEvent("scroll resize",d(window),function(){clearTimeout(a.state.scrollTicker);!a.state.scrolling&&a.state.visible&&(a.state.scrolling=!0,a.position());a.state.scrollTicker=setTimeout(function(){a.state.scrolling=!1;cancelAnimationFrame(a.state.afID)},150)})},show:function(){var a=this;this.state.visible=!0;this.options.preRendered||this.$tooltipElem.appendTo(d("body"));
this.state.widthSet||(this.$tooltipElem.width(this.$tooltipElem.width()),this.state.widthSet=!0);this.position();this.resetTimers();this.state.showTimeout=setTimeout(function(){a.swapClasses(a.$tooltipElem,a.presentations.hidden,a.presentations.visible)},this.options.showDelay)},hide:function(){var a=this;this.resetTimers();this.state.hideTimeout=setTimeout(function(){a.state.visible=!1;a.swapClasses(a.$tooltipElem,a.presentations.visible,a.presentations.hidden);a.options.preRendered||a.$tooltipElem.remove()},
this.options.hideDelay)},resetTimers:function(){clearTimeout(this.state.showTimeout);clearTimeout(this.state.hideTimeout)},position:function(){var a=this;this.state.scrolling&&(this.state.afID=requestAnimationFrame(function(){a.position()}));var b=this.$targetElem[0].getBoundingClientRect(),c=this.$tooltipElem[0].getBoundingClientRect(),e=this.$tooltipElem[0].currentStyle||window.getComputedStyle(this.$tooltipElem[0]);c.x-=parseFloat(e.marginLeft);c.width=c.width+parseFloat(e.marginLeft)+parseFloat(e.marginRight);
c.height=c.height+parseFloat(e.marginTop)+parseFloat(e.marginBottom);b=this.getRenderPosition(this.options.position,b,c);this.$tooltipElem.css({top:b.y+"px",left:b.x+"px"})},getRenderPosition:function(a,b,c){var e=b.x+this.options.positionOffsetX/100*b.width-c.width/2,d=b.y+this.options.positionOffsetY/100*b.height-c.height/2,f={left:[d,b.x-c.width,this.getInnerHeight()-(d+c.height)],below:[e,this.getInnerHeight()-(b.y+b.height+c.height),this.getInnerWidth()-(e+c.width)],right:[d,this.getInnerWidth()-
(b.x+b.width+c.width),this.getInnerHeight()-(d+c.height)],above:[e,b.y-c.height,this.getInnerWidth()-(e+c.width)]};a=f[a].every(function(a){return 0<=a})?a:Object.keys(f).reduce(function(a,b){return f[a].map(function(a){return 0<a?0:a}).reduce(function(a,b){return a+b})>f[b].map(function(a){return 0<a?0:a}).reduce(function(a,b){return a+b})?a:b});this.$tooltipPointerElem.attr("class","").addClass(this.getStlBlocks(this.presentations[a]));switch(a){case "above":return{x:e,y:b.y-c.height};case "right":return{x:b.x+
b.width,y:d};case "below":return{x:e,y:b.y+b.height};case "left":return{x:b.x-c.width,y:d}}},isDescendant:function(a,b){for(b=b.parentNode;null!=b;){if(b==a)return!0;b=b.parentNode}return!1},getInnerWidth:function(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth},getInnerHeight:function(){return window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}})})(R9,jQuery);(function(b,c){b.createComponentClass("common.seo.SeoMetaTags",{addEventHandlers:function(){this.checkForAdWordsSearch()},checkForAdWordsSearch:function(){b.globals.isSeo&&this.subscribe("cmp2.rendering.finished",function(a){a&&a.items&&a.items.length&&((a=window.location.search.substring(1))&&-1<a.split("\x26").indexOf("a\x3dadwordssearch")&&b.events.publish("cmp2.checkAll"),this.destroy())}.bind(this))}})})(R9,jQuery);(function(b,e){var f=function(a){if(a){a=a.charAt(0).toUpperCase()+a.slice(1);var b="s"===a.slice(-1)?a.slice(0,-1):a;return"."+a+"-Results-"+b+"ResultsPage"}},g=void 0!==window.history.pushState,h=[b.globals.keyCodes.UP,b.globals.keyCodes.DOWN,b.globals.keyCodes.LEFT,b.globals.keyCodes.RIGHT,b.globals.keyCodes.TAB];b.createComponentClass("base.search.SearchPage",{options:{msg:{resultPageTitle:""},isFD:!0,lazyLoadRP:!1,pageVertical:"",analyticsVertical:"",preloadResourcesForRP:!1,resultsPageComponentsMap:{}},
rpLoaded:!1,rpRequest:null,init:function(a){this.rpContainer=this.getChildElement("rp");this.options.isFD?this.options.lazyLoadRP?this.preloadComponents():this.options.preloadRP&&(this.rpLoaded=!0):this.rpLoaded=!0;""!==this.options.msg.resultPageTitle&&(document.title=this.options.msg.resultPageTitle)},addEventHandlers:function(a){var c=this;this.subscribe("pageContainer.contentBlur",function(a){c.element.toggleClass("Blur",a)});a=this.handleSearchSubmit.bind(this);a.priority=1;this.subscribe(["searchform.submit",
"multilocale.search.submit"],a);this.subscribe("omni.vertical.changed",function(a){c.cleanupResultsPage();c.abortActiveResultsPageRequest();b.config.getBoolean("ui.horizon.omni.loadRpOnVerticalChange",!0)&&c.options.resultsPageComponentsMap&&c.options.resultsPageComponentsMap.hasOwnProperty(a)&&c.loadResultsPageComponent(a)});b.question.answer("SearchPage.view",function(){return c.options.isFD?"FD":"RP"});b.config.getBoolean("ui.keyboard.show-focus",!0)&&this.bindAccessibilityHandlers();if(b.config.getBoolean("ui.horizon.modal.no-ad-click",
!0)){var d=this.element;this.subscribe(["InputModal.opened","Select.opened","DatePicker.opened","DropdownDialog.open"],function(){d.addClass("modalOpen")});this.subscribe(["InputModal.closed","Select.closed","DatePicker.closed","DropdownDialog.close"],function(){d.removeClass("modalOpen")})}},abortActiveResultsPageRequest:function(){this.rpTimerId&&clearTimeout(this.rpTimerId);this.rpRequest&&(this.rpRequest.abort(),delete this.rpRequest)},handleSearchSubmit:function(a){a.url&&a.url.startsWith("http")&&
(window.location=a.url);this.abortActiveResultsPageRequest();var b="/"+a.url;this.useSamePageTransition(a)?(window.history.pushState({view:"rp"},"",b),this.options.isFD&&this.switchToRP()):window.location.href=b},useSamePageTransition:function(a){return!a.navigateToResults&&g&&this.rpLoaded&&this.isCorrectRpLoaded(a.vertical)},switchToRP:function(a){b.Analytics.api.setVertical(this.options.analyticsVertical);b.Analytics.api.setPageId("results");"requestId"in b.globals&&(b.globals.requestId=b.globals.requestId.replace("frontdoor",
"results").replace("main",b.globals.vertical||this.options.analyticsVertical));var c=this;window.setTimeout(function(){b.events.publish("frontdoor.view.changed",{view:"inline"});c.element.removeClass("vm-fd");c.element.addClass("vm-rp");b.events.publish("resultspage.view.setvisible",!0);b.events.publish("header.view.set",{view:"results"});b.events.publish("pageContainers.changed",{state:"results"});b.events.publish("body.setClass","wide");b.events.publish("HorizontalFilterList.setClass");b.events.publish("resultspage.routed",
!0);c.rpContainer.removeClass("hiddenFD");c.options.isFD=!1;c.cleanupFrontDoor()},10)},preloadComponents:function(){var a=this;if(this.options.lazyLoadRP){var c=function(){b.globals.vertical===a.options.pageVertical&&a.loadResultsPageComponent(a.options.pageVertical)};"complete"===document.readyState?c():b.events.when("page.initialized",c)}e(document).ready(function(){a.element.hasClass("vm-fd")&&a.options.preloadResourcesForRP&&b.resources.preload("common.booking","styles")})},loadResultsPageComponent:function(a){var c=
this.options.resultsPageComponentsMap[a];if(c&&c.component){this.abortActiveResultsPageRequest();this.cleanupResultsPage();var d=this;this.rpTimerId=setTimeout(function(){d.rpRequest=b.ajax.execute(c.component,{appendTo:d.rpContainer});d.rpRequest.then(function(){d.rpLoaded=!0;b.globals.vertical=a;d.options.analyticsVertical=c.analyticsVertical;delete d.rpRequest})},100)}},cleanupResultsPage:function(){b.ComponentManager.remove(this.rpContainer,!1);this.rpContainer&&this.rpContainer.empty();this.rpLoaded=
!1},cleanupFrontDoor:function(){var a=this;setTimeout(function(){b.ComponentManager.remove(a.id("fd"))},800)},isCorrectRpLoaded:function(a){return 1===this.getChildElement("rp").find(".Base-Results-ResultsPage").length&&1===this.getChildElement("rp").find(f(a)).length},bindAccessibilityHandlers:function(){this.toggleKeyboardFocus(!1);e(document).on("keydown.ada",function(a){!b.globals.keyboardNav&&-1<h.indexOf(a.keyCode)&&this.toggleKeyboardFocus(!0)}.bind(this));e(document).on("mousemove.ada",this.toggleKeyboardFocus.bind(this,
!1))},toggleKeyboardFocus:function(a){b.globals.keyboardNav=a?!0:!1}})})(R9,jq||jQuery);(function(a,b){a.createComponentClass("flights.search.FlightSearchPage","base.search.SearchPage",{options:{preloadResourcesForRP:a.config.getBoolean("ui.horizon.searchpage.flights.preloadStyles",!0)}})})(R9,jQuery);function validateEmail(a){if(!a||!a.match)return!1;a=a.match(/^[A-Z0-9._%+-]{1,63}@(?:[A-Z0-9-]+\.){1,125}[A-Z]{2,63}$/i);return!!(a&&a[0]&&a[0].length)}function replaceArgs(){for(var a=arguments[0],b=1;b<=arguments.length;b++)a=a.replace("{"+(b-1)+"}",arguments[b]);return a}R9.metacookie=R9.metacookie||{};R9.metacookie.saveQueue=R9.metacookie.saveQueue||[];
function saveQueuedMetaCookie(){if(0!=R9.metacookie.saveQueue.length){var a=R9.metacookie.saveQueue[0];jq.ajax({type:"POST",url:"/k/cookie",data:{action:"setmeta",metacookie:a.name,metavalue:a.value,formtoken:R9.globals.formtoken},complete:function(){R9.metacookie.saveQueue.shift();saveQueuedMetaCookie()},success:function(){a.callback()}})}}function setMetaCookie(a,b,c){R9.metacookie.saveQueue.push({name:a,value:b,callback:c||jq.noop});1==R9.metacookie.saveQueue.length&&saveQueuedMetaCookie()}
function deleteMetaCookie(a,b){"function"!==typeof b&&(b=$.noop);jq.ajax({type:"POST",url:"/k/cookie",data:{action:"deletemeta",metacookie:a,formtoken:R9.globals.formtoken},success:b})}jq.ajaxPrefilter("script",function(a){a.cache=!0});(function(c){c.createComponentClass("common.core.RealUserMeasurementsComponent",{options:{fullstoryEnabled:!1},trackedSubmit:!1,addEventHandlers:function(){this.base();this.subscribe("searchform.submit",this.onSearchSubmit.bind(this))},onSearchSubmit:function(a){if(!this.trackedSubmit&&this.options.fullstoryEnabled&&window&&"FS"in window&&a&&a.vertical){this.trackedSubmit=!0;a="did"+this.fixCase(a.vertical)+"Search_bool";var b={};b[a]=!0;FS.setUserVars(b)}},fixCase:function(a){return a.toLowerCase().replace(/(^| )(\w)/g,
function(a){return a.toUpperCase()})}})})(R9);(function(d,f,e,c){d.createComponentClass("common.core.FullyInvisibleCaptcha",{options:{enabled:!1},init:function(){var a=this;this.options.enabled&&(this.setupCaptchaCallback(),this.initAPI().then(function(){a.fireCaptcha()}))},setupCaptchaCallback:function(){var a=this;c.onReCaptchaSubmit=function(b){a.captchaResult(b)};c.onReCaptchaError=function(a){console.log(a)}},initAPI:function(){var a=f.Deferred();c.recaptchaReady=function(){a.resolve()};var b=e.createElement("script");b.type="text/javascript";
b.async=!0;b.src="https://www.google.com/recaptcha/api.js?onload\x3drecaptchaReady\x26render\x3dexplicit";e.getElementById("recaptcha-root").appendChild(b);return a},fireCaptcha:function(){"undefined"!==typeof grecaptcha&&(grecaptcha.render("captcha",{},!0),grecaptcha.execute())},captchaResult:function(a){d.action.execute("common.core.FullyInvisibleCaptchaAction",{data:a})}})})(R9,jQuery,document,window);(function(e,d){e.createComponentClass("common.core.FastlyTiming",{options:{runTest:!1,measurementUrl:"/fastly-timer",logUrl:"/s/run/fastlytimerlog"},init:function(){this.options.runTest&&this.runTimingRequest()},runTimingRequest:function(){d.ajax({type:"POST",url:this.options.measurementUrl,success:this.logResult.bind(this)})},logResult:function(c,a,b){b&&c&&c.cluster&&(a=b.getResponseHeader("x-served-by"),b=b.getResponseHeader("x-timer"),a&&b&&(a=a.split(" "),a=a[a.length-1].split("-"),d.ajax({type:"POST",
url:this.options.logUrl,data:{cluster:c.cluster,timer:b,fastlyNode:a[a.length-1]}})))}})})(R9,jQuery);(new R9.logger).timeEnd("combined");